"use strict";(self.webpackChunkangularapp=self.webpackChunkangularapp||[]).push([[179],{2011:(mt,Fe,P)=>{P.d(Fe,{Dh:()=>fe,GT:()=>Ce,cc:()=>Te,hO:()=>Ue,on:()=>z,pX:()=>ye,xv:()=>we});var f=P(4650),B=P(127),N=P(880);mt=P.hmd(mt);const oe=["ngOnDestroy"],ye=(pe,rt,Ye,Ve={})=>new Proxy(pe,{get:(Pe,Ae)=>Ye.runOutsideAngular(()=>{var Je;if(pe[Ae])return!(null===(Je=Ve?.spy)||void 0===Je)&&Je.get&&Ve.spy.get(Ae,pe[Ae]),pe[Ae];if(oe.indexOf(Ae)>-1)return()=>{};const te=rt.toPromise().then(me=>{const Re=me&&me[Ae];return"function"==typeof Re?Re.bind(me):Re&&Re.then?Re.then(X=>Ye.run(()=>X)):Ye.run(()=>Re)});return new Proxy(()=>{},{get:(me,Re)=>te[Re],apply:(me,Re,X)=>te.then(re=>{var ae;const ve=re&&re(...X);return!(null===(ae=Ve?.spy)||void 0===ae)&&ae.apply&&Ve.spy.apply(Ae,X,ve),ve})})})}),Ce=(pe,rt)=>{rt.forEach(Ye=>{Object.getOwnPropertyNames(Ye.prototype||Ye).forEach(Ve=>{Object.defineProperty(pe.prototype,Ve,Object.getOwnPropertyDescriptor(Ye.prototype||Ye,Ve))})})};class de{constructor(rt){return rt}}const fe=new f.OlP("angularfire2.app.options"),we=new f.OlP("angularfire2.app.name");function z(pe,rt,Ye){const Pe="object"==typeof Ye&&Ye||{};Pe.name=Pe.name||"string"==typeof Ye&&Ye||"[DEFAULT]";const Je=B.Z.apps.filter(te=>te&&te.name===Pe.name)[0]||rt.runOutsideAngular(()=>B.Z.initializeApp(pe,Pe));try{JSON.stringify(pe)!==JSON.stringify(Je.options)&&G("error",`${Je.name} Firebase App already initialized with different options${mt.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new de(Je)}const G=(pe,...rt)=>{(0,f.X6Q)()&&typeof console<"u"&&console[pe](...rt)},ne={provide:de,useFactory:z,deps:[fe,f.R0b,[new f.FiY,we]]};let Ue=(()=>{class pe{constructor(Ye){B.Z.registerVersion("angularfire",N.q4.full,"core"),B.Z.registerVersion("angularfire",N.q4.full,"app-compat"),B.Z.registerVersion("angular",f.q4F.full,Ye.toString())}static initializeApp(Ye,Ve){return{ngModule:pe,providers:[{provide:fe,useValue:Ye},{provide:we,useValue:Ve}]}}}return pe.\u0275fac=function(Ye){return new(Ye||pe)(f.LFG(f.Lbi))},pe.\u0275mod=f.oAB({type:pe}),pe.\u0275inj=f.cJS({providers:[ne]}),pe})();function Te(pe,rt,Ye,Ve,Pe){const[,Ae,Je]=globalThis.\u0275AngularfireInstanceCache.find(te=>te[0]===pe)||[];if(Ae)return function Oe(pe,rt){try{return pe.toString()===rt.toString()}catch{return pe===rt}}(Pe,Je)||(ge("error",`${rt} was already initialized on the ${Ye} Firebase App with different settings.${We?" You may need to reload as Firebase is not HMR aware.":""}`),ge("warn",{is:Pe,was:Je})),Ae;{const te=Ve();return globalThis.\u0275AngularfireInstanceCache.push([pe,te,Pe]),te}}const We=!!mt.hot,ge=(pe,...rt)=>{(0,f.X6Q)()&&typeof console<"u"&&console[pe](...rt)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},880:(mt,Fe,P)=>{P.d(Fe,{q4:()=>Va,iC:()=>Gi,fc:()=>Io,HU:()=>na,vb:()=>Ep,JM:()=>$u});var f=P(4650),B=P(5867),N=P(5861),oe=P(9681),ye=P(2090),Ce=P(4859),de=P(1877);P(2833);const we="@firebase/remote-config",z="0.3.11",Te=new ye.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class ft{constructor(k,Y,ce,je){this.client=k,this.storage=Y,this.storageCache=ce,this.logger=je}isCachedDataFresh(k,Y){if(!Y)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const ce=Date.now()-Y,je=ce<=k;return this.logger.debug(`Config fetch cache check. Cache age millis: ${ce}. Cache max age millis (minimumFetchIntervalMillis setting): ${k}. Is cache hit: ${je}.`),je}fetch(k){var Y=this;return(0,N.Z)(function*(){const[ce,je]=yield Promise.all([Y.storage.getLastSuccessfulFetchTimestampMillis(),Y.storage.getLastSuccessfulFetchResponse()]);if(je&&Y.isCachedDataFresh(k.cacheMaxAgeMillis,ce))return je;k.eTag=je&&je.eTag;const tt=yield Y.client.fetch(k),vt=[Y.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===tt.status&&vt.push(Y.storage.setLastSuccessfulFetchResponse(tt)),yield Promise.all(vt),tt})()}}function Gt(L=navigator){return L.languages&&L.languages[0]||L.language}class xt{constructor(k,Y,ce,je,tt,vt){this.firebaseInstallations=k,this.sdkVersion=Y,this.namespace=ce,this.projectId=je,this.apiKey=tt,this.appId=vt}fetch(k){var Y=this;return(0,N.Z)(function*(){var ce,je,tt;const[vt,Wt]=yield Promise.all([Y.firebaseInstallations.getId(),Y.firebaseInstallations.getToken()]),St=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${Y.projectId}/namespaces/${Y.namespace}:fetch?key=${Y.apiKey}`,Sn={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":k.eTag||"*"},kt={sdk_version:Y.sdkVersion,app_instance_id:vt,app_instance_id_token:Wt,app_id:Y.appId,language_code:Gt()},In={method:"POST",headers:Sn,body:JSON.stringify(kt)},Do=fetch(St,In),Wi=new Promise((Gs,bi)=>{k.signal.addEventListener(()=>{const sr=new Error("The operation was aborted.");sr.name="AbortError",bi(sr)})});let Ur;try{yield Promise.race([Do,Wi]),Ur=yield Do}catch(Gs){let bi="fetch-client-network";throw"AbortError"===(null===(ce=Gs)||void 0===ce?void 0:ce.name)&&(bi="fetch-timeout"),Te.create(bi,{originalErrorMessage:null===(je=Gs)||void 0===je?void 0:je.message})}let zi=Ur.status;const ja=Ur.headers.get("ETag")||void 0;let $s,To;if(200===Ur.status){let Gs;try{Gs=yield Ur.json()}catch(bi){throw Te.create("fetch-client-parse",{originalErrorMessage:null===(tt=bi)||void 0===tt?void 0:tt.message})}$s=Gs.entries,To=Gs.state}if("INSTANCE_STATE_UNSPECIFIED"===To?zi=500:"NO_CHANGE"===To?zi=304:("NO_TEMPLATE"===To||"EMPTY_CONFIG"===To)&&($s={}),304!==zi&&200!==zi)throw Te.create("fetch-status",{httpStatus:zi});return{status:zi,eTag:ja,config:$s}})()}}class er{constructor(k,Y){this.client=k,this.storage=Y}fetch(k){var Y=this;return(0,N.Z)(function*(){const ce=(yield Y.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return Y.attemptFetch(k,ce)})()}attemptFetch(k,{throttleEndTimeMillis:Y,backoffCount:ce}){var je=this;return(0,N.Z)(function*(){yield function Qe(L,k){return new Promise((Y,ce)=>{const je=Math.max(k-Date.now(),0),tt=setTimeout(Y,je);L.addEventListener(()=>{clearTimeout(tt),ce(Te.create("fetch-throttle",{throttleEndTimeMillis:k}))})})}(k.signal,Y);try{const tt=yield je.client.fetch(k);return yield je.storage.deleteThrottleMetadata(),tt}catch(tt){if(!function cn(L){if(!(L instanceof ye.ZR&&L.customData))return!1;const k=Number(L.customData.httpStatus);return 429===k||500===k||503===k||504===k}(tt))throw tt;const vt={throttleEndTimeMillis:Date.now()+(0,ye.$s)(ce),backoffCount:ce+1};return yield je.storage.setThrottleMetadata(vt),je.attemptFetch(k,vt)}})()}}class Ft{constructor(k,Y,ce,je,tt){this.app=k,this._client=Y,this._storageCache=ce,this._storage=je,this._logger=tt,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Pt(L,k){var Y;const ce=L.target.error||void 0;return Te.create(k,{originalErrorMessage:ce&&(null===(Y=ce)||void 0===Y?void 0:Y.message)})}const tn="app_namespace_store";class tr{constructor(k,Y,ce,je=function Nn(){return new Promise((L,k)=>{var Y;try{const ce=indexedDB.open("firebase_remote_config",1);ce.onerror=je=>{k(Pt(je,"storage-open"))},ce.onsuccess=je=>{L(je.target.result)},ce.onupgradeneeded=je=>{0===je.oldVersion&&je.target.result.createObjectStore(tn,{keyPath:"compositeKey"})}}catch(ce){k(Te.create("storage-open",{originalErrorMessage:null===(Y=ce)||void 0===Y?void 0:Y.message}))}})}()){this.appId=k,this.appName=Y,this.namespace=ce,this.openDbPromise=je}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(k){return this.set("last_fetch_status",k)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(k){return this.set("last_successful_fetch_timestamp_millis",k)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(k){return this.set("last_successful_fetch_response",k)}getActiveConfig(){return this.get("active_config")}setActiveConfig(k){return this.set("active_config",k)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(k){return this.set("active_config_etag",k)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(k){return this.set("throttle_metadata",k)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(k){var Y=this;return(0,N.Z)(function*(){const ce=yield Y.openDbPromise;return new Promise((je,tt)=>{var vt;const be=ce.transaction([tn],"readonly").objectStore(tn),St=Y.createCompositeKey(k);try{const Sn=be.get(St);Sn.onerror=kt=>{tt(Pt(kt,"storage-get"))},Sn.onsuccess=kt=>{const In=kt.target.result;je(In?In.value:void 0)}}catch(Sn){tt(Te.create("storage-get",{originalErrorMessage:null===(vt=Sn)||void 0===vt?void 0:vt.message}))}})})()}set(k,Y){var ce=this;return(0,N.Z)(function*(){const je=yield ce.openDbPromise;return new Promise((tt,vt)=>{var Wt;const St=je.transaction([tn],"readwrite").objectStore(tn),Sn=ce.createCompositeKey(k);try{const kt=St.put({compositeKey:Sn,value:Y});kt.onerror=In=>{vt(Pt(In,"storage-set"))},kt.onsuccess=()=>{tt()}}catch(kt){vt(Te.create("storage-set",{originalErrorMessage:null===(Wt=kt)||void 0===Wt?void 0:Wt.message}))}})})()}delete(k){var Y=this;return(0,N.Z)(function*(){const ce=yield Y.openDbPromise;return new Promise((je,tt)=>{var vt;const be=ce.transaction([tn],"readwrite").objectStore(tn),St=Y.createCompositeKey(k);try{const Sn=be.delete(St);Sn.onerror=kt=>{tt(Pt(kt,"storage-delete"))},Sn.onsuccess=()=>{je()}}catch(Sn){tt(Te.create("storage-delete",{originalErrorMessage:null===(vt=Sn)||void 0===vt?void 0:vt.message}))}})})()}createCompositeKey(k){return[this.appId,this.appName,this.namespace,k].join()}}class fr{constructor(k){this.storage=k}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var k=this;return(0,N.Z)(function*(){const Y=k.storage.getLastFetchStatus(),ce=k.storage.getLastSuccessfulFetchTimestampMillis(),je=k.storage.getActiveConfig(),tt=yield Y;tt&&(k.lastFetchStatus=tt);const vt=yield ce;vt&&(k.lastSuccessfulFetchTimestampMillis=vt);const Wt=yield je;Wt&&(k.activeConfig=Wt)})()}setLastFetchStatus(k){return this.lastFetchStatus=k,this.storage.setLastFetchStatus(k)}setLastSuccessfulFetchTimestampMillis(k){return this.lastSuccessfulFetchTimestampMillis=k,this.storage.setLastSuccessfulFetchTimestampMillis(k)}setActiveConfig(k){return this.activeConfig=k,this.storage.setActiveConfig(k)}}function ht(){return nr.apply(this,arguments)}function nr(){return(nr=(0,N.Z)(function*(){if(!(0,ye.hl)())return!1;try{return yield(0,ye.eu)()}catch{return!1}})).apply(this,arguments)}!function ur(){(0,oe._registerComponent)(new Ce.wA("remote-config",function L(k,{instanceIdentifier:Y}){const ce=k.getProvider("app").getImmediate(),je=k.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Te.create("registration-window");if(!(0,ye.hl)())throw Te.create("indexed-db-unavailable");const{projectId:tt,apiKey:vt,appId:Wt}=ce.options;if(!tt)throw Te.create("registration-project-id");if(!vt)throw Te.create("registration-api-key");if(!Wt)throw Te.create("registration-app-id");const be=new tr(Wt,ce.name,Y=Y||"firebase"),St=new fr(be),Sn=new de.Yd(we);Sn.logLevel=de.in.ERROR;const kt=new xt(je,oe.SDK_VERSION,Y,tt,vt,Wt),In=new er(kt,be),Do=new ft(In,be,St,Sn),Wi=new Ft(ce,Do,St,be,Sn);return function Je(L){const k=(0,ye.m9)(L);k._initializePromise||(k._initializePromise=k._storageCache.loadFromStorage().then(()=>{k._isInitializationComplete=!0}))}(Wi),Wi},"PUBLIC").setMultipleInstances(!0)),(0,oe.registerVersion)(we,z),(0,oe.registerVersion)(we,z,"esm2017")}();var nn=P(8766);const rn="/firebase-messaging-sw.js",Bn="/firebase-cloud-messaging-push-scope",pr="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Dn="google.c.a.c_id",Kn="google.c.a.c_l",gr="google.c.a.ts",Ut="google.c.a.e";var nt=(()=>{return(L=nt||(nt={})).PUSH_RECEIVED="push-received",L.NOTIFICATION_CLICKED="notification-clicked",nt;var L})();function Pn(L){const k=new Uint8Array(L);return btoa(String.fromCharCode(...k)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function lr(L){const Y=(L+"=".repeat((4-L.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),ce=atob(Y),je=new Uint8Array(ce.length);for(let tt=0;tt<ce.length;++tt)je[tt]=ce.charCodeAt(tt);return je}const Dt="fcm_token_details_db",vn="fcm_token_object_Store";function gn(L){return Jt.apply(this,arguments)}function Jt(){return Jt=(0,N.Z)(function*(L){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(tt=>tt.name).includes(Dt))return null;let k=null;return(yield(0,nn.X3)(Dt,5,{upgrade:(ce=(0,N.Z)(function*(je,tt,vt,Wt){var be;if(tt<2||!je.objectStoreNames.contains(vn))return;const St=Wt.objectStore(vn),Sn=yield St.index("fcmSenderId").get(L);if(yield St.clear(),Sn)if(2===tt){const kt=Sn;if(!kt.auth||!kt.p256dh||!kt.endpoint)return;k={token:kt.fcmToken,createTime:null!==(be=kt.createTime)&&void 0!==be?be:Date.now(),subscriptionOptions:{auth:kt.auth,p256dh:kt.p256dh,endpoint:kt.endpoint,swScope:kt.swScope,vapidKey:"string"==typeof kt.vapidKey?kt.vapidKey:Pn(kt.vapidKey)}}}else if(3===tt){const kt=Sn;k={token:kt.fcmToken,createTime:kt.createTime,subscriptionOptions:{auth:Pn(kt.auth),p256dh:Pn(kt.p256dh),endpoint:kt.endpoint,swScope:kt.swScope,vapidKey:Pn(kt.vapidKey)}}}else if(4===tt){const kt=Sn;k={token:kt.fcmToken,createTime:kt.createTime,subscriptionOptions:{auth:Pn(kt.auth),p256dh:Pn(kt.p256dh),endpoint:kt.endpoint,swScope:kt.swScope,vapidKey:Pn(kt.vapidKey)}}}}),function(tt,vt,Wt,be){return ce.apply(this,arguments)})})).close(),yield(0,nn.Lj)(Dt),yield(0,nn.Lj)("fcm_vapid_details_db"),yield(0,nn.Lj)("undefined"),Ln(k)?k:null;var ce}),Jt.apply(this,arguments)}function Ln(L){if(!L||!L.subscriptionOptions)return!1;const{subscriptionOptions:k}=L;return"number"==typeof L.createTime&&L.createTime>0&&"string"==typeof L.token&&L.token.length>0&&"string"==typeof k.auth&&k.auth.length>0&&"string"==typeof k.p256dh&&k.p256dh.length>0&&"string"==typeof k.endpoint&&k.endpoint.length>0&&"string"==typeof k.swScope&&k.swScope.length>0&&"string"==typeof k.vapidKey&&k.vapidKey.length>0}const H="firebase-messaging-store";let q=null;function K(){return q||(q=(0,nn.X3)("firebase-messaging-database",1,{upgrade:(L,k)=>{0===k&&L.createObjectStore(H)}})),q}function ke(L){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,N.Z)(function*(L){const k=U(L),ce=yield(yield K()).transaction(H).objectStore(H).get(k);if(ce)return ce;{const je=yield gn(L.appConfig.senderId);if(je)return yield yt(L,je),je}})).apply(this,arguments)}function yt(L,k){return Kt.apply(this,arguments)}function Kt(){return(Kt=(0,N.Z)(function*(L,k){const Y=U(L),je=(yield K()).transaction(H,"readwrite");return yield je.objectStore(H).put(k,Y),yield je.done,k})).apply(this,arguments)}function Xt(L){return ue.apply(this,arguments)}function ue(){return(ue=(0,N.Z)(function*(L){const k=U(L),ce=(yield K()).transaction(H,"readwrite");yield ce.objectStore(H).delete(k),yield ce.done})).apply(this,arguments)}function U({appConfig:L}){return L.appId}const F=new ye.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function J(L,k){return Ie.apply(this,arguments)}function Ie(){return(Ie=(0,N.Z)(function*(L,k){var Y;const ce=yield wn(L),je=dn(k),tt={method:"POST",headers:ce,body:JSON.stringify(je)};let vt;try{vt=yield(yield fetch(Rt(L.appConfig),tt)).json()}catch(Wt){throw F.create("token-subscribe-failed",{errorInfo:null===(Y=Wt)||void 0===Y?void 0:Y.toString()})}if(vt.error)throw F.create("token-subscribe-failed",{errorInfo:vt.error.message});if(!vt.token)throw F.create("token-subscribe-no-token");return vt.token})).apply(this,arguments)}function Ke(L,k){return _e.apply(this,arguments)}function _e(){return(_e=(0,N.Z)(function*(L,k){var Y;const ce=yield wn(L),je=dn(k.subscriptionOptions),tt={method:"PATCH",headers:ce,body:JSON.stringify(je)};let vt;try{vt=yield(yield fetch(`${Rt(L.appConfig)}/${k.token}`,tt)).json()}catch(Wt){throw F.create("token-update-failed",{errorInfo:null===(Y=Wt)||void 0===Y?void 0:Y.toString()})}if(vt.error)throw F.create("token-update-failed",{errorInfo:vt.error.message});if(!vt.token)throw F.create("token-update-no-token");return vt.token})).apply(this,arguments)}function ze(L,k){return ot.apply(this,arguments)}function ot(){return(ot=(0,N.Z)(function*(L,k){var Y;const je={method:"DELETE",headers:yield wn(L)};try{const vt=yield(yield fetch(`${Rt(L.appConfig)}/${k}`,je)).json();if(vt.error)throw F.create("token-unsubscribe-failed",{errorInfo:vt.error.message})}catch(tt){throw F.create("token-unsubscribe-failed",{errorInfo:null===(Y=tt)||void 0===Y?void 0:Y.toString()})}})).apply(this,arguments)}function Rt({projectId:L}){return`https://fcmregistrations.googleapis.com/v1/projects/${L}/registrations`}function wn(L){return pt.apply(this,arguments)}function pt(){return(pt=(0,N.Z)(function*({appConfig:L,installations:k}){const Y=yield k.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":L.apiKey,"x-goog-firebase-installations-auth":`FIS ${Y}`})})).apply(this,arguments)}function dn({p256dh:L,auth:k,endpoint:Y,vapidKey:ce}){const je={web:{endpoint:Y,auth:k,p256dh:L}};return ce!==pr&&(je.web.applicationPubKey=ce),je}const En=6048e5;function Ds(L){return di.apply(this,arguments)}function di(){return(di=(0,N.Z)(function*(L){const k=yield Tn(L.swRegistration,L.vapidKey),Y={vapidKey:L.vapidKey,swScope:L.swRegistration.scope,endpoint:k.endpoint,auth:Pn(k.getKey("auth")),p256dh:Pn(k.getKey("p256dh"))},ce=yield ke(L.firebaseDependencies);if(ce){if(fn(ce.subscriptionOptions,Y))return Date.now()>=ce.createTime+En?ee(L,{token:ce.token,createTime:Date.now(),subscriptionOptions:Y}):ce.token;try{yield ze(L.firebaseDependencies,ce.token)}catch(je){console.warn(je)}return He(L.firebaseDependencies,Y)}return He(L.firebaseDependencies,Y)})).apply(this,arguments)}function Lt(L){return Gn.apply(this,arguments)}function Gn(){return(Gn=(0,N.Z)(function*(L){const k=yield ke(L.firebaseDependencies);k&&(yield ze(L.firebaseDependencies,k.token),yield Xt(L.firebaseDependencies));const Y=yield L.swRegistration.pushManager.getSubscription();return!Y||Y.unsubscribe()})).apply(this,arguments)}function ee(L,k){return De.apply(this,arguments)}function De(){return(De=(0,N.Z)(function*(L,k){try{const Y=yield Ke(L.firebaseDependencies,k),ce=Object.assign(Object.assign({},k),{token:Y,createTime:Date.now()});return yield yt(L.firebaseDependencies,ce),Y}catch(Y){throw yield Lt(L),Y}})).apply(this,arguments)}function He(L,k){return at.apply(this,arguments)}function at(){return(at=(0,N.Z)(function*(L,k){const ce={token:yield J(L,k),createTime:Date.now(),subscriptionOptions:k};return yield yt(L,ce),ce.token})).apply(this,arguments)}function Tn(L,k){return on.apply(this,arguments)}function on(){return(on=(0,N.Z)(function*(L,k){return(yield L.pushManager.getSubscription())||L.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:lr(k)})})).apply(this,arguments)}function fn(L,k){return k.vapidKey===L.vapidKey&&k.endpoint===L.endpoint&&k.auth===L.auth&&k.p256dh===L.p256dh}function Wn(L){const k={from:L.from,collapseKey:L.collapse_key,messageId:L.fcmMessageId};return function hi(L,k){if(!k.notification)return;L.notification={};const Y=k.notification.title;Y&&(L.notification.title=Y);const ce=k.notification.body;ce&&(L.notification.body=ce);const je=k.notification.image;je&&(L.notification.image=je)}(k,L),function Zt(L,k){!k.data||(L.data=k.data)}(k,L),function Jo(L,k){var Y,ce,je,tt,vt;if(!(k.fcmOptions||null!==(Y=k.notification)&&void 0!==Y&&Y.click_action))return;L.fcmOptions={};const Wt=null!==(je=null===(ce=k.fcmOptions)||void 0===ce?void 0:ce.link)&&void 0!==je?je:null===(tt=k.notification)||void 0===tt?void 0:tt.click_action;Wt&&(L.fcmOptions.link=Wt);const be=null===(vt=k.fcmOptions)||void 0===vt?void 0:vt.analytics_label;be&&(L.fcmOptions.analyticsLabel=be)}(k,L),k}function Od(L){return"object"==typeof L&&!!L&&Dn in L}function Us(L,k){const Y=[];for(let ce=0;ce<L.length;ce++)Y.push(L.charAt(ce)),ce<k.length&&Y.push(k.charAt(ce));return Y.join("")}function Bi(L){return F.create("missing-app-config-values",{valueName:L})}Us("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Us("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Bs{constructor(k,Y,ce){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const je=function Pa(L){if(!L||!L.options)throw Bi("App Configuration Object");if(!L.name)throw Bi("App Name");const k=["projectId","apiKey","appId","messagingSenderId"],{options:Y}=L;for(const ce of k)if(!Y[ce])throw Bi(ce);return{appName:L.name,projectId:Y.projectId,apiKey:Y.apiKey,appId:Y.appId,senderId:Y.messagingSenderId}}(k);this.firebaseDependencies={app:k,appConfig:je,installations:Y,analyticsProvider:ce}}_delete(){return Promise.resolve()}}function Ci(L){return cr.apply(this,arguments)}function cr(){return(cr=(0,N.Z)(function*(L){var k;try{L.swRegistration=yield navigator.serviceWorker.register(rn,{scope:Bn}),L.swRegistration.update().catch(()=>{})}catch(Y){throw F.create("failed-service-worker-registration",{browserErrorMessage:null===(k=Y)||void 0===k?void 0:k.message})}})).apply(this,arguments)}function Bu(L,k){return Er.apply(this,arguments)}function Er(){return(Er=(0,N.Z)(function*(L,k){if(!k&&!L.swRegistration&&(yield Ci(L)),k||!L.swRegistration){if(!(k instanceof ServiceWorkerRegistration))throw F.create("invalid-sw-registration");L.swRegistration=k}})).apply(this,arguments)}function Yr(L,k){return yo.apply(this,arguments)}function yo(){return(yo=(0,N.Z)(function*(L,k){k?L.vapidKey=k:L.vapidKey||(L.vapidKey=pr)})).apply(this,arguments)}function Ts(){return(Ts=(0,N.Z)(function*(L,k){if(!navigator)throw F.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw F.create("permission-blocked");return yield Yr(L,k?.vapidKey),yield Bu(L,k?.serviceWorkerRegistration),Ds(L)})).apply(this,arguments)}function Qr(L,k,Y){return ju.apply(this,arguments)}function ju(){return(ju=(0,N.Z)(function*(L,k,Y){const ce=Fd(k);(yield L.firebaseDependencies.analyticsProvider.get()).logEvent(ce,{message_id:Y[Dn],message_name:Y[Kn],message_time:Y[gr],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Fd(L){switch(L){case nt.NOTIFICATION_CLICKED:return"notification_open";case nt.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Xo(){return(Xo=(0,N.Z)(function*(L,k){const Y=k.data;if(!Y.isFirebaseMessaging)return;L.onMessageHandler&&Y.messageType===nt.PUSH_RECEIVED&&("function"==typeof L.onMessageHandler?L.onMessageHandler(Wn(Y)):L.onMessageHandler.next(Wn(Y)));const ce=Y.data;Od(ce)&&"1"===ce[Ut]&&(yield Qr(L,Y.messageType,ce))})).apply(this,arguments)}const ea="@firebase/messaging",Ld=L=>{const k=new Bs(L.getProvider("app").getImmediate(),L.getProvider("installations-internal").getImmediate(),L.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",Y=>function Zl(L,k){return Xo.apply(this,arguments)}(k,Y)),k},ji=L=>{const k=L.getProvider("messaging").getImmediate();return{getToken:ce=>function ts(L,k){return Ts.apply(this,arguments)}(k,ce)}};function Vd(){return ka.apply(this,arguments)}function ka(){return(ka=(0,N.Z)(function*(){try{yield(0,ye.eu)()}catch{return!1}return typeof window<"u"&&(0,ye.hl)()&&(0,ye.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function rs(){(0,oe._registerComponent)(new Ce.wA("messaging",Ld,"PUBLIC")),(0,oe._registerComponent)(new Ce.wA("messaging-internal",ji,"PRIVATE")),(0,oe.registerVersion)(ea,"0.9.16"),(0,oe.registerVersion)(ea,"0.9.16","esm2017")}();var Hu=P(6148),yp=P(4408),K_=P(7565);const ss=new class is extends K_.v{}(class Fa extends yp.o{constructor(k,Y){super(k,Y),this.scheduler=k,this.work=Y}schedule(k,Y=0){return Y>0?super.schedule(k,Y):(this.delay=Y,this.state=k,this.scheduler.flush(this),this)}execute(k,Y){return Y>0||this.closed?super.execute(k,Y):this._execute(k,Y)}requestAsyncId(k,Y,ce=0){return null!=ce&&ce>0||null==ce&&this.delay>0?super.requestAsyncId(k,Y,ce):k.flush(this)}});var vo=P(4986),jd=P(8505),Ql=P(5363),La=P(9468);const Va=new f.GfV("7.4.1"),As="__angularfire_symbol__analyticsIsSupportedValue",Ua="__angularfire_symbol__analyticsIsSupported",wo="__angularfire_symbol__remoteConfigIsSupportedValue",Lr="__angularfire_symbol__remoteConfigIsSupported",Eo="__angularfire_symbol__messagingIsSupportedValue",ta="__angularfire_symbol__messagingIsSupported";function $u(L,k,Y){if(k){if(1===k.length)return k[0];const tt=k.filter(vt=>vt.app===Y);if(1===tt.length)return tt[0]}return Y.container.getProvider(L).getImmediate({optional:!0})}globalThis[Ua]||(globalThis[Ua]=(0,Hu.Gb)().then(L=>globalThis[As]=L).catch(()=>globalThis[As]=!1)),globalThis[ta]||(globalThis[ta]=Vd().then(L=>globalThis[Eo]=L).catch(()=>globalThis[Eo]=!1)),globalThis[Lr]||(globalThis[Lr]=ht().then(L=>globalThis[wo]=L).catch(()=>globalThis[wo]=!1));const Ep=(L,k)=>{const Y=k?[k]:(0,B.C6)(),ce=[];return Y.forEach(je=>{je.container.getProvider(L).instances.forEach(vt=>{ce.includes(vt)||ce.push(vt)})}),ce};function Hi(){}class Jr{constructor(k,Y=ss){this.zone=k,this.delegate=Y}now(){return this.delegate.now()}schedule(k,Y,ce){const je=this.zone;return this.delegate.schedule(function(vt){je.runGuarded(()=>{k.apply(this,[vt])})},Y,ce)}}class Ba{constructor(k){this.zone=k,this.task=null}call(k,Y){const ce=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Hi,{},Hi,Hi)),Y.pipe((0,jd.b)({next:ce,complete:ce,error:ce})).subscribe(k).add(ce)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let na=(()=>{class L{constructor(Y){this.ngZone=Y,this.outsideAngular=Y.runOutsideAngular(()=>new Jr(Zone.current)),this.insideAngular=Y.run(()=>new Jr(Zone.current,vo.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return L.\u0275fac=function(Y){return new(Y||L)(f.LFG(f.R0b))},L.\u0275prov=f.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();function Xr(){const L=globalThis.\u0275AngularFireScheduler;if(!L)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return L}function Io(L){return L.pipe((0,Ql.Q)(Xr().outsideAngular))}function Gi(L){return Xr(),function Hs(L){return function(Y){return(Y=Y.lift(new Ba(L.ngZone))).pipe((0,La.R)(L.outsideAngular),(0,Ql.Q)(L.insideAngular))}}(Xr())(L)}},6457:(mt,Fe,P)=>{P.d(Fe,{$:()=>vt,A:()=>G,B:()=>Te,G:()=>De,H:()=>fn,J:()=>rs,L:()=>Kt,M:()=>is,N:()=>jd,P:()=>cy,Q:()=>Ql,R:()=>Ir,T:()=>La,U:()=>vo,V:()=>wo,W:()=>Lr,X:()=>wp,Y:()=>bo,Z:()=>L,_:()=>Y,a:()=>oc,a0:()=>kt,a1:()=>Do,a2:()=>Ur,a3:()=>ja,a4:()=>To,a5:()=>bi,a6:()=>Ws,a7:()=>Hd,a8:()=>qs,a9:()=>Z_,aA:()=>Ja,aB:()=>Qs,aC:()=>qa,aD:()=>zp,aE:()=>Gn,aI:()=>Wu,aL:()=>As,aa:()=>Gd,ab:()=>Cp,ac:()=>Y_,af:()=>Dp,ag:()=>Tp,ah:()=>ec,ak:()=>Jr,al:()=>Ap,an:()=>nc,ao:()=>Kd,ap:()=>Rt,aq:()=>Re,ar:()=>ot,as:()=>Ke,at:()=>Ye,au:()=>_h,av:()=>eu,aw:()=>Ve,ax:()=>te,ay:()=>re,az:()=>Xt,b:()=>ry,c:()=>gc,d:()=>mE,e:()=>oh,f:()=>Qn,g:()=>qp,h:()=>Xu,i:()=>Vp,j:()=>Qa,k:()=>sg,l:()=>ei,m:()=>ol,o:()=>fe,r:()=>nh,s:()=>jp,u:()=>Hp});var f=P(5861),B=P(2090),N=P(9681),oe=P(655),ye=P(1877),Ce=P(4859);const fe={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},G={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const Te=function ne(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Oe=function Ue(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},We=new B.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),pe=new ye.Yd("@firebase/auth");function rt(w,...g){pe.logLevel<=ye.in.ERROR&&pe.error(`Auth (${N.SDK_VERSION}): ${w}`,...g)}function Ye(w,...g){throw Je(w,...g)}function Ve(w,...g){return Je(w,...g)}function Pe(w,g,_){const I=Object.assign(Object.assign({},Oe()),{[g]:_});return new B.LL("auth","Firebase",I).create(g,{appName:w.name})}function Ae(w,g,_){if(!(g instanceof _))throw _.name!==g.constructor.name&&Ye(w,"argument-error"),Pe(w,"argument-error",`Type of ${g.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Je(w,...g){if("string"!=typeof w){const _=g[0],I=[...g.slice(1)];return I[0]&&(I[0].appName=w.name),w._errorFactory.create(_,...I)}return We.create(w,...g)}function te(w,g,..._){if(!w)throw Je(g,..._)}function me(w){const g="INTERNAL ASSERTION FAILED: "+w;throw rt(g),new Error(g)}function Re(w,g){w||me(g)}const X=new Map;function re(w){Re(w instanceof Function,"Expected a class definition");let g=X.get(w);return g?(Re(g instanceof w,"Instance stored in cache mismatched with class"),g):(g=new w,X.set(w,g),g)}function le(){var w;return typeof self<"u"&&(null===(w=self.location)||void 0===w?void 0:w.href)||""}function $e(){return"http:"===ft()||"https:"===ft()}function ft(){var w;return typeof self<"u"&&(null===(w=self.location)||void 0===w?void 0:w.protocol)||null}class Qe{constructor(g,_){this.shortDelay=g,this.longDelay=_,Re(_>g,"Short delay should be less than long delay!"),this.isMobile=(0,B.uI)()||(0,B.b$)()}get(){return function Gt(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&($e()||(0,B.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function cn(w,g){Re(w.emulator,"Emulator should always be set here");const{url:_}=w.emulator;return g?`${_}${g.startsWith("/")?g.slice(1):g}`:_}class er{static initialize(g,_,I){this.fetchImpl=g,_&&(this.headersImpl=_),I&&(this.responseImpl=I)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void me("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void me("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void me("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const yn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Qt=new Qe(3e4,6e4);function Ft(w,g){return w.tenantId&&!g.tenantId?Object.assign(Object.assign({},g),{tenantId:w.tenantId}):g}function Pt(w,g,_,I){return tn.apply(this,arguments)}function tn(){return(tn=(0,f.Z)(function*(w,g,_,I,S={}){return Dr(w,S,(0,f.Z)(function*(){let O={},ie={};I&&("GET"===g?ie=I:O={body:JSON.stringify(I)});const Ne=(0,B.xO)(Object.assign({key:w.config.apiKey},ie)).slice(1),ut=yield w._getAdditionalHeaders();return ut["Content-Type"]="application/json",w.languageCode&&(ut["X-Firebase-Locale"]=w.languageCode),er.fetch()(fr(w,w.config.apiHost,_,Ne),Object.assign({method:g,headers:ut,referrerPolicy:"no-referrer"},O))}))})).apply(this,arguments)}function Dr(w,g,_){return Fr.apply(this,arguments)}function Fr(){return(Fr=(0,f.Z)(function*(w,g,_){w._canInitEmulator=!1;const I=Object.assign(Object.assign({},yn),g);try{const S=new ur(w),O=yield Promise.race([_(),S.promise]);S.clearNetworkTimeout();const ie=yield O.json();if("needConfirmation"in ie)throw $n(w,"account-exists-with-different-credential",ie);if(O.ok&&!("errorMessage"in ie))return ie;{const Ne=O.ok?ie.errorMessage:ie.error.message,[ut,ct]=Ne.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===ut)throw $n(w,"credential-already-in-use",ie);if("EMAIL_EXISTS"===ut)throw $n(w,"email-already-in-use",ie);if("USER_DISABLED"===ut)throw $n(w,"user-disabled",ie);const Bt=I[ut]||ut.toLowerCase().replace(/[_\s]+/g,"-");if(ct)throw Pe(w,Bt,ct);Ye(w,Bt)}}catch(S){if(S instanceof B.ZR)throw S;Ye(w,"network-request-failed")}})).apply(this,arguments)}function Nn(w,g,_,I){return tr.apply(this,arguments)}function tr(){return(tr=(0,f.Z)(function*(w,g,_,I,S={}){const O=yield Pt(w,g,_,I,S);return"mfaPendingCredential"in O&&Ye(w,"multi-factor-auth-required",{_serverResponse:O}),O})).apply(this,arguments)}function fr(w,g,_,I){const S=`${g}${_}?${I}`;return w.config.emulator?cn(w.config,S):`${w.config.apiScheme}://${S}`}class ur{constructor(g){this.auth=g,this.timer=null,this.promise=new Promise((_,I)=>{this.timer=setTimeout(()=>I(Ve(this.auth,"network-request-failed")),Qt.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function $n(w,g,_){const I={appName:w.name};_.email&&(I.email=_.email),_.phoneNumber&&(I.phoneNumber=_.phoneNumber);const S=Ve(w,g,I);return S.customData._tokenResponse=_,S}function ht(){return(ht=(0,f.Z)(function*(w,g){return Pt(w,"POST","/v1/accounts:delete",g)})).apply(this,arguments)}function nr(w,g){return nn.apply(this,arguments)}function nn(){return(nn=(0,f.Z)(function*(w,g){return Pt(w,"POST","/v1/accounts:update",g)})).apply(this,arguments)}function rn(w,g){return Bn.apply(this,arguments)}function Bn(){return(Bn=(0,f.Z)(function*(w,g){return Pt(w,"POST","/v1/accounts:lookup",g)})).apply(this,arguments)}function pr(w){if(w)try{const g=new Date(Number(w));if(!isNaN(g.getTime()))return g.toUTCString()}catch{}}function Kn(){return(Kn=(0,f.Z)(function*(w,g=!1){const _=(0,B.m9)(w),I=yield _.getIdToken(g),S=Ut(I);te(S&&S.exp&&S.auth_time&&S.iat,_.auth,"internal-error");const O="object"==typeof S.firebase?S.firebase:void 0,ie=O?.sign_in_provider;return{claims:S,token:I,authTime:pr(gr(S.auth_time)),issuedAtTime:pr(gr(S.iat)),expirationTime:pr(gr(S.exp)),signInProvider:ie||null,signInSecondFactor:O?.sign_in_second_factor||null}})).apply(this,arguments)}function gr(w){return 1e3*Number(w)}function Ut(w){var g;const[_,I,S]=w.split(".");if(void 0===_||void 0===I||void 0===S)return rt("JWT malformed, contained fewer than 3 sections"),null;try{const O=(0,B.tV)(I);return O?JSON.parse(O):(rt("Failed to decode base64 JWT payload"),null)}catch(O){return rt("Caught error parsing JWT payload as JSON",null===(g=O)||void 0===g?void 0:g.toString()),null}}function nt(w,g){return Pn.apply(this,arguments)}function Pn(){return(Pn=(0,f.Z)(function*(w,g,_=!1){if(_)return g;try{return yield g}catch(I){throw I instanceof B.ZR&&lr(I)&&w.auth.currentUser===w&&(yield w.auth.signOut()),I}})).apply(this,arguments)}function lr({code:w}){return"auth/user-disabled"===w||"auth/user-token-expired"===w}class Dt{constructor(g){this.user=g,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(g){var _;if(g){const I=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),I}{this.errorBackoff=3e4;const S=(null!==(_=this.user.stsTokenManager.expirationTime)&&void 0!==_?_:0)-Date.now()-3e5;return Math.max(0,S)}}schedule(g=!1){var _=this;if(!this.isRunning)return;const I=this.getInterval(g);this.timerId=setTimeout((0,f.Z)(function*(){yield _.iteration()}),I)}iteration(){var g=this;return(0,f.Z)(function*(){var _;try{yield g.user.getIdToken(!0)}catch(I){return void("auth/network-request-failed"===(null===(_=I)||void 0===_?void 0:_.code)&&g.schedule(!0))}g.schedule()})()}}class rr{constructor(g,_){this.createdAt=g,this.lastLoginAt=_,this._initializeTime()}_initializeTime(){this.lastSignInTime=pr(this.lastLoginAt),this.creationTime=pr(this.createdAt)}_copy(g){this.createdAt=g.createdAt,this.lastLoginAt=g.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function vn(w){return gn.apply(this,arguments)}function gn(){return(gn=(0,f.Z)(function*(w){var g;const _=w.auth,I=yield w.getIdToken(),S=yield nt(w,rn(_,{idToken:I}));te(S?.users.length,_,"internal-error");const O=S.users[0];w._notifyReloadListener(O);const ie=null!==(g=O.providerUserInfo)&&void 0!==g&&g.length?W(O.providerUserInfo):[],Ne=$(w.providerData,ie),Bt=!!w.isAnonymous&&!(w.email&&O.passwordHash||Ne?.length),Vn={uid:O.localId,displayName:O.displayName||null,photoURL:O.photoUrl||null,email:O.email||null,emailVerified:O.emailVerified||!1,phoneNumber:O.phoneNumber||null,tenantId:O.tenantId||null,providerData:Ne,metadata:new rr(O.createdAt,O.lastLoginAt),isAnonymous:Bt};Object.assign(w,Vn)})).apply(this,arguments)}function Ln(){return(Ln=(0,f.Z)(function*(w){const g=(0,B.m9)(w);yield vn(g),yield g.auth._persistUserIfCurrent(g),g.auth._notifyListenersIfCurrent(g)})).apply(this,arguments)}function $(w,g){return[...w.filter(I=>!g.some(S=>S.providerId===I.providerId)),...g]}function W(w){return w.map(g=>{var{providerId:_}=g,I=(0,oe._T)(g,["providerId"]);return{providerId:_,uid:I.rawId||"",displayName:I.displayName||null,email:I.email||null,phoneNumber:I.phoneNumber||null,photoURL:I.photoUrl||null}})}function q(){return(q=(0,f.Z)(function*(w,g){const _=yield Dr(w,{},(0,f.Z)(function*(){const I=(0,B.xO)({grant_type:"refresh_token",refresh_token:g}).slice(1),{tokenApiHost:S,apiKey:O}=w.config,ie=fr(w,S,"/v1/token",`key=${O}`),Ne=yield w._getAdditionalHeaders();return Ne["Content-Type"]="application/x-www-form-urlencoded",er.fetch()(ie,{method:"POST",headers:Ne,body:I})}));return{accessToken:_.access_token,expiresIn:_.expires_in,refreshToken:_.refresh_token}})).apply(this,arguments)}class K{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(g){te(g.idToken,"internal-error"),te(typeof g.idToken<"u","internal-error"),te(typeof g.refreshToken<"u","internal-error");const _="expiresIn"in g&&typeof g.expiresIn<"u"?Number(g.expiresIn):function et(w){const g=Ut(w);return te(g,"internal-error"),te(typeof g.exp<"u","internal-error"),te(typeof g.iat<"u","internal-error"),Number(g.exp)-Number(g.iat)}(g.idToken);this.updateTokensAndExpiration(g.idToken,g.refreshToken,_)}getToken(g,_=!1){var I=this;return(0,f.Z)(function*(){return te(!I.accessToken||I.refreshToken,g,"user-token-expired"),_||!I.accessToken||I.isExpired?I.refreshToken?(yield I.refresh(g,I.refreshToken),I.accessToken):null:I.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(g,_){var I=this;return(0,f.Z)(function*(){const{accessToken:S,refreshToken:O,expiresIn:ie}=yield function H(w,g){return q.apply(this,arguments)}(g,_);I.updateTokensAndExpiration(S,O,Number(ie))})()}updateTokensAndExpiration(g,_,I){this.refreshToken=_||null,this.accessToken=g||null,this.expirationTime=Date.now()+1e3*I}static fromJSON(g,_){const{refreshToken:I,accessToken:S,expirationTime:O}=_,ie=new K;return I&&(te("string"==typeof I,"internal-error",{appName:g}),ie.refreshToken=I),S&&(te("string"==typeof S,"internal-error",{appName:g}),ie.accessToken=S),O&&(te("number"==typeof O,"internal-error",{appName:g}),ie.expirationTime=O),ie}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(g){this.accessToken=g.accessToken,this.refreshToken=g.refreshToken,this.expirationTime=g.expirationTime}_clone(){return Object.assign(new K,this.toJSON())}_performRefresh(){return me("not implemented")}}function ke(w,g){te("string"==typeof w||typeof w>"u","internal-error",{appName:g})}class Xe{constructor(g){var{uid:_,auth:I,stsTokenManager:S}=g,O=(0,oe._T)(g,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Dt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=_,this.auth=I,this.stsTokenManager=S,this.accessToken=S.accessToken,this.displayName=O.displayName||null,this.email=O.email||null,this.emailVerified=O.emailVerified||!1,this.phoneNumber=O.phoneNumber||null,this.photoURL=O.photoURL||null,this.isAnonymous=O.isAnonymous||!1,this.tenantId=O.tenantId||null,this.providerData=O.providerData?[...O.providerData]:[],this.metadata=new rr(O.createdAt||void 0,O.lastLoginAt||void 0)}getIdToken(g){var _=this;return(0,f.Z)(function*(){const I=yield nt(_,_.stsTokenManager.getToken(_.auth,g));return te(I,_.auth,"internal-error"),_.accessToken!==I&&(_.accessToken=I,yield _.auth._persistUserIfCurrent(_),_.auth._notifyListenersIfCurrent(_)),I})()}getIdTokenResult(g){return function Dn(w){return Kn.apply(this,arguments)}(this,g)}reload(){return function Jt(w){return Ln.apply(this,arguments)}(this)}_assign(g){this!==g&&(te(this.uid===g.uid,this.auth,"internal-error"),this.displayName=g.displayName,this.photoURL=g.photoURL,this.email=g.email,this.emailVerified=g.emailVerified,this.phoneNumber=g.phoneNumber,this.isAnonymous=g.isAnonymous,this.tenantId=g.tenantId,this.providerData=g.providerData.map(_=>Object.assign({},_)),this.metadata._copy(g.metadata),this.stsTokenManager._assign(g.stsTokenManager))}_clone(g){return new Xe(Object.assign(Object.assign({},this),{auth:g,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(g){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=g,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(g){this.reloadListener?this.reloadListener(g):this.reloadUserInfo=g}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(g,_=!1){var I=this;return(0,f.Z)(function*(){let S=!1;g.idToken&&g.idToken!==I.stsTokenManager.accessToken&&(I.stsTokenManager.updateFromServerResponse(g),S=!0),_&&(yield vn(I)),yield I.auth._persistUserIfCurrent(I),S&&I.auth._notifyListenersIfCurrent(I)})()}delete(){var g=this;return(0,f.Z)(function*(){const _=yield g.getIdToken();return yield nt(g,function wr(w,g){return ht.apply(this,arguments)}(g.auth,{idToken:_})),g.stsTokenManager.clearRefreshToken(),g.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(g=>Object.assign({},g)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(g,_){var I,S,O,ie,Ne,ut,ct,Bt;const Vn=null!==(I=_.displayName)&&void 0!==I?I:void 0,Ki=null!==(S=_.email)&&void 0!==S?S:void 0,Xs=null!==(O=_.phoneNumber)&&void 0!==O?O:void 0,wc=null!==(ie=_.photoURL)&&void 0!==ie?ie:void 0,Ey=null!==(Ne=_.tenantId)&&void 0!==Ne?Ne:void 0,vh=null!==(ut=_._redirectEventId)&&void 0!==ut?ut:void 0,Ec=null!==(ct=_.createdAt)&&void 0!==ct?ct:void 0,nu=null!==(Bt=_.lastLoginAt)&&void 0!==Bt?Bt:void 0,{uid:al,emailVerified:Iy,isAnonymous:lg,providerData:Ic,stsTokenManager:Cy}=_;te(al&&Cy,g,"internal-error");const wh=K.fromJSON(this.name,Cy);te("string"==typeof al,g,"internal-error"),ke(Vn,g.name),ke(Ki,g.name),te("boolean"==typeof Iy,g,"internal-error"),te("boolean"==typeof lg,g,"internal-error"),ke(Xs,g.name),ke(wc,g.name),ke(Ey,g.name),ke(vh,g.name),ke(Ec,g.name),ke(nu,g.name);const Eh=new Xe({uid:al,auth:g,email:Ki,emailVerified:Iy,displayName:Vn,isAnonymous:lg,photoURL:wc,phoneNumber:Xs,tenantId:Ey,stsTokenManager:wh,createdAt:Ec,lastLoginAt:nu});return Ic&&Array.isArray(Ic)&&(Eh.providerData=Ic.map(cg=>Object.assign({},cg))),vh&&(Eh._redirectEventId=vh),Eh}static _fromIdTokenResponse(g,_,I=!1){return(0,f.Z)(function*(){const S=new K;S.updateFromServerResponse(_);const O=new Xe({uid:_.localId,auth:g,stsTokenManager:S,isAnonymous:I});return yield vn(O),O})()}}const Kt=(()=>{class w{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,f.Z)(function*(){return!0})()}_set(_,I){var S=this;return(0,f.Z)(function*(){S.storage[_]=I})()}_get(_){var I=this;return(0,f.Z)(function*(){const S=I.storage[_];return void 0===S?null:S})()}_remove(_){var I=this;return(0,f.Z)(function*(){delete I.storage[_]})()}_addListener(_,I){}_removeListener(_,I){}}return w.type="NONE",w})();function Xt(w,g,_){return`firebase:${w}:${g}:${_}`}class ue{constructor(g,_,I){this.persistence=g,this.auth=_,this.userKey=I;const{config:S,name:O}=this.auth;this.fullUserKey=Xt(this.userKey,S.apiKey,O),this.fullPersistenceKey=Xt("persistence",S.apiKey,O),this.boundEventHandler=_._onStorageEvent.bind(_),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(g){return this.persistence._set(this.fullUserKey,g.toJSON())}getCurrentUser(){var g=this;return(0,f.Z)(function*(){const _=yield g.persistence._get(g.fullUserKey);return _?Xe._fromJSON(g.auth,_):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(g){var _=this;return(0,f.Z)(function*(){if(_.persistence===g)return;const I=yield _.getCurrentUser();return yield _.removeCurrentUser(),_.persistence=g,I?_.setCurrentUser(I):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(g,_,I="authUser"){return(0,f.Z)(function*(){if(!_.length)return new ue(re(Kt),g,I);const S=(yield Promise.all(_.map(function(){var ct=(0,f.Z)(function*(Bt){if(yield Bt._isAvailable())return Bt});return function(Bt){return ct.apply(this,arguments)}}()))).filter(ct=>ct);let O=S[0]||re(Kt);const ie=Xt(I,g.config.apiKey,g.name);let Ne=null;for(const ct of _)try{const Bt=yield ct._get(ie);if(Bt){const Vn=Xe._fromJSON(g,Bt);ct!==O&&(Ne=Vn),O=ct;break}}catch{}const ut=S.filter(ct=>ct._shouldAllowMigration);return O._shouldAllowMigration&&ut.length?(O=ut[0],Ne&&(yield O._set(ie,Ne.toJSON())),yield Promise.all(_.map(function(){var ct=(0,f.Z)(function*(Bt){if(Bt!==O)try{yield Bt._remove(ie)}catch{}});return function(Bt){return ct.apply(this,arguments)}}())),new ue(O,g,I)):new ue(O,g,I)})()}}function U(w){const g=w.toLowerCase();if(g.includes("opera/")||g.includes("opr/")||g.includes("opios/"))return"Opera";if(Ie(g))return"IEMobile";if(g.includes("msie")||g.includes("trident/"))return"IE";if(g.includes("edge/"))return"Edge";if(M(g))return"Firefox";if(g.includes("silk/"))return"Silk";if(_e(g))return"Blackberry";if(ze(g))return"Webos";if(F(g))return"Safari";if((g.includes("chrome/")||J(g))&&!g.includes("edge/"))return"Chrome";if(Ke(g))return"Android";{const I=w.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===I?.length)return I[1]}return"Other"}function M(w=(0,B.z$)()){return/firefox\//i.test(w)}function F(w=(0,B.z$)()){const g=w.toLowerCase();return g.includes("safari/")&&!g.includes("chrome/")&&!g.includes("crios/")&&!g.includes("android")}function J(w=(0,B.z$)()){return/crios\//i.test(w)}function Ie(w=(0,B.z$)()){return/iemobile/i.test(w)}function Ke(w=(0,B.z$)()){return/android/i.test(w)}function _e(w=(0,B.z$)()){return/blackberry/i.test(w)}function ze(w=(0,B.z$)()){return/webos/i.test(w)}function ot(w=(0,B.z$)()){return/iphone|ipad|ipod/i.test(w)||/macintosh/i.test(w)&&/mobile/i.test(w)}function Rt(w=(0,B.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(w)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(w)}function dn(w=(0,B.z$)()){return ot(w)||Ke(w)||ze(w)||_e(w)||/windows phone/i.test(w)||Ie(w)}function Ds(w,g=[]){let _;switch(w){case"Browser":_=U((0,B.z$)());break;case"Worker":_=`${U((0,B.z$)())}-${w}`;break;default:_=w}const I=g.length?g.join(","):"FirebaseCore-web";return`${_}/JsCore/${N.SDK_VERSION}/${I}`}class di{constructor(g){this.auth=g,this.queue=[]}pushCallback(g,_){const I=O=>new Promise((ie,Ne)=>{try{ie(g(O))}catch(ut){Ne(ut)}});I.onAbort=_,this.queue.push(I);const S=this.queue.length-1;return()=>{this.queue[S]=()=>Promise.resolve()}}runMiddleware(g){var _=this;return(0,f.Z)(function*(){var I;if(_.auth.currentUser===g)return;const S=[];try{for(const O of _.queue)yield O(g),O.onAbort&&S.push(O.onAbort)}catch(O){S.reverse();for(const ie of S)try{ie()}catch{}throw _.auth._errorFactory.create("login-blocked",{originalMessage:null===(I=O)||void 0===I?void 0:I.message})}})()}}class Lt{constructor(g,_,I){this.app=g,this.heartbeatServiceProvider=_,this.config=I,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ee(this),this.idTokenSubscription=new ee(this),this.beforeStateQueue=new di(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=We,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=g.name,this.clientVersion=I.sdkClientVersion}_initializeWithPersistence(g,_){var I=this;return _&&(this._popupRedirectResolver=re(_)),this._initializationPromise=this.queue((0,f.Z)(function*(){var S,O;if(!I._deleted&&(I.persistenceManager=yield ue.create(I,g),!I._deleted)){if(null!==(S=I._popupRedirectResolver)&&void 0!==S&&S._shouldInitProactively)try{yield I._popupRedirectResolver._initialize(I)}catch{}yield I.initializeCurrentUser(_),I.lastNotifiedUid=(null===(O=I.currentUser)||void 0===O?void 0:O.uid)||null,!I._deleted&&(I._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var g=this;return(0,f.Z)(function*(){if(g._deleted)return;const _=yield g.assertedPersistence.getCurrentUser();if(g.currentUser||_){if(g.currentUser&&_&&g.currentUser.uid===_.uid)return g._currentUser._assign(_),void(yield g.currentUser.getIdToken());yield g._updateCurrentUser(_,!0)}})()}initializeCurrentUser(g){var _=this;return(0,f.Z)(function*(){var I;const S=yield _.assertedPersistence.getCurrentUser();let O=S,ie=!1;if(g&&_.config.authDomain){yield _.getOrInitRedirectPersistenceManager();const Ne=null===(I=_.redirectUser)||void 0===I?void 0:I._redirectEventId,ut=O?._redirectEventId,ct=yield _.tryRedirectSignIn(g);(!Ne||Ne===ut)&&ct?.user&&(O=ct.user,ie=!0)}if(!O)return _.directlySetCurrentUser(null);if(!O._redirectEventId){if(ie)try{yield _.beforeStateQueue.runMiddleware(O)}catch(Ne){O=S,_._popupRedirectResolver._overrideRedirectResult(_,()=>Promise.reject(Ne))}return O?_.reloadAndSetCurrentUserOrClear(O):_.directlySetCurrentUser(null)}return te(_._popupRedirectResolver,_,"argument-error"),yield _.getOrInitRedirectPersistenceManager(),_.redirectUser&&_.redirectUser._redirectEventId===O._redirectEventId?_.directlySetCurrentUser(O):_.reloadAndSetCurrentUserOrClear(O)})()}tryRedirectSignIn(g){var _=this;return(0,f.Z)(function*(){let I=null;try{I=yield _._popupRedirectResolver._completeRedirectFn(_,g,!0)}catch{yield _._setRedirectUser(null)}return I})()}reloadAndSetCurrentUserOrClear(g){var _=this;return(0,f.Z)(function*(){var I;try{yield vn(g)}catch(S){if("auth/network-request-failed"!==(null===(I=S)||void 0===I?void 0:I.code))return _.directlySetCurrentUser(null)}return _.directlySetCurrentUser(g)})()}useDeviceLanguage(){this.languageCode=function xt(){if(typeof navigator>"u")return null;const w=navigator;return w.languages&&w.languages[0]||w.language||null}()}_delete(){var g=this;return(0,f.Z)(function*(){g._deleted=!0})()}updateCurrentUser(g){var _=this;return(0,f.Z)(function*(){const I=g?(0,B.m9)(g):null;return I&&te(I.auth.config.apiKey===_.config.apiKey,_,"invalid-user-token"),_._updateCurrentUser(I&&I._clone(_))})()}_updateCurrentUser(g,_=!1){var I=this;return(0,f.Z)(function*(){if(!I._deleted)return g&&te(I.tenantId===g.tenantId,I,"tenant-id-mismatch"),_||(yield I.beforeStateQueue.runMiddleware(g)),I.queue((0,f.Z)(function*(){yield I.directlySetCurrentUser(g),I.notifyAuthListeners()}))})()}signOut(){var g=this;return(0,f.Z)(function*(){return yield g.beforeStateQueue.runMiddleware(null),(g.redirectPersistenceManager||g._popupRedirectResolver)&&(yield g._setRedirectUser(null)),g._updateCurrentUser(null,!0)})()}setPersistence(g){var _=this;return this.queue((0,f.Z)(function*(){yield _.assertedPersistence.setPersistence(re(g))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(g){this._errorFactory=new B.LL("auth","Firebase",g())}onAuthStateChanged(g,_,I){return this.registerStateListener(this.authStateSubscription,g,_,I)}beforeAuthStateChanged(g,_){return this.beforeStateQueue.pushCallback(g,_)}onIdTokenChanged(g,_,I){return this.registerStateListener(this.idTokenSubscription,g,_,I)}toJSON(){var g;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(g=this._currentUser)||void 0===g?void 0:g.toJSON()}}_setRedirectUser(g,_){var I=this;return(0,f.Z)(function*(){const S=yield I.getOrInitRedirectPersistenceManager(_);return null===g?S.removeCurrentUser():S.setCurrentUser(g)})()}getOrInitRedirectPersistenceManager(g){var _=this;return(0,f.Z)(function*(){if(!_.redirectPersistenceManager){const I=g&&re(g)||_._popupRedirectResolver;te(I,_,"argument-error"),_.redirectPersistenceManager=yield ue.create(_,[re(I._redirectPersistence)],"redirectUser"),_.redirectUser=yield _.redirectPersistenceManager.getCurrentUser()}return _.redirectPersistenceManager})()}_redirectUserForId(g){var _=this;return(0,f.Z)(function*(){var I,S;return _._isInitialized&&(yield _.queue((0,f.Z)(function*(){}))),(null===(I=_._currentUser)||void 0===I?void 0:I._redirectEventId)===g?_._currentUser:(null===(S=_.redirectUser)||void 0===S?void 0:S._redirectEventId)===g?_.redirectUser:null})()}_persistUserIfCurrent(g){var _=this;return(0,f.Z)(function*(){if(g===_.currentUser)return _.queue((0,f.Z)(function*(){return _.directlySetCurrentUser(g)}))})()}_notifyListenersIfCurrent(g){g===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var g,_;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const I=null!==(_=null===(g=this.currentUser)||void 0===g?void 0:g.uid)&&void 0!==_?_:null;this.lastNotifiedUid!==I&&(this.lastNotifiedUid=I,this.authStateSubscription.next(this.currentUser))}registerStateListener(g,_,I,S){if(this._deleted)return()=>{};const O="function"==typeof _?_:_.next.bind(_),ie=this._isInitialized?Promise.resolve():this._initializationPromise;return te(ie,this,"internal-error"),ie.then(()=>O(this.currentUser)),"function"==typeof _?g.addObserver(_,I,S):g.addObserver(_)}directlySetCurrentUser(g){var _=this;return(0,f.Z)(function*(){_.currentUser&&_.currentUser!==g&&(_._currentUser._stopProactiveRefresh(),g&&_.isProactiveRefreshEnabled&&g._startProactiveRefresh()),_.currentUser=g,g?yield _.assertedPersistence.setCurrentUser(g):yield _.assertedPersistence.removeCurrentUser()})()}queue(g){return this.operations=this.operations.then(g,g),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(g){!g||this.frameworks.includes(g)||(this.frameworks.push(g),this.frameworks.sort(),this.clientVersion=Ds(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var g=this;return(0,f.Z)(function*(){var _;const I={"X-Client-Version":g.clientVersion};g.app.options.appId&&(I["X-Firebase-gmpid"]=g.app.options.appId);const S=yield null===(_=g.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===_?void 0:_.getHeartbeatsHeader();return S&&(I["X-Firebase-Client"]=S),I})()}}function Gn(w){return(0,B.m9)(w)}class ee{constructor(g){this.auth=g,this.observer=null,this.addObserver=(0,B.ne)(_=>this.observer=_)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function De(w,g,_){const I=Gn(w);te(I._canInitEmulator,I,"emulator-config-failed"),te(/^https?:\/\//.test(g),I,"invalid-emulator-scheme");const S=!!_?.disableWarnings,O=He(g),{host:ie,port:Ne}=function at(w){const g=He(w),_=/(\/\/)?([^?#/]+)/.exec(w.substr(g.length));if(!_)return{host:"",port:null};const I=_[2].split("@").pop()||"",S=/^(\[[^\]]+\])(:|$)/.exec(I);if(S){const O=S[1];return{host:O,port:Tn(I.substr(O.length+1))}}{const[O,ie]=I.split(":");return{host:O,port:Tn(ie)}}}(g);I.config.emulator={url:`${O}//${ie}${null===Ne?"":`:${Ne}`}/`},I.settings.appVerificationDisabledForTesting=!0,I.emulatorConfig=Object.freeze({host:ie,port:Ne,protocol:O.replace(":",""),options:Object.freeze({disableWarnings:S})}),S||function on(){function w(){const g=document.createElement("p"),_=g.style;g.innerText="Running in emulator mode. Do not use with production credentials.",_.position="fixed",_.width="100%",_.backgroundColor="#ffffff",_.border=".1em solid #000000",_.color="#b50000",_.bottom="0px",_.left="0px",_.margin="0px",_.zIndex="10000",_.textAlign="center",g.classList.add("firebase-emulator-warning"),document.body.appendChild(g)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",w):w())}()}function He(w){const g=w.indexOf(":");return g<0?"":w.substr(0,g+1)}function Tn(w){if(!w)return null;const g=Number(w);return isNaN(g)?null:g}class fn{constructor(g,_){this.providerId=g,this.signInMethod=_}toJSON(){return me("not implemented")}_getIdTokenResponse(g){return me("not implemented")}_linkToIdToken(g,_){return me("not implemented")}_getReauthenticationResolver(g){return me("not implemented")}}function Wn(w,g){return hi.apply(this,arguments)}function hi(){return(hi=(0,f.Z)(function*(w,g){return Pt(w,"POST","/v1/accounts:resetPassword",Ft(w,g))})).apply(this,arguments)}function Zt(w,g){return Jo.apply(this,arguments)}function Jo(){return(Jo=(0,f.Z)(function*(w,g){return Pt(w,"POST","/v1/accounts:update",g)})).apply(this,arguments)}function Od(w,g){return Us.apply(this,arguments)}function Us(){return(Us=(0,f.Z)(function*(w,g){return Pt(w,"POST","/v1/accounts:update",Ft(w,g))})).apply(this,arguments)}function Bi(){return(Bi=(0,f.Z)(function*(w,g){return Nn(w,"POST","/v1/accounts:signInWithPassword",Ft(w,g))})).apply(this,arguments)}function Bs(w,g){return Ci.apply(this,arguments)}function Ci(){return(Ci=(0,f.Z)(function*(w,g){return Pt(w,"POST","/v1/accounts:sendOobCode",Ft(w,g))})).apply(this,arguments)}function cr(w,g){return Bu.apply(this,arguments)}function Bu(){return(Bu=(0,f.Z)(function*(w,g){return Bs(w,g)})).apply(this,arguments)}function Er(w,g){return Yr.apply(this,arguments)}function Yr(){return(Yr=(0,f.Z)(function*(w,g){return Bs(w,g)})).apply(this,arguments)}function yo(w,g){return ts.apply(this,arguments)}function ts(){return(ts=(0,f.Z)(function*(w,g){return Bs(w,g)})).apply(this,arguments)}function Ts(w,g){return Qr.apply(this,arguments)}function Qr(){return(Qr=(0,f.Z)(function*(w,g){return Bs(w,g)})).apply(this,arguments)}function Fd(){return(Fd=(0,f.Z)(function*(w,g){return Nn(w,"POST","/v1/accounts:signInWithEmailLink",Ft(w,g))})).apply(this,arguments)}function Xo(){return(Xo=(0,f.Z)(function*(w,g){return Nn(w,"POST","/v1/accounts:signInWithEmailLink",Ft(w,g))})).apply(this,arguments)}class ea extends fn{constructor(g,_,I,S=null){super("password",I),this._email=g,this._password=_,this._tenantId=S}static _fromEmailAndPassword(g,_){return new ea(g,_,"password")}static _fromEmailAndCode(g,_,I=null){return new ea(g,_,"emailLink",I)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(g){const _="string"==typeof g?JSON.parse(g):g;if(_?.email&&_?.password){if("password"===_.signInMethod)return this._fromEmailAndPassword(_.email,_.password);if("emailLink"===_.signInMethod)return this._fromEmailAndCode(_.email,_.password,_.tenantId)}return null}_getIdTokenResponse(g){var _=this;return(0,f.Z)(function*(){switch(_.signInMethod){case"password":return function Pa(w,g){return Bi.apply(this,arguments)}(g,{returnSecureToken:!0,email:_._email,password:_._password});case"emailLink":return function ju(w,g){return Fd.apply(this,arguments)}(g,{email:_._email,oobCode:_._password});default:Ye(g,"internal-error")}})()}_linkToIdToken(g,_){var I=this;return(0,f.Z)(function*(){switch(I.signInMethod){case"password":return Zt(g,{idToken:_,returnSecureToken:!0,email:I._email,password:I._password});case"emailLink":return function Zl(w,g){return Xo.apply(this,arguments)}(g,{idToken:_,email:I._email,oobCode:I._password});default:Ye(g,"internal-error")}})()}_getReauthenticationResolver(g){return this._getIdTokenResponse(g)}}function ns(w,g){return Ld.apply(this,arguments)}function Ld(){return(Ld=(0,f.Z)(function*(w,g){return Nn(w,"POST","/v1/accounts:signInWithIdp",Ft(w,g))})).apply(this,arguments)}class rs extends fn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(g){const _=new rs(g.providerId,g.signInMethod);return g.idToken||g.accessToken?(g.idToken&&(_.idToken=g.idToken),g.accessToken&&(_.accessToken=g.accessToken),g.nonce&&!g.pendingToken&&(_.nonce=g.nonce),g.pendingToken&&(_.pendingToken=g.pendingToken)):g.oauthToken&&g.oauthTokenSecret?(_.accessToken=g.oauthToken,_.secret=g.oauthTokenSecret):Ye("argument-error"),_}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(g){const _="string"==typeof g?JSON.parse(g):g,{providerId:I,signInMethod:S}=_,O=(0,oe._T)(_,["providerId","signInMethod"]);if(!I||!S)return null;const ie=new rs(I,S);return ie.idToken=O.idToken||void 0,ie.accessToken=O.accessToken||void 0,ie.secret=O.secret,ie.nonce=O.nonce,ie.pendingToken=O.pendingToken||null,ie}_getIdTokenResponse(g){return ns(g,this.buildRequest())}_linkToIdToken(g,_){const I=this.buildRequest();return I.idToken=_,ns(g,I)}_getReauthenticationResolver(g){const _=this.buildRequest();return _.autoCreate=!1,ns(g,_)}buildRequest(){const g={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)g.pendingToken=this.pendingToken;else{const _={};this.idToken&&(_.id_token=this.idToken),this.accessToken&&(_.access_token=this.accessToken),this.secret&&(_.oauth_token_secret=this.secret),_.providerId=this.providerId,this.nonce&&!this.pendingToken&&(_.nonce=this.nonce),g.postBody=(0,B.xO)(_)}return g}}function Vd(w,g){return ka.apply(this,arguments)}function ka(){return(ka=(0,f.Z)(function*(w,g){return Pt(w,"POST","/v1/accounts:sendVerificationCode",Ft(w,g))})).apply(this,arguments)}function Oa(){return(Oa=(0,f.Z)(function*(w,g){return Nn(w,"POST","/v1/accounts:signInWithPhoneNumber",Ft(w,g))})).apply(this,arguments)}function Ud(){return(Ud=(0,f.Z)(function*(w,g){const _=yield Nn(w,"POST","/v1/accounts:signInWithPhoneNumber",Ft(w,g));if(_.temporaryProof)throw $n(w,"account-exists-with-different-credential",_);return _})).apply(this,arguments)}const q_={USER_NOT_FOUND:"user-not-found"};function Bd(){return(Bd=(0,f.Z)(function*(w,g){return Nn(w,"POST","/v1/accounts:signInWithPhoneNumber",Ft(w,Object.assign(Object.assign({},g),{operation:"REAUTH"})),q_)})).apply(this,arguments)}class js extends fn{constructor(g){super("phone","phone"),this.params=g}static _fromVerification(g,_){return new js({verificationId:g,verificationCode:_})}static _fromTokenResponse(g,_){return new js({phoneNumber:g,temporaryProof:_})}_getIdTokenResponse(g){return function mp(w,g){return Oa.apply(this,arguments)}(g,this._makeVerificationRequest())}_linkToIdToken(g,_){return function _p(w,g){return Ud.apply(this,arguments)}(g,Object.assign({idToken:_},this._makeVerificationRequest()))}_getReauthenticationResolver(g){return function Yl(w,g){return Bd.apply(this,arguments)}(g,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:g,phoneNumber:_,verificationId:I,verificationCode:S}=this.params;return g&&_?{temporaryProof:g,phoneNumber:_}:{sessionInfo:I,code:S}}toJSON(){const g={providerId:this.providerId};return this.params.phoneNumber&&(g.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(g.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(g.verificationCode=this.params.verificationCode),this.params.verificationId&&(g.verificationId=this.params.verificationId),g}static fromJSON(g){"string"==typeof g&&(g=JSON.parse(g));const{verificationId:_,verificationCode:I,phoneNumber:S,temporaryProof:O}=g;return I||_||S||O?new js({verificationId:_,verificationCode:I,phoneNumber:S,temporaryProof:O}):null}}class Fa{constructor(g){var _,I,S,O,ie,Ne;const ut=(0,B.zd)((0,B.pd)(g)),ct=null!==(_=ut.apiKey)&&void 0!==_?_:null,Bt=null!==(I=ut.oobCode)&&void 0!==I?I:null,Vn=function Hu(w){switch(w){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(S=ut.mode)&&void 0!==S?S:null);te(ct&&Bt&&Vn,"argument-error"),this.apiKey=ct,this.operation=Vn,this.code=Bt,this.continueUrl=null!==(O=ut.continueUrl)&&void 0!==O?O:null,this.languageCode=null!==(ie=ut.languageCode)&&void 0!==ie?ie:null,this.tenantId=null!==(Ne=ut.tenantId)&&void 0!==Ne?Ne:null}static parseLink(g){const _=function yp(w){const g=(0,B.zd)((0,B.pd)(w)).link,_=g?(0,B.zd)((0,B.pd)(g)).deep_link_id:null,I=(0,B.zd)((0,B.pd)(w)).deep_link_id;return(I?(0,B.zd)((0,B.pd)(I)).link:null)||I||_||g||w}(g);try{return new Fa(_)}catch{return null}}}let is=(()=>{class w{constructor(){this.providerId=w.PROVIDER_ID}static credential(_,I){return ea._fromEmailAndPassword(_,I)}static credentialWithLink(_,I){const S=Fa.parseLink(I);return te(S,"argument-error"),ea._fromEmailAndCode(_,S.code,S.tenantId)}}return w.PROVIDER_ID="password",w.EMAIL_PASSWORD_SIGN_IN_METHOD="password",w.EMAIL_LINK_SIGN_IN_METHOD="emailLink",w})();class ss{constructor(g){this.providerId=g,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(g){this.defaultLanguageCode=g}setCustomParameters(g){return this.customParameters=g,this}getCustomParameters(){return this.customParameters}}class Ss extends ss{constructor(){super(...arguments),this.scopes=[]}addScope(g){return this.scopes.includes(g)||this.scopes.push(g),this}getScopes(){return[...this.scopes]}}class vo extends Ss{static credentialFromJSON(g){const _="string"==typeof g?JSON.parse(g):g;return te("providerId"in _&&"signInMethod"in _,"argument-error"),rs._fromParams(_)}credential(g){return this._credential(Object.assign(Object.assign({},g),{nonce:g.rawNonce}))}_credential(g){return te(g.idToken||g.accessToken,"argument-error"),rs._fromParams(Object.assign(Object.assign({},g),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(g){return vo.oauthCredentialFromTaggedObject(g)}static credentialFromError(g){return vo.oauthCredentialFromTaggedObject(g.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:g}){if(!g)return null;const{oauthIdToken:_,oauthAccessToken:I,oauthTokenSecret:S,pendingToken:O,nonce:ie,providerId:Ne}=g;if(!I&&!S&&!_&&!O||!Ne)return null;try{return new vo(Ne)._credential({idToken:_,accessToken:I,nonce:ie,pendingToken:O})}catch{return null}}}let jd=(()=>{class w extends Ss{constructor(){super("facebook.com")}static credential(_){return rs._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.FACEBOOK_SIGN_IN_METHOD,accessToken:_})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_||!("oauthAccessToken"in _)||!_.oauthAccessToken)return null;try{return w.credential(_.oauthAccessToken)}catch{return null}}}return w.FACEBOOK_SIGN_IN_METHOD="facebook.com",w.PROVIDER_ID="facebook.com",w})(),Ql=(()=>{class w extends Ss{constructor(){super("google.com"),this.addScope("profile")}static credential(_,I){return rs._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GOOGLE_SIGN_IN_METHOD,idToken:_,accessToken:I})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{oauthIdToken:I,oauthAccessToken:S}=_;if(!I&&!S)return null;try{return w.credential(I,S)}catch{return null}}}return w.GOOGLE_SIGN_IN_METHOD="google.com",w.PROVIDER_ID="google.com",w})(),La=(()=>{class w extends Ss{constructor(){super("github.com")}static credential(_){return rs._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.GITHUB_SIGN_IN_METHOD,accessToken:_})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_||!("oauthAccessToken"in _)||!_.oauthAccessToken)return null;try{return w.credential(_.oauthAccessToken)}catch{return null}}}return w.GITHUB_SIGN_IN_METHOD="github.com",w.PROVIDER_ID="github.com",w})();class As extends fn{constructor(g,_){super(g,g),this.pendingToken=_}_getIdTokenResponse(g){return ns(g,this.buildRequest())}_linkToIdToken(g,_){const I=this.buildRequest();return I.idToken=_,ns(g,I)}_getReauthenticationResolver(g){const _=this.buildRequest();return _.autoCreate=!1,ns(g,_)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(g){const _="string"==typeof g?JSON.parse(g):g,{providerId:I,signInMethod:S,pendingToken:O}=_;return I&&S&&O&&I===S?new As(I,O):null}static _create(g,_){return new As(g,_)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class wo extends ss{constructor(g){te(g.startsWith("saml."),"argument-error"),super(g)}static credentialFromResult(g){return wo.samlCredentialFromTaggedObject(g)}static credentialFromError(g){return wo.samlCredentialFromTaggedObject(g.customData||{})}static credentialFromJSON(g){const _=As.fromJSON(g);return te(_,"argument-error"),_}static samlCredentialFromTaggedObject({_tokenResponse:g}){if(!g)return null;const{pendingToken:_,providerId:I}=g;if(!_||!I)return null;try{return As._create(I,_)}catch{return null}}}let Lr=(()=>{class w extends Ss{constructor(){super("twitter.com")}static credential(_,I){return rs._fromParams({providerId:w.PROVIDER_ID,signInMethod:w.TWITTER_SIGN_IN_METHOD,oauthToken:_,oauthTokenSecret:I})}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{oauthAccessToken:I,oauthTokenSecret:S}=_;if(!I||!S)return null;try{return w.credential(I,S)}catch{return null}}}return w.TWITTER_SIGN_IN_METHOD="twitter.com",w.PROVIDER_ID="twitter.com",w})();function Eo(w,g){return ta.apply(this,arguments)}function ta(){return(ta=(0,f.Z)(function*(w,g){return Nn(w,"POST","/v1/accounts:signUp",Ft(w,g))})).apply(this,arguments)}class Tr{constructor(g){this.user=g.user,this.providerId=g.providerId,this._tokenResponse=g._tokenResponse,this.operationType=g.operationType}static _fromIdTokenResponse(g,_,I,S=!1){return(0,f.Z)(function*(){const O=yield Xe._fromIdTokenResponse(g,I,S),ie=vp(I);return new Tr({user:O,providerId:ie,_tokenResponse:I,operationType:_})})()}static _forOperation(g,_,I){return(0,f.Z)(function*(){yield g._updateTokensIfNecessary(I,!0);const S=vp(I);return new Tr({user:g,providerId:S,_tokenResponse:I,operationType:_})})()}}function vp(w){return w.providerId?w.providerId:"phoneNumber"in w?"phone":null}function wp(w){return ir.apply(this,arguments)}function ir(){return(ir=(0,f.Z)(function*(w){var g;const _=Gn(w);if(yield _._initializationPromise,null!==(g=_.currentUser)&&void 0!==g&&g.isAnonymous)return new Tr({user:_.currentUser,providerId:null,operationType:"signIn"});const I=yield Eo(_,{returnSecureToken:!0}),S=yield Tr._fromIdTokenResponse(_,"signIn",I,!0);return yield _._updateCurrentUser(S.user),S})).apply(this,arguments)}class $u extends B.ZR{constructor(g,_,I,S){var O;super(_.code,_.message),this.operationType=I,this.user=S,Object.setPrototypeOf(this,$u.prototype),this.customData={appName:g.name,tenantId:null!==(O=g.tenantId)&&void 0!==O?O:void 0,_serverResponse:_.customData._serverResponse,operationType:I}}static _fromErrorAndOperation(g,_,I,S){return new $u(g,_,I,S)}}function Ep(w,g,_,I){return("reauthenticate"===g?_._getReauthenticationResolver(w):_._getIdTokenResponse(w)).catch(O=>{throw"auth/multi-factor-auth-required"===O.code?$u._fromErrorAndOperation(w,O,g,I):O})}function Hi(w){return new Set(w.map(({providerId:g})=>g).filter(g=>!!g))}function Jr(w,g){return Ba.apply(this,arguments)}function Ba(){return(Ba=(0,f.Z)(function*(w,g){const _=(0,B.m9)(w);yield Sr(!0,_,g);const{providerUserInfo:I}=yield nr(_.auth,{idToken:yield _.getIdToken(),deleteProvider:[g]}),S=Hi(I||[]);return _.providerData=_.providerData.filter(O=>S.has(O.providerId)),S.has("phone")||(_.phoneNumber=null),yield _.auth._persistUserIfCurrent(_),_})).apply(this,arguments)}function na(w,g){return Xr.apply(this,arguments)}function Xr(){return(Xr=(0,f.Z)(function*(w,g,_=!1){const I=yield nt(w,g._linkToIdToken(w.auth,yield w.getIdToken()),_);return Tr._forOperation(w,"link",I)})).apply(this,arguments)}function Sr(w,g,_){return $i.apply(this,arguments)}function $i(){return($i=(0,f.Z)(function*(w,g,_){yield vn(g);const S=!1===w?"provider-already-linked":"no-such-provider";te(Hi(g.providerData).has(_)===w,g.auth,S)})).apply(this,arguments)}function Io(w,g){return Co.apply(this,arguments)}function Co(){return(Co=(0,f.Z)(function*(w,g,_=!1){var I;const{auth:S}=w,O="reauthenticate";try{const ie=yield nt(w,Ep(S,O,g,w),_);te(ie.idToken,S,"internal-error");const Ne=Ut(ie.idToken);te(Ne,S,"internal-error");const{sub:ut}=Ne;return te(w.uid===ut,S,"user-mismatch"),Tr._forOperation(w,O,ie)}catch(ie){throw"auth/user-not-found"===(null===(I=ie)||void 0===I?void 0:I.code)&&Ye(S,"user-mismatch"),ie}})).apply(this,arguments)}function Gi(w,g){return Hs.apply(this,arguments)}function Hs(){return(Hs=(0,f.Z)(function*(w,g,_=!1){const I="signIn",S=yield Ep(w,I,g),O=yield Tr._fromIdTokenResponse(w,I,S);return _||(yield w._updateCurrentUser(O.user)),O})).apply(this,arguments)}function bo(w,g){return Mt.apply(this,arguments)}function Mt(){return(Mt=(0,f.Z)(function*(w,g){return Gi(Gn(w),g)})).apply(this,arguments)}function L(w,g){return k.apply(this,arguments)}function k(){return(k=(0,f.Z)(function*(w,g){const _=(0,B.m9)(w);return yield Sr(!1,_,g.providerId),na(_,g)})).apply(this,arguments)}function Y(w,g){return ce.apply(this,arguments)}function ce(){return(ce=(0,f.Z)(function*(w,g){return Io((0,B.m9)(w),g)})).apply(this,arguments)}function je(w,g){return tt.apply(this,arguments)}function tt(){return(tt=(0,f.Z)(function*(w,g){return Nn(w,"POST","/v1/accounts:signInWithCustomToken",Ft(w,g))})).apply(this,arguments)}function vt(w,g){return Wt.apply(this,arguments)}function Wt(){return(Wt=(0,f.Z)(function*(w,g){const _=Gn(w),I=yield je(_,{token:g,returnSecureToken:!0}),S=yield Tr._fromIdTokenResponse(_,"signIn",I);return yield _._updateCurrentUser(S.user),S})).apply(this,arguments)}class be{constructor(g,_){this.factorId=g,this.uid=_.mfaEnrollmentId,this.enrollmentTime=new Date(_.enrolledAt).toUTCString(),this.displayName=_.displayName}static _fromServerResponse(g,_){return"phoneInfo"in _?St._fromServerResponse(g,_):Ye(g,"internal-error")}}class St extends be{constructor(g){super("phone",g),this.phoneNumber=g.phoneInfo}static _fromServerResponse(g,_){return new St(_)}}function Sn(w,g,_){var I;te((null===(I=_.url)||void 0===I?void 0:I.length)>0,w,"invalid-continue-uri"),te(typeof _.dynamicLinkDomain>"u"||_.dynamicLinkDomain.length>0,w,"invalid-dynamic-link-domain"),g.continueUrl=_.url,g.dynamicLinkDomain=_.dynamicLinkDomain,g.canHandleCodeInApp=_.handleCodeInApp,_.iOS&&(te(_.iOS.bundleId.length>0,w,"missing-ios-bundle-id"),g.iOSBundleId=_.iOS.bundleId),_.android&&(te(_.android.packageName.length>0,w,"missing-android-pkg-name"),g.androidInstallApp=_.android.installApp,g.androidMinimumVersionCode=_.android.minimumVersion,g.androidPackageName=_.android.packageName)}function kt(w,g,_){return In.apply(this,arguments)}function In(){return(In=(0,f.Z)(function*(w,g,_){const I=(0,B.m9)(w),S={requestType:"PASSWORD_RESET",email:g};_&&Sn(I,S,_),yield Er(I,S)})).apply(this,arguments)}function Do(w,g,_){return Wi.apply(this,arguments)}function Wi(){return(Wi=(0,f.Z)(function*(w,g,_){yield Wn((0,B.m9)(w),{oobCode:g,newPassword:_})})).apply(this,arguments)}function Ur(w,g){return zi.apply(this,arguments)}function zi(){return(zi=(0,f.Z)(function*(w,g){yield Od((0,B.m9)(w),{oobCode:g})})).apply(this,arguments)}function ja(w,g){return $s.apply(this,arguments)}function $s(){return($s=(0,f.Z)(function*(w,g){const _=(0,B.m9)(w),I=yield Wn(_,{oobCode:g}),S=I.requestType;switch(te(S,_,"internal-error"),S){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":te(I.newEmail,_,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":te(I.mfaInfo,_,"internal-error");default:te(I.email,_,"internal-error")}let O=null;return I.mfaInfo&&(O=be._fromServerResponse(Gn(_),I.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.newEmail:I.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===I.requestType?I.email:I.newEmail)||null,multiFactorInfo:O},operation:S}})).apply(this,arguments)}function To(w,g){return Gs.apply(this,arguments)}function Gs(){return(Gs=(0,f.Z)(function*(w,g){const{data:_}=yield ja((0,B.m9)(w),g);return _.email})).apply(this,arguments)}function bi(w,g,_){return sr.apply(this,arguments)}function sr(){return(sr=(0,f.Z)(function*(w,g,_){const I=Gn(w),S=yield Eo(I,{returnSecureToken:!0,email:g,password:_}),O=yield Tr._fromIdTokenResponse(I,"signIn",S);return yield I._updateCurrentUser(O.user),O})).apply(this,arguments)}function Ws(w,g,_){return bo((0,B.m9)(w),is.credential(g,_))}function Hd(w,g,_){return zs.apply(this,arguments)}function zs(){return(zs=(0,f.Z)(function*(w,g,_){const I=(0,B.m9)(w),S={requestType:"EMAIL_SIGNIN",email:g};te(_.handleCodeInApp,I,"argument-error"),_&&Sn(I,S,_),yield yo(I,S)})).apply(this,arguments)}function qs(w,g){return"EMAIL_SIGNIN"===Fa.parseLink(g)?.operation}function Z_(w,g,_){return Jl.apply(this,arguments)}function Jl(){return(Jl=(0,f.Z)(function*(w,g,_){const I=(0,B.m9)(w),S=is.credentialWithLink(g,_||le());return te(S._tenantId===(I.tenantId||null),I,"tenant-id-mismatch"),bo(I,S)})).apply(this,arguments)}function Ip(w,g){return $d.apply(this,arguments)}function $d(){return($d=(0,f.Z)(function*(w,g){return Pt(w,"POST","/v1/accounts:createAuthUri",Ft(w,g))})).apply(this,arguments)}function Gd(w,g){return Ha.apply(this,arguments)}function Ha(){return(Ha=(0,f.Z)(function*(w,g){const I={identifier:g,continueUri:$e()?le():"http://localhost"},{signinMethods:S}=yield Ip((0,B.m9)(w),I);return S||[]})).apply(this,arguments)}function Cp(w,g){return Gu.apply(this,arguments)}function Gu(){return(Gu=(0,f.Z)(function*(w,g){const _=(0,B.m9)(w),S={requestType:"VERIFY_EMAIL",idToken:yield w.getIdToken()};g&&Sn(_.auth,S,g);const{email:O}=yield cr(_.auth,S);O!==w.email&&(yield w.reload())})).apply(this,arguments)}function Y_(w,g,_){return $a.apply(this,arguments)}function $a(){return($a=(0,f.Z)(function*(w,g,_){const I=(0,B.m9)(w),O={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield w.getIdToken(),newEmail:g};_&&Sn(I.auth,O,_);const{email:ie}=yield Ts(I.auth,O);ie!==w.email&&(yield w.reload())})).apply(this,arguments)}function bp(w,g){return Wd.apply(this,arguments)}function Wd(){return(Wd=(0,f.Z)(function*(w,g){return Pt(w,"POST","/v1/accounts:update",g)})).apply(this,arguments)}function Dp(w,g){return Xl.apply(this,arguments)}function Xl(){return(Xl=(0,f.Z)(function*(w,{displayName:g,photoURL:_}){if(void 0===g&&void 0===_)return;const I=(0,B.m9)(w),O={idToken:yield I.getIdToken(),displayName:g,photoUrl:_,returnSecureToken:!0},ie=yield nt(I,bp(I.auth,O));I.displayName=ie.displayName||null,I.photoURL=ie.photoUrl||null;const Ne=I.providerData.find(({providerId:ut})=>"password"===ut);Ne&&(Ne.displayName=I.displayName,Ne.photoURL=I.photoURL),yield I._updateTokensIfNecessary(ie)})).apply(this,arguments)}function Tp(w,g){return Sp((0,B.m9)(w),g,null)}function ec(w,g){return Sp((0,B.m9)(w),null,g)}function Sp(w,g,_){return tc.apply(this,arguments)}function tc(){return(tc=(0,f.Z)(function*(w,g,_){const{auth:I}=w,O={idToken:yield w.getIdToken(),returnSecureToken:!0};g&&(O.email=g),_&&(O.password=_);const ie=yield nt(w,Zt(I,O));yield w._updateTokensIfNecessary(ie,!0)})).apply(this,arguments)}class fi{constructor(g,_,I={}){this.isNewUser=g,this.providerId=_,this.profile=I}}class Zn extends fi{constructor(g,_,I,S){super(g,_,I),this.username=S}}class cE extends fi{constructor(g,_){super(g,"facebook.com",_)}}class Q_ extends Zn{constructor(g,_){super(g,"github.com",_,"string"==typeof _?.login?_?.login:null)}}class dE extends fi{constructor(g,_){super(g,"google.com",_)}}class J_ extends Zn{constructor(g,_,I){super(g,"twitter.com",_,I)}}function Ap(w){const{user:g,_tokenResponse:_}=w;return g.isAnonymous&&!_?{providerId:null,isNewUser:!1,profile:null}:function Br(w){var g,_;if(!w)return null;const{providerId:I}=w,S=w.rawUserInfo?JSON.parse(w.rawUserInfo):{},O=w.isNewUser||"identitytoolkit#SignupNewUserResponse"===w.kind;if(!I&&w?.idToken){const ie=null===(_=null===(g=Ut(w.idToken))||void 0===g?void 0:g.firebase)||void 0===_?void 0:_.sign_in_provider;if(ie)return new fi(O,"anonymous"!==ie&&"custom"!==ie?ie:null)}if(!I)return null;switch(I){case"facebook.com":return new cE(O,S);case"github.com":return new Q_(O,S);case"google.com":return new dE(O,S);case"twitter.com":return new J_(O,S,w.screenName||null);case"custom":case"anonymous":return new fi(O,null);default:return new fi(O,I,S)}}(_)}class Ao{constructor(g,_){this.type=g,this.credential=_}static _fromIdtoken(g){return new Ao("enroll",g)}static _fromMfaPendingCredential(g){return new Ao("signin",g)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(g){var _,I;if(g?.multiFactorSession){if(null!==(_=g.multiFactorSession)&&void 0!==_&&_.pendingCredential)return Ao._fromMfaPendingCredential(g.multiFactorSession.pendingCredential);if(null!==(I=g.multiFactorSession)&&void 0!==I&&I.idToken)return Ao._fromIdtoken(g.multiFactorSession.idToken)}return null}}class Mp{constructor(g,_,I){this.session=g,this.hints=_,this.signInResolver=I}static _fromError(g,_){const I=Gn(g),S=_.customData._serverResponse,O=(S.mfaInfo||[]).map(Ne=>be._fromServerResponse(I,Ne));te(S.mfaPendingCredential,I,"internal-error");const ie=Ao._fromMfaPendingCredential(S.mfaPendingCredential);return new Mp(ie,O,function(){var Ne=(0,f.Z)(function*(ut){const ct=yield ut._process(I,ie);delete S.mfaInfo,delete S.mfaPendingCredential;const Bt=Object.assign(Object.assign({},S),{idToken:ct.idToken,refreshToken:ct.refreshToken});switch(_.operationType){case"signIn":const Vn=yield Tr._fromIdTokenResponse(I,_.operationType,Bt);return yield I._updateCurrentUser(Vn.user),Vn;case"reauthenticate":return te(_.user,I,"internal-error"),Tr._forOperation(_.user,_.operationType,Bt);default:Ye(I,"internal-error")}});return function(ut){return Ne.apply(this,arguments)}}())}resolveSignIn(g){var _=this;return(0,f.Z)(function*(){return _.signInResolver(g)})()}}function nc(w,g){var _;const I=(0,B.m9)(w),S=g;return te(g.customData.operationType,I,"argument-error"),te(null===(_=S.customData._serverResponse)||void 0===_?void 0:_.mfaPendingCredential,I,"argument-error"),Mp._fromError(I,S)}function Np(w,g){return Pt(w,"POST","/v2/accounts/mfaEnrollment:start",Ft(w,g))}class Pp{constructor(g){this.user=g,this.enrolledFactors=[],g._onReload(_=>{_.mfaInfo&&(this.enrolledFactors=_.mfaInfo.map(I=>be._fromServerResponse(g.auth,I)))})}static _fromUser(g){return new Pp(g)}getSession(){var g=this;return(0,f.Z)(function*(){return Ao._fromIdtoken(yield g.user.getIdToken())})()}enroll(g,_){var I=this;return(0,f.Z)(function*(){const S=g,O=yield I.getSession(),ie=yield nt(I.user,S._process(I.user.auth,O,_));return yield I.user._updateTokensIfNecessary(ie),I.user.reload()})()}unenroll(g){var _=this;return(0,f.Z)(function*(){var I;const S="string"==typeof g?g:g.uid,O=yield _.user.getIdToken(),ie=yield nt(_.user,function pE(w,g){return Pt(w,"POST","/v2/accounts/mfaEnrollment:withdraw",Ft(w,g))}(_.user.auth,{idToken:O,mfaEnrollmentId:S}));_.enrolledFactors=_.enrolledFactors.filter(({uid:Ne})=>Ne!==S),yield _.user._updateTokensIfNecessary(ie);try{yield _.user.reload()}catch(Ne){if("auth/user-token-expired"!==(null===(I=Ne)||void 0===I?void 0:I.code))throw Ne}})()}}const ey=new WeakMap;function Kd(w){const g=(0,B.m9)(w);return ey.has(g)||ey.set(g,Pp._fromUser(g)),ey.get(g)}const rc="__sak";class Zd{constructor(g,_){this.storageRetriever=g,this.type=_}_isAvailable(){try{return this.storage?(this.storage.setItem(rc,"1"),this.storage.removeItem(rc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(g,_){return this.storage.setItem(g,JSON.stringify(_)),Promise.resolve()}_get(g){const _=this.storage.getItem(g);return Promise.resolve(_?JSON.parse(_):null)}_remove(g){return this.storage.removeItem(g),Promise.resolve()}get storage(){return this.storageRetriever()}}const ry=(()=>{class w extends Zd{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(_,I)=>this.onStorageEvent(_,I),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Yd(){const w=(0,B.z$)();return F(w)||ot(w)}()&&function En(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=dn(),this._shouldAllowMigration=!0}forAllChangedKeys(_){for(const I of Object.keys(this.listeners)){const S=this.storage.getItem(I),O=this.localCache[I];S!==O&&_(I,O,S)}}onStorageEvent(_,I=!1){if(!_.key)return void this.forAllChangedKeys((Ne,ut,ct)=>{this.notifyListeners(Ne,ct)});const S=_.key;if(I?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const Ne=this.storage.getItem(S);if(_.newValue!==Ne)null!==_.newValue?this.storage.setItem(S,_.newValue):this.storage.removeItem(S);else if(this.localCache[S]===_.newValue&&!I)return}const O=()=>{const Ne=this.storage.getItem(S);!I&&this.localCache[S]===Ne||this.notifyListeners(S,Ne)},ie=this.storage.getItem(S);!function pt(){return(0,B.w1)()&&10===document.documentMode}()||ie===_.newValue||_.newValue===_.oldValue?O():setTimeout(O,10)}notifyListeners(_,I){this.localCache[_]=I;const S=this.listeners[_];if(S)for(const O of Array.from(S))O(I&&JSON.parse(I))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((_,I,S)=>{this.onStorageEvent(new StorageEvent("storage",{key:_,oldValue:I,newValue:S}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(_,I){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[_]||(this.listeners[_]=new Set,this.localCache[_]=this.storage.getItem(_)),this.listeners[_].add(I)}_removeListener(_,I){this.listeners[_]&&(this.listeners[_].delete(I),0===this.listeners[_].size&&delete this.listeners[_]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(_,I){var S=()=>super._set,O=this;return(0,f.Z)(function*(){yield S().call(O,_,I),O.localCache[_]=JSON.stringify(I)})()}_get(_){var I=()=>super._get,S=this;return(0,f.Z)(function*(){const O=yield I().call(S,_);return S.localCache[_]=JSON.stringify(O),O})()}_remove(_){var I=()=>super._remove,S=this;return(0,f.Z)(function*(){yield I().call(S,_),delete S.localCache[_]})()}}return w.type="LOCAL",w})(),oc=(()=>{class w extends Zd{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(_,I){}_removeListener(_,I){}}return w.type="SESSION",w})();let gE=(()=>{class w{constructor(_){this.eventTarget=_,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(_){const I=this.receivers.find(O=>O.isListeningto(_));if(I)return I;const S=new w(_);return this.receivers.push(S),S}isListeningto(_){return this.eventTarget===_}handleEvent(_){var I=this;return(0,f.Z)(function*(){const S=_,{eventId:O,eventType:ie,data:Ne}=S.data,ut=I.handlersMap[ie];if(!ut?.size)return;S.ports[0].postMessage({status:"ack",eventId:O,eventType:ie});const ct=Array.from(ut).map(function(){var Vn=(0,f.Z)(function*(Ki){return Ki(S.origin,Ne)});return function(Ki){return Vn.apply(this,arguments)}}()),Bt=yield function Qd(w){return Promise.all(w.map(function(){var g=(0,f.Z)(function*(_){try{return{fulfilled:!0,value:yield _}}catch(I){return{fulfilled:!1,reason:I}}});return function(_){return g.apply(this,arguments)}}()))}(ct);S.ports[0].postMessage({status:"done",eventId:O,eventType:ie,response:Bt})})()}_subscribe(_,I){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[_]||(this.handlersMap[_]=new Set),this.handlersMap[_].add(I)}_unsubscribe(_,I){this.handlersMap[_]&&I&&this.handlersMap[_].delete(I),(!I||0===this.handlersMap[_].size)&&delete this.handlersMap[_],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return w.receivers=[],w})();function Wu(w="",g=10){let _="";for(let I=0;I<g;I++)_+=Math.floor(10*Math.random());return w+_}class kn{constructor(g){this.target=g,this.handlers=new Set}removeMessageHandler(g){g.messageChannel&&(g.messageChannel.port1.removeEventListener("message",g.onMessage),g.messageChannel.port1.close()),this.handlers.delete(g)}_send(g,_,I=50){var S=this;return(0,f.Z)(function*(){const O=typeof MessageChannel<"u"?new MessageChannel:null;if(!O)throw new Error("connection_unavailable");let ie,Ne;return new Promise((ut,ct)=>{const Bt=Wu("",20);O.port1.start();const Vn=setTimeout(()=>{ct(new Error("unsupported_event"))},I);Ne={messageChannel:O,onMessage(Ki){const Xs=Ki;if(Xs.data.eventId===Bt)switch(Xs.data.status){case"ack":clearTimeout(Vn),ie=setTimeout(()=>{ct(new Error("timeout"))},3e3);break;case"done":clearTimeout(ie),ut(Xs.data.response);break;default:clearTimeout(Vn),clearTimeout(ie),ct(new Error("invalid_response"))}}},S.handlers.add(Ne),O.port1.addEventListener("message",Ne.onMessage),S.target.postMessage({eventType:g,eventId:Bt,data:_},[O.port2])}).finally(()=>{Ne&&S.removeMessageHandler(Ne)})})()}}function Mn(){return window}function Jd(){return typeof Mn().WorkerGlobalScope<"u"&&"function"==typeof Mn().importScripts}function qu(){return(qu=(0,f.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Zs="firebaseLocalStorageDb",Yn="firebaseLocalStorage",Ot="fbase_key";class Ga{constructor(g){this.request=g}toPromise(){return new Promise((g,_)=>{this.request.addEventListener("success",()=>{g(this.request.result)}),this.request.addEventListener("error",()=>{_(this.request.error)})})}}function Ku(w,g){return w.transaction([Yn],g?"readwrite":"readonly").objectStore(Yn)}function sa(){const w=indexedDB.open(Zs,1);return new Promise((g,_)=>{w.addEventListener("error",()=>{_(w.error)}),w.addEventListener("upgradeneeded",()=>{const I=w.result;try{I.createObjectStore(Yn,{keyPath:Ot})}catch(S){_(S)}}),w.addEventListener("success",(0,f.Z)(function*(){const I=w.result;I.objectStoreNames.contains(Yn)?g(I):(I.close(),yield function kp(){const w=indexedDB.deleteDatabase(Zs);return new Ga(w).toPromise()}(),g(yield sa()))}))})}function Wa(w,g,_){return lc.apply(this,arguments)}function lc(){return(lc=(0,f.Z)(function*(w,g,_){const I=Ku(w,!0).put({[Ot]:g,value:_});return new Ga(I).toPromise()})).apply(this,arguments)}function Di(){return(Di=(0,f.Z)(function*(w,g){const _=Ku(w,!1).get(g),I=yield new Ga(_).toPromise();return void 0===I?null:I.value})).apply(this,arguments)}function oa(w,g){const _=Ku(w,!0).delete(g);return new Ga(_).toPromise()}const Vp=(()=>{class w{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var _=this;return(0,f.Z)(function*(){return _.db||(_.db=yield sa()),_.db})()}_withRetries(_){var I=this;return(0,f.Z)(function*(){let S=0;for(;;)try{const O=yield I._openDb();return yield _(O)}catch(O){if(S++>3)throw O;I.db&&(I.db.close(),I.db=void 0)}})()}initializeServiceWorkerMessaging(){var _=this;return(0,f.Z)(function*(){return Jd()?_.initializeReceiver():_.initializeSender()})()}initializeReceiver(){var _=this;return(0,f.Z)(function*(){_.receiver=gE._getInstance(function uc(){return Jd()?self:null}()),_.receiver._subscribe("keyChanged",function(){var I=(0,f.Z)(function*(S,O){return{keyProcessed:(yield _._poll()).includes(O.key)}});return function(S,O){return I.apply(this,arguments)}}()),_.receiver._subscribe("ping",function(){var I=(0,f.Z)(function*(S,O){return["keyChanged"]});return function(S,O){return I.apply(this,arguments)}}())})()}initializeSender(){var _=this;return(0,f.Z)(function*(){var I,S;if(_.activeServiceWorker=yield function zu(){return qu.apply(this,arguments)}(),!_.activeServiceWorker)return;_.sender=new kn(_.activeServiceWorker);const O=yield _.sender._send("ping",{},800);!O||(null===(I=O[0])||void 0===I?void 0:I.fulfilled)&&(null===(S=O[0])||void 0===S?void 0:S.value.includes("keyChanged"))&&(_.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(_){var I=this;return(0,f.Z)(function*(){if(I.sender&&I.activeServiceWorker&&function ac(){var w;return(null===(w=navigator?.serviceWorker)||void 0===w?void 0:w.controller)||null}()===I.activeServiceWorker)try{yield I.sender._send("keyChanged",{key:_},I.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,f.Z)(function*(){try{if(!indexedDB)return!1;const _=yield sa();return yield Wa(_,rc,"1"),yield oa(_,rc),!0}catch{}return!1})()}_withPendingWrite(_){var I=this;return(0,f.Z)(function*(){I.pendingWrites++;try{yield _()}finally{I.pendingWrites--}})()}_set(_,I){var S=this;return(0,f.Z)(function*(){return S._withPendingWrite((0,f.Z)(function*(){return yield S._withRetries(O=>Wa(O,_,I)),S.localCache[_]=I,S.notifyServiceWorker(_)}))})()}_get(_){var I=this;return(0,f.Z)(function*(){const S=yield I._withRetries(O=>function xo(w,g){return Di.apply(this,arguments)}(O,_));return I.localCache[_]=S,S})()}_remove(_){var I=this;return(0,f.Z)(function*(){return I._withPendingWrite((0,f.Z)(function*(){return yield I._withRetries(S=>oa(S,_)),delete I.localCache[_],I.notifyServiceWorker(_)}))})()}_poll(){var _=this;return(0,f.Z)(function*(){const I=yield _._withRetries(ie=>{const Ne=Ku(ie,!1).getAll();return new Ga(Ne).toPromise()});if(!I)return[];if(0!==_.pendingWrites)return[];const S=[],O=new Set;for(const{fbase_key:ie,value:Ne}of I)O.add(ie),JSON.stringify(_.localCache[ie])!==JSON.stringify(Ne)&&(_.notifyListeners(ie,Ne),S.push(ie));for(const ie of Object.keys(_.localCache))_.localCache[ie]&&!O.has(ie)&&(_.notifyListeners(ie,null),S.push(ie));return S})()}notifyListeners(_,I){this.localCache[_]=I;const S=this.listeners[_];if(S)for(const O of Array.from(S))O(I)}startPolling(){var _=this;this.stopPolling(),this.pollTimer=setInterval((0,f.Z)(function*(){return _._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(_,I){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[_]||(this.listeners[_]=new Set,this._get(_)),this.listeners[_].add(I)}_removeListener(_,I){this.listeners[_]&&(this.listeners[_].delete(I),0===this.listeners[_].size&&delete this.listeners[_]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return w.type="LOCAL",w})();function cc(w,g){return Pt(w,"POST","/v2/accounts/mfaSignIn:start",Ft(w,g))}function Ys(){return(Ys=(0,f.Z)(function*(w){return(yield Pt(w,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Rs(w){return new Promise((g,_)=>{const I=document.createElement("script");I.setAttribute("src",w),I.onload=g,I.onerror=S=>{const O=Ve("internal-error");O.customData=S,_(O)},I.type="text/javascript",I.charset="UTF-8",function dr(){var w,g;return null!==(g=null===(w=document.getElementsByTagName("head"))||void 0===w?void 0:w[0])&&void 0!==g?g:document}().appendChild(I)})}function dc(w){return`__${w}${Math.floor(1e6*Math.random())}`}const Yu=1e12;class On{constructor(g){this.auth=g,this.counter=Yu,this._widgets=new Map}render(g,_){const I=this.counter;return this._widgets.set(I,new Up(g,this.auth.name,_||{})),this.counter++,I}reset(g){var _;const I=g||Yu;null===(_=this._widgets.get(I))||void 0===_||_.delete(),this._widgets.delete(I)}getResponse(g){var _;return(null===(_=this._widgets.get(g||Yu))||void 0===_?void 0:_.getResponse())||""}execute(g){var _=this;return(0,f.Z)(function*(){var I;return null===(I=_._widgets.get(g||Yu))||void 0===I||I.execute(),""})()}}class Up{constructor(g,_,I){this.params=I,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const S="string"==typeof g?document.getElementById(g):g;te(S,"argument-error",{appName:_}),this.container=S,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function sy(w){const g=[],_="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let I=0;I<w;I++)g.push(_.charAt(Math.floor(Math.random()*_.length)));return g.join("")}(50);const{callback:g,"expired-callback":_}=this.params;if(g)try{g(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,_)try{_()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const eh=dc("rcb"),oy=new Qe(3e4,6e4);class th{constructor(){var g;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(g=Mn().grecaptcha)||void 0===g||!g.render)}load(g,_=""){return te(function uy(w){return w.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(w)}(_),g,"argument-error"),this.shouldResolveImmediately(_)?Promise.resolve(Mn().grecaptcha):new Promise((I,S)=>{const O=Mn().setTimeout(()=>{S(Ve(g,"network-request-failed"))},oy.get());Mn()[eh]=()=>{Mn().clearTimeout(O),delete Mn()[eh];const Ne=Mn().grecaptcha;if(!Ne)return void S(Ve(g,"internal-error"));const ut=Ne.render;Ne.render=(ct,Bt)=>{const Vn=ut(ct,Bt);return this.counter++,Vn},this.hostLanguage=_,I(Ne)},Rs(`https://www.google.com/recaptcha/api.js??${(0,B.xO)({onload:eh,render:"explicit",hl:_})}`).catch(()=>{clearTimeout(O),S(Ve(g,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(g){var _;return!(null===(_=Mn().grecaptcha)||void 0===_||!_.render)&&(g===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class za{load(g){return(0,f.Z)(function*(){return new On(g)})()}clearedOneInstance(){}}const Bp="recaptcha",ly={theme:"light",type:"image"};class Ir{constructor(g,_=Object.assign({},ly),I){this.parameters=_,this.type=Bp,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Gn(I),this.isInvisible="invisible"===this.parameters.size,te(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const S="string"==typeof g?document.getElementById(g):g;te(S,this.auth,"argument-error"),this.container=S,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new za:new th,this.validateStartingState()}verify(){var g=this;return(0,f.Z)(function*(){g.assertNotDestroyed();const _=yield g.render(),I=g.getAssertedRecaptcha();return I.getResponse(_)||new Promise(O=>{const ie=Ne=>{!Ne||(g.tokenChangeListeners.delete(ie),O(Ne))};g.tokenChangeListeners.add(ie),g.isInvisible&&I.execute(_)})})()}render(){try{this.assertNotDestroyed()}catch(g){return Promise.reject(g)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(g=>{throw this.renderPromise=null,g})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(g=>{this.container.removeChild(g)})}validateStartingState(){te(!this.parameters.sitekey,this.auth,"argument-error"),te(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),te(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(g){return _=>{if(this.tokenChangeListeners.forEach(I=>I(_)),"function"==typeof g)g(_);else if("string"==typeof g){const I=Mn()[g];"function"==typeof I&&I(_)}}}assertNotDestroyed(){te(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var g=this;return(0,f.Z)(function*(){if(yield g.init(),!g.widgetId){let _=g.container;if(!g.isInvisible){const I=document.createElement("div");_.appendChild(I),_=I}g.widgetId=g.getAssertedRecaptcha().render(_,g.parameters)}return g.widgetId})()}init(){var g=this;return(0,f.Z)(function*(){te($e()&&!Jd(),g.auth,"internal-error"),yield function hc(){let w=null;return new Promise(g=>{"complete"!==document.readyState?(w=()=>g(),window.addEventListener("load",w)):g()}).catch(g=>{throw w&&window.removeEventListener("load",w),g})}(),g.recaptcha=yield g._recaptchaLoader.load(g.auth,g.auth.languageCode||void 0);const _=yield function Ti(w){return Ys.apply(this,arguments)}(g.auth);te(_,g.auth,"internal-error"),g.parameters.sitekey=_})()}getAssertedRecaptcha(){return te(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Ro{constructor(g,_){this.verificationId=g,this.onConfirmation=_}confirm(g){const _=js._fromVerification(this.verificationId,g);return this.onConfirmation(_)}}function jp(w,g,_){return fc.apply(this,arguments)}function fc(){return(fc=(0,f.Z)(function*(w,g,_){const I=Gn(w),S=yield Ms(I,g,(0,B.m9)(_));return new Ro(S,O=>bo(I,O))})).apply(this,arguments)}function ei(w,g,_){return qi.apply(this,arguments)}function qi(){return(qi=(0,f.Z)(function*(w,g,_){const I=(0,B.m9)(w);yield Sr(!1,I,"phone");const S=yield Ms(I.auth,g,(0,B.m9)(_));return new Ro(S,O=>L(I,O))})).apply(this,arguments)}function nh(w,g,_){return aa.apply(this,arguments)}function aa(){return(aa=(0,f.Z)(function*(w,g,_){const I=(0,B.m9)(w),S=yield Ms(I.auth,g,(0,B.m9)(_));return new Ro(S,O=>Y(I,O))})).apply(this,arguments)}function Ms(w,g,_){return ua.apply(this,arguments)}function ua(){return(ua=(0,f.Z)(function*(w,g,_){var I;const S=yield _.verify();try{let O;if(te("string"==typeof S,w,"argument-error"),te(_.type===Bp,w,"argument-error"),O="string"==typeof g?{phoneNumber:g}:g,"session"in O){const ie=O.session;if("phoneNumber"in O)return te("enroll"===ie.type,w,"internal-error"),(yield Np(w,{idToken:ie.credential,phoneEnrollmentInfo:{phoneNumber:O.phoneNumber,recaptchaToken:S}})).phoneSessionInfo.sessionInfo;{te("signin"===ie.type,w,"internal-error");const Ne=(null===(I=O.multiFactorHint)||void 0===I?void 0:I.uid)||O.multiFactorUid;return te(Ne,w,"missing-multi-factor-info"),(yield cc(w,{mfaPendingCredential:ie.credential,mfaEnrollmentId:Ne,phoneSignInInfo:{recaptchaToken:S}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:ie}=yield Vd(w,{phoneNumber:O.phoneNumber,recaptchaToken:S});return ie}}finally{_._reset()}})).apply(this,arguments)}function Hp(w,g){return pc.apply(this,arguments)}function pc(){return(pc=(0,f.Z)(function*(w,g){yield na((0,B.m9)(w),g)})).apply(this,arguments)}let cy=(()=>{class w{constructor(_){this.providerId=w.PROVIDER_ID,this.auth=Gn(_)}verifyPhoneNumber(_,I){return Ms(this.auth,_,(0,B.m9)(I))}static credential(_,I){return js._fromVerification(_,I)}static credentialFromResult(_){return w.credentialFromTaggedObject(_)}static credentialFromError(_){return w.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{phoneNumber:I,temporaryProof:S}=_;return I&&S?js._fromTokenResponse(I,S):null}}return w.PROVIDER_ID="phone",w.PHONE_SIGN_IN_METHOD="phone",w})();function mr(w,g){return g?re(g):(te(w._popupRedirectResolver,w,"argument-error"),w._popupRedirectResolver)}class os extends fn{constructor(g){super("custom","custom"),this.params=g}_getIdTokenResponse(g){return ns(g,this._buildIdpRequest())}_linkToIdToken(g,_){return ns(g,this._buildIdpRequest(_))}_getReauthenticationResolver(g){return ns(g,this._buildIdpRequest())}_buildIdpRequest(g){const _={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return g&&(_.idToken=g),_}}function pi(w){return Gi(w.auth,new os(w),w.bypassAuthState)}function $p(w){const{auth:g,user:_}=w;return te(_,g,"internal-error"),Io(_,new os(w),w.bypassAuthState)}function Qu(w){return Gp.apply(this,arguments)}function Gp(){return(Gp=(0,f.Z)(function*(w){const{auth:g,user:_}=w;return te(_,g,"internal-error"),na(_,new os(w),w.bypassAuthState)})).apply(this,arguments)}class rh{constructor(g,_,I,S,O=!1){this.auth=g,this.resolver=I,this.user=S,this.bypassAuthState=O,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(_)?_:[_]}execute(){var g=this;return new Promise(function(){var _=(0,f.Z)(function*(I,S){g.pendingPromise={resolve:I,reject:S};try{g.eventManager=yield g.resolver._initialize(g.auth),yield g.onExecution(),g.eventManager.registerConsumer(g)}catch(O){g.reject(O)}});return function(I,S){return _.apply(this,arguments)}}())}onAuthEvent(g){var _=this;return(0,f.Z)(function*(){const{urlResponse:I,sessionId:S,postBody:O,tenantId:ie,error:Ne,type:ut}=g;if(Ne)return void _.reject(Ne);const ct={auth:_.auth,requestUri:I,sessionId:S,tenantId:ie||void 0,postBody:O||void 0,user:_.user,bypassAuthState:_.bypassAuthState};try{_.resolve(yield _.getIdpTask(ut)(ct))}catch(Bt){_.reject(Bt)}})()}onError(g){this.reject(g)}getIdpTask(g){switch(g){case"signInViaPopup":case"signInViaRedirect":return pi;case"linkViaPopup":case"linkViaRedirect":return Qu;case"reauthViaPopup":case"reauthViaRedirect":return $p;default:Ye(this.auth,"internal-error")}}resolve(g){Re(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(g),this.unregisterAndCleanUp()}reject(g){Re(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(g),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ih=new Qe(2e3,1e4);function gc(w,g,_){return sh.apply(this,arguments)}function sh(){return(sh=(0,f.Z)(function*(w,g,_){const I=Gn(w);Ae(w,g,ss);const S=mr(I,_);return new Ju(I,"signInViaPopup",g,S).executeNotNull()})).apply(this,arguments)}function oh(w,g,_){return ah.apply(this,arguments)}function ah(){return(ah=(0,f.Z)(function*(w,g,_){const I=(0,B.m9)(w);Ae(I.auth,g,ss);const S=mr(I.auth,_);return new Ju(I.auth,"reauthViaPopup",g,S,I).executeNotNull()})).apply(this,arguments)}function mE(w,g,_){return mc.apply(this,arguments)}function mc(){return(mc=(0,f.Z)(function*(w,g,_){const I=(0,B.m9)(w);Ae(I.auth,g,ss);const S=mr(I.auth,_);return new Ju(I.auth,"linkViaPopup",g,S,I).executeNotNull()})).apply(this,arguments)}let Ju=(()=>{class w extends rh{constructor(_,I,S,O,ie){super(_,I,O,ie),this.provider=S,this.authWindow=null,this.pollId=null,w.currentPopupAction&&w.currentPopupAction.cancel(),w.currentPopupAction=this}executeNotNull(){var _=this;return(0,f.Z)(function*(){const I=yield _.execute();return te(I,_.auth,"internal-error"),I})()}onExecution(){var _=this;return(0,f.Z)(function*(){Re(1===_.filter.length,"Popup operations only handle one event");const I=Wu();_.authWindow=yield _.resolver._openPopup(_.auth,_.provider,_.filter[0],I),_.authWindow.associatedEvent=I,_.resolver._originValidation(_.auth).catch(S=>{_.reject(S)}),_.resolver._isIframeWebStorageSupported(_.auth,S=>{S||_.reject(Ve(_.auth,"web-storage-unsupported"))}),_.pollUserCancellation()})()}get eventId(){var _;return(null===(_=this.authWindow)||void 0===_?void 0:_.associatedEvent)||null}cancel(){this.reject(Ve(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,w.currentPopupAction=null}pollUserCancellation(){const _=()=>{var I,S;this.pollId=null!==(S=null===(I=this.authWindow)||void 0===I?void 0:I.window)&&void 0!==S&&S.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ve(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(_,ih.get())};_()}}return w.currentPopupAction=null,w})();const Mo=new Map;class Wp extends rh{constructor(g,_,I=!1){super(g,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],_,void 0,I),this.eventId=null}execute(){var g=()=>super.execute,_=this;return(0,f.Z)(function*(){let I=Mo.get(_.auth._key());if(!I){try{const O=(yield function uh(w,g){return lh.apply(this,arguments)}(_.resolver,_.auth))?yield g().call(_):null;I=()=>Promise.resolve(O)}catch(S){I=()=>Promise.reject(S)}Mo.set(_.auth._key(),I)}return _.bypassAuthState||Mo.set(_.auth._key(),()=>Promise.resolve(null)),I()})()}onAuthEvent(g){var _=()=>super.onAuthEvent,I=this;return(0,f.Z)(function*(){if("signInViaRedirect"===g.type)return _().call(I,g);if("unknown"!==g.type){if(g.eventId){const S=yield I.auth._redirectUserForId(g.eventId);if(S)return I.user=S,_().call(I,g);I.resolve(null)}}else I.resolve(null)})()}onExecution(){return(0,f.Z)(function*(){})()}cleanUp(){}}function lh(){return(lh=(0,f.Z)(function*(w,g){const _=Ka(g),I=la(w);if(!(yield I._isAvailable()))return!1;const S="true"===(yield I._get(_));return yield I._remove(_),S})).apply(this,arguments)}function _c(w,g){return ch.apply(this,arguments)}function ch(){return(ch=(0,f.Z)(function*(w,g){return la(w)._set(Ka(g),"true")})).apply(this,arguments)}function zp(){Mo.clear()}function qa(w,g){Mo.set(w._key(),g)}function la(w){return re(w._redirectPersistence)}function Ka(w){return Xt("pendingRedirect",w.config.apiKey,w.name)}function Qn(w,g,_){return function ca(w,g,_){return No.apply(this,arguments)}(w,g,_)}function No(){return(No=(0,f.Z)(function*(w,g,_){const I=Gn(w);Ae(w,g,ss);const S=mr(I,_);return yield _c(S,I),S._openRedirect(I,g,"signInViaRedirect")})).apply(this,arguments)}function Xu(w,g,_){return function Za(w,g,_){return el.apply(this,arguments)}(w,g,_)}function el(){return(el=(0,f.Z)(function*(w,g,_){const I=(0,B.m9)(w);Ae(I.auth,g,ss);const S=mr(I.auth,_);yield _c(S,I.auth);const O=yield Zp(I);return S._openRedirect(I.auth,g,"reauthViaRedirect",O)})).apply(this,arguments)}function qp(w,g,_){return function yc(w,g,_){return Ya.apply(this,arguments)}(w,g,_)}function Ya(){return(Ya=(0,f.Z)(function*(w,g,_){const I=(0,B.m9)(w);Ae(I.auth,g,ss);const S=mr(I.auth,_);yield Sr(!1,I,g.providerId),yield _c(S,I.auth);const O=yield Zp(I);return S._openRedirect(I.auth,g,"linkViaRedirect",O)})).apply(this,arguments)}function Qa(w,g){return tl.apply(this,arguments)}function tl(){return(tl=(0,f.Z)(function*(w,g){return yield Gn(w)._initializationPromise,Qs(w,g,!1)})).apply(this,arguments)}function Qs(w,g){return Kp.apply(this,arguments)}function Kp(){return(Kp=(0,f.Z)(function*(w,g,_=!1){const I=Gn(w),S=mr(I,g),ie=yield new Wp(I,S,_).execute();return ie&&!_&&(delete ie.user._redirectEventId,yield I._persistUserIfCurrent(ie.user),yield I._setRedirectUser(null,g)),ie})).apply(this,arguments)}function Zp(w){return da.apply(this,arguments)}function da(){return(da=(0,f.Z)(function*(w){const g=Wu(`${w.uid}:::`);return w._redirectEventId=g,yield w.auth._setRedirectUser(w),yield w.auth._persistUserIfCurrent(w),g})).apply(this,arguments)}class Ja{constructor(g){this.auth=g,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(g){this.consumers.add(g),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,g)&&(this.sendToConsumer(this.queuedRedirectEvent,g),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(g){this.consumers.delete(g)}onEvent(g){if(this.hasEventBeenHandled(g))return!1;let _=!1;return this.consumers.forEach(I=>{this.isEventForConsumer(g,I)&&(_=!0,this.sendToConsumer(g,I),this.saveEventToCache(g))}),this.hasHandledPotentialRedirect||!function Js(w){switch(w.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nl(w);default:return!1}}(g)||(this.hasHandledPotentialRedirect=!0,_||(this.queuedRedirectEvent=g,_=!0)),_}sendToConsumer(g,_){var I;if(g.error&&!nl(g)){const S=(null===(I=g.error.code)||void 0===I?void 0:I.split("auth/")[1])||"internal-error";_.onError(Ve(this.auth,S))}else _.onAuthEvent(g)}isEventForConsumer(g,_){const I=null===_.eventId||!!g.eventId&&g.eventId===_.eventId;return _.filter.includes(g.type)&&I}hasEventBeenHandled(g){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Xa(g))}saveEventToCache(g){this.cachedEventUids.add(Xa(g)),this.lastProcessedEventTime=Date.now()}}function Xa(w){return[w.type,w.eventId,w.sessionId,w.tenantId].filter(g=>g).join("-")}function nl({type:w,error:g}){return"unknown"===w&&"auth/no-auth-event"===g?.code}function eu(w){return rl.apply(this,arguments)}function rl(){return(rl=(0,f.Z)(function*(w,g={}){return Pt(w,"GET","/v1/projects",g)})).apply(this,arguments)}const hh=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Yp=/^https?/;function fh(){return(fh=(0,f.Z)(function*(w){if(w.config.emulator)return;const{authorizedDomains:g}=yield eu(w);for(const _ of g)try{if(hy(_))return}catch{}Ye(w,"unauthorized-domain")})).apply(this,arguments)}function hy(w){const g=le(),{protocol:_,hostname:I}=new URL(g);if(w.startsWith("chrome-extension://")){const ie=new URL(w);return""===ie.hostname&&""===I?"chrome-extension:"===_&&w.replace("chrome-extension://","")===g.replace("chrome-extension://",""):"chrome-extension:"===_&&ie.hostname===I}if(!Yp.test(_))return!1;if(hh.test(w))return I===w;const S=w.replace(/\./g,"\\.");return new RegExp("^(.+\\."+S+"|"+S+")$","i").test(I)}const Qp=new Qe(3e4,6e4);function Jp(){const w=Mn().___jsl;if(w?.H)for(const g of Object.keys(w.H))if(w.H[g].r=w.H[g].r||[],w.H[g].L=w.H[g].L||[],w.H[g].r=[...w.H[g].L],w.CP)for(let _=0;_<w.CP.length;_++)w.CP[_]=null}let il=null;function Xp(w){return il=il||function ph(w){return new Promise((g,_)=>{var I,S,O;function ie(){Jp(),gapi.load("gapi.iframes",{callback:()=>{g(gapi.iframes.getContext())},ontimeout:()=>{Jp(),_(Ve(w,"network-request-failed"))},timeout:Qp.get()})}if(null!==(S=null===(I=Mn().gapi)||void 0===I?void 0:I.iframes)&&void 0!==S&&S.Iframe)g(gapi.iframes.getContext());else{if(null===(O=Mn().gapi)||void 0===O||!O.load){const Ne=dc("iframefcb");return Mn()[Ne]=()=>{gapi.load?ie():_(Ve(w,"network-request-failed"))},Rs(`https://apis.google.com/js/api.js?onload=${Ne}`).catch(ut=>_(ut))}ie()}}).catch(g=>{throw il=null,g})}(w),il}const fy=new Qe(5e3,15e3),py={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sl=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gy(w){const g=w.config;te(g.authDomain,w,"auth-domain-config-required");const _=g.emulator?cn(g,"emulator/auth/iframe"):`https://${w.config.authDomain}/__/auth/iframe`,I={apiKey:g.apiKey,appName:w.name,v:N.SDK_VERSION},S=sl.get(w.config.apiHost);S&&(I.eid=S);const O=w._getFrameworks();return O.length&&(I.fw=O.join(",")),`${_}?${(0,B.xO)(I).slice(1)}`}function tu(){return tu=(0,f.Z)(function*(w){const g=yield Xp(w),_=Mn().gapi;return te(_,w,"internal-error"),g.open({where:document.body,url:gy(w),messageHandlersFilter:_.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:py,dontclear:!0},I=>new Promise(function(){var S=(0,f.Z)(function*(O,ie){yield I.restyle({setHideOnLeave:!1});const Ne=Ve(w,"network-request-failed"),ut=Mn().setTimeout(()=>{ie(Ne)},fy.get());function ct(){Mn().clearTimeout(ut),O(I)}I.ping(ct).then(ct,()=>{ie(Ne)})});return function(O,ie){return S.apply(this,arguments)}}()))}),tu.apply(this,arguments)}const ha={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class vc{constructor(g){this.window=g,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _h(w,g,_,I,S,O){te(w.config.authDomain,w,"auth-domain-config-required"),te(w.config.apiKey,w,"invalid-api-key");const ie={apiKey:w.config.apiKey,appName:w.name,authType:_,redirectUrl:I,v:N.SDK_VERSION,eventId:S};if(g instanceof ss){g.setDefaultLanguage(w.languageCode),ie.providerId=g.providerId||"",(0,B.xb)(g.getCustomParameters())||(ie.customParameters=JSON.stringify(g.getCustomParameters()));for(const[ut,ct]of Object.entries(O||{}))ie[ut]=ct}if(g instanceof Ss){const ut=g.getScopes().filter(ct=>""!==ct);ut.length>0&&(ie.scopes=ut.join(","))}w.tenantId&&(ie.tid=w.tenantId);const Ne=ie;for(const ut of Object.keys(Ne))void 0===Ne[ut]&&delete Ne[ut];return`${function _E({config:w}){return w.emulator?cn(w,"emulator/auth/handler"):`https://${w.authDomain}/__/auth/handler`}(w)}?${(0,B.xO)(Ne).slice(1)}`}const yh="webStorageSupport",sg=class ig{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=oc,this._completeRedirectFn=Qs,this._overrideRedirectResult=qa}_openPopup(g,_,I,S){var O=this;return(0,f.Z)(function*(){var ie;Re(null===(ie=O.eventManagers[g._key()])||void 0===ie?void 0:ie.manager,"_initialize() not called before _openPopup()");const Ne=_h(g,_,I,le(),S);return function gh(w,g,_,I=500,S=600){const O=Math.max((window.screen.availHeight-S)/2,0).toString(),ie=Math.max((window.screen.availWidth-I)/2,0).toString();let Ne="";const ut=Object.assign(Object.assign({},ha),{width:I.toString(),height:S.toString(),top:O,left:ie}),ct=(0,B.z$)().toLowerCase();_&&(Ne=J(ct)?"_blank":_),M(ct)&&(g=g||"http://localhost",ut.scrollbars="yes");const Bt=Object.entries(ut).reduce((Ki,[Xs,wc])=>`${Ki}${Xs}=${wc},`,"");if(function wn(w=(0,B.z$)()){var g;return ot(w)&&!(null===(g=window.navigator)||void 0===g||!g.standalone)}(ct)&&"_self"!==Ne)return function mh(w,g){const _=document.createElement("a");_.href=w,_.target=g;const I=document.createEvent("MouseEvent");I.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),_.dispatchEvent(I)}(g||"",Ne),new vc(null);const Vn=window.open(g||"",Ne,Bt);te(Vn,w,"popup-blocked");try{Vn.focus()}catch{}return new vc(Vn)}(g,Ne,Wu())})()}_openRedirect(g,_,I,S){var O=this;return(0,f.Z)(function*(){return yield O._originValidation(g),function xs(w){Mn().location.href=w}(_h(g,_,I,le(),S)),new Promise(()=>{})})()}_initialize(g){const _=g._key();if(this.eventManagers[_]){const{manager:S,promise:O}=this.eventManagers[_];return S?Promise.resolve(S):(Re(O,"If manager is not set, promise should be"),O)}const I=this.initAndGetManager(g);return this.eventManagers[_]={promise:I},I.catch(()=>{delete this.eventManagers[_]}),I}initAndGetManager(g){var _=this;return(0,f.Z)(function*(){const I=yield function my(w){return tu.apply(this,arguments)}(g),S=new Ja(g);return I.register("authEvent",O=>(te(O?.authEvent,g,"invalid-auth-event"),{status:S.onEvent(O.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),_.eventManagers[g._key()]={manager:S},_.iframes[g._key()]=I,S})()}_isIframeWebStorageSupported(g,_){this.iframes[g._key()].send(yh,{type:yh},S=>{var O;const ie=null===(O=S?.[0])||void 0===O?void 0:O[yh];void 0!==ie&&_(!!ie),Ye(g,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(g){const _=g._key();return this.originValidationPromises[_]||(this.originValidationPromises[_]=function dy(w){return fh.apply(this,arguments)}(g)),this.originValidationPromises[_]}get _shouldInitProactively(){return dn()||F()||ot()}};class as extends class og{constructor(g){this.factorId=g}_process(g,_,I){switch(_.type){case"enroll":return this._finalizeEnroll(g,_.credential,I);case"signin":return this._finalizeSignIn(g,_.credential);default:return me("unexpected MultiFactorSessionType")}}}{constructor(g){super("phone"),this.credential=g}static _fromCredential(g){return new as(g)}_finalizeEnroll(g,_,I){return function X_(w,g){return Pt(w,"POST","/v2/accounts/mfaEnrollment:finalize",Ft(w,g))}(g,{idToken:_,displayName:I,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(g,_){return function Xd(w,g){return Pt(w,"POST","/v2/accounts/mfaSignIn:finalize",Ft(w,g))}(g,{mfaPendingCredential:_,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let ol=(()=>{class w{constructor(){}static assertion(_){return as._fromCredential(_)}}return w.FACTOR_ID="phone",w})();var ag="@firebase/auth";class yE{constructor(g){this.auth=g,this.internalListeners=new Map}getUid(){var g;return this.assertAuthConfigured(),(null===(g=this.auth.currentUser)||void 0===g?void 0:g.uid)||null}getToken(g){var _=this;return(0,f.Z)(function*(){return _.assertAuthConfigured(),yield _.auth._initializationPromise,_.auth.currentUser?{accessToken:yield _.auth.currentUser.getIdToken(g)}:null})()}addAuthTokenListener(g){if(this.assertAuthConfigured(),this.internalListeners.has(g))return;const _=this.auth.onIdTokenChanged(I=>{var S;g((null===(S=I)||void 0===S?void 0:S.stsTokenManager.accessToken)||null)});this.internalListeners.set(g,_),this.updateProactiveRefresh()}removeAuthTokenListener(g){this.assertAuthConfigured();const _=this.internalListeners.get(g);!_||(this.internalListeners.delete(g),_(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}!function wy(w){(0,N._registerComponent)(new Ce.wA("auth",(g,{options:_})=>{const I=g.getProvider("app").getImmediate(),S=g.getProvider("heartbeat"),{apiKey:O,authDomain:ie}=I.options;return((Ne,ut)=>{te(O&&!O.includes(":"),"invalid-api-key",{appName:Ne.name}),te(!ie?.includes(":"),"argument-error",{appName:Ne.name});const ct={apiKey:O,authDomain:ie,clientPlatform:w,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ds(w)},Bt=new Lt(Ne,ut,ct);return function ve(w,g){const _=g?.persistence||[],I=(Array.isArray(_)?_:[_]).map(re);g?.errorMap&&w._updateErrorMap(g.errorMap),w._initializeWithPersistence(I,g?.popupRedirectResolver)}(Bt,_),Bt})(I,S)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((g,_,I)=>{g.getProvider("auth-internal").initialize()})),(0,N._registerComponent)(new Ce.wA("auth-internal",g=>{const _=Gn(g.getProvider("auth").getImmediate());return new yE(_)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,N.registerVersion)(ag,"0.20.5",function gT(w){switch(w){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(w)),(0,N.registerVersion)(ag,"0.20.5","esm2017")}("Browser")},2090:(mt,Fe,P)=>{P.d(Fe,{$s:()=>vn,BH:()=>Ue,DV:()=>Pt,Dv:()=>pr,G6:()=>te,GJ:()=>Qt,L:()=>fe,LL:()=>le,Mn:()=>Ae,Pz:()=>xt,Sg:()=>Te,UG:()=>ge,UI:()=>Dr,US:()=>Ce,Wj:()=>Kn,Yr:()=>Je,ZB:()=>G,ZR:()=>ve,b$:()=>Ye,cI:()=>Gt,d:()=>Ve,dS:()=>Ut,eu:()=>Re,g5:()=>N,gK:()=>bn,gQ:()=>wr,h$:()=>de,hl:()=>me,hu:()=>B,jU:()=>pe,lb:()=>gr,m9:()=>Ln,ne:()=>ht,p$:()=>z,pd:()=>$n,r3:()=>Ft,ru:()=>rt,tV:()=>we,uI:()=>We,ug:()=>et,vZ:()=>Fr,w1:()=>Pe,w9:()=>yn,xO:()=>fr,xb:()=>tn,z$:()=>Oe,zI:()=>X,zd:()=>ur});const B=function($,W){if(!$)throw N(W)},N=function($){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+$)},oe=function($){const W=[];let H=0;for(let q=0;q<$.length;q++){let K=$.charCodeAt(q);K<128?W[H++]=K:K<2048?(W[H++]=K>>6|192,W[H++]=63&K|128):55296==(64512&K)&&q+1<$.length&&56320==(64512&$.charCodeAt(q+1))?(K=65536+((1023&K)<<10)+(1023&$.charCodeAt(++q)),W[H++]=K>>18|240,W[H++]=K>>12&63|128,W[H++]=K>>6&63|128,W[H++]=63&K|128):(W[H++]=K>>12|224,W[H++]=K>>6&63|128,W[H++]=63&K|128)}return W},Ce={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray($,W){if(!Array.isArray($))throw Error("encodeByteArray takes an array as a parameter");this.init_();const H=W?this.byteToCharMapWebSafe_:this.byteToCharMap_,q=[];for(let K=0;K<$.length;K+=3){const ke=$[K],Xe=K+1<$.length,yt=Xe?$[K+1]:0,Kt=K+2<$.length,Xt=Kt?$[K+2]:0;let M=(15&yt)<<2|Xt>>6,F=63&Xt;Kt||(F=64,Xe||(M=64)),q.push(H[ke>>2],H[(3&ke)<<4|yt>>4],H[M],H[F])}return q.join("")},encodeString($,W){return this.HAS_NATIVE_SUPPORT&&!W?btoa($):this.encodeByteArray(oe($),W)},decodeString($,W){return this.HAS_NATIVE_SUPPORT&&!W?atob($):function($){const W=[];let H=0,q=0;for(;H<$.length;){const K=$[H++];if(K<128)W[q++]=String.fromCharCode(K);else if(K>191&&K<224){const ke=$[H++];W[q++]=String.fromCharCode((31&K)<<6|63&ke)}else if(K>239&&K<365){const Kt=((7&K)<<18|(63&$[H++])<<12|(63&$[H++])<<6|63&$[H++])-65536;W[q++]=String.fromCharCode(55296+(Kt>>10)),W[q++]=String.fromCharCode(56320+(1023&Kt))}else{const ke=$[H++],Xe=$[H++];W[q++]=String.fromCharCode((15&K)<<12|(63&ke)<<6|63&Xe)}}return W.join("")}(this.decodeStringToByteArray($,W))},decodeStringToByteArray($,W){this.init_();const H=W?this.charToByteMapWebSafe_:this.charToByteMap_,q=[];for(let K=0;K<$.length;){const ke=H[$.charAt(K++)],yt=K<$.length?H[$.charAt(K)]:0;++K;const Xt=K<$.length?H[$.charAt(K)]:64;++K;const U=K<$.length?H[$.charAt(K)]:64;if(++K,null==ke||null==yt||null==Xt||null==U)throw Error();q.push(ke<<2|yt>>4),64!==Xt&&(q.push(yt<<4&240|Xt>>2),64!==U&&q.push(Xt<<6&192|U))}return q},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let $=0;$<this.ENCODED_VALS.length;$++)this.byteToCharMap_[$]=this.ENCODED_VALS.charAt($),this.charToByteMap_[this.byteToCharMap_[$]]=$,this.byteToCharMapWebSafe_[$]=this.ENCODED_VALS_WEBSAFE.charAt($),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[$]]=$,$>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt($)]=$,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt($)]=$)}}},de=function($){const W=oe($);return Ce.encodeByteArray(W,!0)},fe=function($){return de($).replace(/\./g,"")},we=function($){try{return Ce.decodeString($,!0)}catch(W){console.error("base64Decode failed: ",W)}return null};function z($){return G(void 0,$)}function G($,W){if(!(W instanceof Object))return W;switch(W.constructor){case Date:return new Date(W.getTime());case Object:void 0===$&&($={});break;case Array:$=[];break;default:return W}for(const H in W)!W.hasOwnProperty(H)||!ne(H)||($[H]=G($[H],W[H]));return $}function ne($){return"__proto__"!==$}class Ue{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((W,H)=>{this.resolve=W,this.reject=H})}wrapCallback(W){return(H,q)=>{H?this.reject(H):this.resolve(q),"function"==typeof W&&(this.promise.catch(()=>{}),1===W.length?W(H):W(H,q))}}}function Te($,W){if($.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const q=W||"demo-project",K=$.iat||0,ke=$.sub||$.user_id;if(!ke)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Xe=Object.assign({iss:`https://securetoken.google.com/${q}`,aud:q,iat:K,exp:K+3600,auth_time:K,sub:ke,user_id:ke,firebase:{sign_in_provider:"custom",identities:{}}},$);return[fe(JSON.stringify({alg:"none",type:"JWT"})),fe(JSON.stringify(Xe)),""].join(".")}function Oe(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function We(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Oe())}function ge(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function pe(){return"object"==typeof self&&self.self===self}function rt(){const $="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof $&&void 0!==$.id}function Ye(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Ve(){return Oe().indexOf("Electron/")>=0}function Pe(){const $=Oe();return $.indexOf("MSIE ")>=0||$.indexOf("Trident/")>=0}function Ae(){return Oe().indexOf("MSAppHost/")>=0}function Je(){return!1}function te(){return!ge()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function me(){return"object"==typeof indexedDB}function Re(){return new Promise(($,W)=>{try{let H=!0;const q="validate-browser-context-for-indexeddb-analytics-module",K=self.indexedDB.open(q);K.onsuccess=()=>{K.result.close(),H||self.indexedDB.deleteDatabase(q),$(!0)},K.onupgradeneeded=()=>{H=!1},K.onerror=()=>{var ke;W((null===(ke=K.error)||void 0===ke?void 0:ke.message)||"")}}catch(H){W(H)}})}function X(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class ve extends Error{constructor(W,H,q){super(H),this.code=W,this.customData=q,this.name="FirebaseError",Object.setPrototypeOf(this,ve.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,le.prototype.create)}}class le{constructor(W,H,q){this.service=W,this.serviceName=H,this.errors=q}create(W,...H){const q=H[0]||{},K=`${this.service}/${W}`,ke=this.errors[W],Xe=ke?function $e($,W){return $.replace(ft,(H,q)=>{const K=W[q];return null!=K?String(K):`<${q}?>`})}(ke,q):"Error";return new ve(K,`${this.serviceName}: ${Xe} (${K}).`,q)}}const ft=/\{\$([^}]+)}/g;function Gt($){return JSON.parse($)}function xt($){return JSON.stringify($)}const Qe=function($){let W={},H={},q={},K="";try{const ke=$.split(".");W=Gt(we(ke[0])||""),H=Gt(we(ke[1])||""),K=ke[2],q=H.d||{},delete H.d}catch{}return{header:W,claims:H,data:q,signature:K}},yn=function($){const H=Qe($).claims;return!!H&&"object"==typeof H&&H.hasOwnProperty("iat")},Qt=function($){const W=Qe($).claims;return"object"==typeof W&&!0===W.admin};function Ft($,W){return Object.prototype.hasOwnProperty.call($,W)}function Pt($,W){if(Object.prototype.hasOwnProperty.call($,W))return $[W]}function tn($){for(const W in $)if(Object.prototype.hasOwnProperty.call($,W))return!1;return!0}function Dr($,W,H){const q={};for(const K in $)Object.prototype.hasOwnProperty.call($,K)&&(q[K]=W.call(H,$[K],K,$));return q}function Fr($,W){if($===W)return!0;const H=Object.keys($),q=Object.keys(W);for(const K of H){if(!q.includes(K))return!1;const ke=$[K],Xe=W[K];if(Nn(ke)&&Nn(Xe)){if(!Fr(ke,Xe))return!1}else if(ke!==Xe)return!1}for(const K of q)if(!H.includes(K))return!1;return!0}function Nn($){return null!==$&&"object"==typeof $}function fr($){const W=[];for(const[H,q]of Object.entries($))Array.isArray(q)?q.forEach(K=>{W.push(encodeURIComponent(H)+"="+encodeURIComponent(K))}):W.push(encodeURIComponent(H)+"="+encodeURIComponent(q));return W.length?"&"+W.join("&"):""}function ur($){const W={};return $.replace(/^\?/,"").split("&").forEach(q=>{if(q){const[K,ke]=q.split("=");W[decodeURIComponent(K)]=decodeURIComponent(ke)}}),W}function $n($){const W=$.indexOf("?");if(!W)return"";const H=$.indexOf("#",W);return $.substring(W,H>0?H:void 0)}class wr{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let W=1;W<this.blockSize;++W)this.pad_[W]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(W,H){H||(H=0);const q=this.W_;if("string"==typeof W)for(let U=0;U<16;U++)q[U]=W.charCodeAt(H)<<24|W.charCodeAt(H+1)<<16|W.charCodeAt(H+2)<<8|W.charCodeAt(H+3),H+=4;else for(let U=0;U<16;U++)q[U]=W[H]<<24|W[H+1]<<16|W[H+2]<<8|W[H+3],H+=4;for(let U=16;U<80;U++){const M=q[U-3]^q[U-8]^q[U-14]^q[U-16];q[U]=4294967295&(M<<1|M>>>31)}let Xt,ue,K=this.chain_[0],ke=this.chain_[1],Xe=this.chain_[2],yt=this.chain_[3],Kt=this.chain_[4];for(let U=0;U<80;U++){U<40?U<20?(Xt=yt^ke&(Xe^yt),ue=1518500249):(Xt=ke^Xe^yt,ue=1859775393):U<60?(Xt=ke&Xe|yt&(ke|Xe),ue=2400959708):(Xt=ke^Xe^yt,ue=3395469782);const M=(K<<5|K>>>27)+Xt+Kt+ue+q[U]&4294967295;Kt=yt,yt=Xe,Xe=4294967295&(ke<<30|ke>>>2),ke=K,K=M}this.chain_[0]=this.chain_[0]+K&4294967295,this.chain_[1]=this.chain_[1]+ke&4294967295,this.chain_[2]=this.chain_[2]+Xe&4294967295,this.chain_[3]=this.chain_[3]+yt&4294967295,this.chain_[4]=this.chain_[4]+Kt&4294967295}update(W,H){if(null==W)return;void 0===H&&(H=W.length);const q=H-this.blockSize;let K=0;const ke=this.buf_;let Xe=this.inbuf_;for(;K<H;){if(0===Xe)for(;K<=q;)this.compress_(W,K),K+=this.blockSize;if("string"==typeof W){for(;K<H;)if(ke[Xe]=W.charCodeAt(K),++Xe,++K,Xe===this.blockSize){this.compress_(ke),Xe=0;break}}else for(;K<H;)if(ke[Xe]=W[K],++Xe,++K,Xe===this.blockSize){this.compress_(ke),Xe=0;break}}this.inbuf_=Xe,this.total_+=H}digest(){const W=[];let H=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let K=this.blockSize-1;K>=56;K--)this.buf_[K]=255&H,H/=256;this.compress_(this.buf_);let q=0;for(let K=0;K<5;K++)for(let ke=24;ke>=0;ke-=8)W[q]=this.chain_[K]>>ke&255,++q;return W}}function ht($,W){const H=new nr($,W);return H.subscribe.bind(H)}class nr{constructor(W,H){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=H,this.task.then(()=>{W(this)}).catch(q=>{this.error(q)})}next(W){this.forEachObserver(H=>{H.next(W)})}error(W){this.forEachObserver(H=>{H.error(W)}),this.close(W)}complete(){this.forEachObserver(W=>{W.complete()}),this.close()}subscribe(W,H,q){let K;if(void 0===W&&void 0===H&&void 0===q)throw new Error("Missing Observer.");K=function rn($,W){if("object"!=typeof $||null===$)return!1;for(const H of W)if(H in $&&"function"==typeof $[H])return!0;return!1}(W,["next","error","complete"])?W:{next:W,error:H,complete:q},void 0===K.next&&(K.next=Bn),void 0===K.error&&(K.error=Bn),void 0===K.complete&&(K.complete=Bn);const ke=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?K.error(this.finalError):K.complete()}catch{}}),this.observers.push(K),ke}unsubscribeOne(W){void 0===this.observers||void 0===this.observers[W]||(delete this.observers[W],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(W){if(!this.finalized)for(let H=0;H<this.observers.length;H++)this.sendOne(H,W)}sendOne(W,H){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[W])try{H(this.observers[W])}catch(q){typeof console<"u"&&console.error&&console.error(q)}})}close(W){this.finalized||(this.finalized=!0,void 0!==W&&(this.finalError=W),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Bn(){}const pr=function($,W,H,q){let K;if(q<W?K="at least "+W:q>H&&(K=0===H?"none":"no more than "+H),K)throw new Error($+" failed: Was called with "+q+(1===q?" argument.":" arguments.")+" Expects "+K+".")};function bn($,W){return`${$} failed: ${W} argument `}function Kn($,W,H,q){if((!q||H)&&"function"!=typeof H)throw new Error(bn($,W)+"must be a valid function.")}function gr($,W,H,q){if((!q||H)&&("object"!=typeof H||null===H))throw new Error(bn($,W)+"must be a valid context object.")}const Ut=function($){const W=[];let H=0;for(let q=0;q<$.length;q++){let K=$.charCodeAt(q);if(K>=55296&&K<=56319){const ke=K-55296;q++,B(q<$.length,"Surrogate pair missing trail surrogate."),K=65536+(ke<<10)+($.charCodeAt(q)-56320)}K<128?W[H++]=K:K<2048?(W[H++]=K>>6|192,W[H++]=63&K|128):K<65536?(W[H++]=K>>12|224,W[H++]=K>>6&63|128,W[H++]=63&K|128):(W[H++]=K>>18|240,W[H++]=K>>12&63|128,W[H++]=K>>6&63|128,W[H++]=63&K|128)}return W},et=function($){let W=0;for(let H=0;H<$.length;H++){const q=$.charCodeAt(H);q<128?W++:q<2048?W+=2:q>=55296&&q<=56319?(W+=4,H++):W+=3}return W};function vn($,W=1e3,H=2){const q=W*Math.pow(H,$),K=Math.round(.5*q*(Math.random()-.5)*2);return Math.min(144e5,q+K)}function Ln($){return $&&$._delegate?$._delegate:$}},6034:(mt,Fe,P)=>{var f=P(4650);let B=null;function N(){return B}const de=new f.OlP("DocumentToken");let fe=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return function we(){return(0,f.LFG)(G)}()},providedIn:"platform"}),n})();const z=new f.OlP("Location Initialized");let G=(()=>{class n extends fe{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return N().getBaseHref(this._doc)}onPopState(t){const r=N().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=N().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,r,i){ne()?this._history.pushState(t,r,i):this.location.hash=i}replaceState(t,r,i){ne()?this._history.replaceState(t,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(de))},n.\u0275prov=f.Yz7({token:n,factory:function(){return function Ue(){return new G((0,f.LFG)(de))}()},providedIn:"platform"}),n})();function ne(){return!!window.history.pushState}function Te(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function Oe(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function We(n){return n&&"?"!==n[0]?"?"+n:n}let ge=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return function pe(){const n=(0,f.LFG)(de).location;return new Ye((0,f.LFG)(fe),n&&n.origin||"")}()},providedIn:"root"}),n})();const rt=new f.OlP("appBaseHref");let Ye=(()=>{class n extends ge{constructor(t,r){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Te(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+We(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,a){const l=this.prepareExternalUrl(i+We(a));this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){const l=this.prepareExternalUrl(i+We(a));this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(fe),f.LFG(rt,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),Ve=(()=>{class n extends ge{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=Te(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,a){let l=this.prepareExternalUrl(i+We(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){let l=this.prepareExternalUrl(i+We(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(fe),f.LFG(rt,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),Pe=(()=>{class n{constructor(t){this._subject=new f.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._baseHref=Oe(te(r)),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+We(r))}normalize(t){return n.stripTrailingSlash(function Je(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,te(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+We(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+We(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=We,n.joinWithSlash=Te,n.stripTrailingSlash=Oe,n.\u0275fac=function(t){return new(t||n)(f.LFG(ge))},n.\u0275prov=f.Yz7({token:n,factory:function(){return function Ae(){return new Pe((0,f.LFG)(ge))}()},providedIn:"root"}),n})();function te(n){return n.replace(/\/index.html$/,"")}class Bs{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ci=(()=>{class n{constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((i,a,l)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new Bs(i.item,this._ngForOf,-1,-1),null===l?void 0:l);else if(null==l)r.remove(null===a?void 0:a);else if(null!==a){const h=r.get(a);r.move(h,l),cr(h,i)}});for(let i=0,a=r.length;i<a;i++){const h=r.get(i).context;h.index=i,h.count=a,h.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{cr(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.s_b),f.Y36(f.Rgc),f.Y36(f.ZZ4))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function cr(n,e){n.context.$implicit=e.item}let Er=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new Yr,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){yo("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){yo("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.s_b),f.Y36(f.Rgc))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class Yr{constructor(){this.$implicit=null,this.ngIf=null}}function yo(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,f.AaK)(e)}'.`)}let wo=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})();function wp(n){return"server"===n}let Hi=(()=>{class n{}return n.\u0275prov=(0,f.Yz7)({token:n,providedIn:"root",factory:()=>new Jr((0,f.LFG)(de),window)}),n})();class Jr{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function na(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const a=i.shadowRoot;if(a){const l=a.getElementById(e)||a.querySelector(`[name="${e}"]`);if(l)return l}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],i-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Ba(this.window.history)||Ba(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Ba(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Io extends class $i extends class Ce{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function ye(n){B||(B=n)}(new Io)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Gi(){return Co=Co||document.querySelector("base"),Co?Co.getAttribute("href"):null}();return null==t?null:function bo(n){Hs=Hs||document.createElement("a"),Hs.setAttribute("href",n);const e=Hs.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Co=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function Jo(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,a]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(a)}return null}(document.cookie,e)}}let Hs,Co=null;const Mt=new f.OlP("TRANSITION_ID"),k=[{provide:f.ip1,useFactory:function L(n,e,t){return()=>{t.get(f.CZH).donePromise.then(()=>{const r=N(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let a=0;a<i.length;a++)r.remove(i[a])})}},deps:[Mt,de,f.zs3],multi:!0}];let ce=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const je=new f.OlP("EventManagerPlugins");let tt=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let a=0;a<i.length;a++){const l=i[a];if(l.supports(t))return this._eventNameToPlugin.set(t,l),l}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(je),f.LFG(f.R0b))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();class vt{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=N().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let Wt=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),be=(()=>{class n extends Wt{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,i){t.forEach(a=>{const l=this._doc.createElement("style");l.textContent=a,i.push(r.appendChild(l))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(St),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(t,i,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(St))}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(de))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();function St(n){N().remove(n)}const Sn={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},kt=/%COMP%/g;function $s(n,e,t){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?$s(n,i,t):(i=i.replace(kt,n),t.push(i))}return t}function To(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let bi=(()=>{class n{constructor(t,r,i){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new sr(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case f.ifc.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new qs(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(t),i}case 1:case f.ifc.ShadowDom:return new Z_(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const i=$s(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(tt),f.LFG(be),f.LFG(f.AFp))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();class sr{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Sn[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(zs(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(zs(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const a=Sn[i];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=Sn[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(f.JOm.DashCase|f.JOm.Important)?e.style.setProperty(t,r,i&f.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&f.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,To(r)):this.eventManager.addEventListener(e,t,To(r))}}function zs(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class qs extends sr{constructor(e,t,r,i){super(e),this.component=r;const a=$s(i+"-"+r.id,r.styles,[]);t.addStyles(a),this.contentAttr=function zi(n){return"_ngcontent-%COMP%".replace(kt,n)}(i+"-"+r.id),this.hostAttr=function ja(n){return"_nghost-%COMP%".replace(kt,n)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class Z_ extends sr{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const a=$s(i.id,i.styles,[]);for(let l=0;l<a.length;l++){const h=document.createElement("style");h.textContent=a[l],this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Jl=(()=>{class n extends vt{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(de))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const Ip=["alt","control","meta","shift"],Gd={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ha={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Cp={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Gu=(()=>{class n extends vt{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const a=n.parseEventName(r),l=n.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>N().onAndCancel(t,a.domEventName,l))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const a=n._normalizeKey(r.pop());let l="";if(Ip.forEach(m=>{const v=r.indexOf(m);v>-1&&(r.splice(v,1),l+=m+".")}),l+=a,0!=r.length||0===a.length)return null;const h={};return h.domEventName=i,h.fullKey=l,h}static getEventFullKey(t){let r="",i=function Y_(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&Ha.hasOwnProperty(e)&&(e=Ha[e]))}return Gd[e]||e}(t);return i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),Ip.forEach(a=>{a!=i&&Cp[a](t)&&(r+=a+".")}),r+=i,r}static eventCallback(t,r,i){return a=>{n.getEventFullKey(a)===t&&i.runGuarded(()=>r(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(de))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const Sp=(0,f.eFA)(f._c5,"browser",[{provide:f.Lbi,useValue:"browser"},{provide:f.g9A,useValue:function Dp(){Io.makeCurrent()},multi:!0},{provide:de,useFactory:function Tp(){return(0,f.RDi)(document),document},deps:[]}]),tc=new f.OlP(""),Br=[{provide:f.rWj,useClass:class Y{addToWindow(e){f.dqk.getAngularTestability=(r,i=!0)=>{const a=e.findTestabilityInTree(r,i);if(null==a)throw new Error("Could not find testability for element.");return a},f.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),f.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),f.dqk.frameworkStabilizers||(f.dqk.frameworkStabilizers=[]),f.dqk.frameworkStabilizers.push(r=>{const i=f.dqk.getAllAngularTestabilities();let a=i.length,l=!1;const h=function(m){l=l||m,a--,0==a&&r(l)};i.forEach(function(m){m.whenStable(h)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?N().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:f.lri,useClass:f.dDg,deps:[f.R0b,f.eoX,f.rWj]},{provide:f.dDg,useClass:f.dDg,deps:[f.R0b,f.eoX,f.rWj]}],fi=[{provide:f.zSh,useValue:"root"},{provide:f.qLn,useFactory:function Xl(){return new f.qLn},deps:[]},{provide:je,useClass:Jl,multi:!0,deps:[de,f.R0b,f.Lbi]},{provide:je,useClass:Gu,multi:!0,deps:[de]},{provide:bi,useClass:bi,deps:[tt,be,f.AFp]},{provide:f.FYo,useExisting:bi},{provide:Wt,useExisting:be},{provide:be,useClass:be,deps:[de]},{provide:tt,useClass:tt,deps:[je,f.R0b]},{provide:class Sr{},useClass:ce,deps:[]},[]];let Zn=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:f.AFp,useValue:t.appId},{provide:Mt,useExisting:f.AFp},k]}}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(tc,12))},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[...fi,...Br],imports:[wo,f.hGG]}),n})(),Ap=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(de))},n.\u0275prov=f.Yz7({token:n,factory:function(t){let r=null;return r=t?new t:function J_(){return new Ap((0,f.LFG)(de))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;var kn=P(8996),Mn=P(8306);const{isArray:xs}=Array,{getPrototypeOf:Jd,prototype:zu,keys:qu}=Object;var Zs=P(8421),ia=P(7669),Yn=P(5403),Ot=P(4004);const{isArray:Ga}=Array;let wy=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})(),Ch=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[wy]}),n})(),DT=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[Ch]}),n})();var Ty=P(5867),eo=P(6148);const Sy_firebaseConfig={apiKey:"AIzaSyClD21a4Yb_O2e__nm-sqI_LsdocEieF54",authDomain:"my-test-project-450cf.firebaseapp.com",projectId:"my-test-project-450cf",storageBucket:"my-test-project-450cf.appspot.com",messagingSenderId:"781922575005",appId:"1:781922575005:web:25d346cef985b1b201ea74",measurementId:"G-T2GBSCH2D1"};var Ay=P(4986);function Nt(...n){const e=(0,ia.yG)(n);return(0,kn.D)(n,e)}var ti=P(6451),hg=P(3099),jr=P(4482);function Ar(n,e){return(0,jr.e)((t,r)=>{let i=null,a=0,l=!1;const h=()=>l&&!i&&r.complete();t.subscribe((0,Yn.x)(r,m=>{i?.unsubscribe();let v=0;const b=a++;(0,Zs.Xf)(n(m,b)).subscribe(i=(0,Yn.x)(r,D=>r.next(e?e(m,D,b,v++):D),()=>{i=null,h()}))},()=>{l=!0,h()}))})}function gi(n,e,t,r,i){return(a,l)=>{let h=t,m=e,v=0;a.subscribe((0,Yn.x)(l,b=>{const D=v++;m=h?n(m,b,D):(h=!0,b),r&&l.next(m)},i&&(()=>{h&&l.next(m),l.complete()})))}}function to(n,e){return(0,jr.e)(gi(n,e,arguments.length>=2,!0))}var ru=P(4671);function bE(n,e=ru.y){return n=n??AT,(0,jr.e)((t,r)=>{let i,a=!0;t.subscribe((0,Yn.x)(r,l=>{const h=e(l);(a||!n(i,h))&&(a=!1,i=h,r.next(l))}))})}function AT(n,e){return n===e}var DE=P(5032),An=P(880),xr=P(2011),xy=(P(5881),P(3942)),no=P(4859),xe=P(5861),Si=P(9681),R=P(2090),mi=P(1877);const Oo="@firebase/database";let AE="";function RT(n){AE=n}class xE{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,R.Pz)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,R.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class MN{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,R.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const ro=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new xE(e)}}catch{}return new MN},fa=ro("localStorage"),bh=ro("sessionStorage"),bc=new mi.Yd("@firebase/database"),Ry=function(){let n=1;return function(){return n++}}(),RE=function(n){const e=(0,R.dS)(n),t=new R.gQ;t.update(e);const r=t.digest();return R.US.encodeByteArray(r)},pa=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=pa.apply(null,r):e+="object"==typeof r?(0,R.Pz)(r):r,e+=" "}return e};let ul=null,My=!0;const fg=function(n,e){(0,R.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(bc.logLevel=mi.in.VERBOSE,ul=bc.log.bind(bc),e&&bh.set("logging_enabled",!0)):"function"==typeof n?ul=n:(ul=null,bh.remove("logging_enabled"))},Rr=function(...n){if(!0===My&&(My=!1,null===ul&&!0===bh.get("logging_enabled")&&fg(!0)),ul){const e=pa.apply(null,n);ul(e)}},Dc=function(n){return function(...e){Rr(n,...e)}},ME=function(...n){const e="FIREBASE INTERNAL ERROR: "+pa(...n);bc.error(e)},Ai=function(...n){const e=`FIREBASE FATAL ERROR: ${pa(...n)}`;throw bc.error(e),new Error(e)},Hr=function(...n){const e="FIREBASE WARNING: "+pa(...n);bc.warn(e)},pg=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},ga="[MIN_NAME]",Fo="[MAX_NAME]",ll=function(n,e){if(n===e)return 0;if(n===ga||e===Fo)return-1;if(e===ga||n===Fo)return 1;{const t=Th(n),r=Th(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},MT=function(n,e){return n===e?0:n<e?-1:1},Dh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,R.Pz)(e))},Py=function(n){if("object"!=typeof n||null===n)return(0,R.Pz)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,R.Pz)(e[r]),t+=":",t+=Py(n[e[r]]);return t+="}",t},ky=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Mr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const Oy=function(n){(0,R.hu)(!pg(n),"Invalid JSON number");const r=1023;let i,a,l,h,m;0===n?(a=0,l=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(h=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=h+r,l=Math.round(n*Math.pow(2,52-h)-Math.pow(2,52))):(a=0,l=Math.round(n/Math.pow(2,-1074))));const v=[];for(m=52;m;m-=1)v.push(l%2?1:0),l=Math.floor(l/2);for(m=11;m;m-=1)v.push(a%2?1:0),a=Math.floor(a/2);v.push(i?1:0),v.reverse();const b=v.join("");let D="";for(m=0;m<64;m+=8){let x=parseInt(b.substr(m,8),2).toString(16);1===x.length&&(x="0"+x),D+=x}return D.toLowerCase()},PE=new RegExp("^-?(0*)\\d{1,10}$"),Ly=-2147483648,ma=2147483647,Th=function(n){if(PE.test(n)){const e=Number(n);if(e>=Ly&&e<=ma)return e}return null},cl=function(n){try{n()}catch(e){setTimeout(()=>{throw Hr("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},gg=function(n,e){const t=setTimeout(n,e);return"object"==typeof t&&t.unref&&t.unref(),t};class mg{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Hr(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class OT{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Rr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Hr(e)}}let Tc=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const xh=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,wg="websocket",Sc="long_polling";class jy{constructor(e,t,r,i,a=!1,l="",h=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=l,this.includeNamespaceInQueryParams=h,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=fa.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&fa.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function OE(n,e,t){let r;if((0,R.hu)("string"==typeof e,"typeof type must == string"),(0,R.hu)("object"==typeof t,"typeof params must == object"),e===wg)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==Sc)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function kE(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Mr(t,(a,l)=>{i.push(a+"="+l)}),r+i.join("&")}class FT{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,R.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,R.p$)(this.counters_)}}const Eg={},Rh={};function Ig(n){const e=n.toString();return Eg[e]||(Eg[e]=new FT),Eg[e]}class FE{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&cl(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class _a{constructor(e,t,r,i,a,l,h){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=l,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Dc(e),this.stats_=Ig(t),this.urlFn=m=>(this.appCheckToken&&(m.ac=this.appCheckToken),OE(t,Sc,m))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new FE(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,R.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Cg((...a)=>{const[l,h,m,v,b]=a;if(this.incrementIncomingBytes_(a),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===l)this.id=h,this.password=m;else{if("close"!==l)throw new Error("Unrecognized command received: "+l);h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_()}},(...a)=>{const[l,h]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(l,h)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&xh.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){_a.forceAllow_=!0}static forceDisallow(){_a.forceDisallow_=!0}static isAvailable(){return!((0,R.Yr)()||!_a.forceAllow_&&(_a.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,R.Pz)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,R.h$)(t),i=ky(r,1840);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,R.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,R.Pz)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Cg{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,R.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Ry(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Cg.createIFrame_();let a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(h){Rr("frame writing exception"),h.stack&&Rr(h.stack),Rr(h)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Rr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const l=this.pendingSegs.shift();r=r+"&seg"+i+"="+l.seg+"&ts"+i+"="+l.ts+"&d"+i+"="+l.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,R.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Rr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let Mh=null;typeof MozWebSocket<"u"?Mh=MozWebSocket:typeof WebSocket<"u"&&(Mh=WebSocket);let Ac=(()=>{class n{constructor(t,r,i,a,l,h,m){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Dc(this.connId),this.stats_=Ig(r),this.connURL=n.connectionURL_(r,h,m,a,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,a,l){const h={v:"5"};return!(0,R.Yr)()&&typeof location<"u"&&location.hostname&&xh.test(location.hostname)&&(h.r="f"),r&&(h.s=r),i&&(h.ls=i),a&&(h.ac=a),l&&(h.p=l),OE(t,wg,h)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,fa.set("previous_websocket_failure",!0);try{let i;if((0,R.Yr)()){i={headers:{"User-Agent":`Firebase/5/${AE}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const l=process.env,h=0===this.connURL.indexOf("wss://")?l.HTTPS_PROXY||l.https_proxy:l.HTTP_PROXY||l.http_proxy;h&&(i.proxy={origin:h})}this.mySock=new Mh(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const a=i.message||i.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==Mh&&!n.forceDisallow_}static previouslyFailed(){return fa.isInMemoryStorage||!0===fa.get("previous_websocket_failure")}markConnectionHealthy(){fa.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,R.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,R.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,R.Pz)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=ky(r,16384);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),$y=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[_a,Ac]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=Ac&&Ac.isAvailable();let i=r&&!Ac.previouslyFailed();if(t.webSocketOnly&&(r||Hr("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ac];else{const a=this.transports_=[];for(const l of n.ALL_TRANSPORTS)l&&l.isAvailable()&&a.push(l);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class iu{constructor(e,t,r,i,a,l,h,m,v,b){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=l,this.onReady_=h,this.onDisconnect_=m,this.onKill_=v,this.lastSessionId=b,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Dc("c:"+this.id+":"),this.transportManager_=new $y(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=gg(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Dh("t",e),r=Dh("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Dh("t",e),r=Dh("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Dh("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?ME("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ME("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&Hr("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),gg(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):gg(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(fa.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class KE{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class Tg{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,R.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!r||r===i[a].context))return void i.splice(a,1)}validateEventType_(e){(0,R.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class Nh extends Tg{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,R.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Nh}getInitialEvent(e){return(0,R.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Fn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function mn(){return new Fn("")}function en(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function us(n){return n.pieces_.length-n.pieceNum_}function jn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Fn(n.pieces_,e)}function kh(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Oh(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Ky(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Fn(e,0)}function Un(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Fn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Fn(t,0)}function an(n){return n.pieceNum_>=n.pieces_.length}function xi(n,e){const t=en(n),r=en(e);if(null===t)return e;if(t===r)return xi(jn(n),jn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function YT(n,e){const t=Oh(n,0),r=Oh(e,0);for(let i=0;i<t.length&&i<r.length;i++){const a=ll(t[i],r[i]);if(0!==a)return a}return t.length===r.length?0:t.length<r.length?-1:1}function Zy(n,e){if(us(n)!==us(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Zi(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(us(n)>us(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class ZE{constructor(e,t){this.errorPrefix_=t,this.parts_=Oh(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,R.ug)(this.parts_[r]);QE(this)}}function QE(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+ya(n))}function ya(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class Fh extends Tg{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new Fh}getInitialEvent(e){return(0,R.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Lh=1e3;let Vh,dl=(()=>{class n extends KE{constructor(t,r,i,a,l,h,m,v){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=l,this.authTokenProvider_=h,this.appCheckTokenProvider_=m,this.authOverride_=v,this.id=n.nextPersistentConnectionId_++,this.log_=Dc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Lh,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,v&&!(0,R.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Fh.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&Nh.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const a=++this.requestNumber_,l={r:a,a:t,b:r};this.log_((0,R.Pz)(l)),(0,R.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();const r=new R.BH,i={p:t._path.toString(),q:t._queryObject};return this.outstandingGets_.push({action:"g",request:i,onComplete:h=>{const m=h.d;"ok"===h.s?r.resolve(m):r.reject(m)}}),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,a){this.initConnection_();const l=t._queryIdentifier,h=t._path.toString();this.log_("Listen called for "+h+" "+l),this.listens.has(h)||this.listens.set(h,new Map),(0,R.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,R.hu)(!this.listens.get(h).has(l),"listen() called twice for same path/queryId.");const m={onComplete:a,hashFn:r,query:t,tag:i};this.listens.get(h).set(l,m),this.connected_&&this.sendListen_(m)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);const l={p:i};t.tag&&(l.q=r._queryObject,l.t=t.tag),l.h=t.hashFn(),this.sendRequest("q",l,m=>{const v=m.d,b=m.s;n.warnOnListenWarnings_(v,r),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",m),"ok"!==b&&this.removeListen_(i,a),t.onComplete&&t.onComplete(b,v))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,R.r3)(t,"w")){const i=(0,R.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',l=r._path.toString();Hr(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,R.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,R.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,a=>{const l=a.s,h=a.d||"error";this.authToken_===t&&("ok"===l?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),(0,R.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,r)}sendUnlisten_(t,r,i,a){this.log_("Unlisten on "+t+" for "+r);const l={p:t};a&&(l.q=i,l.t=a),this.sendRequest("n",l)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,a){const l={p:r,d:i};this.log_("onDisconnect "+t,l),this.sendRequest(t,l,h=>{a&&setTimeout(()=>{a(h.s,h.d)},Math.floor(0))})}put(t,r,i,a){this.putInternal("p",t,r,i,a)}merge(t,r,i,a){this.putInternal("m",t,r,i,a)}putInternal(t,r,i,a,l){this.initConnection_();const h={p:r,d:i};void 0!==l&&(h.h=l),this.outstandingPuts_.push({action:t,request:h,onComplete:a}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,l=>{this.log_(r+" response",l),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),a&&a(l.s,l.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,R.Pz)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):ME("Unrecognized action received from server: "+(0,R.Pz)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,R.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Lh,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Lh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Lh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,xe.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),a=t.onRealtimeDisconnect_.bind(t),l=t.id+":"+n.nextConnectionId_++,h=t.lastSessionId;let m=!1,v=null;const b=function(){v?v.close():(m=!0,a())};t.realtime_={close:b,sendRequest:function(j){(0,R.hu)(v,"sendRequest call when we're not connected not allowed."),v.sendRequest(j)}};const x=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[j,Q]=yield Promise.all([t.authTokenProvider_.getToken(x),t.appCheckTokenProvider_.getToken(x)]);m?Rr("getToken() completed but was canceled"):(Rr("getToken() completed. Creating connection."),t.authToken_=j&&j.accessToken,t.appCheckToken_=Q&&Q.token,v=new iu(l,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,a,Se=>{Hr(Se+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},h))}catch(j){t.log_("Failed to get token: "+j),m||(t.repoInfo_.nodeAdmin&&Hr(j),b())}}})()}interrupt(t){Rr("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Rr("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,R.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Lh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(l=>Py(l)).join("$"):"default";const a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const i=new Fn(t).toString();let a;if(this.listens.has(i)){const l=this.listens.get(i);a=l.get(r),l.delete(r),0===l.size&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,r){Rr("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Rr("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,R.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+AE.replace(/\./g,"-")]=1,(0,R.uI)()?t["framework.cordova"]=1:(0,R.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Nh.getInstance().currentlyOnline();return(0,R.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class zt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new zt(e,t)}}class Ag{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new zt(ga,e),i=new zt(ga,t);return 0!==this.compare(r,i)}minPost(){return zt.MIN}}class Uh extends Ag{static get __EMPTY_NODE(){return Vh}static set __EMPTY_NODE(e){Vh=e}compare(e,t){return ll(e.name,t.name)}isDefinedOn(e){throw(0,R.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return zt.MIN}maxPost(){return new zt(Fo,Vh)}makePost(e,t){return(0,R.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new zt(e,Vh)}toString(){return".key"}}const Vo=new Uh;class Bh{constructor(e,t,r,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,i&&(l*=-1),l<0)e=this.isReverse_?e.left:e.right;else{if(0===l){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let xg,io=(()=>{class n{constructor(t,r,i,a,l){this.key=t,this.value=r,this.color=i??n.RED,this.left=a??Yi.EMPTY_NODE,this.right=l??Yi.EMPTY_NODE}copy(t,r,i,a,l){return new n(t??this.key,r??this.value,i??this.color,a??this.left,l??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let a=this;const l=i(t,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(t,r,i),null):0===l?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return Yi.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,a;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return Yi.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class Yi{constructor(e,t=Yi.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Yi(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,io.BLACK,null,null))}remove(e){return new Yi(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,io.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Bh(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Bh(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Bh(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Bh(this.root_,null,this.comparator_,!0,e)}}function tS(n,e){return ll(n.name,e.name)}function Yy(n,e){return ll(n,e)}Yi.EMPTY_NODE=new class eS{copy(e,t,r,i,a){return this}insert(e,t,r){return new io(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Qy=function(n){return"number"==typeof n?"number:"+Oy(n):"string:"+n},Jy=function(n){if(n.isLeafNode()){const e=n.val();(0,R.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,R.r3)(e,".sv"),"Priority must be a string or number.")}else(0,R.hu)(n===xg||n.isEmpty(),"priority of unexpected type.");(0,R.hu)(n===xg||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Rg,Mg,XE,jh=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,R.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Jy(this.priorityNode_)}static set __childrenNodeConstructor(t){Rg=t}static get __childrenNodeConstructor(){return Rg}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return an(t)?this:".priority"===en(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=en(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,R.hu)(".priority"!==i||1===us(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(jn(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Qy(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?Oy(this.value_):this.value_,this.lazyHash_=RE(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,R.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,a=n.VALUE_TYPE_ORDER.indexOf(r),l=n.VALUE_TYPE_ORDER.indexOf(i);return(0,R.hu)(a>=0,"Unknown leaf type: "+r),(0,R.hu)(l>=0,"Unknown leaf type: "+i),a===l?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:l-a}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const zn=new class eI extends Ag{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),a=r.compareTo(i);return 0===a?ll(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return zt.MIN}maxPost(){return new zt(Fo,new jh("[PRIORITY-POST]",XE))}makePost(e,t){const r=Mg(e);return new zt(t,new jh("[PRIORITY-POST]",r))}toString(){return".priority"}},rS=Math.log(2);class Xy{constructor(e){this.count=parseInt(Math.log(e+1)/rS,10),this.current_=this.count-1;const i=(a=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ev=function(n,e,t,r){n.sort(e);const i=function(m,v){const b=v-m;let D,x;if(0===b)return null;if(1===b)return D=n[m],x=t?t(D):D,new io(x,D.node,io.BLACK,null,null);{const j=parseInt(b/2,10)+m,Q=i(m,j),Se=i(j+1,v);return D=n[j],x=t?t(D):D,new io(x,D.node,io.BLACK,Q,Se)}},h=function(m){let v=null,b=null,D=n.length;const x=function(Q,Se){const Le=D-Q,Et=D;D-=Q;const It=i(Le+1,Et),Ct=n[Le],wt=t?t(Ct):Ct;j(new io(wt,Ct.node,Se,null,It))},j=function(Q){v?(v.left=Q,v=Q):(b=Q,v=Q)};for(let Q=0;Q<m.count;++Q){const Se=m.nextBitIsOne(),Le=Math.pow(2,m.count-(Q+1));Se?x(Le,io.BLACK):(x(Le,io.BLACK),x(Le,io.RED))}return b}(new Xy(n.length));return new Yi(r||e,h)};let tI;const su={};class ou{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,R.hu)(su&&zn,"ChildrenNode.ts has not been loaded"),tI=tI||new ou({".priority":su},{".priority":zn}),tI}get(e){const t=(0,R.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Yi?t:null}hasIndex(e){return(0,R.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,R.hu)(e!==Vo,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const a=t.getIterator(zt.Wrap);let h,l=a.getNext();for(;l;)i=i||e.isDefinedOn(l.node),r.push(l),l=a.getNext();h=i?ev(r,e.getCompare()):su;const m=e.toString(),v=Object.assign({},this.indexSet_);v[m]=e;const b=Object.assign({},this.indexes_);return b[m]=h,new ou(b,v)}addToIndexes(e,t){const r=(0,R.UI)(this.indexes_,(i,a)=>{const l=(0,R.DV)(this.indexSet_,a);if((0,R.hu)(l,"Missing index implementation for "+a),i===su){if(l.isDefinedOn(e.node)){const h=[],m=t.getIterator(zt.Wrap);let v=m.getNext();for(;v;)v.name!==e.name&&h.push(v),v=m.getNext();return h.push(e),ev(h,l.getCompare())}return su}{const h=t.get(e.name);let m=i;return h&&(m=m.remove(new zt(e.name,h))),m.insert(e,e.node)}});return new ou(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,R.UI)(this.indexes_,i=>{if(i===su)return i;{const a=t.get(e.name);return a?i.remove(new zt(e.name,a)):i}});return new ou(r,this.indexSet_)}}let Ng,Yt=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&Jy(this.priorityNode_),this.children_.isEmpty()&&(0,R.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ng||(Ng=new n(new Yi(Yy),null,ou.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ng}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?Ng:r}}getChild(t){const r=en(t);return null===r?this:this.getImmediateChild(r).getChild(jn(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,R.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new zt(t,r);let a,l;r.isEmpty()?(a=this.children_.remove(t),l=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),l=this.indexMap_.addToIndexes(i,this.children_));const h=a.isEmpty()?Ng:this.priorityNode_;return new n(a,h,l)}}updateChild(t,r){const i=en(t);if(null===i)return r;{(0,R.hu)(".priority"!==en(t)||1===us(t),".priority must be the last token in a path");const a=this.getImmediateChild(i).updateChild(jn(t),r);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,a=0,l=!0;if(this.forEachChild(zn,(h,m)=>{r[h]=m.val(t),i++,l&&n.INTEGER_REGEXP_.test(h)?a=Math.max(a,Number(h)):l=!1}),!t&&l&&a<2*i){const h=[];for(const m in r)h[m]=r[m];return h}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+Qy(this.getPriority().val())+":"),this.forEachChild(zn,(r,i)=>{const a=i.hash();""!==a&&(t+=":"+r+":"+a)}),this.lazyHash_=""===t?"":RE(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const a=this.resolveIndex_(i);if(a){const l=a.getPredecessorKey(new zt(t,r));return l?l.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new zt(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new zt(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,zt.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)<0;)a.getNext(),l=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,zt.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)>0;)a.getNext(),l=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Pg?-1:0}withIndex(t){if(t===Vo||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Vo||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(zn),a=r.getIterator(zn);let l=i.getNext(),h=a.getNext();for(;l&&h;){if(l.name!==h.name||!l.node.equals(h.node))return!1;l=i.getNext(),h=a.getNext()}return null===l&&null===h}return!1}return!1}}resolveIndex_(t){return t===Vo?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const Pg=new class LN extends Yt{constructor(){super(new Yi(Yy),Yt.EMPTY_NODE,ou.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Yt.EMPTY_NODE}isEmpty(){return!1}};function Jn(n,e=null){if(null===n)return Yt.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,R.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new jh(n,Jn(e));if(n instanceof Array){let t=Yt.EMPTY_NODE;return Mr(n,(r,i)=>{if((0,R.r3)(n,r)&&"."!==r.substring(0,1)){const a=Jn(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority(Jn(e))}{const t=[];let r=!1;if(Mr(n,(l,h)=>{if("."!==l.substring(0,1)){const m=Jn(h);m.isEmpty()||(r=r||!m.getPriority().isEmpty(),t.push(new zt(l,m)))}}),0===t.length)return Yt.EMPTY_NODE;const a=ev(t,tS,l=>l.name,Yy);if(r){const l=ev(t,zn.getCompare());return new Yt(a,Jn(e),new ou({".priority":l},{".priority":zn}))}return new Yt(a,Jn(e),ou.Default)}}Object.defineProperties(zt,{MIN:{value:new zt(ga,Yt.EMPTY_NODE)},MAX:{value:new zt(Fo,Pg)}}),Uh.__EMPTY_NODE=Yt.EMPTY_NODE,jh.__childrenNodeConstructor=Yt,function nS(n){xg=n}(Pg),function xc(n){XE=n}(Pg),function FN(n){Mg=n}(Jn);class kg extends Ag{constructor(e){super(),this.indexPath_=e,(0,R.hu)(!an(e)&&".priority"!==en(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),a=r.compareTo(i);return 0===a?ll(e.name,t.name):a}makePost(e,t){const r=Jn(e),i=Yt.EMPTY_NODE.updateChild(this.indexPath_,r);return new zt(t,i)}maxPost(){const e=Yt.EMPTY_NODE.updateChild(this.indexPath_,Pg);return new zt(Fo,e)}toString(){return Oh(this.indexPath_,0).join("/")}}const Og=new class iS extends Ag{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?ll(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return zt.MIN}maxPost(){return zt.MAX}makePost(e,t){const r=Jn(e);return new zt(t,r)}toString(){return".value"}},hl="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",sS=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const a=new Array(8);for(i=7;i>=0;i--)a[i]=hl.charAt(t%64),t=Math.floor(t/64);(0,R.hu)(0===t,"Cannot push at time == 0");let l=a.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)l+=hl.charAt(e[i]);return(0,R.hu)(20===l.length,"nextPushId: Length should be 20."),l}}(),Fg=function(n){if(n===""+ma)return"-";const e=Th(n);if(null!=e)return""+(e+1);const t=new Array(n.length);for(let l=0;l<t.length;l++)t[l]=n.charAt(l);if(t.length<786)return t.push("-"),t.join("");let r=t.length-1;for(;r>=0&&"z"===t[r];)r--;if(-1===r)return Fo;const a=hl.charAt(hl.indexOf(t[r])+1);return t[r]=a,t.slice(0,r+1).join("")},Uo=function(n){if(n===""+Ly)return ga;const e=Th(n);if(null!=e)return""+(e-1);const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=n.charAt(r);return"-"===t[t.length-1]?1===t.length?""+ma:(delete t[t.length-1],t.join("")):(t[t.length-1]=hl.charAt(hl.indexOf(t[t.length-1])-1),t.join("")+"z".repeat(786-t.length))};function Lg(n){return{type:"value",snapshotNode:n}}function fl(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function pl(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Vg(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class iI{constructor(e){this.index_=e}updateChild(e,t,r,i,a,l){(0,R.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=e.getImmediateChild(t);return h.getChild(i).equals(r.getChild(i))&&h.isEmpty()===r.isEmpty()||(null!=l&&(r.isEmpty()?e.hasChild(t)?l.trackChildChange(pl(t,h)):(0,R.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?l.trackChildChange(fl(t,r)):l.trackChildChange(Vg(t,r,h))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(zn,(i,a)=>{t.hasChild(i)||r.trackChildChange(pl(i,a))}),t.isLeafNode()||t.forEachChild(zn,(i,a)=>{if(e.hasChild(i)){const l=e.getImmediateChild(i);l.equals(a)||r.trackChildChange(Vg(i,a,l))}else r.trackChildChange(fl(i,a))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Yt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class au{constructor(e){this.indexedFilter_=new iI(e.getIndex()),this.index_=e.getIndex(),this.startPost_=au.getStartPost_(e),this.endPost_=au.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,r,i,a,l){return this.matches(new zt(t,r))||(r=Yt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,a,l)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Yt.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Yt.EMPTY_NODE);const a=this;return t.forEachChild(zn,(l,h)=>{a.matches(new zt(l,h))||(i=i.updateImmediateChild(l,Yt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Ug{constructor(e){this.rangedFilter_=new au(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,r,i,a,l){return this.rangedFilter_.matches(new zt(t,r))||(r=Yt.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,a,l):this.fullLimitUpdateChild_(e,t,r,a,l)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Yt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let a;i=Yt.EMPTY_NODE.withIndex(this.index_),a=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;a.hasNext()&&l<this.limit_;){const h=a.getNext();let m;if(m=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),h)<=0:this.index_.compare(h,this.rangedFilter_.getEndPost())<=0,!m)break;i=i.updateImmediateChild(h.name,h.node),l++}}else{let a,l,h,m;if(i=t.withIndex(this.index_),i=i.updatePriority(Yt.EMPTY_NODE),this.reverse_){m=i.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost();const D=this.index_.getCompare();h=(x,j)=>D(j,x)}else m=i.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),h=this.index_.getCompare();let v=0,b=!1;for(;m.hasNext();){const D=m.getNext();!b&&h(a,D)<=0&&(b=!0),b&&v<this.limit_&&h(D,l)<=0?v++:i=i.updateImmediateChild(D.name,Yt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,a){let l;if(this.reverse_){const D=this.index_.getCompare();l=(x,j)=>D(j,x)}else l=this.index_.getCompare();const h=e;(0,R.hu)(h.numChildren()===this.limit_,"");const m=new zt(t,r),v=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),b=this.rangedFilter_.matches(m);if(h.hasChild(t)){const D=h.getImmediateChild(t);let x=i.getChildAfterChild(this.index_,v,this.reverse_);for(;null!=x&&(x.name===t||h.hasChild(x.name));)x=i.getChildAfterChild(this.index_,x,this.reverse_);const j=null==x?1:l(x,m);if(b&&!r.isEmpty()&&j>=0)return a?.trackChildChange(Vg(t,r,D)),h.updateImmediateChild(t,r);{a?.trackChildChange(pl(t,D));const Se=h.updateImmediateChild(t,Yt.EMPTY_NODE);return null!=x&&this.rangedFilter_.matches(x)?(a?.trackChildChange(fl(x.name,x.node)),Se.updateImmediateChild(x.name,x.node)):Se}}return r.isEmpty()?e:b&&l(v,m)>=0?(null!=a&&(a.trackChildChange(pl(v.name,v.node)),a.trackChildChange(fl(t,r))),h.updateImmediateChild(t,r).updateImmediateChild(v.name,Yt.EMPTY_NODE)):e}}class Mc{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=zn}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,R.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,R.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ga}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,R.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,R.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Fo}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,R.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===zn}copy(){const e=new Mc;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function iv(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function sv(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function Hh(n,e){const t=n.copy();return t.index_=e,t}function uS(n){const e={};if(n.isDefault())return e;let t;return n.index_===zn?t="$priority":n.index_===Og?t="$value":n.index_===Vo?t="$key":((0,R.hu)(n.index_ instanceof kg,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,R.Pz)(t),n.startSet_&&(e.startAt=(0,R.Pz)(n.indexStartValue_),n.startNameSet_&&(e.startAt+=","+(0,R.Pz)(n.indexStartName_))),n.endSet_&&(e.endAt=(0,R.Pz)(n.indexEndValue_),n.endNameSet_&&(e.endAt+=","+(0,R.Pz)(n.indexEndName_))),n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function sI(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_)),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_)),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==zn&&(e.i=n.index_.toString()),e}class ov extends KE{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Dc("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,R.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const l=ov.getListenId_(e,r),h={};this.listens_[l]=h;const m=uS(e._queryParams);this.restRequest_(a+".json",m,(v,b)=>{let D=b;if(404===v&&(D=null,v=null),null===v&&this.onDataUpdate_(a,D,!1,r),(0,R.DV)(this.listens_,l)===h){let x;x=v?401===v?"permission_denied":"rest_error:"+v:"ok",i(x,null)}})}unlisten(e,t){const r=ov.getListenId_(e,t);delete this.listens_[r]}get(e){const t=uS(e._queryParams),r=e._path.toString(),i=new R.BH;return this.restRequest_(r+".json",t,(a,l)=>{let h=l;404===a&&(h=null,a=null),null===a?(this.onDataUpdate_(r,h,!1,null),i.resolve(h)):i.reject(new Error(h))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,R.xO)(t);this.log_("Sending REST request for "+l);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(r&&4===h.readyState){this.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);let m=null;if(h.status>=200&&h.status<300){try{m=(0,R.cI)(h.responseText)}catch{Hr("Failed to parse JSON response for "+l+": "+h.responseText)}r(null,m)}else 401!==h.status&&404!==h.status&&Hr("Got unsuccessful REST response for "+l+" Status: "+h.status),r(h.status);r=null}},h.open("GET",l,!0),h.send()})}}class oI{constructor(){this.rootNode_=Yt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function $h(){return{value:null,children:new Map}}function Nc(n,e,t){if(an(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=en(e);n.children.has(r)||n.children.set(r,$h()),Nc(n.children.get(r),e=jn(e),t)}}function Gh(n,e){if(an(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(zn,(r,i)=>{Nc(n,new Fn(r),i)}),Gh(n,e)}}if(n.children.size>0){const t=en(e);return e=jn(e),n.children.has(t)&&Gh(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function aI(n,e,t){null!==n.value?t(e,n.value):function UN(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{aI(i,new Fn(e.toString()+"/"+r),t)})}class BN{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Mr(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class $N{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new BN(e);const r=1e4+2e4*Math.random();gg(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Mr(e,(i,a)=>{a>0&&(0,R.r3)(this.statsToReport_,i)&&(t[i]=a,r=!0)}),r&&this.server_.reportStats(t),gg(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var so=(()=>{return(n=so||(so={}))[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",so;var n})();function Bo(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class Pc{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=so.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(an(this.path)){if(null!=this.affectedTree.value)return(0,R.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Fn(e));return new Pc(mn(),t,this.revert)}}return(0,R.hu)(en(this.path)===e,"operationForChild called for unrelated child."),new Pc(jn(this.path),this.affectedTree,this.revert)}}class Wh{constructor(e,t){this.source=e,this.path=t,this.type=so.LISTEN_COMPLETE}operationForChild(e){return an(this.path)?new Wh(this.source,mn()):new Wh(this.source,jn(this.path))}}class uu{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=so.OVERWRITE}operationForChild(e){return an(this.path)?new uu(this.source,mn(),this.snap.getImmediateChild(e)):new uu(this.source,jn(this.path),this.snap)}}class lu{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=so.MERGE}operationForChild(e){if(an(this.path)){const t=this.children.subtree(new Fn(e));return t.isEmpty()?null:t.value?new uu(this.source,mn(),t.value):new lu(this.source,mn(),t)}return(0,R.hu)(en(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new lu(this.source,jn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class va{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(an(e))return this.isFullyInitialized()&&!this.filtered_;const t=en(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class av{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function ks(n,e,t,r,i,a){const l=r.filter(h=>h.type===t);l.sort((h,m)=>function dS(n,e,t){if(null==e.childName||null==t.childName)throw(0,R.g5)("Should only compare child_ events.");const r=new zt(e.childName,e.snapshotNode),i=new zt(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,h,m)),l.forEach(h=>{const m=function cI(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,h,a);i.forEach(v=>{v.respondsTo(h.type)&&e.push(v.createEvent(m,n.query_))})})}function kc(n,e){return{eventCache:n,serverCache:e}}function zh(n,e,t,r){return kc(new va(e,t,r),n.serverCache)}function uv(n,e,t,r){return kc(n.eventCache,new va(e,t,r))}function Bg(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function gl(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let Oc;class Hn{constructor(e,t=(()=>(Oc||(Oc=new Yi(MT)),Oc))()){this.value=e,this.children=t}static fromObject(e){let t=new Hn(null);return Mr(e,(r,i)=>{t=t.set(new Fn(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:mn(),value:this.value};if(an(e))return null;{const r=en(e),i=this.children.get(r);if(null!==i){const a=i.findRootMostMatchingPathAndValue(jn(e),t);return null!=a?{path:Un(new Fn(r),a.path),value:a.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(an(e))return this;{const t=en(e),r=this.children.get(t);return null!==r?r.subtree(jn(e)):new Hn(null)}}set(e,t){if(an(e))return new Hn(t,this.children);{const r=en(e),a=(this.children.get(r)||new Hn(null)).set(jn(e),t),l=this.children.insert(r,a);return new Hn(this.value,l)}}remove(e){if(an(e))return this.children.isEmpty()?new Hn(null):new Hn(null,this.children);{const t=en(e),r=this.children.get(t);if(r){const i=r.remove(jn(e));let a;return a=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&a.isEmpty()?new Hn(null):new Hn(this.value,a)}return this}}get(e){if(an(e))return this.value;{const t=en(e),r=this.children.get(t);return r?r.get(jn(e)):null}}setTree(e,t){if(an(e))return t;{const r=en(e),a=(this.children.get(r)||new Hn(null)).setTree(jn(e),t);let l;return l=a.isEmpty()?this.children.remove(r):this.children.insert(r,a),new Hn(this.value,l)}}fold(e){return this.fold_(mn(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,a)=>{r[i]=a.fold_(Un(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,mn(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(an(e))return null;{const a=en(e),l=this.children.get(a);return l?l.findOnPath_(jn(e),Un(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,mn(),t)}foreachOnPath_(e,t,r){if(an(e))return this;{this.value&&r(t,this.value);const i=en(e),a=this.children.get(i);return a?a.foreachOnPath_(jn(e),Un(t,i),r):new Hn(null)}}foreach(e){this.foreach_(mn(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Un(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class _i{constructor(e){this.writeTree_=e}static empty(){return new _i(new Hn(null))}}function cu(n,e,t){if(an(e))return new _i(new Hn(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let a=r.value;const l=xi(i,e);return a=a.updateChild(l,t),new _i(n.writeTree_.set(i,a))}{const i=new Hn(t),a=n.writeTree_.setTree(e,i);return new _i(a)}}}function ml(n,e,t){let r=n;return Mr(t,(i,a)=>{r=cu(r,Un(e,i),a)}),r}function dI(n,e){if(an(e))return _i.empty();{const t=n.writeTree_.setTree(e,new Hn(null));return new _i(t)}}function jg(n,e){return null!=du(n,e)}function du(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(xi(t.path,e)):null}function Hg(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(zn,(r,i)=>{e.push(new zt(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new zt(r,i.value))}),e}function jo(n,e){if(an(e))return n;{const t=du(n,e);return new _i(null!=t?new Hn(t):n.writeTree_.subtree(e))}}function $g(n){return n.writeTree_.isEmpty()}function hu(n,e){return hI(mn(),n.writeTree_,e)}function hI(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,a)=>{".priority"===i?((0,R.hu)(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):t=hI(Un(n,i),a,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(Un(n,".priority"),r)),t}}function lv(n,e){return fv(e,n)}function pS(n,e){if(n.snap)return Zi(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Zi(Un(n.path,t),e))return!0;return!1}function ls(n){return n.visible}function gI(n,e,t){let r=_i.empty();for(let i=0;i<n.length;++i){const a=n[i];if(e(a)){const l=a.path;let h;if(a.snap)Zi(t,l)?(h=xi(t,l),r=cu(r,h,a.snap)):Zi(l,t)&&(h=xi(l,t),r=cu(r,mn(),a.snap.getChild(h)));else{if(!a.children)throw(0,R.g5)("WriteRecord should have .snap or .children");if(Zi(t,l))h=xi(t,l),r=ml(r,h,a.children);else if(Zi(l,t))if(h=xi(l,t),an(h))r=ml(r,mn(),a.children);else{const m=(0,R.DV)(a.children,en(h));if(m){const v=m.getChild(jn(h));r=cu(r,mn(),v)}}}}}return r}function mI(n,e,t,r,i){if(r||i){const a=jo(n.visibleWrites,e);return!i&&$g(a)?t:i||null!=t||jg(a,mn())?hu(gI(n.allWrites,function(v){return(v.visible||i)&&(!r||!~r.indexOf(v.writeId))&&(Zi(v.path,e)||Zi(e,v.path))},e),t||Yt.EMPTY_NODE):null}{const a=du(n.visibleWrites,e);if(null!=a)return a;{const l=jo(n.visibleWrites,e);return $g(l)?t:null!=t||jg(l,mn())?hu(l,t||Yt.EMPTY_NODE):null}}}function Gg(n,e,t,r){return mI(n.writeTree,n.treePath,e,t,r)}function Wg(n,e){return function GN(n,e,t){let r=Yt.EMPTY_NODE;const i=du(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(zn,(a,l)=>{r=r.updateImmediateChild(a,l)}),r;if(t){const a=jo(n.visibleWrites,e);return t.forEachChild(zn,(l,h)=>{const m=hu(jo(a,new Fn(l)),h);r=r.updateImmediateChild(l,m)}),Hg(a).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}return Hg(jo(n.visibleWrites,e)).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}(n.writeTree,n.treePath,e)}function yI(n,e,t,r){return function mS(n,e,t,r,i){(0,R.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const a=Un(e,t);if(jg(n.visibleWrites,a))return null;{const l=jo(n.visibleWrites,a);return $g(l)?i.getChild(t):hu(l,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function qh(n,e){return function _I(n,e){return du(n.visibleWrites,e)}(n.writeTree,Un(n.treePath,e))}function dv(n,e,t){return function cv(n,e,t,r){const i=Un(e,t),a=du(n.visibleWrites,i);return null!=a?a:r.isCompleteForChild(t)?hu(jo(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function hv(n,e){return fv(Un(n.treePath,e),n.writeTree)}function fv(n,e){return{treePath:n,writeTree:e}}class wS{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,R.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,R.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const a=i.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(r,Vg(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(r,pl(r,i.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(r,fl(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw(0,R.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,Vg(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const zg=new class Ho{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class pv{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new va(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return dv(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:gl(this.viewCache_),a=function vS(n,e,t,r,i,a){return function _S(n,e,t,r,i,a,l){let h;const m=jo(n.visibleWrites,e),v=du(m,mn());if(null!=v)h=v;else{if(null==t)return[];h=hu(m,t)}if(h=h.withIndex(l),h.isEmpty()||h.isLeafNode())return[];{const b=[],D=l.getCompare(),x=a?h.getReverseIteratorFrom(r,l):h.getIteratorFrom(r,l);let j=x.getNext();for(;j&&b.length<i;)0!==D(j,r)&&b.push(j),j=x.getNext();return b}}(n.writeTree,n.treePath,e,t,r,i,a)}(this.writes_,i,t,1,r,e);return 0===a.length?null:a[0]}}function wI(n,e,t,r,i,a){const l=e.eventCache;if(null!=qh(r,t))return e;{let h,m;if(an(t))if((0,R.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const v=gl(e),D=Wg(r,v instanceof Yt?v:Yt.EMPTY_NODE);h=n.filter.updateFullNode(e.eventCache.getNode(),D,a)}else{const v=Gg(r,gl(e));h=n.filter.updateFullNode(e.eventCache.getNode(),v,a)}else{const v=en(t);if(".priority"===v){(0,R.hu)(1===us(t),"Can't have a priority with additional path components");const b=l.getNode();m=e.serverCache.getNode();const D=yI(r,t,b,m);h=null!=D?n.filter.updatePriority(b,D):l.getNode()}else{const b=jn(t);let D;if(l.isCompleteForChild(v)){m=e.serverCache.getNode();const x=yI(r,t,l.getNode(),m);D=null!=x?l.getNode().getImmediateChild(v).updateChild(b,x):l.getNode().getImmediateChild(v)}else D=dv(r,v,e.serverCache);h=null!=D?n.filter.updateChild(l.getNode(),v,D,b,i,a):l.getNode()}}return zh(e,h,l.isFullyInitialized()||an(t),n.filter.filtersNodes())}}function qg(n,e,t,r,i,a,l,h){const m=e.serverCache;let v;const b=l?n.filter:n.filter.getIndexedFilter();if(an(t))v=b.updateFullNode(m.getNode(),r,null);else if(b.filtersNodes()&&!m.isFiltered()){const j=m.getNode().updateChild(t,r);v=b.updateFullNode(m.getNode(),j,null)}else{const j=en(t);if(!m.isCompleteForPath(t)&&us(t)>1)return e;const Q=jn(t),Le=m.getNode().getImmediateChild(j).updateChild(Q,r);v=".priority"===j?b.updatePriority(m.getNode(),Le):b.updateChild(m.getNode(),j,Le,Q,zg,null)}const D=uv(e,v,m.isFullyInitialized()||an(t),b.filtersNodes());return wI(n,D,t,i,new pv(i,D,a),h)}function Kh(n,e,t,r,i,a,l){const h=e.eventCache;let m,v;const b=new pv(i,e,a);if(an(t))v=n.filter.updateFullNode(e.eventCache.getNode(),r,l),m=zh(e,v,!0,n.filter.filtersNodes());else{const D=en(t);if(".priority"===D)v=n.filter.updatePriority(e.eventCache.getNode(),r),m=zh(e,v,h.isFullyInitialized(),h.isFiltered());else{const x=jn(t),j=h.getNode().getImmediateChild(D);let Q;if(an(x))Q=r;else{const Se=b.getCompleteChild(D);Q=null!=Se?".priority"===kh(x)&&Se.getChild(Ky(x)).isEmpty()?Se:Se.updateChild(x,r):Yt.EMPTY_NODE}m=j.equals(Q)?e:zh(e,n.filter.updateChild(h.getNode(),D,Q,x,b,l),h.isFullyInitialized(),n.filter.filtersNodes())}}return m}function EI(n,e){return n.eventCache.isCompleteForChild(e)}function Zh(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Yh(n,e,t,r,i,a,l,h){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let v,m=e;v=an(t)?r:new Hn(null).setTree(t,r);const b=e.serverCache.getNode();return v.children.inorderTraversal((D,x)=>{if(b.hasChild(D)){const Q=Zh(0,e.serverCache.getNode().getImmediateChild(D),x);m=qg(n,m,new Fn(D),Q,i,a,l,h)}}),v.children.inorderTraversal((D,x)=>{const j=!e.serverCache.isCompleteForChild(D)&&void 0===x.value;if(!b.hasChild(D)&&!j){const Se=Zh(0,e.serverCache.getNode().getImmediateChild(D),x);m=qg(n,m,new Fn(D),Se,i,a,l,h)}}),m}class CI{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new iI(r.getIndex()),a=function nv(n){return n.loadsAllData()?new iI(n.getIndex()):n.hasLimit()?new Ug(n):new au(n)}(r);this.processor_=function ES(n){return{filter:n}}(a);const l=t.serverCache,h=t.eventCache,m=i.updateFullNode(Yt.EMPTY_NODE,l.getNode(),null),v=a.updateFullNode(Yt.EMPTY_NODE,h.getNode(),null),b=new va(m,l.isFullyInitialized(),i.filtersNodes()),D=new va(v,h.isFullyInitialized(),a.filtersNodes());this.viewCache_=kc(D,b),this.eventGenerator_=new av(this.query_)}get query(){return this.query_}}function mv(n,e){const t=gl(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!an(e)&&!t.getImmediateChild(en(e)).isEmpty())?t.getChild(e):null}function DS(n){return 0===n.eventRegistrations_.length}function _v(n,e,t){const r=[];if(t){(0,R.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(a=>{const l=a.createCancelEvent(t,i);l&&r.push(l)})}if(e){let i=[];for(let a=0;a<n.eventRegistrations_.length;++a){const l=n.eventRegistrations_[a];if(l.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(a+1));break}}else i.push(l)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function yv(n,e,t,r){e.type===so.MERGE&&null!==e.source.queryId&&((0,R.hu)(gl(n.viewCache_),"We should always have a full cache before handling merges"),(0,R.hu)(Bg(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,a=function vI(n,e,t,r,i){const a=new wS;let l,h;if(t.type===so.OVERWRITE){const v=t;v.source.fromUser?l=Kh(n,e,v.path,v.snap,r,i,a):((0,R.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered()&&!an(v.path),l=qg(n,e,v.path,v.snap,r,i,h,a))}else if(t.type===so.MERGE){const v=t;v.source.fromUser?l=function CS(n,e,t,r,i,a,l){let h=e;return r.foreach((m,v)=>{const b=Un(t,m);EI(e,en(b))&&(h=Kh(n,h,b,v,i,a,l))}),r.foreach((m,v)=>{const b=Un(t,m);EI(e,en(b))||(h=Kh(n,h,b,v,i,a,l))}),h}(n,e,v.path,v.children,r,i,a):((0,R.hu)(v.source.fromServer,"Unknown source."),h=v.source.tagged||e.serverCache.isFiltered(),l=Yh(n,e,v.path,v.children,r,i,h,a))}else if(t.type===so.ACK_USER_WRITE){const v=t;l=v.revert?function gv(n,e,t,r,i,a){let l;if(null!=qh(r,t))return e;{const h=new pv(r,e,i),m=e.eventCache.getNode();let v;if(an(t)||".priority"===en(t)){let b;if(e.serverCache.isFullyInitialized())b=Gg(r,gl(e));else{const D=e.serverCache.getNode();(0,R.hu)(D instanceof Yt,"serverChildren would be complete if leaf node"),b=Wg(r,D)}v=n.filter.updateFullNode(m,b,a)}else{const b=en(t);let D=dv(r,b,e.serverCache);null==D&&e.serverCache.isCompleteForChild(b)&&(D=m.getImmediateChild(b)),v=null!=D?n.filter.updateChild(m,b,D,jn(t),h,a):e.eventCache.getNode().hasChild(b)?n.filter.updateChild(m,b,Yt.EMPTY_NODE,jn(t),h,a):m,v.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=Gg(r,gl(e)),l.isLeafNode()&&(v=n.filter.updateFullNode(v,l,a)))}return l=e.serverCache.isFullyInitialized()||null!=qh(r,mn()),zh(e,v,l,n.filter.filtersNodes())}}(n,e,v.path,r,i,a):function bS(n,e,t,r,i,a,l){if(null!=qh(i,t))return e;const h=e.serverCache.isFiltered(),m=e.serverCache;if(null!=r.value){if(an(t)&&m.isFullyInitialized()||m.isCompleteForPath(t))return qg(n,e,t,m.getNode().getChild(t),i,a,h,l);if(an(t)){let v=new Hn(null);return m.getNode().forEachChild(Vo,(b,D)=>{v=v.set(new Fn(b),D)}),Yh(n,e,t,v,i,a,h,l)}return e}{let v=new Hn(null);return r.foreach((b,D)=>{const x=Un(t,b);m.isCompleteForPath(x)&&(v=v.set(b,m.getNode().getChild(x)))}),Yh(n,e,t,v,i,a,h,l)}}(n,e,v.path,v.affectedTree,r,i,a)}else{if(t.type!==so.LISTEN_COMPLETE)throw(0,R.g5)("Unknown operation type: "+t.type);l=function II(n,e,t,r,i){const a=e.serverCache;return wI(n,uv(e,a.getNode(),a.isFullyInitialized()||an(t),a.isFiltered()),t,r,zg,i)}(n,e,t.path,r,a)}const m=a.getChanges();return function IS(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=Bg(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(Lg(Bg(e)))}}(e,l,m),{viewCache:l,changes:m}}(n.processor_,i,e,t,r);return function WN(n,e){(0,R.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,R.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,a.viewCache),(0,R.hu)(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,vv(n,a.changes,a.viewCache.eventCache.getNode(),null)}function vv(n,e,t,r){return function cS(n,e,t,r){const i=[],a=[];return e.forEach(l=>{"child_changed"===l.type&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&a.push(function rI(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(l.childName,l.snapshotNode))}),ks(n,i,"child_removed",e,r,t),ks(n,i,"child_added",e,r,t),ks(n,i,"child_moved",a,r,t),ks(n,i,"child_changed",e,r,t),ks(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let Qh,Qg;class $o{constructor(){this.views=new Map}}function wv(n,e,t,r){const i=e.source.queryId;if(null!==i){const a=n.views.get(i);return(0,R.hu)(null!=a,"SyncTree gave us an op for an invalid query."),yv(a,e,t,r)}{let a=[];for(const l of n.views.values())a=a.concat(yv(l,e,t,r));return a}}function Ev(n,e,t,r,i){const l=n.views.get(e._queryIdentifier);if(!l){let h=Gg(t,i?r:null),m=!1;h?m=!0:r instanceof Yt?(h=Wg(t,r),m=!1):(h=Yt.EMPTY_NODE,m=!1);const v=kc(new va(h,m,!1),new va(r,i,!1));return new CI(e,v)}return l}function Iv(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Go(n,e){let t=null;for(const r of n.views.values())t=t||mv(r,e);return t}function DI(n,e){return e._queryParams.loadsAllData()?Yg(n):n.views.get(e._queryIdentifier)}function Zg(n,e){return null!=DI(n,e)}function fu(n){return null!=Yg(n)}function Yg(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let MS=1;class Jh{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Hn(null),this.pendingWriteTree_=function yS(){return{visibleWrites:_i.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function wa(n,e,t,r,i){return function hS(n,e,t,r,i){(0,R.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=cu(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?oo(n,new uu({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Os(n,e,t=!1){const r=function fS(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function pI(n,e){const t=n.allWrites.findIndex(h=>h.writeId===e);(0,R.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,a=!1,l=n.allWrites.length-1;for(;i&&l>=0;){const h=n.allWrites[l];h.visible&&(l>=t&&pS(h,r.path)?i=!1:Zi(r.path,h.path)&&(a=!0)),l--}return!!i&&(a?(function gS(n){n.visibleWrites=gI(n.allWrites,ls,mn()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=dI(n.visibleWrites,r.path):Mr(r.children,m=>{n.visibleWrites=dI(n.visibleWrites,Un(r.path,m))}),!0))}(n.pendingWriteTree_,e)){let a=new Hn(null);return null!=r.snap?a=a.set(mn(),!0):Mr(r.children,l=>{a=a.set(new Fn(l),!0)}),oo(n,new Pc(r.path,a,t))}return[]}function Xh(n,e,t){return oo(n,new uu({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function cs(n,e,t,r){const i=e._path,a=n.syncPointTree_.get(i);let l=[];if(a&&("default"===e._queryIdentifier||Zg(a,e))){const h=function ZN(n,e,t,r){const i=e._queryIdentifier,a=[];let l=[];const h=fu(n);if("default"===i)for(const[m,v]of n.views.entries())l=l.concat(_v(v,t,r)),DS(v)&&(n.views.delete(m),v.query._queryParams.loadsAllData()||a.push(v.query));else{const m=n.views.get(i);m&&(l=l.concat(_v(m,t,r)),DS(m)&&(n.views.delete(i),m.query._queryParams.loadsAllData()||a.push(m.query)))}return h&&!fu(n)&&a.push(new(function KN(){return(0,R.hu)(Qh,"Reference.ts has not been loaded"),Qh}())(e._repo,e._path)),{removed:a,events:l}}(a,e,t,r);(function SS(n){return 0===n.views.size})(a)&&(n.syncPointTree_=n.syncPointTree_.remove(i));const m=h.removed;l=h.events;const v=-1!==m.findIndex(D=>D._queryParams.loadsAllData()),b=n.syncPointTree_.findOnPath(i,(D,x)=>fu(x));if(v&&!b){const D=n.syncPointTree_.subtree(i);if(!D.isEmpty()){const x=function TI(n){return n.fold((e,t,r)=>{if(t&&fu(t))return[Yg(t)];{let i=[];return t&&(i=Iv(t)),Mr(r,(a,l)=>{i=i.concat(l)}),i}})}(D);for(let j=0;j<x.length;++j){const Q=x[j],Se=Q.query,Le=wl(n,Q);n.listenProvider_.startListening(Uc(Se),Wo(n,Se),Le.hashFn,Le.onComplete)}}}!b&&m.length>0&&!r&&(v?n.listenProvider_.stopListening(Uc(e),null):m.forEach(D=>{const x=n.queryToTagMap.get(Ea(D));n.listenProvider_.stopListening(Uc(D),x)})),function SI(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=Ea(r),a=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(a)}}}(n,m)}return l}function ni(n,e,t,r){const i=pu(n,r);if(null!=i){const a=gu(i),l=a.path,h=a.queryId,m=xi(l,e);return Jg(n,l,new uu(Bo(h),m,t))}return[]}function tf(n,e){const t=n._path;let r=null,i=!1;e.syncPointTree_.foreachOnPath(t,(v,b)=>{const D=xi(v,t);r=r||Go(b,D),i=i||fu(b)});let l,a=e.syncPointTree_.get(t);a?(i=i||fu(a),r=r||Go(a,mn())):(a=new $o,e.syncPointTree_=e.syncPointTree_.set(t,a)),null!=r?l=!0:(l=!1,r=Yt.EMPTY_NODE,e.syncPointTree_.subtree(t).foreachChild((b,D)=>{const x=Go(D,mn());x&&(r=r.updateImmediateChild(b,x))}));const h=Zg(a,n);if(!h&&!n._queryParams.loadsAllData()){const v=Ea(n);(0,R.hu)(!e.queryToTagMap.has(v),"View does not exist, but we have a tag");const b=function AI(){return MS++}();e.queryToTagMap.set(v,b),e.tagToQueryMap.set(b,v)}return{syncPoint:a,writesCache:lv(e.pendingWriteTree_,t),serverCache:r,serverCacheComplete:l,foundAncestorDefaultView:i,viewAlreadyExists:h}}function ds(n,e,t){const{syncPoint:r,serverCache:i,writesCache:a,serverCacheComplete:l,viewAlreadyExists:h,foundAncestorDefaultView:m}=tf(e,n);let v=function AS(n,e,t,r,i,a){const l=Ev(n,e,r,i,a);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,l),function TS(n,e){n.eventRegistrations_.push(e)}(l,t),function bI(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(zn,(a,l)=>{r.push(fl(a,l))}),t.isFullyInitialized()&&r.push(Lg(t.getNode())),vv(n,r,t.getNode(),e)}(l,t)}(r,e,t,a,i,l);if(!h&&!m){const b=DI(r,e);v=v.concat(function xI(n,e,t){const r=e._path,i=Wo(n,e),a=wl(n,t),l=n.listenProvider_.startListening(Uc(e),i,a.hashFn,a.onComplete),h=n.syncPointTree_.subtree(r);if(i)(0,R.hu)(!fu(h.value),"If we're adding a query, it shouldn't be shadowed");else{const m=h.fold((v,b,D)=>{if(!an(v)&&b&&fu(b))return[Yg(b).query];{let x=[];return b&&(x=x.concat(Iv(b).map(j=>j.query))),Mr(D,(j,Q)=>{x=x.concat(Q)}),x}});for(let v=0;v<m.length;++v){const b=m[v];n.listenProvider_.stopListening(Uc(b),Wo(n,b))}}return l}(n,e,b))}return v}function Lc(n,e,t){const i=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(l,h)=>{const v=Go(h,xi(l,e));if(v)return v});return mI(i,e,a,t,!0)}function oo(n,e){return yl(e,n.syncPointTree_,null,lv(n.pendingWriteTree_,mn()))}function yl(n,e,t,r){if(an(n.path))return vl(n,e,t,r);{const i=e.get(mn());null==t&&null!=i&&(t=Go(i,mn()));let a=[];const l=en(n.path),h=n.operationForChild(l),m=e.children.get(l);if(m&&h){const v=t?t.getImmediateChild(l):null,b=hv(r,l);a=a.concat(yl(h,m,v,b))}return i&&(a=a.concat(wv(i,n,r,t))),a}}function vl(n,e,t,r){const i=e.get(mn());null==t&&null!=i&&(t=Go(i,mn()));let a=[];return e.children.inorderTraversal((l,h)=>{const m=t?t.getImmediateChild(l):null,v=hv(r,l),b=n.operationForChild(l);b&&(a=a.concat(vl(b,h,m,v)))}),i&&(a=a.concat(wv(i,n,r,t))),a}function wl(n,e){const t=e.query,r=Wo(n,t);return{hashFn:()=>(function zN(n){return n.viewCache_.serverCache.getNode()}(e)||Yt.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function PS(n,e,t){const r=pu(n,t);if(r){const i=gu(r),a=i.path,l=i.queryId,h=xi(a,e);return Jg(n,a,new Wh(Bo(l),h))}return[]}(n,t._path,r):function Cv(n,e){return oo(n,new Wh({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const a=function PT(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return cs(n,t,null,a)}}}}function Wo(n,e){const t=Ea(e);return n.queryToTagMap.get(t)}function Ea(n){return n._path.toString()+"$"+n._queryIdentifier}function pu(n,e){return n.tagToQueryMap.get(e)}function gu(n){const e=n.indexOf("$");return(0,R.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Fn(n.substr(0,e))}}function Jg(n,e,t){const r=n.syncPointTree_.get(e);return(0,R.hu)(r,"Missing sync point for query tag that we're tracking"),wv(r,t,lv(n.pendingWriteTree_,e),null)}function Uc(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function RS(){return(0,R.hu)(Qg,"Reference.ts has not been loaded"),Qg}())(n._repo,n._path):n}class Xg{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Xg(t)}node(){return this.node_}}class em{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Un(this.path_,e);return new em(this.syncTree_,t)}node(){return Lc(this.syncTree_,this.path_)}}const MI=function(n,e,t){return n&&"object"==typeof n?((0,R.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?kS(n[".sv"],e,t):"object"==typeof n[".sv"]?OS(n[".sv"],e):void(0,R.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},kS=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,R.hu)(!1,"Unexpected server value: "+n)},OS=function(n,e,t){n.hasOwnProperty("increment")||(0,R.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,R.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,R.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const l=i.getValue();return"number"!=typeof l?r:l+r},bv=function(n,e,t,r){return tm(e,new em(t,n),r)},Dv=function(n,e,t){return tm(n,new Xg(e),t)};function tm(n,e,t){const r=n.getPriority().val(),i=MI(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const l=n,h=MI(l.getValue(),e,t);return h!==l.getValue()||i!==l.getPriority().val()?new jh(h,Jn(i)):n}{const l=n;return a=l,i!==l.getPriority().val()&&(a=a.updatePriority(new jh(i))),l.forEachChild(zn,(h,m)=>{const v=tm(m,e.getImmediateChild(h),t);v!==m&&(a=a.updateImmediateChild(h,v))}),a}}class nf{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function Bc(n,e){let t=e instanceof Fn?e:new Fn(e),r=n,i=en(t);for(;null!==i;){const a=(0,R.DV)(r.node.children,i)||{children:{},childCount:0};r=new nf(i,r,a),t=jn(t),i=en(t)}return r}function El(n){return n.node.value}function jc(n,e){n.node.value=e,im(n)}function rf(n){return n.node.childCount>0}function nm(n,e){Mr(n.node.children,(t,r)=>{e(new nf(t,n,r))})}function rm(n,e,t,r){t&&!r&&e(n),nm(n,i=>{rm(i,e,!0,r)}),t&&r&&e(n)}function Hc(n){return new Fn(null===n.parent?n.name:Hc(n.parent)+"/"+n.name)}function im(n){null!==n.parent&&function Av(n,e,t){const r=function Tv(n){return void 0===El(n)&&!rf(n)}(t),i=(0,R.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,im(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,im(n))}(n.parent,n.name,n)}const NI=/[\[\].#$\/\u0000-\u001F\u007F]/,PI=/[\[\].#$\u0000-\u001F\u007F]/,sf=10485760,af=function(n){return"string"==typeof n&&0!==n.length&&!NI.test(n)},kI=function(n){return"string"==typeof n&&0!==n.length&&!PI.test(n)},$c=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!pg(n)||n&&"object"==typeof n&&(0,R.r3)(n,".sv")},ao=function(n,e,t,r){r&&void 0===e||Gc((0,R.gK)(n,"value"),e,t)},Gc=function(n,e,t){const r=t instanceof Fn?new ZE(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+ya(r));if("function"==typeof e)throw new Error(n+"contains a function "+ya(r)+" with contents = "+e.toString());if(pg(e))throw new Error(n+"contains "+e.toString()+" "+ya(r));if("string"==typeof e&&e.length>sf/3&&(0,R.ug)(e)>sf)throw new Error(n+"contains a string greater than "+sf+" utf8 bytes "+ya(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,a=!1;if(Mr(e,(l,h)=>{if(".value"===l)i=!0;else if(".priority"!==l&&".sv"!==l&&(a=!0,!af(l)))throw new Error(n+" contains an invalid key ("+l+") "+ya(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function YE(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,R.ug)(e),QE(n)})(r,l),Gc(n,h,r),function Lo(n){const e=n.parts_.pop();n.byteLength_-=(0,R.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&a)throw new Error(n+' contains ".value" child '+ya(r)+" in addition to actual children.")}},FI=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,R.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const a=[];Mr(e,(l,h)=>{const m=new Fn(l);if(Gc(i,h,Un(t,m)),".priority"===kh(m)&&!$c(h))throw new Error(i+"contains an invalid value for '"+m.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(m)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const a=Oh(r);for(let l=0;l<a.length;l++)if((".priority"!==a[l]||l!==a.length-1)&&!af(a[l]))throw new Error(n+"contains an invalid key ("+a[l]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(YT);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&Zi(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,a)},xv=function(n,e,t){if(!t||void 0!==e){if(pg(e))throw new Error((0,R.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!$c(e))throw new Error((0,R.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Wc=function(n,e,t,r){if(!(r&&void 0===t||af(t)))throw new Error((0,R.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Il=function(n,e,t,r){if(!(r&&void 0===t||kI(t)))throw new Error((0,R.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},hs=function(n,e){if(".info"===en(e))throw new Error(n+" failed = Can't modify data under /.info/")},Rv=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!af(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),kI(n)}(t))throw new Error((0,R.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class VI{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function uf(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],a=i.getPath();null!==t&&!Zy(a,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:a}),t.events.push(i)}t&&n.eventLists_.push(t)}function Mv(n,e,t){uf(n,t),Nv(n,r=>Zy(r,e))}function fs(n,e,t){uf(n,t),Nv(n,r=>Zi(r,e)||Zi(e,r))}function Nv(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(QN(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function QN(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();ul&&Rr("event: "+t.toString()),cl(r)}}}const UI="repo_interrupt";class BI{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new VI,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=$h(),this.transactionQueueTree_=new nf,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Nr(n){const t=n.infoData_.getNode(new Fn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function zc(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:Nr(n)})}function jI(n,e,t,r,i){n.dataUpdateCount++;const a=new Fn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(i)if(r){const m=(0,R.UI)(t,v=>Jn(v));l=function _l(n,e,t,r){const i=pu(n,r);if(i){const a=gu(i),l=a.path,h=a.queryId,m=xi(l,e),v=Hn.fromObject(t);return Jg(n,l,new lu(Bo(h),m,v))}return[]}(n.serverSyncTree_,a,m,i)}else{const m=Jn(t);l=ni(n.serverSyncTree_,a,m,i)}else if(r){const m=(0,R.UI)(t,v=>Jn(v));l=function NS(n,e,t){const r=Hn.fromObject(t);return oo(n,new lu({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,a,m)}else{const m=Jn(t);l=Xh(n.serverSyncTree_,a,m)}let h=a;l.length>0&&(h=qc(n,a)),fs(n.eventQueue_,h,l)}function HI(n,e){Pv(n,"connected",e),!1===e&&function BS(n){Cl(n,"onDisconnectEvents");const e=zc(n),t=$h();aI(n.onDisconnect_,mn(),(i,a)=>{const l=bv(i,a,n.serverSyncTree_,e);Nc(t,i,l)});let r=[];aI(t,mn(),(i,a)=>{r=r.concat(Xh(n.serverSyncTree_,i,a));const l=kv(n,i);qc(n,l)}),n.onDisconnect_=$h(),fs(n.eventQueue_,mn(),r)}(n)}function Pv(n,e,t){const r=new Fn("/.info/"+e),i=Jn(t);n.infoData_.updateSnapshot(r,i);const a=Xh(n.infoSyncTree_,r,i);fs(n.eventQueue_,r,a)}function lf(n){return n.nextWriteId_++}function GI(n,e){const t=function Vc(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(v,b)=>{const D=xi(v,t);r=r||Go(b,D)});let i=n.syncPointTree_.get(t);i?r=r||Go(i,mn()):(i=new $o,n.syncPointTree_=n.syncPointTree_.set(t,i));const a=null!=r,l=a?new va(r,!0,!1):null;return function qN(n){return Bg(n.viewCache_)}(Ev(i,e,lv(n.pendingWriteTree_,e._path),a?l.getNode():Yt.EMPTY_NODE,a))}(n.serverSyncTree_,e);return null!=t?Promise.resolve(t):n.server_.get(e).then(r=>{const i=Jn(r).withIndex(e._queryParams.getIndex());if(e._queryParams.loadsAllData())Xh(n.serverSyncTree_,e._path,i);else{const l=function ef(n,e){const{syncPoint:t,serverCache:r,writesCache:i,serverCacheComplete:a}=tf(e,n),l=Ev(t,e,i,r,a);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,l),e._queryParams.loadsAllData()?null:Wo(n,e)}(n.serverSyncTree_,e);ni(n.serverSyncTree_,e._path,i,l)}return cs(n.serverSyncTree_,e,null).length>0&&Cl(n,"unexpected cancel events in repoGetValue"),i},r=>(Cl(n,"get for query "+(0,R.Pz)(e)+" failed: "+r),Promise.reject(new Error(r))))}function mu(n,e,t,r,i){Cl(n,"set",{path:e.toString(),value:t,priority:r});const a=zc(n),l=Jn(t,r),h=Lc(n.serverSyncTree_,e),m=Dv(l,h,a),v=lf(n),b=wa(n.serverSyncTree_,e,m,v,!0);uf(n.eventQueue_,b),n.server_.put(e.toString(),l.val(!0),(x,j)=>{const Q="ok"===x;Q||Hr("set at "+e+" failed: "+x);const Se=Os(n.serverSyncTree_,v,!Q);fs(n.eventQueue_,e,Se),ri(0,i,x,j)});const D=kv(n,e);qc(n,D),fs(n.eventQueue_,D,[])}function WI(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&Gh(n.onDisconnect_,e),ri(0,t,r,i)})}function zI(n,e,t,r){const i=Jn(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(a,l)=>{"ok"===a&&Nc(n.onDisconnect_,e,i),ri(0,r,a,l)})}function cf(n,e,t){let r;r=".info"===en(e._path)?cs(n.infoSyncTree_,e,t):cs(n.serverSyncTree_,e,t),Mv(n.eventQueue_,e._path,r)}function uo(n){n.persistentConnection_&&n.persistentConnection_.interrupt(UI)}function Cl(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Rr(t,...e)}function ri(n,e,t,r){e&&cl(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let a=i;r&&(a+=": "+r);const l=new Error(a);l.code=i,e(l)}})}function ps(n,e,t){return Lc(n.serverSyncTree_,e,t)||Yt.EMPTY_NODE}function df(n,e=n.transactionQueueTree_){if(e||_u(n,e),El(e)){const t=QI(n,e);(0,R.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function ZI(n,e,t){const r=t.map(v=>v.currentWriteId),i=ps(n,e,r);let a=i;const l=i.hash();for(let v=0;v<t.length;v++){const b=t[v];(0,R.hu)(0===b.status,"tryToSendTransactionQueue_: items in queue should all be run."),b.status=1,b.retryCount++;const D=xi(e,b.path);a=a.updateChild(D,b.currentOutputSnapshotRaw)}const h=a.val(!0),m=e;n.server_.put(m.toString(),h,v=>{Cl(n,"transaction put response",{path:m.toString(),status:v});let b=[];if("ok"===v){const D=[];for(let x=0;x<t.length;x++)t[x].status=2,b=b.concat(Os(n.serverSyncTree_,t[x].currentWriteId)),t[x].onComplete&&D.push(()=>t[x].onComplete(null,!0,t[x].currentOutputSnapshotResolved)),t[x].unwatcher();_u(n,Bc(n.transactionQueueTree_,e)),df(n,n.transactionQueueTree_),fs(n.eventQueue_,e,b);for(let x=0;x<D.length;x++)cl(D[x])}else{if("datastale"===v)for(let D=0;D<t.length;D++)t[D].status=3===t[D].status?4:0;else{Hr("transaction at "+m.toString()+" failed: "+v);for(let D=0;D<t.length;D++)t[D].status=4,t[D].abortReason=v}qc(n,e)}},l)}(n,Hc(e),t)}else rf(e)&&nm(e,t=>{df(n,t)})}function qc(n,e){const t=YI(n,e),r=Hc(t);return function HS(n,e,t){if(0===e.length)return;const r=[];let i=[];const l=e.filter(h=>0===h.status).map(h=>h.currentWriteId);for(let h=0;h<e.length;h++){const m=e[h],v=xi(t,m.path);let D,b=!1;if((0,R.hu)(null!==v,"rerunTransactionsUnderNode_: relativePath should not be null."),4===m.status)b=!0,D=m.abortReason,i=i.concat(Os(n.serverSyncTree_,m.currentWriteId,!0));else if(0===m.status)if(m.retryCount>=25)b=!0,D="maxretry",i=i.concat(Os(n.serverSyncTree_,m.currentWriteId,!0));else{const x=ps(n,m.path,l);m.currentInputSnapshot=x;const j=e[h].update(x.val());if(void 0!==j){Gc("transaction failed: Data returned ",j,m.path);let Q=Jn(j);"object"==typeof j&&null!=j&&(0,R.r3)(j,".priority")||(Q=Q.updatePriority(x.getPriority()));const Le=m.currentWriteId,Et=zc(n),It=Dv(Q,x,Et);m.currentOutputSnapshotRaw=Q,m.currentOutputSnapshotResolved=It,m.currentWriteId=lf(n),l.splice(l.indexOf(Le),1),i=i.concat(wa(n.serverSyncTree_,m.path,It,m.currentWriteId,m.applyLocally)),i=i.concat(Os(n.serverSyncTree_,Le,!0))}else b=!0,D="nodata",i=i.concat(Os(n.serverSyncTree_,m.currentWriteId,!0))}fs(n.eventQueue_,t,i),i=[],b&&(e[h].status=2,setTimeout(e[h].unwatcher,Math.floor(0)),e[h].onComplete&&r.push("nodata"===D?()=>e[h].onComplete(null,!1,e[h].currentInputSnapshot):()=>e[h].onComplete(new Error(D),!1,null)))}_u(n,n.transactionQueueTree_);for(let h=0;h<r.length;h++)cl(r[h]);df(n,n.transactionQueueTree_)}(n,QI(n,t),r),r}function YI(n,e){let t,r=n.transactionQueueTree_;for(t=en(e);null!==t&&void 0===El(r);)r=Bc(r,t),t=en(e=jn(e));return r}function QI(n,e){const t=[];return sm(n,e,t),t.sort((r,i)=>r.order-i.order),t}function sm(n,e,t){const r=El(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);nm(e,i=>{sm(n,i,t)})}function _u(n,e){const t=El(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,jc(e,t.length>0?t:void 0)}nm(e,r=>{_u(n,r)})}function kv(n,e){const t=Hc(YI(n,e)),r=Bc(n.transactionQueueTree_,e);return function Sv(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{om(n,i)}),om(n,r),rm(r,i=>{om(n,i)}),t}function om(n,e){const t=El(e);if(t){const r=[];let i=[],a=-1;for(let l=0;l<t.length;l++)3===t[l].status||(1===t[l].status?((0,R.hu)(a===l-1,"All SENT items should be at beginning of queue."),a=l,t[l].status=3,t[l].abortReason="set"):((0,R.hu)(0===t[l].status,"Unexpected transaction status in abort"),t[l].unwatcher(),i=i.concat(Os(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&r.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));-1===a?jc(e,void 0):t.length=a+1,fs(n.eventQueue_,Hc(e),i);for(let l=0;l<r.length;l++)cl(r[l])}}const am=function(n,e){const t=um(n),r=t.namespace;return"firebase.com"===t.domain&&Ai(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&Ai("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Hr("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new jy(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new Fn(t.pathString)}},um=function(n){let e="",t="",r="",i="",a="",l=!0,h="https",m=443;if("string"==typeof n){let v=n.indexOf("//");v>=0&&(h=n.substring(0,v-1),n=n.substring(v+2));let b=n.indexOf("/");-1===b&&(b=n.length);let D=n.indexOf("?");-1===D&&(D=n.length),e=n.substring(0,Math.min(b,D)),b<D&&(i=function $S(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(b,D)));const x=function JI(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Hr(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,D)));v=e.indexOf(":"),v>=0?(l="https"===h||"wss"===h,m=parseInt(e.substring(v+1),10)):v=e.length;const j=e.slice(0,v);if("localhost"===j.toLowerCase())t="localhost";else if(j.split(".").length<=2)t=j;else{const Q=e.indexOf(".");r=e.substring(0,Q).toLowerCase(),t=e.substring(Q+1),a=r}"ns"in x&&(a=x.ns)}return{host:e,port:m,domain:t,subdomain:r,secure:l,scheme:h,pathString:i,namespace:a}};class XI{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,R.Pz)(this.snapshot.exportVal())}}class Ov{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Fv{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,R.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Lv{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new R.BH;return WI(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){hs("OnDisconnect.remove",this._path);const e=new R.BH;return zI(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){hs("OnDisconnect.set",this._path),ao("OnDisconnect.set",e,this._path,!1);const t=new R.BH;return zI(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){hs("OnDisconnect.setWithPriority",this._path),ao("OnDisconnect.setWithPriority",e,this._path,!1),xv("OnDisconnect.setWithPriority",t,!1);const r=new R.BH;return function qI(n,e,t,r,i){const a=Jn(t,r);n.server_.onDisconnectPut(e.toString(),a.val(!0),(l,h)=>{"ok"===l&&Nc(n.onDisconnect_,e,a),ri(0,i,l,h)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){hs("OnDisconnect.update",this._path),FI("OnDisconnect.update",e,this._path,!1);const t=new R.BH;return function JN(n,e,t,r){if((0,R.xb)(t))return Rr("onDisconnect().update() called with empty data.  Don't do anything."),void ri(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,a)=>{"ok"===i&&Mr(t,(l,h)=>{const m=Jn(h);Nc(n.onDisconnect_,Un(e,l),m)}),ri(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class ii{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return an(this._path)?null:kh(this._path)}get ref(){return new gs(this._repo,this._path)}get _queryIdentifier(){const e=sI(this._queryParams),t=Py(e);return"{}"===t?"default":t}get _queryObject(){return sI(this._queryParams)}isEqual(e){if(!((e=(0,R.m9)(e))instanceof ii))return!1;const t=this._repo===e._repo,r=Zy(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function ZT(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function hf(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Ia(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Vo){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==ga)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Fo)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===zn){if(null!=e&&!$c(e)||null!=t&&!$c(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,R.hu)(n.getIndex()instanceof kg||n.getIndex()===Og,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function ff(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class gs extends ii{constructor(e,t){super(e,t,new Mc,!1)}get parent(){const e=Ky(this._path);return null===e?null:new gs(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class yu{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Fn(e),r=vu(this.ref,e);return new yu(this._node.getChild(t),r,zn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new yu(i,vu(this.ref,r),zn)))}hasChild(e){const t=new Fn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Vv(n,e){return(n=(0,R.m9)(n))._checkNotDeleted("ref"),void 0!==e?vu(n._root,e):n._root}function Uv(n,e){(n=(0,R.m9)(n))._checkNotDeleted("refFromURL");const t=am(e,n._repo.repoInfo_.nodeAdmin);Rv("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Ai("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),Vv(n,t.path.toString())}function vu(n,e){return null===en((n=(0,R.m9)(n))._path)?(t=e,t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Il("child","path",t,!1)):Il("child","path",e,!1),new gs(n._repo,Un(n._path,e));var t}function Bv(n,e){n=(0,R.m9)(n),hs("set",n._path),ao("set",e,n._path,!1);const t=new R.BH;return mu(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function KS(n,e){FI("update",e,n._path,!1);const t=new R.BH;return function US(n,e,t,r){Cl(n,"update",{path:e.toString(),value:t});let i=!0;const a=zc(n),l={};if(Mr(t,(h,m)=>{i=!1,l[h]=bv(Un(e,h),Jn(m),n.serverSyncTree_,a)}),i)Rr("update() called with empty data.  Don't do anything."),ri(0,r,"ok",void 0);else{const h=lf(n),m=function YN(n,e,t,r){!function fI(n,e,t,r){(0,R.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=ml(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=Hn.fromObject(t);return oo(n,new lu({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,l,h);uf(n.eventQueue_,m),n.server_.merge(e.toString(),t,(v,b)=>{const D="ok"===v;D||Hr("update at "+e+" failed: "+v);const x=Os(n.serverSyncTree_,h,!D),j=x.length>0?qc(n,e):e;fs(n.eventQueue_,j,x),ri(0,r,v,b)}),Mr(t,v=>{const b=kv(n,Un(e,v));qc(n,b)}),fs(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}class lm{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new XI("value",this,new yu(e.snapshotNode,new gs(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ov(this,e,t):null}matches(e){return e instanceof lm&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class cm{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ov(this,e,t):null}createEvent(e,t){(0,R.hu)(null!=e.childName,"Child events should have a childName.");const r=vu(new gs(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new XI(e.type,this,new yu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof cm&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function pf(n,e,t,r,i){let a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){const m=t,v=(b,D)=>{cf(n._repo,n,h),m(b,D)};v.userCallback=t.userCallback,v.context=t.context,t=v}const l=new Fv(t,a||void 0),h="value"===e?new lm(l):new cm(e,l);return function KI(n,e,t){let r;r=".info"===en(e._path)?ds(n.infoSyncTree_,e,t):ds(n.serverSyncTree_,e,t),Mv(n.eventQueue_,e._path,r)}(n._repo,n,h),()=>cf(n._repo,n,h)}function jv(n,e,t,r){return pf(n,"value",e,t,r)}function eC(n,e,t,r){return pf(n,"child_added",e,t,r)}function tC(n,e,t,r){return pf(n,"child_changed",e,t,r)}function nC(n,e,t,r){return pf(n,"child_moved",e,t,r)}function rC(n,e,t,r){return pf(n,"child_removed",e,t,r)}function iC(n,e,t){let r=null;const i=t?new Fv(t):null;"value"===e?r=new lm(i):e&&(r=new cm(e,i)),cf(n._repo,n,r)}class co{}class Hv extends co{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ao("endAt",this._value,e._path,!0);const t=sv(e._queryParams,this._value,this._key);if(ff(t),Ia(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ii(e._repo,e._path,t,e._orderByCalled)}}class oC extends co{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ao("endBefore",this._value,e._path,!1);const t=function aS(n,e,t){let r,i;return n.index_===Vo?("string"==typeof e&&(e=Uo(e)),i=sv(n,e,t)):(r=null==t?ga:Uo(t),i=sv(n,e,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(ff(t),Ia(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new ii(e._repo,e._path,t,e._orderByCalled)}}class $v extends co{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ao("startAt",this._value,e._path,!0);const t=iv(e._queryParams,this._value,this._key);if(ff(t),Ia(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new ii(e._repo,e._path,t,e._orderByCalled)}}class lC extends co{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ao("startAfter",this._value,e._path,!1);const t=function oS(n,e,t){let r;if(n.index_===Vo)"string"==typeof e&&(e=Fg(e)),r=iv(n,e,t);else{let i;i=null==t?Fo:Fg(t),r=iv(n,e,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(ff(t),Ia(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new ii(e._repo,e._path,t,e._orderByCalled)}}class dC extends co{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new ii(e._repo,e._path,function rv(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class fC extends co{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new ii(e._repo,e._path,function VN(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class YS extends co{constructor(e){super(),this._path=e}_apply(e){hf(e,"orderByChild");const t=new Fn(this._path);if(an(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new kg(t),i=Hh(e._queryParams,r);return Ia(i),new ii(e._repo,e._path,i,!0)}}class Kc extends co{_apply(e){hf(e,"orderByKey");const t=Hh(e._queryParams,Vo);return Ia(t),new ii(e._repo,e._path,t,!0)}}class Gv extends co{_apply(e){hf(e,"orderByPriority");const t=Hh(e._queryParams,zn);return Ia(t),new ii(e._repo,e._path,t,!0)}}class pC extends co{_apply(e){hf(e,"orderByValue");const t=Hh(e._queryParams,Og);return Ia(t),new ii(e._repo,e._path,t,!0)}}class nP extends co{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(ao("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Hv(this._value,this._key)._apply(new $v(this._value,this._key)._apply(e))}}function ho(n,...e){let t=(0,R.m9)(n);for(const r of e)t=r._apply(t);return t}(function Kg(n){(0,R.hu)(!Qh,"__referenceConstructor has already been defined"),Qh=n})(gs),function xS(n){(0,R.hu)(!Qg,"__referenceConstructor has already been defined"),Qg=n}(gs);const Wv={};function gf(n,e,t,r,i){let a=r||n.options.databaseURL;void 0===a&&(n.options.projectId||Ai("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rr("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let m,v,l=am(a,i),h=l.repoInfo;typeof process<"u"&&process.env&&(v=process.env.FIREBASE_DATABASE_EMULATOR_HOST),v?(m=!0,a=`http://${v}?ns=${h.namespace}`,l=am(a,i),h=l.repoInfo):m=!l.repoInfo.secure;const b=i&&m?new Tc(Tc.OWNER):new OT(n.name,n.options,e);Rv("Invalid Firebase Database URL",l),an(l.path)||Ai("Database URL must point to the root of a Firebase Database (not including a child path).");const D=function _r(n,e,t,r){let i=Wv[e.name];i||(i={},Wv[e.name]=i);let a=i[n.toURLString()];return a&&Ai("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new BI(n,false,t,r),i[n.toURLString()]=a,a}(h,n,b,new mg(n.name,t));return new mC(D,n)}class mC{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function VS(n,e,t){if(n.stats_=Ig(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new ov(n.repoInfo_,(r,i,a,l)=>{jI(n,r,i,a,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>HI(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,R.Pz)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new dl(n.repoInfo_,e,(r,i,a,l)=>{jI(n,r,i,a,l)},r=>{HI(n,r)},r=>{!function $I(n,e){Mr(e,(t,r)=>{Pv(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function NN(n,e){const t=n.toString();return Rh[t]||(Rh[t]=e()),Rh[t]}(n.repoInfo_,()=>new $N(n.stats_,n.server_)),n.infoData_=new oI,n.infoSyncTree_=new Jh({startListening:(r,i,a,l)=>{let h=[];const m=n.infoData_.getNode(r._path);return m.isEmpty()||(h=Xh(n.infoSyncTree_,r._path,m),setTimeout(()=>{l("ok")},0)),h},stopListening:()=>{}}),Pv(n,"connected",!1),n.serverSyncTree_=new Jh({startListening:(r,i,a,l)=>(n.server_.listen(r,a,i,(h,m)=>{const v=l(h,m);fs(n.eventQueue_,r._path,v)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new gs(this._repo,mn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function dm(n,e){const t=Wv[e];(!t||t[n.key]!==n)&&Ai(`Database ${e}(${n.repoInfo_}) has already been deleted.`),uo(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Ai("Cannot call "+e+" on a deleted database.")}}function zv(){$y.IS_TRANSPORT_INITIALIZED&&Hr("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function eA(){zv(),_a.forceDisallow()}function _C(){zv(),Ac.forceDisallow(),_a.forceAllow()}function rA(n,e){fg(n,e)}const mf={".sv":"timestamp"};class aA{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}dl.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},dl.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function iA(n){RT(Si.SDK_VERSION),(0,Si._registerComponent)(new no.wA("database",(e,{instanceIdentifier:t})=>gf(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,Si.registerVersion)(Oo,"0.13.3",n),(0,Si.registerVersion)(Oo,"0.13.3","esm2017")}();const _f=new mi.Yd("@firebase/database-compat"),Zc=function(n){_f.warn("FIREBASE WARNING: "+n)};class fA{constructor(e){this._delegate=e}cancel(e){(0,R.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,R.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,R.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,R.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,R.Dv)("OnDisconnect.set",1,2,arguments.length),(0,R.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,R.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,R.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),a=>r(a)),i}update(e,t){if((0,R.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,Zc("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,R.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class EC{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,R.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Ca{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,R.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,R.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,R.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,R.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,R.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),Il("DataSnapshot.child","path",e,!1),new Ca(this._database,this._delegate.child(e))}hasChild(e){return(0,R.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Il("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,R.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,R.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,R.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new Ca(this._database,t)))}hasChildren(){return(0,R.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,R.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,R.Dv)("DataSnapshot.ref",0,0,arguments.length),new ms(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class $r{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var a;(0,R.Dv)("Query.on",2,4,arguments.length),(0,R.Wj)("Query.on","callback",t,!1);const l=$r.getCancelAndContextArgs_("Query.on",r,i),h=(v,b)=>{t.call(l.context,new Ca(this.database,v),b)};h.userCallback=t,h.context=l.context;const m=null===(a=l.cancel)||void 0===a?void 0:a.bind(l.context);switch(e){case"value":return jv(this._delegate,h,m),t;case"child_added":return eC(this._delegate,h,m),t;case"child_removed":return rC(this._delegate,h,m),t;case"child_changed":return tC(this._delegate,h,m),t;case"child_moved":return nC(this._delegate,h,m),t;default:throw new Error((0,R.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,R.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,R.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,R.Wj)("Query.off","callback",t,!0),(0,R.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,iC(this._delegate,e,i)}else iC(this._delegate,e)}get(){return function ZS(n){return GI((n=(0,R.m9)(n))._repo,n).then(e=>new yu(e,new gs(n._repo,n._path),n._queryParams.getIndex()))}(this._delegate).then(e=>new Ca(this.database,e))}once(e,t,r,i){(0,R.Dv)("Query.once",1,4,arguments.length),(0,R.Wj)("Query.once","callback",t,!0);const a=$r.getCancelAndContextArgs_("Query.once",r,i),l=new R.BH,h=(v,b)=>{const D=new Ca(this.database,v);t&&t.call(a.context,D,b),l.resolve(D)};h.userCallback=t,h.context=a.context;const m=v=>{a.cancel&&a.cancel.call(a.context,v),l.reject(v)};switch(e){case"value":jv(this._delegate,h,m,{onlyOnce:!0});break;case"child_added":eC(this._delegate,h,m,{onlyOnce:!0});break;case"child_removed":rC(this._delegate,h,m,{onlyOnce:!0});break;case"child_changed":tC(this._delegate,h,m,{onlyOnce:!0});break;case"child_moved":nC(this._delegate,h,m,{onlyOnce:!0});break;default:throw new Error((0,R.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return l.promise}limitToFirst(e){return(0,R.Dv)("Query.limitToFirst",1,1,arguments.length),new $r(this.database,ho(this._delegate,function hC(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new dC(n)}(e)))}limitToLast(e){return(0,R.Dv)("Query.limitToLast",1,1,arguments.length),new $r(this.database,ho(this._delegate,function bl(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new fC(n)}(e)))}orderByChild(e){return(0,R.Dv)("Query.orderByChild",1,1,arguments.length),new $r(this.database,ho(this._delegate,function QS(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Il("orderByChild","path",n,!1),new YS(n)}(e)))}orderByKey(){return(0,R.Dv)("Query.orderByKey",0,0,arguments.length),new $r(this.database,ho(this._delegate,function eP(){return new Kc}()))}orderByPriority(){return(0,R.Dv)("Query.orderByPriority",0,0,arguments.length),new $r(this.database,ho(this._delegate,function tP(){return new Gv}()))}orderByValue(){return(0,R.Dv)("Query.orderByValue",0,0,arguments.length),new $r(this.database,ho(this._delegate,function gC(){return new pC}()))}startAt(e=null,t){return(0,R.Dv)("Query.startAt",0,2,arguments.length),new $r(this.database,ho(this._delegate,function uC(n=null,e){return Wc("startAt","key",e,!0),new $v(n,e)}(e,t)))}startAfter(e=null,t){return(0,R.Dv)("Query.startAfter",0,2,arguments.length),new $r(this.database,ho(this._delegate,function cC(n,e){return Wc("startAfter","key",e,!0),new lC(n,e)}(e,t)))}endAt(e=null,t){return(0,R.Dv)("Query.endAt",0,2,arguments.length),new $r(this.database,ho(this._delegate,function sC(n,e){return Wc("endAt","key",e,!0),new Hv(n,e)}(e,t)))}endBefore(e=null,t){return(0,R.Dv)("Query.endBefore",0,2,arguments.length),new $r(this.database,ho(this._delegate,function aC(n,e){return Wc("endBefore","key",e,!0),new oC(n,e)}(e,t)))}equalTo(e,t){return(0,R.Dv)("Query.equalTo",1,2,arguments.length),new $r(this.database,ho(this._delegate,function At(n,e){return Wc("equalTo","key",e,!0),new nP(n,e)}(e,t)))}toString(){return(0,R.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,R.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,R.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof $r))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,R.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,R.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,R.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new ms(this.database,new gs(this._delegate._repo,this._delegate._path))}}class ms extends $r{constructor(e,t){super(e,new ii(t._repo,t._path,new Mc,!1)),this.database=e,this._delegate=t}getKey(){return(0,R.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,R.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new ms(this.database,vu(this._delegate,e))}getParent(){(0,R.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new ms(this.database,e):null}getRoot(){return(0,R.Dv)("Reference.root",0,0,arguments.length),new ms(this.database,this._delegate.root)}set(e,t){(0,R.Dv)("Reference.set",1,2,arguments.length),(0,R.Wj)("Reference.set","onComplete",t,!0);const r=Bv(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,R.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,Zc("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}hs("Reference.update",this._delegate._path),(0,R.Wj)("Reference.update","onComplete",t,!0);const r=KS(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,R.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,R.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function qS(n,e,t){if(hs("setWithPriority",n._path),ao("setWithPriority",e,n._path,!1),xv("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new R.BH;return mu(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),a=>r(a)),i}remove(e){(0,R.Dv)("Reference.remove",0,1,arguments.length),(0,R.Wj)("Reference.remove","onComplete",e,!0);const t=function WS(n){return hs("remove",n._path),Bv(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,R.Dv)("Reference.transaction",1,3,arguments.length),(0,R.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,R.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,R.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function hm(n,e,t){var r;if(n=(0,R.m9)(n),hs("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=t?.applyLocally)||void 0===r||r,a=new R.BH,h=jv(n,()=>{});return function lo(n,e,t,r,i,a){Cl(n,"transaction on "+e);const l={path:e,update:t,onComplete:r,status:null,order:Ry(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=ps(n,e,void 0);l.currentInputSnapshot=h;const m=l.update(h.val());if(void 0===m)l.unwatcher(),l.currentOutputSnapshotRaw=null,l.currentOutputSnapshotResolved=null,l.onComplete&&l.onComplete(null,!1,l.currentInputSnapshot);else{Gc("transaction failed: Data returned ",m,l.path),l.status=0;const v=Bc(n.transactionQueueTree_,e),b=El(v)||[];let D;b.push(l),jc(v,b),"object"==typeof m&&null!==m&&(0,R.r3)(m,".priority")?(D=(0,R.DV)(m,".priority"),(0,R.hu)($c(D),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):D=(Lc(n.serverSyncTree_,e)||Yt.EMPTY_NODE).getPriority().val();const x=zc(n),j=Jn(m,D),Q=Dv(j,h,x);l.currentOutputSnapshotRaw=j,l.currentOutputSnapshotResolved=Q,l.currentWriteId=lf(n);const Se=wa(n.serverSyncTree_,e,Q,l.currentWriteId,l.applyLocally);fs(n.eventQueue_,e,Se),df(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(m,v,b)=>{let D=null;m?a.reject(m):(D=new yu(b,new gs(n._repo,n._path),zn),a.resolve(new aA(v,D)))},h,i),a.promise}(this._delegate,e,{applyLocally:r}).then(a=>new EC(a.committed,new Ca(this.database,a.snapshot)));return t&&i.then(a=>t(null,a.committed,a.snapshot),a=>t(a,!1,null)),i}setPriority(e,t){(0,R.Dv)("Reference.setPriority",1,2,arguments.length),(0,R.Wj)("Reference.setPriority","onComplete",t,!0);const r=function zS(n,e){n=(0,R.m9)(n),hs("setPriority",n._path),xv("setPriority",e,!1);const t=new R.BH;return mu(n._repo,Un(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,R.Dv)("Reference.push",0,2,arguments.length),(0,R.Wj)("Reference.push","onComplete",t,!0);const r=function GS(n,e){n=(0,R.m9)(n),hs("push",n._path),ao("push",e,n._path,!0);const t=Nr(n._repo),r=sS(t),i=vu(n,r),a=vu(n,r);let l;return l=null!=e?Bv(a,e).then(()=>a):Promise.resolve(a),i.then=l.then.bind(l),i.catch=l.then.bind(l,void 0),i}(this._delegate,e),i=r.then(l=>new ms(this.database,l));t&&i.then(()=>t(null),l=>t(l));const a=new ms(this.database,r);return a.then=i.then.bind(i),a.catch=i.catch.bind(i,void 0),a}onDisconnect(){return hs("Reference.onDisconnect",this._delegate._path),new fA(new Lv(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class Yc{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:eA,forceLongPolling:_C}}useEmulator(e,t,r={}){!function yC(n,e,t,r={}){(n=(0,R.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Ai("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ai('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new Tc(Tc.OWNER);else if(r.mockUserToken){const l="string"==typeof r.mockUserToken?r.mockUserToken:(0,R.Sg)(r.mockUserToken,n.app.options.projectId);a=new Tc(l)}!function XS(n,e,t,r){n.repoInfo_=new jy(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),r&&(n.authTokenProvider_=r)}(i,e,t,a)}(this._delegate,e,t,r)}ref(e){if((0,R.Dv)("database.ref",0,1,arguments.length),e instanceof ms){const t=Uv(this._delegate,e.toString());return new ms(this,t)}{const t=Vv(this._delegate,e);return new ms(this,t)}}refFromURL(e){(0,R.Dv)("database.refFromURL",1,1,arguments.length);const r=Uv(this._delegate,e);return new ms(this,r)}goOffline(){return(0,R.Dv)("database.goOffline",0,0,arguments.length),function vC(n){(n=(0,R.m9)(n))._checkNotDeleted("goOffline"),uo(n._repo)}(this._delegate)}goOnline(){return(0,R.Dv)("database.goOnline",0,0,arguments.length),function nA(n){(n=(0,R.m9)(n))._checkNotDeleted("goOnline"),function jS(n){n.persistentConnection_&&n.persistentConnection_.resume(UI)}(n._repo)}(this._delegate)}}Yc.ServerValue={TIMESTAMP:function sA(){return mf}(),increment:n=>function oA(n){return{".sv":{increment:n}}}(n)};var gA=Object.freeze({__proto__:null,initStandalone:function pA({app:n,url:e,version:t,customAuthImpl:r,namespace:i,nodeAdmin:a=!1}){RT(t);const l=new no.zt("auth-internal",new no.H0("database-standalone"));return l.setComponent(new no.wA("auth-internal",()=>r,"PRIVATE")),{instance:new Yc(gf(n,l,void 0,e,a),n),namespace:i}}});const iP=Yc.ServerValue;!function sP(n){n.INTERNAL.registerComponent(new no.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new Yc(i,r)},"PUBLIC").setServiceProps({Reference:ms,Query:$r,Database:Yc,DataSnapshot:Ca,enableLogging:rA,INTERNAL:gA,ServerValue:iP}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.2.3")}(xy.Z);var wu=P(7579),qv=P(5363),IC=P(6063);class fm extends wu.x{constructor(e=1/0,t=1/0,r=IC.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:a,_windowTime:l}=this;t||(r.push(e),!i&&r.push(a.now()+l)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,a=i.slice();for(let l=0;l<a.length&&!e.closed;l+=r?1:2)e.next(a[l]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,a=(i?1:2)*e;if(e<1/0&&a<r.length&&r.splice(0,r.length-a),!i){const l=t.now();let h=0;for(let m=1;m<r.length&&r[m]<=l;m+=2)h=m;h&&r.splice(0,h+1)}}}function CC(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,(0,hg.B)({connector:()=>new fm(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}const Qc=(0,P(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Ri(n,e){return(0,jr.e)((t,r)=>{let i=0;t.subscribe((0,Yn.x)(r,a=>n.call(e,a,i++)&&r.next(a)))})}var Tl=P(515);function yf(n){return n<=0?()=>Tl.E:(0,jr.e)((e,t)=>{let r=0;e.subscribe((0,Yn.x)(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Kv(n){return(0,jr.e)((e,t)=>{let r=!1;e.subscribe((0,Yn.x)(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function bC(n=_A){return(0,jr.e)((e,t)=>{let r=!1;e.subscribe((0,Yn.x)(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function _A(){return new Qc}function ba(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Ri((i,a)=>n(i,a,r)):ru.y,yf(1),t?Kv(e):bC(()=>new Qc))}var Zv=P(576);function DC(n,e){return(0,Zv.m)(e)?Ar(()=>n,e):Ar(()=>n)}var Eu=P(9468);const xC=new Map,CA={activated:!1,tokenObservers:[]},bA={initialized:!1,enabled:!1};function Gr(n){return xC.get(n)||CA}function fo(n,e){xC.set(n,e)}function gm(){return bA}class PC{constructor(e,t,r,i,a){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,xe.Z)(function*(){t.stop();try{t.pending=new R.BH,yield function SA(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new R.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Mi=new R.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function mm(n){if(!Gr(n).activated)throw Mi.create("use-before-activation",{appName:n.name})}function Xv(n,e){return ew.apply(this,arguments)}function ew(){return(ew=(0,xe.Z)(function*({url:n,body:e},t){var r,i;const a={"Content-Type":"application/json"},l=t.getImmediate({optional:!0});if(l){const j=yield l.getHeartbeatsHeader();j&&(a["X-Firebase-Client"]=j)}const h={method:"POST",body:JSON.stringify(e),headers:a};let m,v;try{m=yield fetch(n,h)}catch(j){throw Mi.create("fetch-network-error",{originalErrorMessage:null===(r=j)||void 0===r?void 0:r.message})}if(200!==m.status)throw Mi.create("fetch-status-error",{httpStatus:m.status});try{v=yield m.json()}catch(j){throw Mi.create("fetch-parse-error",{originalErrorMessage:null===(i=j)||void 0===i?void 0:i.message})}const b=v.ttl.match(/^([\d.]+)(s)$/);if(!b||!b[2]||isNaN(Number(b[1])))throw Mi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${v.ttl}`});const D=1e3*Number(b[1]),x=Date.now();return{token:v.token,expireTimeMillis:x+D,issuedAtTimeMillis:x}})).apply(this,arguments)}function kC(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:e}}}const ym="firebase-app-check-store";let Iu=null;function Cu(){return Iu||(Iu=new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=i=>{n(i.target.result)},r.onerror=i=>{var a;e(Mi.create("storage-open",{originalErrorMessage:null===(a=i.target.error)||void 0===a?void 0:a.message}))},r.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(ym,{keyPath:"compositeKey"})}}catch(r){e(Mi.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}}),Iu)}function Al(){return(Al=(0,xe.Z)(function*(n,e){const r=(yield Cu()).transaction(ym,"readwrite"),a=r.objectStore(ym).put({compositeKey:n,value:e});return new Promise((l,h)=>{a.onsuccess=m=>{l()},r.onerror=m=>{var v;h(Mi.create("storage-set",{originalErrorMessage:null===(v=m.target.error)||void 0===v?void 0:v.message}))}})})).apply(this,arguments)}const vf=new mi.Yd("@firebase/app-check");function iw(n,e){return(0,R.hl)()?function MA(n,e){return function Sl(n,e){return Al.apply(this,arguments)}(function nw(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{vf.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Ef(){return gm().enabled}function ed(){return sw.apply(this,arguments)}function sw(){return(sw=(0,xe.Z)(function*(){const n=gm();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const HC={error:"UNKNOWN_ERROR"};function kA(n){return R.US.encodeString(JSON.stringify(n),!1)}function vm(n){return If.apply(this,arguments)}function If(){return(If=(0,xe.Z)(function*(n,e=!1){const t=n.app;mm(t);const r=Gr(t);let a,i=r.token;if(!i){const m=yield r.cachedTokenPromise;m&&td(m)&&(i=m)}if(!e&&i&&td(i))return{token:i.token};let h,l=!1;if(Ef()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Xv(kC(t,yield ed()),n.heartbeatServiceProvider).then(v=>(r.exchangeTokenPromise=void 0,v)),l=!0);const m=yield r.exchangeTokenPromise;return yield iw(t,m),fo(t,Object.assign(Object.assign({},r),{token:m})),{token:m.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(m=>(r.exchangeTokenPromise=void 0,m)),l=!0),i=yield r.exchangeTokenPromise}catch(m){"appCheck/throttled"===m.code?vf.warn(m.message):vf.error(m),a=m}return i?(h={token:i.token},fo(t,Object.assign(Object.assign({},r),{token:i})),yield iw(t,i)):h=FA(a),l&&uw(t,h),h})).apply(this,arguments)}function $C(n,e){const t=Gr(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),fo(n,Object.assign(Object.assign({},t),{tokenObservers:r}))}function GC(n){const{app:e}=n,t=Gr(e);let r=t.tokenRefresher;r||(r=function OA(n){const{app:e}=n;return new PC((0,xe.Z)(function*(){let r;if(r=Gr(e).token?yield vm(n,!0):yield vm(n),r.error)throw r.error}),()=>!0,()=>{const t=Gr(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),fo(e,Object.assign(Object.assign({},t),{tokenRefresher:r}))),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function uw(n,e){const t=Gr(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}function td(n){return n.expireTimeMillis-Date.now()>0}function FA(n){return{token:kA(HC),error:n}}class lw{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Gr(this.app);for(const t of e)$C(this.app,t.next);return Promise.resolve()}}const tb="app-check-internal";!function WA(){(0,Si._registerComponent)(new no.wA("app-check",n=>function LA(n,e){return new lw(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(tb).initialize()})),(0,Si._registerComponent)(new no.wA(tb,n=>function VA(n){return{getToken:e=>vm(n,e),addTokenListener:e=>function aw(n,e,t,r){const{app:i}=n,a=Gr(i),l={next:t,error:r,type:e};if(fo(i,Object.assign(Object.assign({},a),{tokenObservers:[...a.tokenObservers,l]})),a.token&&td(a.token)){const h=a.token;Promise.resolve().then(()=>{t({token:h.token}),GC(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>GC(n))}(n,"INTERNAL",e),removeTokenListener:e=>$C(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Si.registerVersion)("@firebase/app-check","0.5.12")}();class nd{constructor(){return(0,An.vb)("app-check")}}typeof window<"u"&&window;var _s=P(127);const Cf=new f.OlP("angularfire2.auth.use-emulator"),Rl=new f.OlP("angularfire2.auth.settings"),hw=new f.OlP("angularfire2.auth.tenant-id"),fw=new f.OlP("angularfire2.auth.langugage-code"),pw=new f.OlP("angularfire2.auth.use-device-language"),rd=new f.OlP("angularfire.auth.persistence"),id=(n,e,t,r,i,a,l,h)=>(0,xr.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const m=e.runOutsideAngular(()=>n.auth());if(t&&m.useEmulator(...t),r&&(m.tenantId=r),m.languageCode=i,a&&m.useDeviceLanguage(),l)for(const[v,b]of Object.entries(l))m.settings[v]=b;return h&&m.setPersistence(h),m},[t,r,i,a,l,h]);let bf=(()=>{class n{constructor(t,r,i,a,l,h,m,v,b,D,x,j){const Q=new wu.x,Se=Nt(void 0).pipe((0,qv.Q)(l.outsideAngular),Ar(()=>a.runOutsideAngular(()=>Promise.resolve().then(P.bind(P,5881)))),(0,Ot.U)(()=>(0,xr.on)(t,a,r)),(0,Ot.U)(Le=>id(Le,a,h,v,b,D,m,x)),CC({bufferSize:1,refCount:!1}));if(wp(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Nt(null);else{Se.pipe(ba()).subscribe();const Et=Se.pipe(Ar(wt=>wt.getRedirectResult().then(qt=>qt,()=>null)),An.iC,CC({bufferSize:1,refCount:!1})),It=Se.pipe(Ar(wt=>new Mn.y(qt=>({unsubscribe:a.runOutsideAngular(()=>wt.onAuthStateChanged(pn=>qt.next(pn),pn=>qt.error(pn),()=>qt.complete()))})))),Ct=Se.pipe(Ar(wt=>new Mn.y(qt=>({unsubscribe:a.runOutsideAngular(()=>wt.onIdTokenChanged(pn=>qt.next(pn),pn=>qt.error(pn),()=>qt.complete()))}))));this.authState=Et.pipe(DC(It),(0,Eu.R)(l.outsideAngular),(0,qv.Q)(l.insideAngular)),this.user=Et.pipe(DC(Ct),(0,Eu.R)(l.outsideAngular),(0,qv.Q)(l.insideAngular)),this.idToken=this.user.pipe(Ar(wt=>wt?(0,kn.D)(wt.getIdToken()):Nt(null))),this.idTokenResult=this.user.pipe(Ar(wt=>wt?(0,kn.D)(wt.getIdTokenResult()):Nt(null))),this.credential=(0,ti.T)(Et,Q,this.authState.pipe(Ri(wt=>!wt))).pipe((0,Ot.U)(wt=>wt?.user?wt:null),(0,Eu.R)(l.outsideAngular),(0,qv.Q)(l.insideAngular))}return(0,xr.pX)(this,Se,a,{spy:{apply:(Le,Et,It)=>{(Le.startsWith("signIn")||Le.startsWith("createUser"))&&It.then(Ct=>Q.next(Ct))}}})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(xr.Dh),f.LFG(xr.xv,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(An.HU),f.LFG(Cf,8),f.LFG(Rl,8),f.LFG(hw,8),f.LFG(fw,8),f.LFG(pw,8),f.LFG(rd,8),f.LFG(nd,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),QA=(()=>{class n{constructor(){_s.Z.registerVersion("angularfire",An.q4.full,"auth-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[bf]}),n})();function bm(n){return null==n}function gw(n){return"function"==typeof n.set}function ab(n,e){return gw(e)?e:n.ref(e)}function ub(n,e){if(function sb(n){return"string"==typeof n}(n))return e.stringCase();if(gw(n))return e.firebaseCase();if(function ob(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function Dm(n,e,t="on",r=Ay.z){return new Mn.y(i=>{let a=null;return a=n[t](e,(l,h)=>{r.schedule(()=>{i.next({snapshot:l,prevKey:h})}),"once"===t&&r.schedule(()=>i.complete())},l=>{r.schedule(()=>i.error(l))}),"on"===t?{unsubscribe(){null!=a&&n.off(e,a)}}:{unsubscribe(){}}}).pipe((0,Ot.U)(i=>{const{snapshot:a,prevKey:l}=i;let h=null;return a.exists()&&(h=a.key),{type:e,payload:a,prevKey:l,key:h}}),(0,hg.B)())}function Tm(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function _w(n,e){const{payload:t,prevKey:r,key:i}=e,a=Tm(n,i),l=function lb(n,e){if(bm(e))return 0;{const t=Tm(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let h=null;e.payload.forEach(m=>{const v={payload:m,type:"value",prevKey:h,key:m.key};return h=m.key,n=[...n,v],!1})}return n;case"child_added":if(a>-1){const h=n[a-1];(h&&h.key||null)!==r&&(n=n.filter(m=>m.payload.key!==t.key)).splice(l,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(l,0,e)}return n;case"child_removed":return n.filter(h=>h.payload.key!==t.key);case"child_changed":return n.map(h=>h.payload.key===i?e:h);case"child_moved":if(a>-1){const h=n.splice(a,1)[0];return(n=n.slice()).splice(l,0,h),n}return n;default:return n}}function Sm(n){return(bm(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function cb(n,e,t){return function mw(n,e,t){return Dm(n,"value","once",t).pipe(Ar(r=>{const i=[Nt(r)];return e.forEach(a=>i.push(Dm(n,a,"on",t))),(0,ti.T)(...i).pipe(to(_w,[]))}),bE())}(n,e=Sm(e),t)}function db(n,e,t){const r=(e=Sm(e)).map(i=>Dm(n,i,"on",t));return(0,ti.T)(...r)}function Am(n,e){return function(r,i){return ub(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function fb(n){return function(t){return t?ub(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function yw(n,e){return function(){return Dm(n,"value","on",e)}}const tx=new f.OlP("angularfire2.realtimeDatabaseURL"),gb=new f.OlP("angularfire2.database.use-emulator");let mb=(()=>{class n{constructor(t,r,i,a,l,h,m,v,b,D,x,j,Q,Se,Le){this.schedulers=h;const Et=m,It=(0,xr.on)(t,l,r);v&&id(It,l,b,x,j,Q,D,Se),this.database=(0,xr.cc)(`${It.name}.database.${i}`,"AngularFireDatabase",It.name,()=>{const Ct=l.runOutsideAngular(()=>It.database(i||void 0));return Et&&Ct.useEmulator(...Et),Ct},[Et])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>ab(this.database,t));let a=i;return r&&(a=r(i)),function ex(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:Am(r,"update"),set:Am(r,"set"),push:i=>r.push(i),remove:fb(r),snapshotChanges:i=>cb(n,i,t).pipe(An.iC),stateChanges:i=>db(n,i,t).pipe(An.iC),auditTrail:i=>function JA(n,e,t){return function hb(n,e,t){return function XA(n,e){return Dm(n,"value","on",e).pipe((0,Ot.U)(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function xT(...n){const e=(0,ia.jO)(n);return(0,jr.e)((t,r)=>{const i=n.length,a=new Array(i);let l=n.map(()=>!1),h=!1;for(let m=0;m<i;m++)(0,Zs.Xf)(n[m]).subscribe((0,Yn.x)(r,v=>{a[m]=v,!h&&!l[m]&&(l[m]=!0,(h=l.every(ru.y))&&(l=null))},DE.Z));t.subscribe((0,Yn.x)(r,m=>{if(h){const v=[m,...a];r.next(e?e(...v):v)}}))})}(e),(0,Ot.U)(([i,a])=>{const l=i.lastKeyToLoad,h=a.map(m=>m.key);return{actions:a,lastKeyToLoad:l,loadedKeys:h}}),function TE(n){return(0,jr.e)((e,t)=>{let r=!1,i=0;e.subscribe((0,Yn.x)(t,a=>(r||(r=!n(a,i++)))&&t.next(a)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,Ot.U)(i=>i.actions))}(n,db(n,e).pipe(to((i,a)=>[...i,a],[])),t)}(n,i,t).pipe(An.iC),valueChanges:(i,a)=>cb(n,i,t).pipe((0,Ot.U)(h=>h.map(m=>a&&a.idField?Object.assign(Object.assign({},m.payload.val()),{[a.idField]:m.key}):m.payload.val())),An.iC)}}(a,this)}object(t){return function pb(n,e){return{query:n,snapshotChanges:()=>yw(n,e.schedulers.outsideAngular)().pipe(An.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>yw(n,e.schedulers.outsideAngular)().pipe(An.iC,(0,Ot.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>ab(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(xr.Dh),f.LFG(xr.xv,8),f.LFG(tx,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(An.HU),f.LFG(gb,8),f.LFG(bf,8),f.LFG(Cf,8),f.LFG(Rl,8),f.LFG(hw,8),f.LFG(fw,8),f.LFG(pw,8),f.LFG(rd,8),f.LFG(nd,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),nx=(()=>{class n{constructor(){_s.Z.registerVersion("angularfire",An.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[mb]}),n})();var sd=P(8189);function si(...n){return function rx(){return(0,sd.J)(1)}()((0,kn.D)(n,(0,ia.yG)(n)))}function Da(...n){const e=(0,ia.yG)(n);return(0,jr.e)((t,r)=>{(e?si(n,t,e):si(n,t)).subscribe(r)})}function vw(){return(0,jr.e)((n,e)=>{let t,r=!1;n.subscribe((0,Yn.x)(e,i=>{const a=t;t=i,r&&e.next([a,i]),r=!0}))})}var gt,ix=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},bu={},xm=xm||{},jt=ix||self;function Du(){}function ww(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Ml(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Rm="closure_uid_"+(1e9*Math.random()>>>0),ox=0;function ax(n,e,t){return n.call.apply(n.bind,arguments)}function od(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function oi(n,e,t){return(oi=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ax:od).apply(null,arguments)}function ad(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Wr(n,e){function t(){}t.prototype=e.prototype,n.Z=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Vb=function(r,i,a){for(var l=Array(arguments.length-2),h=2;h<arguments.length;h++)l[h-2]=arguments[h];return e.prototype[i].apply(r,l)}}function Ta(){this.s=this.s,this.o=this.o}var Ew={};Ta.prototype.s=!1,Ta.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var n=function sx(n){return Object.prototype.hasOwnProperty.call(n,Rm)&&n[Rm]||(n[Rm]=++ox)}(this);delete Ew[n]}},Ta.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const ux=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1},Iw=Array.prototype.forEach?function(n,e,t){Array.prototype.forEach.call(n,e,t)}:function(n,e,t){const r=n.length,i="string"==typeof n?n.split(""):n;for(let a=0;a<r;a++)a in i&&e.call(t,i[a],a,n)};function Cw(n){return Array.prototype.concat.apply([],arguments)}function Tu(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Nm(n){return/^[\s\xa0]*$/.test(n)}var Ni,bw=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function ai(n,e){return-1!=n.indexOf(e)}function _b(n,e){return n<e?-1:n>e?1:0}e:{var cx=jt.navigator;if(cx){var yb=cx.userAgent;if(yb){Ni=yb;break e}}Ni=""}function Dw(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function vb(n){const e={};for(const t in n)e[t]=n[t];return e}var Tw="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Sw(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let a=0;a<Tw.length;a++)t=Tw[a],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Aw(n){return Aw[" "](n),n}Aw[" "]=Du;var Df,n,Eb=ai(Ni,"Opera"),ud=ai(Ni,"Trident")||ai(Ni,"MSIE"),Ib=ai(Ni,"Edge"),Pm=Ib||ud,Cb=ai(Ni,"Gecko")&&!(ai(Ni.toLowerCase(),"webkit")&&!ai(Ni,"Edge"))&&!(ai(Ni,"Trident")||ai(Ni,"MSIE"))&&!ai(Ni,"Edge"),bb=ai(Ni.toLowerCase(),"webkit")&&!ai(Ni,"Edge");function xw(){var n=jt.document;return n?n.documentMode:void 0}e:{var km="",Rw=(n=Ni,Cb?/rv:([^\);]+)(\)|;)/.exec(n):Ib?/Edge\/([\d\.]+)/.exec(n):ud?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):bb?/WebKit\/(\S+)/.exec(n):Eb?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(Rw&&(km=Rw?Rw[1]:""),ud){var Mw=xw();if(null!=Mw&&Mw>parseFloat(km)){Df=String(Mw);break e}}Df=km}var bP={};var DP=jt.document&&ud&&(xw()||parseInt(Df,10))||void 0,TP=function(){if(!jt.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{jt.addEventListener("test",Du,e),jt.removeEventListener("test",Du,e)}catch{}return n}();function Pi(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}function Om(n,e){if(Pi.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Cb){e:{try{Aw(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:SP[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Om.Z.h.call(this)}}Pi.prototype.h=function(){this.defaultPrevented=!0},Wr(Om,Pi);var SP={2:"touch",3:"pen",4:"mouse"};Om.prototype.h=function(){Om.Z.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Fm="closure_listenable_"+(1e6*Math.random()|0),Lm=0;function AP(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ia=i,this.key=++Lm,this.ca=this.fa=!1}function Tf(n){n.ca=!0,n.listener=null,n.proxy=null,n.src=null,n.ia=null}function Nl(n){this.src=n,this.g={},this.h=0}function Vm(n,e){var t=e.type;if(t in n.g){var a,r=n.g[t],i=ux(r,e);(a=0<=i)&&Array.prototype.splice.call(r,i,1),a&&(Tf(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function Um(n,e,t,r){for(var i=0;i<n.length;++i){var a=n[i];if(!a.ca&&a.listener==e&&a.capture==!!t&&a.ia==r)return i}return-1}Nl.prototype.add=function(n,e,t,r,i){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var l=Um(n,e,r,i);return-1<l?(e=n[l],t||(e.fa=!1)):((e=new AP(e,this.src,a,!!r,i)).fa=t,n.push(e)),e};var Sb="closure_lm_"+(1e6*Math.random()|0),Sf={};function Nw(n,e,t,r,i){if(r&&r.once)return hx(n,e,t,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)Nw(n,e[a],t,r,i);return null}return t=Nb(t),n&&n[Fm]?n.N(e,t,Ml(r)?!!r.capture:!!r,i):Ab(n,e,t,!1,r,i)}function Ab(n,e,t,r,i,a){if(!e)throw Error("Invalid event type");var l=Ml(i)?!!i.capture:!!i,h=kw(n);if(h||(n[Sb]=h=new Nl(n)),(t=h.add(e,t,r,l,a)).proxy)return t;if(r=function xb(){var e=Bm;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)TP||(i=l),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(Rb(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function hx(n,e,t,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)hx(n,e[a],t,r,i);return null}return t=Nb(t),n&&n[Fm]?n.O(e,t,Ml(r)?!!r.capture:!!r,i):Ab(n,e,t,!0,r,i)}function fx(n,e,t,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)fx(n,e[a],t,r,i);else r=Ml(r)?!!r.capture:!!r,t=Nb(t),n&&n[Fm]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=Um(a=n.g[e],t,r,i))&&(Tf(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=kw(n))&&(e=n.g[e.toString()],n=-1,e&&(n=Um(e,t,r,i)),(t=-1<n?e[n]:null)&&Pw(t))}function Pw(n){if("number"!=typeof n&&n&&!n.ca){var e=n.src;if(e&&e[Fm])Vm(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(Rb(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=kw(e))?(Vm(t,n),0==t.h&&(t.src=null,e[Sb]=null)):Tf(n)}}}function Rb(n){return n in Sf?Sf[n]:Sf[n]="on"+n}function Bm(n,e){if(n.ca)n=!0;else{e=new Om(e,this);var t=n.listener,r=n.ia||n.src;n.fa&&Pw(n),n=t.call(r,e)}return n}function kw(n){return(n=n[Sb])instanceof Nl?n:null}var Mb="__closure_events_fn_"+(1e9*Math.random()>>>0);function Nb(n){return"function"==typeof n?n:(n[Mb]||(n[Mb]=function(e){return n.handleEvent(e)}),n[Mb])}function ui(){Ta.call(this),this.i=new Nl(this),this.P=this,this.I=null}function li(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new Pi(e,n);else if(e instanceof Pi)e.target=e.target||n;else{var i=e;Sw(e=new Pi(r,n),i)}if(i=!0,t)for(var a=t.length-1;0<=a;a--){var l=e.g=t[a];i=jm(l,r,!0,e)&&i}if(i=jm(l=e.g=n,r,!0,e)&&i,i=jm(l,r,!1,e)&&i,t)for(a=0;a<t.length;a++)i=jm(l=e.g=t[a],r,!1,e)&&i}function jm(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var l=e[a];if(l&&!l.ca&&l.capture==t){var h=l.listener,m=l.ia||l.src;l.fa&&Vm(n.i,l),i=!1!==h.call(m,r)&&i}}return i&&!r.defaultPrevented}Wr(ui,Ta),ui.prototype[Fm]=!0,ui.prototype.removeEventListener=function(n,e,t,r){fx(this,n,e,t,r)},ui.prototype.M=function(){if(ui.Z.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Tf(t[r]);delete n.g[e],n.h--}}this.I=null},ui.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},ui.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var Ow=jt.JSON.stringify;function xP(){var n=Qi;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var Lw,Fw=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new Pb,n=>n.reset());class Pb{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function RP(n){jt.setTimeout(()=>{throw n},0)}function ys(n,e){Lw||function Vw(){var n=jt.Promise.resolve(void 0);Lw=function(){n.then(gx)}}(),Uw||(Lw(),Uw=!0),Qi.add(n,e)}var Uw=!1,Qi=new class px{constructor(){this.h=this.g=null}add(e,t){const r=Fw.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function gx(){for(var n;n=xP();){try{n.h.call(n.g)}catch(t){RP(t)}var e=Fw;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Uw=!1}function ld(n,e){ui.call(this),this.h=n||1,this.g=e||jt,this.j=oi(this.kb,this),this.l=Date.now()}function Bw(n){n.da=!1,n.S&&(n.g.clearTimeout(n.S),n.S=null)}function jw(n,e,t){if("function"==typeof n)t&&(n=oi(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=oi(n.handleEvent,n)}return 2147483647<Number(e)?-1:jt.setTimeout(n,e||0)}function Hm(n){n.g=jw(()=>{n.g=null,n.i&&(n.i=!1,Hm(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Wr(ld,ui),(gt=ld.prototype).da=!1,gt.S=null,gt.kb=function(){if(this.da){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-n):(this.S&&(this.g.clearTimeout(this.S),this.S=null),li(this,"tick"),this.da&&(Bw(this),this.start()))}},gt.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},gt.M=function(){ld.Z.M.call(this),Bw(this),delete this.g};class kb extends Ta{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Hm(this)}M(){super.M(),this.g&&(jt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cd(n){Ta.call(this),this.h=n,this.g={}}Wr(cd,Ta);var Ob=[];function Hw(n,e,t,r){Array.isArray(t)||(t&&(Ob[0]=t.toString()),t=Ob);for(var i=0;i<t.length;i++){var a=Nw(e,t[i],r||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function $w(n){Dw(n.g,function(e,t){this.g.hasOwnProperty(t)&&Pw(e)},n),n.g={}}function $m(){this.g=!0}function Su(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function Lb(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var l=1;l<i.length;l++)i[l]=""}}}return Ow(t)}catch{return e}}(n,t)+(r?" "+r:"")})}cd.prototype.M=function(){cd.Z.M.call(this),$w(this)},cd.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},$m.prototype.Aa=function(){this.g=!1},$m.prototype.info=function(){};var Sa={},zo=null;function Gm(){return zo=zo||new ui}function _x(n){Pi.call(this,Sa.Ma,n)}function Af(n){const e=Gm();li(e,new _x(e,n))}function Vb(n,e){Pi.call(this,Sa.STAT_EVENT,n),this.stat=e}function ki(n){const e=Gm();li(e,new Vb(e,n))}function Ub(n,e){Pi.call(this,Sa.Na,n),this.size=e}function dd(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return jt.setTimeout(function(){n()},e)}Sa.Ma="serverreachability",Wr(_x,Pi),Sa.STAT_EVENT="statevent",Wr(Vb,Pi),Sa.Na="timingevent",Wr(Ub,Pi);var Gw={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Ww={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function zw(){}function yx(){}zw.prototype.h=null;var Kw,Pl={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Wm(){Pi.call(this,"d")}function zm(){Pi.call(this,"c")}function xf(){}function hd(n,e,t,r){this.l=n,this.j=e,this.m=t,this.X=r||1,this.V=new cd(this),this.P=qm,this.W=new ld(n=Pm?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Rf}function Rf(){this.i=null,this.g="",this.h=!1}Wr(Wm,Pi),Wr(zm,Pi),Wr(xf,zw),xf.prototype.g=function(){return new XMLHttpRequest},xf.prototype.i=function(){return{}},Kw=new xf;var qm=45e3,Km={},Zm={};function Ym(n,e,t){n.K=1,n.v=pd(qo(e)),n.s=t,n.U=!0,Zw(n,null)}function Zw(n,e){n.F=Date.now(),Qm(n),n.A=qo(n.v);var t=n.A,r=n.X;Array.isArray(r)||(r=[String(r)]),zb(t.h,"t",r),n.C=0,t=n.l.H,n.h=new Rf,n.g=UP(n.l,t?e:null,!n.s),0<n.O&&(n.L=new kb(oi(n.Ia,n,n.g),n.O)),Hw(n.V,n.g,"readystatechange",n.gb),e=n.H?vb(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.A,n.u,n.s,e)):(n.u="GET",n.g.ea(n.A,n.u,null,e)),Af(1),function Fb(n,e,t,r,i,a){n.info(function(){if(n.g)if(a)for(var l="",h=a.split("&"),m=0;m<h.length;m++){var v=h[m].split("=");if(1<v.length){var b=v[0];v=v[1];var D=b.split("_");l=2<=D.length&&"type"==D[1]?l+(b+"=")+v+"&":l+(b+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+l})}(n.j,n.u,n.A,n.m,n.X,n.s)}function Bb(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Ba}function jb(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=MP(n,t),i==Zm){4==e&&(n.o=4,ki(14),r=!1),Su(n.j,n.m,null,"[Incomplete Response]");break}if(i==Km){n.o=4,ki(15),Su(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}Su(n.j,n.m,i,null),Hb(n,i)}Bb(n)&&i!=Zm&&i!=Km&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,ki(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.aa&&(n.aa=!0,(e=n.l).g==n&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),Lf(e),e.L=!0,ki(11))):(Su(n.j,n.m,t,"[Invalid Chunked Response]"),kl(n),Mf(n))}function MP(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?Zm:(t=Number(e.substring(t,r)),isNaN(t)?Km:(r+=1)+t>e.length?Zm:(e=e.substr(r,t),n.C=r+t,e))}function Qm(n){n.Y=Date.now()+n.P,Yw(n,n.P)}function Yw(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=dd(oi(n.eb,n),e)}function Jm(n){n.B&&(jt.clearTimeout(n.B),n.B=null)}function Mf(n){0==n.l.G||n.I||c_(n.l,n)}function kl(n){Jm(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,Bw(n.W),$w(n.V),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Hb(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||t0(t.i,n)))if(t.I=n.N,!n.J&&t0(t.i,n)&&3==t.G){try{var r=t.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;md(t),Tt(t)}Ff(t),ki(18)}}else t.ta=i[1],0<t.ta-t.U&&37500>i[2]&&t.N&&0==t.A&&!t.v&&(t.v=dd(oi(t.ab,t),6e3));if(1>=Zb(t.i)&&t.ka){try{t.ka()}catch{}t.ka=void 0}}else Vf(t,11)}else if((n.J||t.g==n)&&md(t),!Nm(e))for(i=t.Ca.g.parse(e),e=0;e<i.length;e++){let v=i[e];if(t.U=v[0],v=v[1],2==t.G)if("c"==v[0]){t.J=v[1],t.la=v[2];const b=v[3];null!=b&&(t.ma=b,t.h.info("VER="+t.ma));const D=v[4];null!=D&&(t.za=D,t.h.info("SVER="+t.za));const x=v[5];null!=x&&"number"==typeof x&&0<x&&(t.K=r=1.5*x,t.h.info("backChannelRequestTimeoutMs_="+r)),r=t;const j=n.g;if(j){const Q=j.g?j.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Q){var a=r.i;!a.g&&(ai(Q,"spdy")||ai(Q,"quic")||ai(Q,"h2"))&&(a.j=a.l,a.g=new Set,a.h&&(Yb(a,a.h),a.h=null))}if(r.D){const Se=j.g?j.g.getResponseHeader("X-HTTP-Session-Id"):null;Se&&(r.sa=Se,or(r.F,r.D,Se))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-n.F,t.h.info("Handshake RTT: "+t.O+"ms"));var l=n;if((r=t).oa=VP(r,r.H?r.la:null,r.W),l.J){Dx(r.i,l);var h=l,m=r.K;m&&h.setTimeout(m),h.B&&(Jm(h),Qm(h)),r.g=l}else u_(r);0<t.l.length&&un(t)}else"stop"!=v[0]&&"close"!=v[0]||Vf(t,7);else 3==t.G&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?Vf(t,7):dt(t):"noop"!=v[0]&&t.j&&t.j.wa(v),t.A=0)}Af(4)}catch{}}function $b(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(ww(n)||"string"==typeof n)Iw(n,e,void 0);else{if(n.T&&"function"==typeof n.T)var t=n.T();else if(n.R&&"function"==typeof n.R)t=void 0;else if(ww(n)||"string"==typeof n){t=[];for(var r=n.length,i=0;i<r;i++)t.push(i)}else for(i in t=[],r=0,n)t[r++]=i;r=function NP(n){if(n.R&&"function"==typeof n.R)return n.R();if("string"==typeof n)return n.split("");if(ww(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length;for(var a=0;a<i;a++)e.call(void 0,r[a],t&&t[a],n)}}function Nf(n,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var r=0;r<t;r+=2)this.set(arguments[r],arguments[r+1])}else if(n)if(n instanceof Nf)for(t=n.T(),r=0;r<t.length;r++)this.set(t[r],n.get(t[r]));else for(r in n)this.set(r,n[r])}function Gb(n){if(n.i!=n.g.length){for(var e=0,t=0;e<n.g.length;){var r=n.g[e];Ol(n.h,r)&&(n.g[t++]=r),e++}n.g.length=t}if(n.i!=n.g.length){var i={};for(t=e=0;e<n.g.length;)Ol(i,r=n.g[e])||(n.g[t++]=r,i[r]=1),e++;n.g.length=t}}function Ol(n,e){return Object.prototype.hasOwnProperty.call(n,e)}(gt=hd.prototype).setTimeout=function(n){this.P=n},gt.gb=function(n){n=n.target;const e=this.L;e&&3==V(n)?e.l():this.Ia(n)},gt.Ia=function(n){try{if(n==this.g)e:{const b=V(this.g);var e=this.g.Da();const D=this.g.ba();if(!(3>b)&&(3!=b||Pm||this.g&&(this.h.h||this.g.ga()||Z(this.g)))){this.I||4!=b||7==e||Af(8==e||0>=D?3:2),Jm(this);var t=this.g.ba();this.N=t;t:if(Bb(this)){var r=Z(this.g);n="";var i=r.length,a=4==V(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){kl(this),Mf(this);var l="";break t}this.h.i=new jt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:a&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.ga();if(this.i=200==t,function mx(n,e,t,r,i,a,l){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+a+" "+l})}(this.j,this.u,this.A,this.m,this.X,b,t),this.i){if(this.$&&!this.J){t:{if(this.g){var h,m=this.g;if((h=m.g?m.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Nm(h)){var v=h;break t}}v=null}if(!(t=v)){this.i=!1,this.o=3,ki(12),kl(this),Mf(this);break e}Su(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Hb(this,t)}this.U?(jb(this,b,l),Pm&&this.i&&3==b&&(Hw(this.V,this.W,"tick",this.fb),this.W.start())):(Su(this.j,this.m,l,null),Hb(this,l)),4==b&&kl(this),this.i&&!this.I&&(4==b?c_(this.l,this):(this.i=!1,Qm(this)))}else 400==t&&0<l.indexOf("Unknown SID")?(this.o=3,ki(12)):(this.o=0,ki(13)),kl(this),Mf(this)}}}catch{}},gt.fb=function(){if(this.g){var n=V(this.g),e=this.g.ga();this.C<e.length&&(Jm(this),jb(this,n,e),this.i&&4!=n&&Qm(this))}},gt.cancel=function(){this.I=!0,kl(this)},gt.eb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function Au(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Af(3),ki(17)),kl(this),this.o=2,Mf(this)):Yw(this,this.Y-n)},(gt=Nf.prototype).R=function(){Gb(this);for(var n=[],e=0;e<this.g.length;e++)n.push(this.h[this.g[e]]);return n},gt.T=function(){return Gb(this),this.g.concat()},gt.get=function(n,e){return Ol(this.h,n)?this.h[n]:e},gt.set=function(n,e){Ol(this.h,n)||(this.i++,this.g.push(n)),this.h[n]=e},gt.forEach=function(n,e){for(var t=this.T(),r=0;r<t.length;r++){var i=t[r],a=this.get(i);n.call(e,a,i,this)}};var Pf=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Fl(n,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,n instanceof Fl){this.g=void 0!==e?e:n.g,Ko(this,n.j),this.s=n.s,kf(this,n.i),fd(this,n.m),this.l=n.l,e=n.h;var t=new Of;t.i=e.i,e.g&&(t.g=new Nf(e.g),t.h=e.h),Xm(this,t),this.o=n.o}else n&&(t=String(n).match(Pf))?(this.g=!!e,Ko(this,t[1]||"",!0),this.s=t_(t[2]||""),kf(this,t[3]||"",!0),fd(this,t[4]),this.l=t_(t[5]||"",!0),Xm(this,t[6]||"",!0),this.o=t_(t[7]||"")):(this.g=!!e,this.h=new Of(null,this.g))}function qo(n){return new Fl(n)}function Ko(n,e,t){n.j=t?t_(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function kf(n,e,t){n.i=t?t_(e,!0):e}function fd(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Xm(n,e,t){e instanceof Of?(n.h=e,function qb(n,e){e&&!n.j&&(Aa(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(Jw(this,r),zb(this,i,t))},n)),n.j=e}(n.h,n.g)):(t||(e=n_(e,Ix)),n.h=new Of(e,n.g))}function or(n,e,t){n.h.set(e,t)}function pd(n){return or(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function t_(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function n_(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,PP),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function PP(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Fl.prototype.toString=function(){var n=[],e=this.j;e&&n.push(n_(e,wx,!0),":");var t=this.i;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(n_(e,wx,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&n.push("/"),n.push(n_(t,"/"==t.charAt(0)?Ex:Wb,!0))),(t=this.h.toString())&&n.push("?",t),(t=this.o)&&n.push("#",n_(t,Cx)),n.join("")};var wx=/[#\/\?@]/g,Wb=/[#\?:]/g,Ex=/[#\?]/g,Ix=/[#\?@]/g,Cx=/#/g;function Of(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function Aa(n){n.g||(n.g=new Nf,n.h=0,n.i&&function vx(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var a=n[t].substring(0,r);i=n[t].substring(r+1)}else a=n[t];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Jw(n,e){Aa(n),e=gd(n,e),Ol(n.g.h,e)&&(n.i=null,n.h-=n.g.get(e).length,Ol((n=n.g).h,e)&&(delete n.h[e],n.i--,n.g.length>2*n.i&&Gb(n)))}function Xw(n,e){return Aa(n),e=gd(n,e),Ol(n.g.h,e)}function zb(n,e,t){Jw(n,e),0<t.length&&(n.i=null,n.g.set(gd(n,e),Tu(t)),n.h+=t.length)}function gd(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function bx(n){this.l=n||Kb,n=jt.PerformanceNavigationTiming?0<(n=jt.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(jt.g&&jt.g.Ea&&jt.g.Ea()&&jt.g.Ea().Zb),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(gt=Of.prototype).add=function(n,e){Aa(this),this.i=null,n=gd(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},gt.forEach=function(n,e){Aa(this),this.g.forEach(function(t,r){Iw(t,function(i){n.call(e,i,r,this)},this)},this)},gt.T=function(){Aa(this);for(var n=this.g.R(),e=this.g.T(),t=[],r=0;r<e.length;r++)for(var i=n[r],a=0;a<i.length;a++)t.push(e[r]);return t},gt.R=function(n){Aa(this);var e=[];if("string"==typeof n)Xw(this,n)&&(e=Cw(e,this.g.get(gd(this,n))));else{n=this.g.R();for(var t=0;t<n.length;t++)e=Cw(e,n[t])}return e},gt.set=function(n,e){return Aa(this),this.i=null,Xw(this,n=gd(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},gt.get=function(n,e){return n&&0<(n=this.R(n)).length?String(n[0]):e},gt.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var n=[],e=this.g.T(),t=0;t<e.length;t++){var r=e[t],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var l=i;""!==r[a]&&(l+="="+encodeURIComponent(String(r[a]))),n.push(l)}}return this.i=n.join("&")};var Kb=10;function r_(n){return!!n.h||!!n.g&&n.g.size>=n.j}function Zb(n){return n.h?1:n.g?n.g.size:0}function t0(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function Yb(n,e){n.g?n.g.add(e):n.h=e}function Dx(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function Qb(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return Tu(n.i)}function n0(){}function Tx(){this.g=new n0}function kP(n,e,t){const r=t||"";try{$b(n,function(i,a){let l=i;Ml(i)&&(l=Ow(i)),e.push(r+a+"="+encodeURIComponent(l))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function r0(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function i_(n){this.l=n.$b||null,this.j=n.ib||!1}function s0(n,e){ui.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=o0,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}bx.prototype.cancel=function(){if(this.i=Qb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},n0.prototype.stringify=function(n){return jt.JSON.stringify(n,void 0)},n0.prototype.parse=function(n){return jt.JSON.parse(n,void 0)},Wr(i_,zw),i_.prototype.g=function(){return new s0(this.l,this.j)},i_.prototype.i=function(n){return function(){return n}}({}),Wr(s0,ui);var o0=0;function Sx(n){n.j.read().then(n.Sa.bind(n)).catch(n.ha.bind(n))}function s_(n){n.readyState=4,n.l=null,n.j=null,n.A=null,o_(n)}function o_(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(gt=s0.prototype).open=function(n,e){if(this.readyState!=o0)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,o_(this)},gt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||jt).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},gt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,s_(this)),this.readyState=o0},gt.Va=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,o_(this)),this.g&&(this.readyState=3,o_(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof jt.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Sx(this)}else n.text().then(this.Ua.bind(this),this.ha.bind(this))},gt.Sa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?s_(this):o_(this),3==this.readyState&&Sx(this)}},gt.Ua=function(n){this.g&&(this.response=this.responseText=n,s_(this))},gt.Ta=function(n){this.g&&(this.response=n,s_(this))},gt.ha=function(){this.g&&s_(this)},gt.setRequestHeader=function(n,e){this.v.append(n,e)},gt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},gt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(s0.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var FP=jt.JSON.parse;function s(n){ui.call(this),this.headers=new Nf,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=o,this.K=this.L=!1}Wr(s,ui);var o="",u=/^https?$/i,c=["POST","PUT"];function p(n){return"content-type"==n.toLowerCase()}function y(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,E(n),T(n)}function E(n){n.D||(n.D=!0,li(n,"complete"),li(n,"error"))}function C(n){if(n.h&&typeof xm<"u"&&(!n.C[1]||4!=V(n)||2!=n.ba()))if(n.v&&4==V(n))jw(n.Fa,0,n);else if(li(n,"readystatechange"),4==V(n)){n.h=!1;try{const h=n.ba();e:switch(h){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===h){var i=String(n.H).match(Pf)[1]||null;if(!i&&jt.self&&jt.self.location){var a=jt.self.location.protocol;i=a.substr(0,a.length-1)}r=!u.test(i?i.toLowerCase():"")}t=r}if(t)li(n,"complete"),li(n,"success");else{n.m=6;try{var l=2<V(n)?n.g.statusText:""}catch{l=""}n.j=l+" ["+n.ba()+"]",E(n)}}finally{T(n)}}}function T(n,e){if(n.g){A(n);const t=n.g,r=n.C[0]?Du:null;n.g=null,n.C=null,e||li(n,"ready");try{t.onreadystatechange=r}catch{}}}function A(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(jt.clearTimeout(n.A),n.A=null)}function V(n){return n.g?n.g.readyState:0}function Z(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case o:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Me(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=function se(n){let e="";return Dw(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):or(n,e,t))}function qe(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function it(n){this.za=0,this.l=[],this.h=new $m,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=qe("failFast",!1,n),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=qe("baseRetryDelayMs",5e3,n),this.$a=qe("retryDelaySeedMs",1e4,n),this.Ya=qe("forwardChannelMaxRetries",2,n),this.ra=qe("forwardChannelRequestTimeoutMs",2e4,n),this.qa=n&&n.xmlHttpFactory||void 0,this.Ba=n&&n.Yb||!1,this.K=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.J="",this.i=new bx(n&&n.concurrentRequestLimit),this.Ca=new Tx,this.ja=n&&n.fastHandshake||!1,this.Ra=n&&n.Wb||!1,n&&n.Aa&&this.h.Aa(),n&&n.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&n&&n.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!n||!1!==n.Xb}function dt(n){if(Be(n),3==n.G){var e=n.V++,t=qo(n.F);or(t,"SID",n.J),or(t,"RID",e),or(t,"TYPE","terminate"),Ll(n,t),(e=new hd(n,n.h,e,void 0)).K=2,e.v=pd(qo(t)),t=!1,jt.navigator&&jt.navigator.sendBeacon&&(t=jt.navigator.sendBeacon(e.v.toString(),"")),!t&&jt.Image&&((new Image).src=e.v,t=!0),t||(e.g=UP(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Qm(e)}LP(n)}function Tt(n){n.g&&(Lf(n),n.g.cancel(),n.g=null)}function Be(n){Tt(n),n.u&&(jt.clearTimeout(n.u),n.u=null),md(n),n.i.cancel(),n.m&&("number"==typeof n.m&&jt.clearTimeout(n.m),n.m=null)}function bt(n,e){n.l.push(new class{constructor(n,e){this.h=n,this.g=e}}(n.Za++,e)),3==n.G&&un(n)}function un(n){r_(n.i)||n.m||(n.m=!0,ys(n.Ha,n),n.C=0)}function xu(n,e){var t;t=e?e.m:n.V++;const r=qo(n.F);or(r,"SID",n.J),or(r,"RID",t),or(r,"AID",n.U),Ll(n,r),n.o&&n.s&&Me(r,n.o,n.s),t=new hd(n,n.h,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.l=e.D.concat(n.l)),e=a_(n,t,1e3),t.setTimeout(Math.round(.5*n.ra)+Math.round(.5*n.ra*Math.random())),Yb(n.i,t),Ym(t,r,e)}function Ll(n,e){n.j&&$b({},function(t,r){or(e,r,t)})}function a_(n,e,t){t=Math.min(n.l.length,t);var r=n.j?oi(n.j.Oa,n.j,n):null;e:{var i=n.l;let a=-1;for(;;){const l=["count="+t];-1==a?0<t?(a=i[0].h,l.push("ofs="+a)):a=0:l.push("ofs="+a);let h=!0;for(let m=0;m<t;m++){let v=i[m].h;const b=i[m].g;if(v-=a,0>v)a=Math.max(0,i[m].h-100),h=!1;else try{kP(b,l,"req"+v+"_")}catch{r&&r(b)}}if(h){r=l.join("&");break e}}}return n=n.l.splice(0,t),e.D=n,r}function u_(n){n.g||n.u||(n.Y=1,ys(n.Ga,n),n.A=0)}function Ff(n){return!(n.g||n.u||3<=n.A||(n.Y++,n.u=dd(oi(n.Ga,n),d_(n,n.A)),n.A++,0))}function Lf(n){null!=n.B&&(jt.clearTimeout(n.B),n.B=null)}function l_(n){n.g=new hd(n,n.h,"rpc",n.Y),null===n.o&&(n.g.H=n.s),n.g.O=0;var e=qo(n.oa);or(e,"RID","rpc"),or(e,"SID",n.J),or(e,"CI",n.N?"0":"1"),or(e,"AID",n.U),Ll(n,e),or(e,"TYPE","xmlhttp"),n.o&&n.s&&Me(e,n.o,n.s),n.K&&n.g.setTimeout(n.K);var t=n.g;n=n.la,t.K=1,t.v=pd(qo(e)),t.s=null,t.U=!0,Zw(t,n)}function md(n){null!=n.v&&(jt.clearTimeout(n.v),n.v=null)}function c_(n,e){var t=null;if(n.g==e){md(n),Lf(n),n.g=null;var r=2}else{if(!t0(n.i,e))return;t=e.D,Dx(n.i,e),r=1}if(n.I=e.N,0!=n.G)if(e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;li(r=Gm(),new Ub(r,t,e,i)),un(n)}else u_(n);else if(3==(i=e.o)||0==i&&0<n.I||!(1==r&&function Xn(n,e){return!(Zb(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.l=e.D.concat(n.l),0):1==n.G||2==n.G||n.C>=(n.Xa?0:n.Ya)||(n.m=dd(oi(n.Ha,n,e),d_(n,n.C)),n.C++,0)))}(n,e)||2==r&&Ff(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:Vf(n,5);break;case 4:Vf(n,10);break;case 3:Vf(n,6);break;default:Vf(n,2)}}function d_(n,e){let t=n.Pa+Math.floor(Math.random()*n.$a);return n.j||(t*=2),t*e}function Vf(n,e){if(n.h.info("Error code "+e),2==e){var t=null;n.j&&(t=null);var r=oi(n.jb,n);t||(t=new Fl("//www.google.com/images/cleardot.gif"),jt.location&&"http"==jt.location.protocol||Ko(t,"https"),pd(t)),function OP(n,e){const t=new $m;if(jt.Image){const r=new Image;r.onload=ad(r0,t,r,"TestLoadImage: loaded",!0,e),r.onerror=ad(r0,t,r,"TestLoadImage: error",!1,e),r.onabort=ad(r0,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=ad(r0,t,r,"TestLoadImage: timeout",!1,e),jt.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else ki(2);n.G=0,n.j&&n.j.va(e),LP(n),Be(n)}function LP(n){n.G=0,n.I=-1,n.j&&((0!=Qb(n.i).length||0!=n.l.length)&&(n.i.i.length=0,Tu(n.l),n.l.length=0),n.j.ua())}function VP(n,e,t){let r=function Qw(n){return n instanceof Fl?qo(n):new Fl(n,void 0)}(t);if(""!=r.i)e&&kf(r,e+"."+r.i),fd(r,r.m);else{const i=jt.location;r=function e_(n,e,t,r){var i=new Fl(null,void 0);return n&&Ko(i,n),e&&kf(i,e),t&&fd(i,t),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,t)}return n.aa&&Dw(n.aa,function(i,a){or(r,a,i)}),t=n.sa,(e=n.D)&&t&&or(r,e,t),or(r,"VER",n.ma),Ll(n,r),r}function UP(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new s(t&&n.Ba&&!n.qa?new i_({ib:!0}):n.qa)).L=n.H,e}function BP(){}function Jb(){if(ud&&!(10<=Number(DP)))throw Error("Environmental error: no available transport.")}function po(n,e){ui.call(this),this.g=new it(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.P=n,(n=e&&e.httpHeadersOverwriteParam)&&!Nm(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Nm(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new h_(this)}function jP(n){Wm.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function HP(){zm.call(this),this.status=1}function h_(n){this.g=n}(gt=s.prototype).ea=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Kw.g(),this.C=function qw(n){return n.h||(n.h=n.i())}(this.u?this.u:Kw),this.g.onreadystatechange=oi(this.Fa,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(a){return void y(this,a)}n=t||"";const i=new Nf(this.headers);r&&$b(r,function(a,l){i.set(l,a)}),r=function lx(n){e:{var e=p;const t=n.length,r="string"==typeof n?n.split(""):n;for(let i=0;i<t;i++)if(i in r&&e.call(void 0,r[i],i,n)){e=i;break e}e=-1}return 0>e?null:"string"==typeof n?n.charAt(e):n[e]}(i.T()),t=jt.FormData&&n instanceof jt.FormData,!(0<=ux(c,e))||r||t||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(a,l){this.g.setRequestHeader(l,a)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{A(this),0<this.B&&((this.K=function d(n){return ud&&function Db(){return function wb(n){var e=bP;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=bw(String(Df)).split("."),t=bw("9").split("."),r=Math.max(e.length,t.length);for(let l=0;0==n&&l<r;l++){var i=e[l]||"",a=t[l]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==i[0].length&&0==a[0].length)break;n=_b(0==i[1].length?0:parseInt(i[1],10),0==a[1].length?0:parseInt(a[1],10))||_b(0==i[2].length,0==a[2].length)||_b(i[2],a[2]),i=i[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=oi(this.pa,this)):this.A=jw(this.pa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){y(this,a)}},gt.pa=function(){typeof xm<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,li(this,"timeout"),this.abort(8))},gt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,li(this,"complete"),li(this,"abort"),T(this))},gt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),T(this,!0)),s.Z.M.call(this)},gt.Fa=function(){this.s||(this.F||this.v||this.l?C(this):this.cb())},gt.cb=function(){C(this)},gt.ba=function(){try{return 2<V(this)?this.g.status:-1}catch{return-1}},gt.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}},gt.Qa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),FP(e)}},gt.Da=function(){return this.m},gt.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(gt=it.prototype).ma=8,gt.G=1,gt.hb=function(n){try{this.h.info("Origin Trials invoked: "+n)}catch{}},gt.Ha=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.V=Math.floor(1e5*Math.random()),n=this.V++;const i=new hd(this,this.h,n,void 0);let a=this.s;if(this.P&&(a?(a=vb(a),Sw(a,this.P)):a=this.P),null===this.o&&(i.H=a),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var r=this.l[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=a_(this,i,e),or(t=qo(this.F),"RID",n),or(t,"CVER",22),this.D&&or(t,"X-HTTP-Session-Id",this.D),Ll(this,t),this.o&&a&&Me(t,this.o,a),Yb(this.i,i),this.Ra&&or(t,"TYPE","init"),this.ja?(or(t,"$req",e),or(t,"SID","null"),i.$=!0,Ym(i,t,null)):Ym(i,t,e),this.G=2}}else 3==this.G&&(n?xu(this,n):0==this.l.length||r_(this.i)||xu(this))},gt.Ga=function(){if(this.u=null,l_(this),this.$&&!(this.L||null==this.g||0>=this.O)){var n=2*this.O;this.h.info("BP detection timer enabled: "+n),this.B=dd(oi(this.bb,this),n)}},gt.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ki(10),Tt(this),l_(this))},gt.ab=function(){null!=this.v&&(this.v=null,Tt(this),Ff(this),ki(19))},gt.jb=function(n){n?(this.h.info("Successfully pinged google.com"),ki(2)):(this.h.info("Failed to ping google.com"),ki(1))},(gt=BP.prototype).xa=function(){},gt.wa=function(){},gt.va=function(){},gt.ua=function(){},gt.Oa=function(){},Jb.prototype.g=function(n,e){return new po(n,e)},Wr(po,ui),po.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;n.Wa&&(n.h.info("Origin Trials enabled."),ys(oi(n.hb,n,e))),ki(0),n.W=e,n.aa=t||{},n.N=n.X,n.F=VP(n,null,n.W),un(n)},po.prototype.close=function(){dt(this.g)},po.prototype.u=function(n){if("string"==typeof n){var e={};e.__data__=n,bt(this.g,e)}else this.v?((e={}).__data__=Ow(n),bt(this.g,e)):bt(this.g,n)},po.prototype.M=function(){this.g.j=null,delete this.j,dt(this.g),delete this.g,po.Z.M.call(this)},Wr(jP,Wm),Wr(HP,zm),Wr(h_,BP),h_.prototype.xa=function(){li(this.g,"a")},h_.prototype.wa=function(n){li(this.g,new jP(n))},h_.prototype.va=function(n){li(this.g,new HP(n))},h_.prototype.ua=function(){li(this.g,"b")},Jb.prototype.createWebChannel=Jb.prototype.g,po.prototype.send=po.prototype.u,po.prototype.open=po.prototype.m,po.prototype.close=po.prototype.close,Gw.NO_ERROR=0,Gw.TIMEOUT=8,Gw.HTTP_ERROR=6,Ww.COMPLETE="complete",yx.EventType=Pl,Pl.OPEN="a",Pl.CLOSE="b",Pl.ERROR="c",Pl.MESSAGE="d",ui.prototype.listen=ui.prototype.N,s.prototype.listenOnce=s.prototype.O,s.prototype.getLastError=s.prototype.La,s.prototype.getLastErrorCode=s.prototype.Da,s.prototype.getStatus=s.prototype.ba,s.prototype.getResponseJson=s.prototype.Qa,s.prototype.getResponseText=s.prototype.ga,s.prototype.send=s.prototype.ea;var uV=bu.createWebChannelTransport=function(){return new Jb},lV=bu.getStatEventTarget=function(){return Gm()},Ax=bu.ErrorCode=Gw,cV=bu.EventType=Ww,dV=bu.Event=Sa,$P=bu.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},hV=bu.FetchXmlHttpFactory=i_,Xb=bu.WebChannel=yx,fV=bu.XhrIo=s;const GP="@firebase/firestore";class yi{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yi.UNAUTHENTICATED=new yi(null),yi.GOOGLE_CREDENTIALS=new yi("google-credentials-uid"),yi.FIRST_PARTY=new yi("first-party-uid"),yi.MOCK_USER=new yi("mock-user");let f_="9.9.1";const _d=new mi.Yd("@firebase/firestore");function xx(){return _d.logLevel}function Ze(n,...e){if(_d.logLevel<=mi.in.DEBUG){const t=e.map(Rx);_d.debug(`Firestore (${f_}): ${n}`,...t)}}function zr(n,...e){if(_d.logLevel<=mi.in.ERROR){const t=e.map(Rx);_d.error(`Firestore (${f_}): ${n}`,...t)}}function a0(n,...e){if(_d.logLevel<=mi.in.WARN){const t=e.map(Rx);_d.warn(`Firestore (${f_}): ${n}`,...t)}}function Rx(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function _t(n="Unexpected state"){const e=`FIRESTORE (${f_}) INTERNAL ASSERTION FAILED: `+n;throw zr(e),new Error(e)}function Ht(n,e){n||_t()}function lt(n,e){return n}const Ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ge extends R.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class vi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class WP{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(yi.UNAUTHENTICATED))}shutdown(){}}class _V{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class yV{constructor(e){this.t=e,this.currentUser=yi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const a=v=>this.i!==i?(i=this.i,t(v)):Promise.resolve();let l=new vi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new vi,e.enqueueRetryable(()=>a(this.currentUser))};const h=()=>{const v=l;e.enqueueRetryable((0,xe.Z)(function*(){yield v.promise,yield a(r.currentUser)}))},m=v=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=v,this.auth.addAuthTokenListener(this.o),h()};this.t.onInit(v=>m(v)),setTimeout(()=>{if(!this.auth){const v=this.t.getImmediate({optional:!0});v?m(v):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new vi)}},0),h()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ht("string"==typeof r.accessToken),new WP(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Ht(null===e||"string"==typeof e),new yi(e)}}class vV{constructor(e,t,r){this.type="FirstParty",this.user=yi.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const i=e.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}}class wV{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new vV(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(yi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class zP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class EV{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const r=a=>{null!=a.error&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.p;return this.p=a.token,Ze("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.g.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.g.getImmediate({optional:!0});a?i(a):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ht("string"==typeof t.token),this.p=t.token,new zP(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function IV(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class qP{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=IV(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%e.length))}return r}}function sn(n,e){return n<e?-1:n>e?1:0}function p_(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function KP(n){return n+"\0"}class yr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ge(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ge(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ge(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ge(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return yr.fromMillis(Date.now())}static fromDate(e){return yr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new yr(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?sn(this.nanoseconds,e.nanoseconds):sn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Vt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Vt(e)}static min(){return new Vt(new yr(0,0))}static max(){return new Vt(new yr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class u0{constructor(e,t,r){void 0===t?t=0:t>e.length&&_t(),void 0===r?r=e.length-t:r>e.length-t&&_t(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===u0.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof u0?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=e.get(i),l=t.get(i);if(a<l)return-1;if(a>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class xn extends u0{construct(e,t,r){return new xn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ge(Ee.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new xn(t)}static emptyPath(){return new xn([])}}const CV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vr extends u0{construct(e,t,r){return new Vr(e,t,r)}static isValidIdentifier(e){return CV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Vr(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(0===r.length)throw new Ge(Ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const h=e[i];if("\\"===h){if(i+1===e.length)throw new Ge(Ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[i+1];if("\\"!==m&&"."!==m&&"`"!==m)throw new Ge(Ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=m,i+=2}else"`"===h?(l=!l,i++):"."!==h||l?(r+=h,i++):(a(),i++)}if(a(),l)throw new Ge(Ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Vr(t)}static emptyPath(){return new Vr([])}}class st{constructor(e){this.path=e}static fromPath(e){return new st(xn.fromString(e))}static fromName(e){return new st(xn.fromString(e).popFirst(5))}static empty(){return new st(xn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===xn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return xn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new st(new xn(e.slice()))}}class eD{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function Mx(n){return n.fields.find(e=>2===e.kind)}function Uf(n){return n.fields.filter(e=>2!==e.kind)}eD.UNKNOWN_ID=-1;class tD{constructor(e,t){this.fieldPath=e,this.kind=t}}class l0{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new l0(0,go.min())}}function ZP(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Vt.fromTimestamp(1e9===r?new yr(t+1,0):new yr(t,r));return new go(i,st.empty(),e)}function YP(n){return new go(n.readTime,n.key,-1)}class go{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new go(Vt.min(),st.empty(),-1)}static max(){return new go(Vt.max(),st.empty(),-1)}}function Nx(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=st.comparator(n.documentKey,e.documentKey),0!==t?t:sn(n.largestBatchId,e.largestBatchId))}const QP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class JP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function yd(n){return Px.apply(this,arguments)}function Px(){return Px=(0,xe.Z)(function*(n){if(n.code!==Ee.FAILED_PRECONDITION||n.message!==QP)throw n;Ze("LocalStore","Unexpectedly lost primary lease")}),Px.apply(this,arguments)}class he{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_t(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new he((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof he?t:he.resolve(t)}catch(t){return he.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):he.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):he.reject(t)}static resolve(e){return new he((t,r)=>{t(e)})}static reject(e){return new he((t,r)=>{r(e)})}static waitFor(e){return new he((t,r)=>{let i=0,a=0,l=!1;e.forEach(h=>{++i,h.next(()=>{++a,l&&a===i&&t()},m=>r(m))}),l=!0,a===i&&t()})}static or(e){let t=he.resolve(!1);for(const r of e)t=t.next(i=>i?he.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new he((r,i)=>{const a=e.length,l=new Array(a);let h=0;for(let m=0;m<a;m++){const v=m;t(e[v]).next(b=>{l[v]=b,++h,h===a&&r(l)},b=>i(b))}})}static doWhile(e,t){return new he((r,i)=>{const a=()=>{!0===e()?t().next(()=>{a()},i):r()};a()})}}class nD{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.T=new vi,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{t.error?this.T.reject(new c0(e,t.error)):this.T.resolve()},this.transaction.onerror=r=>{const i=kx(r.target.error);this.T.reject(new c0(e,i))}}static open(e,t,r,i){try{return new nD(t,e.transaction(i,r))}catch(a){throw new c0(t,a)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(Ze("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new DV(t)}}class xa{constructor(e,t,r){this.name=e,this.version=t,this.P=r,12.2===xa.v((0,R.z$)())&&zr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Ze("SimpleDb","Removing database:",e),Bf(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!(0,R.hl)())return!1;if(xa.S())return!0;const e=(0,R.z$)(),t=xa.v(e),r=0<t&&t<10,i=xa.D(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static S(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.C)}static N(e,t){return e.store(t)}static v(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static D(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}k(e){var t=this;return(0,xe.Z)(function*(){return t.db||(Ze("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const a=indexedDB.open(t.name,t.version);a.onsuccess=l=>{r(l.target.result)},a.onblocked=()=>{i(new c0(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const h=l.target.error;i("VersionError"===h.name?new Ge(Ee.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===h.name?new Ge(Ee.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+h):new c0(e,h))},a.onupgradeneeded=l=>{Ze("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',l.oldVersion),t.P.O(l.target.result,a.transaction,l.oldVersion,t.version).next(()=>{Ze("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.M&&(t.db.onversionchange=r=>t.M(r)),t.db})()}F(e){this.M=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var a=this;return(0,xe.Z)(function*(){const l="readonly"===t;let h=0;for(;;){++h;try{a.db=yield a.k(e);const m=nD.open(a.db,e,l?"readonly":"readwrite",r),v=i(m).next(b=>(m.R(),b)).catch(b=>(m.abort(b),he.reject(b))).toPromise();return v.catch(()=>{}),yield m.A,v}catch(m){const v=m,b="FirebaseError"!==v.name&&h<3;if(Ze("SimpleDb","Transaction failed with error:",v.message,"Retrying:",b),a.close(),!b)return Promise.reject(v)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class bV{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Bf(this.$.delete())}}class c0 extends Ge{constructor(e,t){super(Ee.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function vd(n){return"IndexedDbTransactionError"===n.name}class DV{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(Ze("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ze("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Bf(r)}add(e){return Ze("SimpleDb","ADD",this.store.name,e,e),Bf(this.store.add(e))}get(e){return Bf(this.store.get(e)).next(t=>(void 0===t&&(t=null),Ze("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Ze("SimpleDb","DELETE",this.store.name,e),Bf(this.store.delete(e))}count(){return Ze("SimpleDb","COUNT",this.store.name),Bf(this.store.count())}K(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),a=[];return this.G(i,(l,h)=>{a.push(h)}).next(()=>a)}{const i=this.store.getAll(r.range);return new he((a,l)=>{i.onerror=h=>{l(h.target.error)},i.onsuccess=h=>{a(h.target.result)}})}}j(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new he((i,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{i(l.target.result)}})}W(e,t){Ze("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.G(i,(a,l,h)=>h.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.G(i,t)}Y(e){const t=this.cursor({});return new he((r,i)=>{t.onerror=a=>{const l=kx(a.target.error);i(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next(h=>{h?l.continue():r()}):r()}})}G(e,t){const r=[];return new he((i,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const h=l.target.result;if(!h)return void i();const m=new bV(h),v=t(h.primaryKey,h.value,m);if(v instanceof he){const b=v.catch(D=>(m.done(),he.reject(D)));r.push(b)}m.isDone?i():null===m.U?h.continue():h.continue(m.U)}}).next(()=>he.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Bf(n){return new he((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=kx(r.target.error);t(i)}})}let XP=!1;function kx(n){const e=xa.v((0,R.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ge("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return XP||(XP=!0,setTimeout(()=>{throw r},0)),r}}return n}class TV{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}Z(e){var t=this;Ze("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,xe.Z)(function*(){t.task=null;try{Ze("IndexBackiller",`Documents written: ${yield t.X.tt()}`)}catch(r){vd(r)?Ze("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield yd(r)}yield t.Z(1)}))}}class SV{constructor(e,t){this.localStore=e,this.persistence=t}tt(e=50){var t=this;return(0,xe.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.et(r,e))})()}et(e,t){const r=new Set;let i=t,a=!0;return he.doWhile(()=>!0===a&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(null!==l&&!r.has(l))return Ze("IndexBackiller",`Processing collection: ${l}`),this.nt(e,l,i).next(h=>{i-=h,r.add(l)});a=!1})).next(()=>t-i)}nt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.st(i,a)).next(h=>(Ze("IndexBackiller",`Updating offset: ${h}`),this.localStore.indexManager.updateCollectionGroup(e,t,h))).next(()=>l.size)}))}st(e,t){let r=e;return t.changes.forEach((i,a)=>{const l=YP(a);Nx(l,r)>0&&(r=l)}),new go(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Fs{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.it(r),this.rt=r=>t.writeSequenceNumber(r))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function ek(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function jf(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function tk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}Fs.ot=-1;class Pr{constructor(e,t){this.comparator=e,this.root=t||Oi.EMPTY}insert(e,t){return new Pr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Oi.BLACK,null,null))}remove(e){return new Pr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Oi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rD(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rD(this.root,e,this.comparator,!1)}getReverseIterator(){return new rD(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rD(this.root,e,this.comparator,!0)}}class rD{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Oi{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??Oi.RED,this.left=i??Oi.EMPTY,this.right=a??Oi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new Oi(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Oi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Oi.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Oi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Oi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw _t();const e=this.left.check();if(e!==this.right.check())throw _t();return e+(this.isRed()?0:1)}}Oi.EMPTY=null,Oi.RED=!0,Oi.BLACK=!1,Oi.EMPTY=new class{constructor(){this.size=0}get key(){throw _t()}get value(){throw _t()}get color(){throw _t()}get left(){throw _t()}get right(){throw _t()}copy(n,e,t,r,i){return this}insert(n,e,t){return new Oi(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class qn{constructor(e){this.comparator=e,this.data=new Pr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nk(this.data.getIterator())}getIteratorFrom(e){return new nk(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof qn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new qn(this.comparator);return t.data=e,t}}class nk{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function g_(n){return n.hasNext()?n.getNext():void 0}class mo{constructor(e){this.fields=e,e.sort(Vr.comparator)}static empty(){return new mo([])}unionWith(e){let t=new qn(Vr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new mo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return p_(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class ci{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new ci(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new ci(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return sn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ci.EMPTY_BYTE_STRING=new ci("");const xV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wd(n){if(Ht(!!n),"string"==typeof n){let e=0;const t=xV.exec(n);if(Ht(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:kr(n.seconds),nanos:kr(n.nanos)}}function kr(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Hf(n){return"string"==typeof n?ci.fromBase64String(n):ci.fromUint8Array(n)}function Ox(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function rk(n){const e=n.mapValue.fields.__previous_value__;return Ox(e)?rk(e):e}function d0(n){const e=wd(n.mapValue.fields.__local_write_time__.timestampValue);return new yr(e.seconds,e.nanos)}class RV{constructor(e,t,r,i,a,l,h,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.useFetchStreams=m}}class Vl{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Vl("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Vl&&e.projectId===this.projectId&&e.database===this.database}}function h0(n){return null==n}function f0(n){return 0===n&&1/n==-1/0}function ik(n){return"number"==typeof n&&Number.isInteger(n)&&!f0(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Ed={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},iD={nullValue:"NULL_VALUE"};function $f(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ox(n)?4:uk(n)?9007199254740991:10:_t()}function Ru(n,e){if(n===e)return!0;const t=$f(n);if(t!==$f(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return d0(n).isEqual(d0(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=wd(r.timestampValue),l=wd(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,Hf(n.bytesValue).isEqual(Hf(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return kr(r.geoPointValue.latitude)===kr(i.geoPointValue.latitude)&&kr(r.geoPointValue.longitude)===kr(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return kr(r.integerValue)===kr(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=kr(r.doubleValue),l=kr(i.doubleValue);return a===l?f0(a)===f0(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return p_(n.arrayValue.values||[],e.arrayValue.values||[],Ru);case 10:return function(r,i){const a=r.mapValue.fields||{},l=i.mapValue.fields||{};if(ek(a)!==ek(l))return!1;for(const h in a)if(a.hasOwnProperty(h)&&(void 0===l[h]||!Ru(a[h],l[h])))return!1;return!0}(n,e);default:return _t()}var i}function p0(n,e){return void 0!==(n.values||[]).find(t=>Ru(t,e))}function Id(n,e){if(n===e)return 0;const t=$f(n),r=$f(e);if(t!==r)return sn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return sn(n.booleanValue,e.booleanValue);case 2:return function(i,a){const l=kr(i.integerValue||i.doubleValue),h=kr(a.integerValue||a.doubleValue);return l<h?-1:l>h?1:l===h?0:isNaN(l)?isNaN(h)?0:-1:1}(n,e);case 3:return sk(n.timestampValue,e.timestampValue);case 4:return sk(d0(n),d0(e));case 5:return sn(n.stringValue,e.stringValue);case 6:return function(i,a){const l=Hf(i),h=Hf(a);return l.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),h=a.split("/");for(let m=0;m<l.length&&m<h.length;m++){const v=sn(l[m],h[m]);if(0!==v)return v}return sn(l.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const l=sn(kr(i.latitude),kr(a.latitude));return 0!==l?l:sn(kr(i.longitude),kr(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,a){const l=i.values||[],h=a.values||[];for(let m=0;m<l.length&&m<h.length;++m){const v=Id(l[m],h[m]);if(v)return v}return sn(l.length,h.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===Ed.mapValue&&a===Ed.mapValue)return 0;if(i===Ed.mapValue)return 1;if(a===Ed.mapValue)return-1;const l=i.fields||{},h=Object.keys(l),m=a.fields||{},v=Object.keys(m);h.sort(),v.sort();for(let b=0;b<h.length&&b<v.length;++b){const D=sn(h[b],v[b]);if(0!==D)return D;const x=Id(l[h[b]],m[v[b]]);if(0!==x)return x}return sn(h.length,v.length)}(n.mapValue,e.mapValue);default:throw _t()}}function sk(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return sn(n,e);const t=wd(n),r=wd(e),i=sn(t.seconds,r.seconds);return 0!==i?i:sn(t.nanos,r.nanos)}function m_(n){return Fx(n)}function Fx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=wd(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Hf(n.bytesValue).toBase64():"referenceValue"in n?st.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",a=!0;for(const l of r.values||[])a?a=!1:i+=",",i+=Fx(l);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let a="{",l=!0;for(const h of i)l?l=!1:a+=",",a+=`${h}:${Fx(r.fields[h])}`;return a+"}"}(n.mapValue):_t();var e}function Gf(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Lx(n){return!!n&&"integerValue"in n}function g0(n){return!!n&&"arrayValue"in n}function ok(n){return!!n&&"nullValue"in n}function ak(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function sD(n){return!!n&&"mapValue"in n}function m0(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return jf(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=m0(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=m0(n.arrayValue.values[t]);return e}return Object.assign({},n)}function uk(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function MV(n){return"nullValue"in n?iD:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Gf(Vl.empty(),st.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:_t()}function NV(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Gf(Vl.empty(),st.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Ed:_t()}function lk(n,e){const t=Id(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function ck(n,e){const t=Id(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Fi{constructor(e){this.value=e}static empty(){return new Fi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!sD(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=m0(t)}setAll(e){let t=Vr.emptyPath(),r={},i=[];e.forEach((l,h)=>{if(!t.isImmediateParentOf(h)){const m=this.getFieldsMap(t);this.applyChanges(m,r,i),r={},i=[],t=h.popLast()}l?r[h.lastSegment()]=m0(l):i.push(h.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());sD(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ru(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];sD(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){jf(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new Fi(m0(this.value))}}function dk(n){const e=[];return jf(n.fields,(t,r)=>{const i=new Vr([t]);if(sD(r)){const a=dk(r.mapValue).fields;if(0===a.length)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new mo(e)}class ar{constructor(e,t,r,i,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new ar(e,0,Vt.min(),Vt.min(),Fi.empty(),0)}static newFoundDocument(e,t,r){return new ar(e,1,t,Vt.min(),r,0)}static newNoDocument(e,t){return new ar(e,2,t,Vt.min(),Fi.empty(),0)}static newUnknownDocument(e,t){return new ar(e,3,t,Vt.min(),Fi.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Vt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ar&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ar(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class PV{constructor(e,t=null,r=[],i=[],a=null,l=null,h=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=l,this.endAt=h,this.ut=null}}function hk(n,e=null,t=[],r=[],i=null,a=null,l=null){return new PV(n,e,t,r,i,a,l)}function Wf(n){const e=lt(n);if(null===e.ut){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+m_(i.value);var i}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),h0(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>m_(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>m_(r)).join(",")),e.ut=t}return e.ut}function _0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!HV(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if((t=n.filters[i]).op!==(r=e.filters[i]).op||!t.field.isEqual(r.field)||!Ru(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!_k(n.startAt,e.startAt)&&_k(n.endAt,e.endAt)}function oD(n){return st.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function aD(n,e){return n.filters.filter(t=>t instanceof Li&&t.field.isEqual(e))}function fk(n,e,t){let r=iD,i=!0;for(const a of aD(n,e)){let l=iD,h=!0;switch(a.op){case"<":case"<=":l=MV(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,h=!1;break;case"!=":case"not-in":l=iD}lk({value:r,inclusive:i},{value:l,inclusive:h})<0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];lk({value:r,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}function pk(n,e,t){let r=Ed,i=!0;for(const a of aD(n,e)){let l=Ed,h=!0;switch(a.op){case">=":case">":l=NV(a.value),h=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,h=!1;break;case"!=":case"not-in":l=Ed}ck({value:r,inclusive:i},{value:l,inclusive:h})>0&&(r=l,i=h)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];ck({value:r,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}class Li extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new OV(e,t,r):"array-contains"===t?new VV(e,r):"in"===t?new UV(e,r):"not-in"===t?new BV(e,r):"array-contains-any"===t?new jV(e,r):new Li(e,t,r)}static ct(e,t,r){return"in"===t?new FV(e,r):new LV(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(Id(t,this.value)):null!==t&&$f(this.value)===$f(t)&&this.at(Id(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return _t()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class OV extends Li{constructor(e,t,r){super(e,t,r),this.key=st.fromName(r.referenceValue)}matches(e){const t=st.comparator(e.key,this.key);return this.at(t)}}class FV extends Li{constructor(e,t){super(e,"in",t),this.keys=gk(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class LV extends Li{constructor(e,t){super(e,"not-in",t),this.keys=gk(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function gk(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>st.fromName(r.referenceValue))}class VV extends Li{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return g0(t)&&p0(t.arrayValue,this.value)}}class UV extends Li{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&p0(this.value.arrayValue,t)}}class BV extends Li{constructor(e,t){super(e,"not-in",t)}matches(e){if(p0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!p0(this.value.arrayValue,t)}}class jV extends Li{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!g0(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>p0(this.value.arrayValue,r))}}class Cd{constructor(e,t){this.position=e,this.inclusive=t}}class __{constructor(e,t="asc"){this.field=e,this.dir=t}}function HV(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function mk(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(r=a.field.isKeyField()?st.comparator(st.fromName(l.referenceValue),t.key):Id(l,t.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function _k(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ru(n.position[t],e.position[t]))return!1;return!0}class Ul{constructor(e,t=null,r=[],i=[],a=null,l="F",h=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=l,this.startAt=h,this.endAt=m,this.lt=null,this.ft=null}}function yk(n,e,t,r,i,a,l,h){return new Ul(n,e,t,r,i,a,l,h)}function y_(n){return new Ul(n)}function Vx(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function Ux(n){for(const e of n.filters)if(e.ht())return e.field;return null}function Bx(n){return null!==n.collectionGroup}function v_(n){const e=lt(n);if(null===e.lt){e.lt=[];const t=Ux(e),r=Vx(e);if(null!==t&&null===r)t.isKeyField()||e.lt.push(new __(t)),e.lt.push(new __(Vr.keyField(),"asc"));else{let i=!1;for(const a of e.explicitOrderBy)e.lt.push(a),a.field.isKeyField()&&(i=!0);if(!i){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new __(Vr.keyField(),a))}}}return e.lt}function Zo(n){const e=lt(n);if(!e.ft)if("F"===e.limitType)e.ft=hk(e.path,e.collectionGroup,v_(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of v_(e))t.push(new __(a.field,"desc"===a.dir?"asc":"desc"));const r=e.endAt?new Cd(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Cd(e.startAt.position,e.startAt.inclusive):null;e.ft=hk(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.ft}function vk(n,e,t){return new Ul(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function y0(n,e){return _0(Zo(n),Zo(e))&&n.limitType===e.limitType}function wk(n){return`${Wf(Zo(n))}|lt:${n.limitType}`}function jx(n){return`Query(target=${function kV(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${m_(r.value)}`;var r}).join(", ")}]`),h0(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>m_(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>m_(t)).join(",")),`Target(${e})`}(Zo(n))}; limitType=${n.limitType})`}function Hx(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):st.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of t.explicitOrderBy)if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,a,l){const h=mk(i,a,l);return i.inclusive?h<=0:h<0}(t.startAt,v_(t),r)||t.endAt&&!function(i,a,l){const h=mk(i,a,l);return i.inclusive?h>=0:h>0}(t.endAt,v_(t),r)));var t,r}function Ek(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Ik(n){return(e,t)=>{let r=!1;for(const i of v_(n)){const a=GV(i,e,t);if(0!==a)return a;r=r||i.field.isKeyField()}return 0}}function GV(n,e,t){const r=n.field.isKeyField()?st.comparator(e.key,t.key):function(i,a,l){const h=a.data.field(i),m=l.data.field(i);return null!==h&&null!==m?Id(h,m):_t()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return _t()}}function Ck(n,e){if(n.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:f0(e)?"-0":e}}function bk(n){return{integerValue:""+n}}function Dk(n,e){return ik(e)?bk(e):Ck(n,e)}class uD{constructor(){this._=void 0}}function WV(n,e,t){return n instanceof w_?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof zf?Sk(n,e):n instanceof qf?Ak(n,e):function(r,i){const a=Tk(r,i),l=xk(a)+xk(r._t);return Lx(a)&&Lx(r._t)?bk(l):Ck(r.wt,l)}(n,e)}function zV(n,e,t){return n instanceof zf?Sk(n,e):n instanceof qf?Ak(n,e):t}function Tk(n,e){return n instanceof E_?Lx(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class w_ extends uD{}class zf extends uD{constructor(e){super(),this.elements=e}}function Sk(n,e){const t=Rk(e);for(const r of n.elements)t.some(i=>Ru(i,r))||t.push(r);return{arrayValue:{values:t}}}class qf extends uD{constructor(e){super(),this.elements=e}}function Ak(n,e){let t=Rk(e);for(const r of n.elements)t=t.filter(i=>!Ru(i,r));return{arrayValue:{values:t}}}class E_ extends uD{constructor(e,t){super(),this.wt=e,this._t=t}}function xk(n){return kr(n.integerValue||n.doubleValue)}function Rk(n){return g0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class v0{constructor(e,t){this.field=e,this.transform=t}}class KV{constructor(e,t){this.version=e,this.transformResults=t}}class br{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new br}static exists(e){return new br(void 0,e)}static updateTime(e){return new br(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lD(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class cD{}function Mk(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new C_(n.key,br.none()):new I_(n.key,n.data,br.none());{const t=n.data,r=Fi.empty();let i=new qn(Vr.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);null===l&&a.length>1&&(a=a.popLast(),l=t.field(a)),null===l?r.delete(a):r.set(a,l),i=i.add(a)}return new Bl(n.key,r,new mo(i.toArray()),br.none())}}function ZV(n,e,t){n instanceof I_?function(r,i,a){const l=r.value.clone(),h=kk(r.fieldTransforms,i,a.transformResults);l.setAll(h),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof Bl?function(r,i,a){if(!lD(r.precondition,i))return void i.convertToUnknownDocument(a.version);const l=kk(r.fieldTransforms,i,a.transformResults),h=i.data;h.setAll(Pk(r)),h.setAll(l),i.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function w0(n,e,t,r){return n instanceof I_?function(i,a,l,h){if(!lD(i.precondition,a))return l;const m=i.value.clone(),v=Ok(i.fieldTransforms,h,a);return m.setAll(v),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),null}(n,e,t,r):n instanceof Bl?function(i,a,l,h){if(!lD(i.precondition,a))return l;const m=Ok(i.fieldTransforms,h,a),v=a.data;return v.setAll(Pk(i)),v.setAll(m),a.convertToFoundDocument(a.version,v).setHasLocalMutations(),null===l?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(b=>b.field))}(n,e,t,r):(l=t,lD(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l);var a,l}function YV(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=Tk(r.transform,i||null);null!=a&&(null===t&&(t=Fi.empty()),t.set(r.field,a))}return t||null}function Nk(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&p_(t,r,(i,a)=>function qV(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof zf&&r instanceof zf||t instanceof qf&&r instanceof qf?p_(t.elements,r.elements,Ru):t instanceof E_&&r instanceof E_?Ru(t._t,r._t):t instanceof w_&&r instanceof w_);var t,r}(i,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class I_ extends cD{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Bl extends cD{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Pk(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function kk(n,e,t){const r=new Map;Ht(n.length===t.length);for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,h=e.data.field(a.field);r.set(a.field,zV(l,h,t[i]))}return r}function Ok(n,e,t){const r=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);r.set(i.field,WV(a,l,e))}return r}class C_ extends cD{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class $x extends cD{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class QV{constructor(e){this.count=e}}var qr,Rn;function Fk(n){switch(n){default:return _t();case Ee.CANCELLED:case Ee.UNKNOWN:case Ee.DEADLINE_EXCEEDED:case Ee.RESOURCE_EXHAUSTED:case Ee.INTERNAL:case Ee.UNAVAILABLE:case Ee.UNAUTHENTICATED:return!1;case Ee.INVALID_ARGUMENT:case Ee.NOT_FOUND:case Ee.ALREADY_EXISTS:case Ee.PERMISSION_DENIED:case Ee.FAILED_PRECONDITION:case Ee.ABORTED:case Ee.OUT_OF_RANGE:case Ee.UNIMPLEMENTED:case Ee.DATA_LOSS:return!0}}function Lk(n){if(void 0===n)return zr("GRPC error has no .code"),Ee.UNKNOWN;switch(n){case qr.OK:return Ee.OK;case qr.CANCELLED:return Ee.CANCELLED;case qr.UNKNOWN:return Ee.UNKNOWN;case qr.DEADLINE_EXCEEDED:return Ee.DEADLINE_EXCEEDED;case qr.RESOURCE_EXHAUSTED:return Ee.RESOURCE_EXHAUSTED;case qr.INTERNAL:return Ee.INTERNAL;case qr.UNAVAILABLE:return Ee.UNAVAILABLE;case qr.UNAUTHENTICATED:return Ee.UNAUTHENTICATED;case qr.INVALID_ARGUMENT:return Ee.INVALID_ARGUMENT;case qr.NOT_FOUND:return Ee.NOT_FOUND;case qr.ALREADY_EXISTS:return Ee.ALREADY_EXISTS;case qr.PERMISSION_DENIED:return Ee.PERMISSION_DENIED;case qr.FAILED_PRECONDITION:return Ee.FAILED_PRECONDITION;case qr.ABORTED:return Ee.ABORTED;case qr.OUT_OF_RANGE:return Ee.OUT_OF_RANGE;case qr.UNIMPLEMENTED:return Ee.UNIMPLEMENTED;case qr.DATA_LOSS:return Ee.DATA_LOSS;default:return _t()}}(Rn=qr||(qr={}))[Rn.OK=0]="OK",Rn[Rn.CANCELLED=1]="CANCELLED",Rn[Rn.UNKNOWN=2]="UNKNOWN",Rn[Rn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Rn[Rn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Rn[Rn.NOT_FOUND=5]="NOT_FOUND",Rn[Rn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Rn[Rn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Rn[Rn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Rn[Rn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Rn[Rn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Rn[Rn.ABORTED=10]="ABORTED",Rn[Rn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Rn[Rn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Rn[Rn.INTERNAL=13]="INTERNAL",Rn[Rn.UNAVAILABLE=14]="UNAVAILABLE",Rn[Rn.DATA_LOSS=15]="DATA_LOSS";class bd{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,a]of r)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){jf(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return tk(this.inner)}size(){return this.innerSize}}const JV=new Pr(st.comparator);function Ls(){return JV}const Vk=new Pr(st.comparator);function E0(...n){let e=Vk;for(const t of n)e=e.insert(t.key,t);return e}function Uk(n){let e=Vk;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Mu(){return I0()}function Bk(){return I0()}function I0(){return new bd(n=>n.toString(),(n,e)=>n.isEqual(e))}const XV=new Pr(st.comparator),eU=new qn(st.comparator);function ln(...n){let e=eU;for(const t of n)e=e.add(t);return e}const tU=new qn(sn);function dD(){return tU}class C0{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t){const r=new Map;return r.set(e,b0.createSynthesizedTargetChangeForCurrentChange(e,t)),new C0(Vt.min(),r,dD(),Ls(),ln())}}class b0{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t){return new b0(ci.EMPTY_BYTE_STRING,t,ln(),ln(),ln())}}class hD{constructor(e,t,r,i){this.gt=e,this.removedTargetIds=t,this.key=r,this.yt=i}}class jk{constructor(e,t){this.targetId=e,this.It=t}}class Hk{constructor(e,t,r=ci.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class $k{constructor(){this.Tt=0,this.Et=Wk(),this.At=ci.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=ln(),t=ln(),r=ln();return this.Et.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:_t()}}),new b0(this.At,this.Rt,e,t,r)}Dt(){this.bt=!1,this.Et=Wk()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class nU{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=Ls(),this.Bt=Gk(),this.Lt=new qn(sn)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,t=>{const r=this.Qt(t);switch(e.state){case 0:this.jt(t)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),r.Vt(e.resumeToken));break;default:_t()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((r,i)=>{this.jt(i)&&t(i)})}zt(e){const t=e.targetId,r=e.It.count,i=this.Ht(t);if(i){const a=i.target;if(oD(a))if(0===r){const l=new st(a.path);this.Kt(t,l,ar.newNoDocument(l,Vt.min()))}else Ht(1===r);else this.Jt(t)!==r&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach((a,l)=>{const h=this.Ht(l);if(h){if(a.current&&oD(h.target)){const m=new st(h.target.path);null!==this.$t.get(m)||this.Xt(l,m)||this.Kt(l,m,ar.newNoDocument(m,e))}a.vt&&(t.set(l,a.St()),a.Dt())}});let r=ln();this.Bt.forEach((a,l)=>{let h=!0;l.forEachWhile(m=>{const v=this.Ht(m);return!v||2===v.purpose||(h=!1,!1)}),h&&(r=r.add(a))}),this.$t.forEach((a,l)=>l.setReadTime(e));const i=new C0(e,t,this.Lt,this.$t,r);return this.$t=Ls(),this.Bt=Gk(),this.Lt=new qn(sn),i}qt(e,t){if(!this.jt(e))return;const r=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,r),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,r){if(!this.jt(e))return;const i=this.Qt(e);this.Xt(e,t)?i.Ct(t,1):i.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),r&&(this.$t=this.$t.insert(t,r))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new $k,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new qn(sn),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||Ze("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new $k),this.Mt.getRemoteKeysForTarget(e).forEach(t=>{this.Kt(e,t,null)})}Xt(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}function Gk(){return new Pr(st.comparator)}function Wk(){return new Pr(st.comparator)}const rU={asc:"ASCENDING",desc:"DESCENDING"},iU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class sU{constructor(e,t){this.databaseId=e,this.dt=t}}function D0(n,e){return n.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zk(n,e){return n.dt?e.toBase64():e.toUint8Array()}function oU(n,e){return D0(n,e.toTimestamp())}function wi(n){return Ht(!!n),Vt.fromTimestamp(function(e){const t=wd(e);return new yr(t.seconds,t.nanos)}(n))}function Gx(n,e){return(t=n,new xn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function qk(n){const e=xn.fromString(n);return Ht(nO(e)),e}function T0(n,e){return Gx(n.databaseId,e.path)}function Nu(n,e){const t=qk(e);if(t.get(1)!==n.databaseId.projectId)throw new Ge(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ge(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new st(Zk(t))}function Wx(n,e){return Gx(n.databaseId,e)}function Kk(n){const e=qk(n);return 4===e.length?xn.emptyPath():Zk(e)}function S0(n){return new xn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Zk(n){return Ht(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Yk(n,e,t){return{name:T0(n,e),fields:t.value.mapValue.fields}}function Qk(n,e,t){const r=Nu(n,e.name),i=wi(e.updateTime),a=new Fi({mapValue:{fields:e.fields}}),l=ar.newFoundDocument(r,i,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function A0(n,e){let t;if(e instanceof I_)t={update:Yk(n,e.key,e.value)};else if(e instanceof C_)t={delete:T0(n,e.key)};else if(e instanceof Bl)t={update:Yk(n,e.key,e.data),updateMask:gU(e.fieldMask)};else{if(!(e instanceof $x))return _t();t={verify:T0(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof w_)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof zf)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof qf)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof E_)return{fieldPath:a.field.canonicalString(),increment:l._t};throw _t()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:oU(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:_t()),t;var i}function zx(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?br.updateTime(wi(i.updateTime)):void 0!==i.exists?br.exists(i.exists):br.none():br.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let h=null;"setToServerValue"in l?(Ht("REQUEST_TIME"===l.setToServerValue),h=new w_):"appendMissingElements"in l?h=new zf(l.appendMissingElements.values||[]):"removeAllFromArray"in l?h=new qf(l.removeAllFromArray.values||[]):"increment"in l?h=new E_(a,l.increment):_t();const m=Vr.fromServerFormat(l.fieldPath);return new v0(m,h)}(n,i)):[];var i;if(e.update){const i=Nu(n,e.update.name),a=new Fi({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=new mo((e.updateMask.fieldPaths||[]).map(v=>Vr.fromServerFormat(v)));return new Bl(i,a,l,t,r)}return new I_(i,a,t,r)}if(e.delete){const i=Nu(n,e.delete);return new C_(i,t)}if(e.verify){const i=Nu(n,e.verify);return new $x(i,t)}return _t()}function Jk(n,e){return{documents:[Wx(n,e.path)]}}function Xk(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=Wx(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Wx(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(m){if(0===m.length)return;const v=m.map(b=>function(D){if("=="===D.op){if(ak(D.value))return{unaryFilter:{field:b_(D.field),op:"IS_NAN"}};if(ok(D.value))return{unaryFilter:{field:b_(D.field),op:"IS_NULL"}}}else if("!="===D.op){if(ak(D.value))return{unaryFilter:{field:b_(D.field),op:"IS_NOT_NAN"}};if(ok(D.value))return{unaryFilter:{field:b_(D.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:b_(D.field),op:hU(D.op),value:D.value}}}(b));return 1===v.length?v[0]:{compositeFilter:{op:"AND",filters:v}}}(e.filters);i&&(t.structuredQuery.where=i);const a=function(m){if(0!==m.length)return m.map(v=>{return{field:b_((b=v).field),direction:dU(b.dir)};var b})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=(v=e.limit,n.dt||h0(v)?v:{value:v});var v,h,m;return null!==l&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt={before:(h=e.startAt).inclusive,values:h.position}),e.endAt&&(t.structuredQuery.endAt={before:!(m=e.endAt).inclusive,values:m.position}),t}function eO(n){let e=Kk(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ht(1===r);const b=t.from[0];b.allDescendants?i=b.collectionId:e=e.child(b.collectionId)}let a=[];t.where&&(a=tO(t.where));let l=[];t.orderBy&&(l=t.orderBy.map(b=>{return new __(D_((D=b).field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction));var D}));let h=null;t.limit&&(h=function(b){let D;return D="object"==typeof b?b.value:b,h0(D)?null:D}(t.limit));let m=null;var b;t.startAt&&(m=new Cd((b=t.startAt).values||[],!!b.before));let v=null;return t.endAt&&(v=function(b){return new Cd(b.values||[],!b.before)}(t.endAt)),yk(e,i,l,a,h,"F",m,v)}function tO(n){return n?void 0!==n.unaryFilter?[pU(n)]:void 0!==n.fieldFilter?[fU(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>tO(e)).reduce((e,t)=>e.concat(t)):_t():[]}function dU(n){return rU[n]}function hU(n){return iU[n]}function b_(n){return{fieldPath:n.canonicalString()}}function D_(n){return Vr.fromServerFormat(n.fieldPath)}function fU(n){return Li.create(D_(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return _t()}}(n.fieldFilter.op),n.fieldFilter.value)}function pU(n){switch(n.unaryFilter.op){case"IS_NAN":const e=D_(n.unaryFilter.field);return Li.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=D_(n.unaryFilter.field);return Li.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=D_(n.unaryFilter.field);return Li.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=D_(n.unaryFilter.field);return Li.create(i,"!=",{nullValue:"NULL_VALUE"});default:return _t()}}function gU(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function nO(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function vs(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=rO(e)),e=mU(n.get(t),e);return rO(e)}function mU(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=a}}return t}function rO(n){return n+"\x01\x01"}function Pu(n){const e=n.length;if(Ht(e>=2),2===e)return Ht("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),xn.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const l=n.indexOf("\x01",a);switch((l<0||l>t)&&_t(),n.charAt(l+1)){case"\x01":const h=n.substring(a,l);let m;0===i.length?m=h:(i+=h,m=i,i=""),r.push(m);break;case"\x10":i+=n.substring(a,l),i+="\0";break;case"\x11":i+=n.substring(a,l+1);break;default:_t()}a=l+2}return new xn(r)}const iO=["userId","batchId"];function fD(n,e){return[n,vs(e)]}function sO(n,e,t){return[n,vs(e),t]}const _U={},yU=["prefixPath","collectionGroup","readTime","documentId"],vU=["prefixPath","collectionGroup","documentId"],wU=["collectionGroup","readTime","prefixPath","documentId"],EU=["canonicalId","targetId"],IU=["targetId","path"],CU=["path","targetId"],bU=["collectionId","parent"],DU=["indexId","uid"],TU=["uid","sequenceNumber"],SU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],AU=["indexId","uid","orderedDocumentKey"],xU=["userId","collectionPath","documentId"],RU=["userId","collectionPath","largestBatchId"],MU=["userId","collectionGroup","largestBatchId"],oO=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],NU=[...oO,"documentOverlays"],aO=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],uO=aO,PU=[...uO,"indexConfiguration","indexState","indexEntries"];class qx extends JP{constructor(e,t){super(),this.ee=e,this.currentSequenceNumber=t}}function Ei(n,e){const t=lt(n);return xa.N(t.ee,e)}class Kx{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&ZV(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=w0(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=w0(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Bk();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let h=this.applyToLocalView(l,a.mutatedFields);h=t.has(i.key)?null:h;const m=Mk(l,h);null!==m&&r.set(i.key,m),l.isValidDocument()||l.convertToNoDocument(Vt.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ln())}isEqual(e){return this.batchId===e.batchId&&p_(this.mutations,e.mutations,(t,r)=>Nk(t,r))&&p_(this.baseMutations,e.baseMutations,(t,r)=>Nk(t,r))}}class Zx{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ht(e.mutations.length===r.length);let i=XV;const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,r[l].version);return new Zx(e,t,r,i)}}class Yx{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Dd{constructor(e,t,r,i,a=Vt.min(),l=Vt.min(),h=ci.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h}withSequenceNumber(e){return new Dd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Dd(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Dd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class lO{constructor(e){this.ne=e}}function cO(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:pD(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:T0(i=n.ne,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:D0(i,a.version.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Kf(e.version)};else{if(!e.isUnknownDocument())return _t();r.unknownDocument={path:t.path.toArray(),version:Kf(e.version)}}var i,a;return r}function pD(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Kf(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Zf(n){const e=new yr(n.seconds,n.nanoseconds);return Vt.fromTimestamp(e)}function Yf(n,e){const t=(e.baseMutations||[]).map(a=>zx(n.ne,a));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];a+1<e.mutations.length&&void 0!==e.mutations[a+1].transform&&(l.updateTransforms=e.mutations[a+1].transform.fieldTransforms,e.mutations.splice(a+1,1),++a)}const r=e.mutations.map(a=>zx(n.ne,a)),i=yr.fromMillis(e.localWriteTimeMs);return new Kx(e.batchId,i,t,r)}function x0(n){const e=Zf(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Zf(n.lastLimboFreeSnapshotVersion):Vt.min();let r;var i;return void 0!==n.query.documents?(Ht(1===(i=n.query).documents.length),r=Zo(y_(Kk(i.documents[0])))):r=Zo(eO(n.query)),new Dd(r,n.targetId,0,n.lastListenSequenceNumber,e,t,ci.fromBase64String(n.resumeToken))}function dO(n,e){const t=Kf(e.snapshotVersion),r=Kf(e.lastLimboFreeSnapshotVersion);let i;i=oD(e.target)?Jk(n.ne,e.target):Xk(n.ne,e.target);const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Wf(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Qx(n){const e=eO({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?vk(e,e.limit,"L"):e}function Jx(n,e){return new Yx(e.largestBatchId,zx(n.ne,e.overlayMutation))}function hO(n,e){const t=e.path.lastSegment();return[n,vs(e.path.popLast()),t]}function fO(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:Kf(r.readTime),documentKey:vs(r.documentKey.path),largestBatchId:r.largestBatchId}}class OU{getBundleMetadata(e,t){return pO(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Zf(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return pO(e).put({bundleId:(r=t).id,createTime:Kf(wi(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return gO(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:Qx(i.bundledQuery),readTime:Zf(i.readTime)};var i})}saveNamedQuery(e,t){return gO(e).put({name:(r=t).name,readTime:Kf(wi(r.readTime)),bundledQuery:r.bundledQuery});var r}}function pO(n){return Ei(n,"bundles")}function gO(n){return Ei(n,"namedQueries")}class gD{constructor(e,t){this.wt=e,this.userId=t}static se(e,t){return new gD(e,t.uid||"")}getOverlay(e,t){return R0(e).get(hO(this.userId,t)).next(r=>r?Jx(this.wt,r):null)}getOverlays(e,t){const r=Mu();return he.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((a,l)=>{const h=new Yx(t,l);i.push(this.ie(e,h))}),he.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(l=>i.add(vs(l.getCollectionPath())));const a=[];return i.forEach(l=>{const h=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(R0(e).W("collectionPathOverlayIndex",h))}),he.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Mu(),a=vs(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return R0(e).K("collectionPathOverlayIndex",l).next(h=>{for(const m of h){const v=Jx(this.wt,m);i.set(v.getKey(),v)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const a=Mu();let l;const h=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return R0(e).J({index:"collectionGroupOverlayIndex",range:h},(m,v,b)=>{const D=Jx(this.wt,v);a.size()<i||D.largestBatchId===l?(a.set(D.getKey(),D),l=D.largestBatchId):b.done()}).next(()=>a)}ie(e,t){return R0(e).put(function(r,i,a){const[l,h,m]=hO(i,a.mutation.key);return{userId:i,collectionPath:h,documentId:m,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:A0(r.ne,a.mutation)}}(this.wt,this.userId,t))}}function R0(n){return Ei(n,"documentOverlays")}class Qf{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(kr(e.integerValue));else if("doubleValue"in e){const r=kr(e.doubleValue);isNaN(r)?this.ce(t,13):(this.ce(t,15),f0(r)?t.ae(0):t.ae(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he(`${r.seconds||""}`),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(Hf(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.ce(t,45),t.ae(r.latitude||0),t.ae(r.longitude||0)}else"mapValue"in e?uk(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):_t()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const r=e.fields||{};this.ce(t,55);for(const i of Object.keys(r))this.le(i,t),this.oe(r[i],t)}me(e,t){const r=e.values||[];this.ce(t,50);for(const i of r)this.oe(i,t)}_e(e,t){this.ce(t,37),st.fromName(e).path.forEach(r=>{this.ce(t,60),this.ge(r,t)})}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}function FU(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function mO(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const a=FU(255&t[i]);if(r+=a,8!==a)break}return r}(n);return Math.ceil(e/8)}Qf.ye=new Qf;class LU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ie(r.value),r=t.next();this.Te()}Ee(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ae(r.value),r=t.next();this.Re()}be(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ie(r);else if(r<2048)this.Ie(960|r>>>6),this.Ie(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ie(480|r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r);else{const i=t.codePointAt(0);this.Ie(240|i>>>18),this.Ie(128|63&i>>>12),this.Ie(128|63&i>>>6),this.Ie(128|63&i)}}this.Te()}Pe(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=t.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}ve(e){const t=this.Ve(e),r=mO(t);this.Se(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}De(e){const t=this.Ve(e),r=mO(t);this.Se(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Oe(){return this.buffer.slice(0,this.position)}Ve(e){const t=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ie(e){const t=255&e;0===t?(this.xe(0),this.xe(255)):255===t?(this.xe(255),this.xe(0)):this.xe(t)}Ae(e){const t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class VU{constructor(e){this.Me=e}de(e){this.Me.pe(e)}he(e){this.Me.be(e)}ae(e){this.Me.ve(e)}ue(){this.Me.Ce()}}class UU{constructor(e){this.Me=e}de(e){this.Me.Ee(e)}he(e){this.Me.Pe(e)}ae(e){this.Me.De(e)}ue(){this.Me.Ne()}}class M0{constructor(){this.Me=new LU,this.Fe=new VU(this.Me),this.$e=new UU(this.Me)}seed(e){this.Me.seed(e)}Be(e){return 0===e?this.Fe:this.$e}Oe(){return this.Me.Oe()}reset(){this.Me.reset()}}class Jf{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Le(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Jf(this.indexId,this.documentKey,this.arrayValue,r)}}function Xf(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=_O(n.arrayValue,e.arrayValue),0!==t?t:(t=_O(n.directionalValue,e.directionalValue),0!==t?t:st.comparator(n.documentKey,e.documentKey)))}function _O(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class BU{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const t of e.filters){const r=t;r.ht()?this.Ke=r:this.qe.push(r)}}Ge(e){const t=Mx(e);if(void 0!==t&&!this.Qe(t))return!1;const r=Uf(e);let i=0,a=0;for(;i<r.length&&this.Qe(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.Ke){const l=r[i];if(!this.je(this.Ke,l)||!this.We(this.Ue[a++],l))return!1;++i}for(;i<r.length;++i){const l=r[i];if(a>=this.Ue.length||!this.We(this.Ue[a++],l))return!1}return!0}Qe(e){for(const t of this.qe)if(this.je(t,e))return!0;return!1}je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}We(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class jU{constructor(){this.ze=new Xx}addToCollectionParentIndex(e,t){return this.ze.add(t),he.resolve()}getCollectionParents(e,t){return he.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return he.resolve()}deleteFieldIndex(e,t){return he.resolve()}getDocumentsMatchingTarget(e,t){return he.resolve(null)}getIndexType(e,t){return he.resolve(0)}getFieldIndexes(e,t){return he.resolve([])}getNextCollectionGroupToUpdate(e){return he.resolve(null)}getMinOffset(e,t){return he.resolve(go.min())}getMinOffsetFromCollectionGroup(e,t){return he.resolve(go.min())}updateCollectionGroup(e,t,r){return he.resolve()}updateIndexEntries(e,t){return he.resolve()}}class Xx{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new qn(xn.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new qn(xn.comparator)).toArray()}}const mD=new Uint8Array(0);class HU{constructor(e,t){this.user=e,this.databaseId=t,this.He=new Xx,this.Je=new bd(r=>Wf(r),(r,i)=>_0(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.He.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.He.add(t)});const a={collectionId:r,parent:vs(i)};return yO(e).put(a)}return he.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[KP(t),""],!1,!0);return yO(e).K(i).next(a=>{for(const l of a){if(l.collectionId!==t)break;r.push(Pu(l.parent))}return r})}addFieldIndex(e,t){const r=_D(e),i={indexId:(l=t).indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])};var l;delete i.indexId;const a=r.add(i);if(t.indexState){const l=P0(e);return a.next(h=>{l.put(fO(h,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=_D(e),i=P0(e),a=N0(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=N0(e);let i=!0;const a=new Map;return he.forEach(this.Ye(t),l=>this.Xe(e,l).next(h=>{i&&(i=!!h),a.set(l,h)})).next(()=>{if(i){let l=ln();const h=[];return he.forEach(a,(m,v)=>{var b;Ze("IndexedDbIndexManager",`Using index ${b=m,`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(Ct=>`${Ct.fieldPath}:${Ct.kind}`).join(",")}`} to execute ${Wf(t)}`);const D=function(Ct,wt){const qt=Mx(wt);if(void 0===qt)return null;for(const pn of aD(Ct,qt.fieldPath))switch(pn.op){case"array-contains-any":return pn.value.arrayValue.values||[];case"array-contains":return[pn.value]}return null}(v,m),x=function(Ct,wt){const qt=new Map;for(const pn of Uf(wt))for(const Zr of aD(Ct,pn.fieldPath))switch(Zr.op){case"==":case"in":qt.set(pn.fieldPath.canonicalString(),Zr.value);break;case"not-in":case"!=":return qt.set(pn.fieldPath.canonicalString(),Zr.value),Array.from(qt.values())}return null}(v,m),j=function(Ct,wt){const qt=[];let pn=!0;for(const Zr of Uf(wt)){const Na=0===Zr.kind?fk(Ct,Zr.fieldPath,Ct.startAt):pk(Ct,Zr.fieldPath,Ct.startAt);qt.push(Na.value),pn&&(pn=Na.inclusive)}return new Cd(qt,pn)}(v,m),Q=function(Ct,wt){const qt=[];let pn=!0;for(const Zr of Uf(wt)){const Na=0===Zr.kind?pk(Ct,Zr.fieldPath,Ct.endAt):fk(Ct,Zr.fieldPath,Ct.endAt);qt.push(Na.value),pn&&(pn=Na.inclusive)}return new Cd(qt,pn)}(v,m),Se=this.Ze(m,v,j),Le=this.Ze(m,v,Q),Et=this.tn(m,v,x),It=this.en(m.indexId,D,Se,j.inclusive,Le,Q.inclusive,Et);return he.forEach(It,Ct=>r.j(Ct,t.limit).next(wt=>{wt.forEach(qt=>{const pn=st.fromSegments(qt.documentKey);l.has(pn)||(l=l.add(pn),h.push(pn))})}))}).next(()=>h)}return he.resolve(null)})}Ye(e){let t=this.Je.get(e);return t||(t=[e],this.Je.set(e,t),t)}en(e,t,r,i,a,l,h){const m=(null!=t?t.length:1)*Math.max(r.length,a.length),v=m/(null!=t?t.length:1),b=[];for(let D=0;D<m;++D){const x=t?this.nn(t[D/v]):mD,j=this.sn(e,x,r[D%v],i),Q=this.rn(e,x,a[D%v],l),Se=h.map(Le=>this.sn(e,x,Le,!0));b.push(...this.createRange(j,Q,Se))}return b}sn(e,t,r,i){const a=new Jf(e,st.empty(),t,r);return i?a:a.Le()}rn(e,t,r,i){const a=new Jf(e,st.empty(),t,r);return i?a.Le():a}Xe(e,t){const r=new BU(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let l=null;for(const h of a)r.Ge(h)&&(!l||h.fields.length>l.fields.length)&&(l=h);return l})}getIndexType(e,t){let r=2;return he.forEach(this.Ye(t),i=>this.Xe(e,i).next(a=>{a?0!==r&&a.fields.length<function(l){let h=new qn(Vr.comparator),m=!1;for(const v of l.filters){const b=v;b.field.isKeyField()||("array-contains"===b.op||"array-contains-any"===b.op?m=!0:h=h.add(b.field))}for(const v of l.orderBy)v.field.isKeyField()||(h=h.add(v.field));return h.size+(m?1:0)}(i)&&(r=1):r=0})).next(()=>r)}on(e,t){const r=new M0;for(const i of Uf(e)){const a=t.data.field(i.fieldPath);if(null==a)return null;const l=r.Be(i.kind);Qf.ye.re(a,l)}return r.Oe()}nn(e){const t=new M0;return Qf.ye.re(e,t.Be(0)),t.Oe()}un(e,t){const r=new M0;return Qf.ye.re(Gf(this.databaseId,t),r.Be(function(i){const a=Uf(i);return 0===a.length?0:a[a.length-1].kind}(e))),r.Oe()}tn(e,t,r){if(null===r)return[];let i=[];i.push(new M0);let a=0;for(const l of Uf(e)){const h=r[a++];for(const m of i)if(this.cn(t,l.fieldPath)&&g0(h))i=this.an(i,l,h);else{const v=m.Be(l.kind);Qf.ye.re(h,v)}}return this.hn(i)}Ze(e,t,r){return this.tn(e,t,r.position)}hn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Oe();return t}an(e,t,r){const i=[...e],a=[];for(const l of r.arrayValue.values||[])for(const h of i){const m=new M0;m.seed(h.Oe()),Qf.ye.re(l,m.Be(t.kind)),a.push(m)}return a}cn(e,t){return!!e.filters.find(r=>r instanceof Li&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=_D(e),i=P0(e);return(t?r.K("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.K()).next(a=>{const l=[];return he.forEach(a,h=>i.get([h.indexId,this.uid]).next(m=>{l.push(function(v,b){const D=b?new l0(b.sequenceNumber,new go(Zf(b.readTime),new st(Pu(b.documentKey)),b.largestBatchId)):l0.empty(),x=v.fields.map(([j,Q])=>new tD(Vr.fromServerFormat(j),Q));return new eD(v.indexId,v.collectionGroup,x,D)}(h,m))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==a?a:sn(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=_D(e),a=P0(e);return this.ln(e).next(l=>i.K("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(h=>he.forEach(h,m=>a.put(fO(m.indexId,this.user,l,r)))))}updateIndexEntries(e,t){const r=new Map;return he.forEach(t,(i,a)=>{const l=r.get(i.collectionGroup);return(l?he.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next(h=>(r.set(i.collectionGroup,h),he.forEach(h,m=>this.fn(e,i,m).next(v=>{const b=this.dn(a,m);return v.isEqual(b)?he.resolve():this._n(e,a,m,v,b)}))))})}wn(e,t,r,i){return N0(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.un(r,t.key),documentKey:t.key.path.toArray()})}mn(e,t,r,i){return N0(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.un(r,t.key),t.key.path.toArray()])}fn(e,t,r){const i=N0(e);let a=new qn(Xf);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.un(r,t)])},(l,h)=>{a=a.add(new Jf(r.indexId,t,h.arrayValue,h.directionalValue))}).next(()=>a)}dn(e,t){let r=new qn(Xf);const i=this.on(t,e);if(null==i)return r;const a=Mx(t);if(null!=a){const l=e.data.field(a.fieldPath);if(g0(l))for(const h of l.arrayValue.values||[])r=r.add(new Jf(t.indexId,e.key,this.nn(h),i))}else r=r.add(new Jf(t.indexId,e.key,mD,i));return r}_n(e,t,r,i,a){Ze("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const l=[];return function(h,m,v,b,D){const x=h.getIterator(),j=m.getIterator();let Q=g_(x),Se=g_(j);for(;Q||Se;){let Le=!1,Et=!1;if(Q&&Se){const It=v(Q,Se);It<0?Et=!0:It>0&&(Le=!0)}else null!=Q?Et=!0:Le=!0;Le?(b(Se),Se=g_(j)):Et?(D(Q),Q=g_(x)):(Q=g_(x),Se=g_(j))}}(i,a,Xf,h=>{l.push(this.wn(e,t,r,h))},h=>{l.push(this.mn(e,t,r,h))}),he.waitFor(l)}ln(e){let t=1;return P0(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((l,h)=>Xf(l,h)).filter((l,h,m)=>!h||0!==Xf(l,m[h-1]));const i=[];i.push(e);for(const l of r){const h=Xf(l,e),m=Xf(l,t);if(0===h)i[0]=e.Le();else if(h>0&&m<0)i.push(l),i.push(l.Le());else if(m>0)break}i.push(t);const a=[];for(let l=0;l<i.length;l+=2)a.push(IDBKeyRange.bound([i[l].indexId,this.uid,i[l].arrayValue,i[l].directionalValue,mD,[]],[i[l+1].indexId,this.uid,i[l+1].arrayValue,i[l+1].directionalValue,mD,[]]));return a}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(vO)}getMinOffset(e,t){return he.mapArray(this.Ye(t),r=>this.Xe(e,r).next(i=>i||_t())).next(vO)}}function yO(n){return Ei(n,"collectionParents")}function N0(n){return Ei(n,"indexEntries")}function _D(n){return Ei(n,"indexConfiguration")}function P0(n){return Ei(n,"indexState")}function vO(n){Ht(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Nx(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new go(e.readTime,e.documentKey,t)}const wO={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Vs{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Vs(e,Vs.DEFAULT_COLLECTION_PERCENTILE,Vs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function EO(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),a=[],l=IDBKeyRange.only(t.batchId);let h=0;const m=r.J({range:l},(b,D,x)=>(h++,x.delete()));a.push(m.next(()=>{Ht(1===h)}));const v=[];for(const b of t.mutations){const D=sO(e,b.key.path,t.batchId);a.push(i.delete(D)),v.push(b.key)}return he.waitFor(a).next(()=>v)}function yD(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw _t();e=n.noDocument}return JSON.stringify(e).length}Vs.DEFAULT_COLLECTION_PERCENTILE=10,Vs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vs.DEFAULT=new Vs(41943040,Vs.DEFAULT_COLLECTION_PERCENTILE,Vs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vs.DISABLED=new Vs(-1,0,0);class vD{constructor(e,t,r,i){this.userId=e,this.wt=t,this.indexManager=r,this.referenceDelegate=i,this.gn={}}static se(e,t,r,i){Ht(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new vD(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Td(e).J({index:"userMutationsIndex",range:r},(i,a,l)=>{t=!1,l.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const a=T_(e),l=Td(e);return l.add({}).next(h=>{Ht("number"==typeof h);const m=new Kx(h,t,r,i),v=function(x,j,Q){const Se=Q.baseMutations.map(Et=>A0(x.ne,Et)),Le=Q.mutations.map(Et=>A0(x.ne,Et));return{userId:j,batchId:Q.batchId,localWriteTimeMs:Q.localWriteTime.toMillis(),baseMutations:Se,mutations:Le}}(this.wt,this.userId,m),b=[];let D=new qn((x,j)=>sn(x.canonicalString(),j.canonicalString()));for(const x of i){const j=sO(this.userId,x.key.path,h);D=D.add(x.key.path.popLast()),b.push(l.put(v)),b.push(a.put(j,_U))}return D.forEach(x=>{b.push(this.indexManager.addToCollectionParentIndex(e,x))}),e.addOnCommittedListener(()=>{this.gn[h]=m.keys()}),he.waitFor(b).next(()=>m)})}lookupMutationBatch(e,t){return Td(e).get(t).next(r=>r?(Ht(r.userId===this.userId),Yf(this.wt,r)):null)}yn(e,t){return this.gn[t]?he.resolve(this.gn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.gn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Td(e).J({index:"userMutationsIndex",range:i},(l,h,m)=>{h.userId===this.userId&&(Ht(h.batchId>=r),a=Yf(this.wt,h)),m.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Td(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,a,l)=>{r=a.batchId,l.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Td(e).K("userMutationsIndex",t).next(r=>r.map(i=>Yf(this.wt,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=fD(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return T_(e).J({range:i},(l,h,m)=>{const[v,b,D]=l,x=Pu(b);if(v===this.userId&&t.path.isEqual(x))return Td(e).get(D).next(j=>{if(!j)throw _t();Ht(j.userId===this.userId),a.push(Yf(this.wt,j))});m.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new qn(sn);const i=[];return t.forEach(a=>{const l=fD(this.userId,a.path),h=IDBKeyRange.lowerBound(l),m=T_(e).J({range:h},(v,b,D)=>{const[x,j,Q]=v,Se=Pu(j);x===this.userId&&a.path.isEqual(Se)?r=r.add(Q):D.done()});i.push(m)}),he.waitFor(i).next(()=>this.pn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=fD(this.userId,r),l=IDBKeyRange.lowerBound(a);let h=new qn(sn);return T_(e).J({range:l},(m,v,b)=>{const[D,x,j]=m,Q=Pu(x);D===this.userId&&r.isPrefixOf(Q)?Q.length===i&&(h=h.add(j)):b.done()}).next(()=>this.pn(e,h))}pn(e,t){const r=[],i=[];return t.forEach(a=>{i.push(Td(e).get(a).next(l=>{if(null===l)throw _t();Ht(l.userId===this.userId),r.push(Yf(this.wt,l))}))}),he.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return EO(e.ee,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.In(t.batchId)}),he.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return he.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return T_(e).J({range:r},(a,l,h)=>{if(a[0]===this.userId){const m=Pu(a[1]);i.push(m)}else h.done()}).next(()=>{Ht(0===i.length)})})}containsKey(e,t){return IO(e,this.userId,t)}Tn(e){return CO(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function IO(n,e,t){const r=fD(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return T_(n).J({range:a,H:!0},(h,m,v)=>{const[b,D,x]=h;b===e&&D===i&&(l=!0),v.done()}).next(()=>l)}function Td(n){return Ei(n,"mutations")}function T_(n){return Ei(n,"documentMutations")}function CO(n){return Ei(n,"mutationQueues")}class ep{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new ep(0)}static Rn(){return new ep(-1)}}class $U{constructor(e,t){this.referenceDelegate=e,this.wt=t}allocateTargetId(e){return this.bn(e).next(t=>{const r=new ep(t.highestTargetId);return t.highestTargetId=r.next(),this.Pn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(t=>Vt.fromTimestamp(new yr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.bn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Pn(e,i)))}addTargetData(e,t){return this.vn(e,t).next(()=>this.bn(e).next(r=>(r.targetCount+=1,this.Vn(t,r),this.Pn(e,r))))}updateTargetData(e,t){return this.vn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>S_(e).delete(t.targetId)).next(()=>this.bn(e)).next(r=>(Ht(r.targetCount>0),r.targetCount-=1,this.Pn(e,r)))}removeTargets(e,t,r){let i=0;const a=[];return S_(e).J((l,h)=>{const m=x0(h);m.sequenceNumber<=t&&null===r.get(m.targetId)&&(i++,a.push(this.removeTargetData(e,m)))}).next(()=>he.waitFor(a)).next(()=>i)}forEachTarget(e,t){return S_(e).J((r,i)=>{const a=x0(i);t(a)})}bn(e){return bO(e).get("targetGlobalKey").next(t=>(Ht(null!==t),t))}Pn(e,t){return bO(e).put("targetGlobalKey",t)}vn(e,t){return S_(e).put(dO(this.wt,t))}Vn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.bn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Wf(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return S_(e).J({range:i,index:"queryTargetsIndex"},(l,h,m)=>{const v=x0(h);_0(t,v.target)&&(a=v,m.done())}).next(()=>a)}addMatchingKeys(e,t,r){const i=[],a=Sd(e);return t.forEach(l=>{const h=vs(l.path);i.push(a.put({targetId:r,path:h})),i.push(this.referenceDelegate.addReference(e,r,l))}),he.waitFor(i)}removeMatchingKeys(e,t,r){const i=Sd(e);return he.forEach(t,a=>{const l=vs(a.path);return he.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=Sd(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Sd(e);let a=ln();return i.J({range:r,H:!0},(l,h,m)=>{const v=Pu(l[1]),b=new st(v);a=a.add(b)}).next(()=>a)}containsKey(e,t){const r=vs(t.path),i=IDBKeyRange.bound([r],[KP(r)],!1,!0);let a=0;return Sd(e).J({index:"documentTargetsIndex",H:!0,range:i},([l,h],m,v)=>{0!==l&&(a++,v.done())}).next(()=>a>0)}te(e,t){return S_(e).get(t).next(r=>r?x0(r):null)}}function S_(n){return Ei(n,"targets")}function bO(n){return Ei(n,"targetGlobal")}function Sd(n){return Ei(n,"targetDocuments")}function DO([n,e],[t,r]){const i=sn(n,t);return 0===i?sn(e,r):i}class GU{constructor(e){this.Sn=e,this.buffer=new qn(DO),this.Dn=0}Cn(){return++this.Dn}xn(e){const t=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();DO(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class WU{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Nn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return null!==this.Nn}kn(e){var t=this;Ze("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,xe.Z)(function*(){t.Nn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){vd(r)?Ze("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield yd(r)}yield t.kn(3e5)}))}}class zU{constructor(e,t){this.On=e,this.params=t}calculateTargetCount(e,t){return this.On.Mn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return he.resolve(Fs.ot);const r=new GU(t);return this.On.forEachTarget(e,i=>r.xn(i.sequenceNumber)).next(()=>this.On.Fn(e,i=>r.xn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.On.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.On.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Ze("LruGarbageCollector","Garbage collection skipped; disabled"),he.resolve(wO)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),wO):this.$n(e,t))}getCacheSize(e){return this.On.getCacheSize(e)}$n(e,t){let r,i,a,l,h,m,v;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(D=>(D>this.params.maximumSequenceNumbersToCollect?(Ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${D}`),i=this.params.maximumSequenceNumbersToCollect):i=D,l=Date.now(),this.nthSequenceNumber(e,i))).next(D=>(r=D,h=Date.now(),this.removeTargets(e,r,t))).next(D=>(a=D,m=Date.now(),this.removeOrphanedDocuments(e,r))).next(D=>(v=Date.now(),xx()<=mi.in.DEBUG&&Ze("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${l-b}ms\n\tDetermined least recently used ${i} in `+(h-l)+`ms\n\tRemoved ${a} targets in `+(m-h)+`ms\n\tRemoved ${D} documents in `+(v-m)+`ms\nTotal Duration: ${v-b}ms`),he.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:D})))}}class qU{constructor(e,t){this.db=e,this.garbageCollector=new zU(this,t)}Mn(e){const t=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Bn(e){let t=0;return this.Fn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Fn(e,t){return this.Ln(e,(r,i)=>t(i))}addReference(e,t,r){return wD(e,r)}removeReference(e,t,r){return wD(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return wD(e,t)}Un(e,t){return function(r,i){let a=!1;return CO(r).Y(l=>IO(r,l,i).next(h=>(h&&(a=!0),he.resolve(!h)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Ln(e,(l,h)=>{if(h<=t){const m=this.Un(e,l).next(v=>{if(!v)return a++,r.getEntry(e,l).next(()=>(r.removeEntry(l,Vt.min()),Sd(e).delete([0,vs(l.path)])))});i.push(m)}}).next(()=>he.waitFor(i)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return wD(e,t)}Ln(e,t){const r=Sd(e);let i,a=Fs.ot;return r.J({index:"documentTargetsIndex"},([l,h],{path:m,sequenceNumber:v})=>{0===l?(a!==Fs.ot&&t(new st(Pu(i)),a),a=v,i=m):a=Fs.ot}).next(()=>{a!==Fs.ot&&t(new st(Pu(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function wD(n,e){return Sd(n).put((r=n.currentSequenceNumber,{targetId:0,path:vs(e.path),sequenceNumber:r}));var r}class TO{constructor(){this.changes=new bd(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ar.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?he.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class KU{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return tp(e).put(r)}removeEntry(e,t,r){return tp(e).delete(function(i,a){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],pD(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.qn(e,r)))}getEntry(e,t){let r=ar.newInvalidDocument(t);return tp(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(k0(t))},(i,a)=>{r=this.Kn(t,a)}).next(()=>r)}Gn(e,t){let r={size:0,document:ar.newInvalidDocument(t)};return tp(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(k0(t))},(i,a)=>{r={document:this.Kn(t,a),size:yD(a)}}).next(()=>r)}getEntries(e,t){let r=Ls();return this.Qn(e,t,(i,a)=>{const l=this.Kn(i,a);r=r.insert(i,l)}).next(()=>r)}jn(e,t){let r=Ls(),i=new Pr(st.comparator);return this.Qn(e,t,(a,l)=>{const h=this.Kn(a,l);r=r.insert(a,h),i=i.insert(a,yD(l))}).next(()=>({documents:r,Wn:i}))}Qn(e,t,r){if(t.isEmpty())return he.resolve();let i=new qn(RO);t.forEach(m=>i=i.add(m));const a=IDBKeyRange.bound(k0(i.first()),k0(i.last())),l=i.getIterator();let h=l.getNext();return tp(e).J({index:"documentKeyIndex",range:a},(m,v,b)=>{const D=st.fromSegments([...v.prefixPath,v.collectionGroup,v.documentId]);for(;h&&RO(h,D)<0;)r(h,null),h=l.getNext();h&&h.isEqual(D)&&(r(h,v),h=l.hasNext()?l.getNext():null),h?b.q(k0(h)):b.done()}).next(()=>{for(;h;)r(h,null),h=l.hasNext()?l.getNext():null})}getAllFromCollection(e,t,r){const i=[t.popLast().toArray(),t.lastSegment(),pD(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return tp(e).K(IDBKeyRange.bound(i,a,!0)).next(l=>{let h=Ls();for(const m of l){const v=this.Kn(st.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);h=h.insert(v.key,v)}return h})}getAllFromCollectionGroup(e,t,r,i){let a=Ls();const l=xO(t,r),h=xO(t,go.max());return tp(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,h,!0)},(m,v,b)=>{const D=this.Kn(st.fromSegments(v.prefixPath.concat(v.collectionGroup,v.documentId)),v);a=a.insert(D.key,D),a.size===i&&b.done()}).next(()=>a)}newChangeBuffer(e){return new ZU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return AO(e).get("remoteDocumentGlobalKey").next(t=>(Ht(!!t),t))}qn(e,t){return AO(e).put("remoteDocumentGlobalKey",t)}Kn(e,t){if(t){const r=function kU(n,e){let t;if(e.document)t=Qk(n.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=st.fromSegments(e.noDocument.path),i=Zf(e.noDocument.readTime);t=ar.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return _t();{const r=st.fromSegments(e.unknownDocument.path),i=Zf(e.unknownDocument.version);t=ar.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new yr(r[0],r[1]);return Vt.fromTimestamp(i)}(e.readTime)),t}(this.wt,t);if(!r.isNoDocument()||!r.version.isEqual(Vt.min()))return r}return ar.newInvalidDocument(e)}}function SO(n){return new KU(n)}class ZU extends TO{constructor(e,t){super(),this.zn=e,this.trackRemovals=t,this.Hn=new bd(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new qn((a,l)=>sn(a.canonicalString(),l.canonicalString()));return this.changes.forEach((a,l)=>{const h=this.Hn.get(a);if(t.push(this.zn.removeEntry(e,a,h.readTime)),l.isValidDocument()){const m=cO(this.zn.wt,l);i=i.add(a.path.popLast()),r+=yD(m)-h.size,t.push(this.zn.addEntry(e,a,m))}else if(r-=h.size,this.trackRemovals){const m=cO(this.zn.wt,l.convertToNoDocument(Vt.min()));t.push(this.zn.addEntry(e,a,m))}}),i.forEach(a=>{t.push(this.zn.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.zn.updateMetadata(e,r)),he.waitFor(t)}getFromCache(e,t){return this.zn.Gn(e,t).next(r=>(this.Hn.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.zn.jn(e,t).next(({documents:r,Wn:i})=>(i.forEach((a,l)=>{this.Hn.set(a,{size:l,readTime:r.get(a).readTime})}),r))}}function AO(n){return Ei(n,"remoteDocumentGlobal")}function tp(n){return Ei(n,"remoteDocumentsV14")}function k0(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function xO(n,e){const t=e.documentKey.path.toArray();return[n,pD(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function RO(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=sn(t[a],r[a]),i)return i;return i=sn(t.length,r.length),i||(i=sn(t[t.length-2],r[r.length-2]),i||sn(t[t.length-1],r[r.length-1]))}class YU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class MO{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.getBaseDocument(e,t,r))).next(i=>(null!==r&&w0(r.mutation,i,mo.empty(),yr.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ln()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ln()){const i=Mu();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let l=E0();return a.forEach((h,m)=>{l=l.insert(h,m.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const r=Mu();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ln()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,h)=>{t.set(l,h)})})}computeViews(e,t,r,i){let a=Ls();const l=I0(),h=I0();return t.forEach((m,v)=>{const b=r.get(v.key);i.has(v.key)&&(void 0===b||b.mutation instanceof Bl)?a=a.insert(v.key,v):void 0!==b&&(l.set(v.key,b.mutation.getFieldMask()),w0(b.mutation,v,b.mutation.getFieldMask(),yr.now()))}),this.recalculateAndSaveOverlays(e,a).next(m=>(m.forEach((v,b)=>l.set(v,b)),t.forEach((v,b)=>{var D;return h.set(v,new YU(b,null!==(D=l.get(v))&&void 0!==D?D:null))}),h))}recalculateAndSaveOverlays(e,t){const r=I0();let i=new Pr((l,h)=>l-h),a=ln();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const h of l)h.keys().forEach(m=>{const v=t.get(m);if(null===v)return;let b=r.get(m)||mo.empty();b=h.applyToLocalView(v,b),r.set(m,b);const D=(i.get(h.batchId)||ln()).add(m);i=i.insert(h.batchId,D)})}).next(()=>{const l=[],h=i.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),v=m.key,b=m.value,D=Bk();b.forEach(x=>{if(!a.has(x)){const j=Mk(t.get(x),r.get(x));null!==j&&D.set(x,j),a=a.add(x)}}),l.push(this.documentOverlayCache.saveOverlays(e,v,D))}return he.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return st.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Bx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):he.resolve(Mu());let h=-1,m=a;return l.next(v=>he.forEach(v,(b,D)=>(h<D.largestBatchId&&(h=D.largestBatchId),a.get(b)?he.resolve():this.getBaseDocument(e,b,D).next(x=>{m=m.insert(b,x)}))).next(()=>this.populateOverlays(e,v,a)).next(()=>this.computeViews(e,m,v,ln())).next(b=>({batchId:h,changes:Uk(b)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new st(t)).next(r=>{let i=E0();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let a=E0();return this.indexManager.getCollectionParents(e,i).next(l=>he.forEach(l,h=>{const m=(v=t,b=h.child(i),new Ul(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt));var v,b;return this.getDocumentsMatchingCollectionQuery(e,m,r).next(v=>{v.forEach((b,D)=>{a=a.insert(b,D)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(a=>(i=a,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(a=>{a.forEach((h,m)=>{const v=m.getKey();null===i.get(v)&&(i=i.insert(v,ar.newInvalidDocument(v)))});let l=E0();return i.forEach((h,m)=>{const v=a.get(h);void 0!==v&&w0(v.mutation,m,mo.empty(),yr.now()),Hx(t,m)&&(l=l.insert(h,m))}),l})}getBaseDocument(e,t,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(e,t):he.resolve(ar.newInvalidDocument(t))}}class QU{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return he.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var r;return this.Jn.set(t.id,{id:(r=t).id,version:r.version,createTime:wi(r.createTime)}),he.resolve()}getNamedQuery(e,t){return he.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,{name:(r=t).name,query:Qx(r.bundledQuery),readTime:wi(r.readTime)}),he.resolve();var r}}class JU{constructor(){this.overlays=new Pr(st.comparator),this.Xn=new Map}getOverlay(e,t){return he.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Mu();return he.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.ie(e,t,a)}),he.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Xn.get(r);return void 0!==i&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.Xn.delete(r)),he.resolve()}getOverlaysForCollection(e,t,r){const i=Mu(),a=t.length+1,l=new st(t.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const m=h.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===a&&m.largestBatchId>r&&i.set(m.getKey(),m)}return he.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new Pr((v,b)=>v-b);const l=this.overlays.getIterator();for(;l.hasNext();){const v=l.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>r){let b=a.get(v.largestBatchId);null===b&&(b=Mu(),a=a.insert(v.largestBatchId,b)),b.set(v.getKey(),v)}}const h=Mu(),m=a.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach((v,b)=>h.set(v,b)),!(h.size()>=i)););return he.resolve(h)}ie(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const l=this.Xn.get(i.largestBatchId).delete(r.key);this.Xn.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new Yx(t,r));let a=this.Xn.get(t);void 0===a&&(a=ln(),this.Xn.set(t,a)),this.Xn.set(t,a.add(r.key))}}class eR{constructor(){this.Zn=new qn(Ii.ts),this.es=new qn(Ii.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const r=new Ii(e,t);this.Zn=this.Zn.add(r),this.es=this.es.add(r)}ss(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.rs(new Ii(e,t))}os(e,t){e.forEach(r=>this.removeReference(r,t))}us(e){const t=new st(new xn([])),r=new Ii(t,e),i=new Ii(t,e+1),a=[];return this.es.forEachInRange([r,i],l=>{this.rs(l),a.push(l.key)}),a}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new st(new xn([])),r=new Ii(t,e),i=new Ii(t,e+1);let a=ln();return this.es.forEachInRange([r,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new Ii(e,0),r=this.Zn.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Ii{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return st.comparator(e.key,t.key)||sn(e.ls,t.ls)}static ns(e,t){return sn(e.ls,t.ls)||st.comparator(e.key,t.key)}}class XU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new qn(Ii.ts)}checkEmpty(e){return he.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const a=this.fs;this.fs++;const l=new Kx(a,t,r,i);this.mutationQueue.push(l);for(const h of i)this.ds=this.ds.add(new Ii(h.key,a)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return he.resolve(l)}lookupMutationBatch(e,t){return he.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ws(t+1),a=i<0?0:i;return he.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return he.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return he.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ii(t,0),i=new Ii(t,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],l=>{const h=this._s(l.ls);a.push(h)}),he.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new qn(sn);return t.forEach(i=>{const a=new Ii(i,0),l=new Ii(i,Number.POSITIVE_INFINITY);this.ds.forEachInRange([a,l],h=>{r=r.add(h.ls)})}),he.resolve(this.gs(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;st.isDocumentKey(a)||(a=a.child(""));const l=new Ii(new st(a),0);let h=new qn(sn);return this.ds.forEachWhile(m=>{const v=m.key.path;return!!r.isPrefixOf(v)&&(v.length===i&&(h=h.add(m.ls)),!0)},l),he.resolve(this.gs(h))}gs(e){const t=[];return e.forEach(r=>{const i=this._s(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){Ht(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let r=this.ds;return he.forEach(t.mutations,i=>{const a=new Ii(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.ds=r})}In(e){}containsKey(e,t){const r=new Ii(t,0),i=this.ds.firstAfterOrEqual(r);return he.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return he.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class eB{constructor(e){this.ps=e,this.docs=new Pr(st.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,l=this.ps(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return he.resolve(r?r.document.mutableCopy():ar.newInvalidDocument(t))}getEntries(e,t){let r=Ls();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():ar.newInvalidDocument(i))}),he.resolve(r)}getAllFromCollection(e,t,r){let i=Ls();const a=new st(t.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:h,value:{document:m}}=l.getNext();if(!t.isPrefixOf(h.path))break;h.path.length>t.length+1||Nx(YP(m),r)<=0||(i=i.insert(m.key,m.mutableCopy()))}return he.resolve(i)}getAllFromCollectionGroup(e,t,r,i){_t()}Is(e,t){return he.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new tB(this)}getSize(e){return he.resolve(this.size)}}class tB extends TO{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.zn.addEntry(e,i)):this.zn.removeEntry(r)}),he.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class nB{constructor(e){this.persistence=e,this.Ts=new bd(t=>Wf(t),_0),this.lastRemoteSnapshotVersion=Vt.min(),this.highestTargetId=0,this.Es=0,this.As=new eR,this.targetCount=0,this.Rs=ep.An()}forEachTarget(e,t){return this.Ts.forEach((r,i)=>t(i)),he.resolve()}getLastRemoteSnapshotVersion(e){return he.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return he.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),he.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Es&&(this.Es=t),he.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new ep(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,he.resolve()}updateTargetData(e,t){return this.vn(t),he.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,he.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.Ts.forEach((l,h)=>{h.sequenceNumber<=t&&null===r.get(h.targetId)&&(this.Ts.delete(l),a.push(this.removeMatchingKeysForTargetId(e,h.targetId)),i++)}),he.waitFor(a).next(()=>i)}getTargetCount(e){return he.resolve(this.targetCount)}getTargetData(e,t){const r=this.Ts.get(t)||null;return he.resolve(r)}addMatchingKeys(e,t,r){return this.As.ss(t,r),he.resolve()}removeMatchingKeys(e,t,r){this.As.os(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),he.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),he.resolve()}getMatchingKeysForTargetId(e,t){const r=this.As.hs(t);return he.resolve(r)}containsKey(e,t){return he.resolve(this.As.containsKey(t))}}class NO{constructor(e,t){this.bs={},this.overlays={},this.Ps=new Fs(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new nB(this),this.indexManager=new jU,this.remoteDocumentCache=new eB(r=>this.referenceDelegate.Ss(r)),this.wt=new lO(t),this.Ds=new QU(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new JU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.bs[e.toKey()];return r||(r=new XU(t,this.referenceDelegate),this.bs[e.toKey()]=r),r}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,r){Ze("MemoryPersistence","Starting transaction:",e);const i=new rB(this.Ps.next());return this.referenceDelegate.Cs(),r(i).next(a=>this.referenceDelegate.xs(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ns(e,t){return he.or(Object.values(this.bs).map(r=>()=>r.containsKey(e,t)))}}class rB extends JP{constructor(e){super(),this.currentSequenceNumber=e}}class ED{constructor(e){this.persistence=e,this.ks=new eR,this.Os=null}static Ms(e){return new ED(e)}get Fs(){if(this.Os)return this.Os;throw _t()}addReference(e,t,r){return this.ks.addReference(r,t),this.Fs.delete(r.toString()),he.resolve()}removeReference(e,t,r){return this.ks.removeReference(r,t),this.Fs.add(r.toString()),he.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),he.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach(i=>this.Fs.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.Fs.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}Cs(){this.Os=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return he.forEach(this.Fs,r=>{const i=st.fromPath(r);return this.$s(e,i).next(a=>{a||t.removeEntry(i,Vt.min())})}).next(()=>(this.Os=null,t.apply(e)))}updateLimboDocument(e,t){return this.$s(e,t).next(r=>{r?this.Fs.delete(t.toString()):this.Fs.add(t.toString())})}Ss(e){return 0}$s(e,t){return he.or([()=>he.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class iB{constructor(e){this.wt=e}O(e,t,r,i){const a=new nD("createOrUpgrade",t);var h;r<1&&i>=1&&(e.createObjectStore("owner"),(h=e).createObjectStore("mutationQueues",{keyPath:"userId"}),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",iO,{unique:!0}),h.createObjectStore("documentMutations"),PO(e),function(h){h.createObjectStore("remoteDocuments")}(e));let l=he.resolve();return r<3&&i>=3&&(0!==r&&(function(h){h.deleteObjectStore("targetDocuments"),h.deleteObjectStore("targets"),h.deleteObjectStore("targetGlobal")}(e),PO(e)),l=l.next(()=>function(h){const m=h.store("targetGlobal"),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Vt.min().toTimestamp(),targetCount:0};return m.put("targetGlobalKey",v)}(a))),r<4&&i>=4&&(0!==r&&(l=l.next(()=>function(h,m){return m.store("mutations").K().next(v=>{h.deleteObjectStore("mutations"),h.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",iO,{unique:!0});const b=m.store("mutations"),D=v.map(x=>b.put(x));return he.waitFor(D)})}(e,a))),l=l.next(()=>{!function(h){h.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(l=l.next(()=>this.Bs(a))),r<6&&i>=6&&(l=l.next(()=>(function(h){h.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(a)))),r<7&&i>=7&&(l=l.next(()=>this.Us(a))),r<8&&i>=8&&(l=l.next(()=>this.qs(e,a))),r<9&&i>=9&&(l=l.next(()=>{!function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(l=l.next(()=>this.Ks(a))),r<11&&i>=11&&(l=l.next(()=>{(function(h){h.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(h){h.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(l=l.next(()=>{!function(h){const m=h.createObjectStore("documentOverlays",{keyPath:xU});m.createIndex("collectionPathOverlayIndex",RU,{unique:!1}),m.createIndex("collectionGroupOverlayIndex",MU,{unique:!1})}(e)})),r<13&&i>=13&&(l=l.next(()=>function(h){const m=h.createObjectStore("remoteDocumentsV14",{keyPath:yU});m.createIndex("documentKeyIndex",vU),m.createIndex("collectionGroupIndex",wU)}(e)).next(()=>this.Gs(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(l=l.next(()=>this.Qs(e,a))),r<15&&i>=15&&(l=l.next(()=>function(h){h.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),h.createObjectStore("indexState",{keyPath:DU}).createIndex("sequenceNumberIndex",TU,{unique:!1}),h.createObjectStore("indexEntries",{keyPath:SU}).createIndex("documentKeyIndex",AU,{unique:!1})}(e))),l}Ls(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=yD(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Bs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.K().next(i=>he.forEach(i,a=>{const l=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return r.K("userMutationsIndex",l).next(h=>he.forEach(h,m=>{Ht(m.userId===a.userId);const v=Yf(this.wt,m);return EO(e,a.userId,v).next(()=>{})}))}))}Us(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const a=[];return r.J((l,h)=>{const m=new xn(l),v=[0,vs(m)];a.push(t.get(v).next(b=>b?he.resolve():t.put({targetId:0,path:vs(m),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>he.waitFor(a))})}qs(e,t){e.createObjectStore("collectionParents",{keyPath:bU});const r=t.store("collectionParents"),i=new Xx,a=l=>{if(i.add(l)){const h=l.lastSegment(),m=l.popLast();return r.put({collectionId:h,parent:vs(m)})}};return t.store("remoteDocuments").J({H:!0},(l,h)=>{const m=new xn(l);return a(m.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([l,h,m],v)=>{const b=Pu(h);return a(b.popLast())}))}Ks(e){const t=e.store("targets");return t.J((r,i)=>{const a=x0(i),l=dO(this.wt,a);return t.put(l)})}Gs(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((a,l)=>{const h=t.store("remoteDocumentsV14"),m=(v=l,v.document?new st(xn.fromString(v.document.name).popFirst(5)):v.noDocument?st.fromSegments(v.noDocument.path):v.unknownDocument?st.fromSegments(v.unknownDocument.path):_t()).path.toArray();var v;const b={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(h.put(b))}).next(()=>he.waitFor(i))}Qs(e,t){const r=t.store("mutations"),i=SO(this.wt),a=new NO(ED.Ms,this.wt.ne);return r.K().next(l=>{const h=new Map;return l.forEach(m=>{var v;let b=null!==(v=h.get(m.userId))&&void 0!==v?v:ln();Yf(this.wt,m).keys().forEach(D=>b=b.add(D)),h.set(m.userId,b)}),he.forEach(h,(m,v)=>{const b=new yi(v),D=gD.se(this.wt,b),x=a.getIndexManager(b),j=vD.se(b,this.wt,x,a.referenceDelegate);return new MO(i,j,D,x).recalculateAndSaveOverlaysForDocumentKeys(new qx(t,Fs.ot),m).next()})})}}function PO(n){n.createObjectStore("targetDocuments",{keyPath:IU}).createIndex("documentTargetsIndex",CU,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",EU,{unique:!0}),n.createObjectStore("targetGlobal")}const tR="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class nR{constructor(e,t,r,i,a,l,h,m,v,b,D=14){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.js=a,this.window=l,this.document=h,this.Ws=v,this.zs=b,this.Hs=D,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=x=>Promise.resolve(),!nR.V())throw new Ge(Ee.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new qU(this,i),this.ei=t+"main",this.wt=new lO(m),this.ni=new xa(this.ei,this.Hs,new iB(this.wt)),this.Vs=new $U(this.referenceDelegate,this.wt),this.remoteDocumentCache=SO(this.wt),this.Ds=new OU,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,!1===b&&zr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ge(Ee.FAILED_PRECONDITION,tR);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new Fs(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){var t=this;return this.ti=function(){var r=(0,xe.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(function(){var t=(0,xe.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget((0,xe.Z)(function*(){t.started&&(yield t.ii())})))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ID(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(t=>{t||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(t=>this.isPrimary&&!t?this.li(e).next(()=>!1):!!t&&this.fi(e).next(()=>!0))).catch(e=>{if(vd(e))return Ze("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ze("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return O0(e).get("owner").next(t=>he.resolve(this.di(t)))}_i(e){return ID(e).delete(this.clientId)}wi(){var e=this;return(0,xe.Z)(function*(){if(e.isPrimary&&!e.mi(e.Zs,18e5)){e.Zs=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Ei(r,"clientMetadata");return i.K().next(a=>{const l=e.gi(a,18e5),h=a.filter(m=>-1===l.indexOf(m));return he.forEach(h,m=>i.delete(m.clientId)).next(()=>h)})}).catch(()=>[]);if(e.si)for(const r of t)e.si.removeItem(e.yi(r.clientId))}})()}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?he.resolve(!0):O0(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)){if(this.di(t)&&this.networkEnabled)return!0;if(!this.di(t)){if(!t.allowTabSynchronization)throw new Ge(Ee.FAILED_PRECONDITION,tR);return!1}}return!(!this.networkEnabled||!this.inForeground)||ID(e).K().next(r=>void 0===this.gi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const l=!this.inForeground&&i.inForeground,h=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||l&&h)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&Ze("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,xe.Z)(function*(){e.vs=!1,e.Ii(),e.Xs&&(e.Xs.cancel(),e.Xs=null),e.Ti(),e.Ei(),yield e.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new qx(t,Fs.ot);return e.li(r).next(()=>e._i(r))}),e.ni.close(),e.Ai()})()}gi(e,t){return e.filter(r=>this.mi(r.updateTimeMs,t)&&!this.pi(r.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>ID(e).K().next(t=>this.gi(t,18e5).map(r=>r.clientId)))}get started(){return this.vs}getMutationQueue(e,t){return vD.se(e,this.wt,t,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new HU(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return gD.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,t,r){Ze("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",a=15===(l=this.Hs)?PU:14===l?uO:13===l?aO:12===l?NU:11===l?oO:void _t();var l;let h;return this.ni.runTransaction(e,i,a,m=>(h=new qx(m,this.Ps?this.Ps.next():Fs.ot),"readwrite-primary"===t?this.ai(h).next(v=>!!v||this.hi(h)).next(v=>{if(!v)throw zr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new Ge(Ee.FAILED_PRECONDITION,QP);return r(h)}).next(v=>this.fi(h).next(()=>v)):this.bi(h).next(()=>r(h)))).then(m=>(h.raiseOnCommittedEvent(),m))}bi(e){return O0(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)&&!this.di(t)&&!(this.zs||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ge(Ee.FAILED_PRECONDITION,tR)})}fi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return O0(e).put("owner",t)}static V(){return xa.V()}li(e){const t=O0(e);return t.get("owner").next(r=>this.di(r)?(Ze("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):he.resolve())}mi(e,t){const r=Date.now();return!(e<r-t||e>r&&(zr(`Detected an update time that is in the future: ${e} > ${r}`),1))}ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground="visible"===this.document.visibilityState)}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Js=()=>{this.Ii(),(0,R.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var t;try{const r=null!==(null===(t=this.si)||void 0===t?void 0:t.getItem(this.yi(e)));return Ze("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return zr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){zr("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function O0(n){return Ei(n,"owner")}function ID(n){return Ei(n,"clientMetadata")}function rR(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class iR{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Pi=r,this.vi=i}static Vi(e,t){let r=ln(),i=ln();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new iR(e,t.fromCache,r,i)}}class kO{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,r,i){return this.Ci(e,t).next(a=>a||this.xi(e,t,i,r)).next(a=>a||this.Ni(e,t))}Ci(e,t){return he.resolve(null)}xi(e,t,r,i){return function $V(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}(t)||i.isEqual(Vt.min())?this.Ni(e,t):this.Di.getDocuments(e,r).next(a=>{const l=this.ki(t,a);return this.Oi(t,l,r,i)?this.Ni(e,t):(xx()<=mi.in.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),jx(t)),this.Mi(e,l,t,ZP(i,-1)))})}ki(e,t){let r=new qn(Ik(e));return t.forEach((i,a)=>{Hx(e,a)&&(r=r.add(a))}),r}Oi(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ni(e,t){return xx()<=mi.in.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",jx(t)),this.Di.getDocumentsMatchingQuery(e,t,go.min())}Mi(e,t,r,i){return this.Di.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}class sB{constructor(e,t,r,i){this.persistence=e,this.Fi=t,this.wt=i,this.$i=new Pr(sn),this.Bi=new bd(a=>Wf(a),_0),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(r)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MO(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.$i))}}function OO(n,e,t,r){return new sB(n,e,t,r)}function FO(n,e){return sR.apply(this,arguments)}function sR(){return sR=(0,xe.Z)(function*(n,e){const t=lt(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.qi(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const l=[],h=[];let m=ln();for(const v of i){l.push(v.batchId);for(const b of v.mutations)m=m.add(b.key)}for(const v of a){h.push(v.batchId);for(const b of v.mutations)m=m.add(b.key)}return t.localDocuments.getDocuments(r,m).next(v=>({Ki:v,removedBatchIds:l,addedBatchIds:h}))})})}),sR.apply(this,arguments)}function oB(n,e){const t=lt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.Ui.newChangeBuffer({trackRemovals:!0});return function(l,h,m,v){const b=m.batch,D=b.keys();let x=he.resolve();return D.forEach(j=>{x=x.next(()=>v.getEntry(h,j)).next(Q=>{const Se=m.docVersions.get(j);Ht(null!==Se),Q.version.compareTo(Se)<0&&(b.applyToRemoteDocument(Q,m),Q.isValidDocument()&&(Q.setReadTime(m.commitVersion),v.addEntry(Q)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(h,b))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let h=ln();for(let m=0;m<l.mutationResults.length;++m)l.mutationResults[m].transformResults.length>0&&(h=h.add(l.batch.mutations[m].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function LO(n){const e=lt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Vs.getLastRemoteSnapshotVersion(t))}function aB(n,e){const t=lt(n),r=e.snapshotVersion;let i=t.$i;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Ui.newChangeBuffer({trackRemovals:!0});i=t.$i;const h=[];e.targetChanges.forEach((b,D)=>{const x=i.get(D);if(!x)return;h.push(t.Vs.removeMatchingKeys(a,b.removedDocuments,D).next(()=>t.Vs.addMatchingKeys(a,b.addedDocuments,D)));let j=x.withSequenceNumber(a.currentSequenceNumber);var Q,Se,Le;e.targetMismatches.has(D)?j=j.withResumeToken(ci.EMPTY_BYTE_STRING,Vt.min()).withLastLimboFreeSnapshotVersion(Vt.min()):b.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(b.resumeToken,r)),i=i.insert(D,j),Se=j,Le=b,(0===(Q=x).resumeToken.approximateByteSize()||Se.snapshotVersion.toMicroseconds()-Q.snapshotVersion.toMicroseconds()>=3e8||Le.addedDocuments.size+Le.modifiedDocuments.size+Le.removedDocuments.size>0)&&h.push(t.Vs.updateTargetData(a,j))});let m=Ls(),v=ln();if(e.documentUpdates.forEach(b=>{e.resolvedLimboDocuments.has(b)&&h.push(t.persistence.referenceDelegate.updateLimboDocument(a,b))}),h.push(VO(a,l,e.documentUpdates).next(b=>{m=b.Gi,v=b.Qi})),!r.isEqual(Vt.min())){const b=t.Vs.getLastRemoteSnapshotVersion(a).next(D=>t.Vs.setTargetsMetadata(a,a.currentSequenceNumber,r));h.push(b)}return he.waitFor(h).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,m,v)).next(()=>m)}).then(a=>(t.$i=i,a))}function VO(n,e,t){let r=ln(),i=ln();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let l=Ls();return t.forEach((h,m)=>{const v=a.get(h);m.isFoundDocument()!==v.isFoundDocument()&&(i=i.add(h)),m.isNoDocument()&&m.version.isEqual(Vt.min())?(e.removeEntry(h,m.readTime),l=l.insert(h,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||0===m.version.compareTo(v.version)&&v.hasPendingWrites?(e.addEntry(m),l=l.insert(h,m)):Ze("LocalStore","Ignoring outdated watch update for ",h,". Current version:",v.version," Watch version:",m.version)}),{Gi:l,Qi:i}})}function uB(n,e){const t=lt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function A_(n,e){const t=lt(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Vs.getTargetData(r,e).next(a=>a?(i=a,he.resolve(i)):t.Vs.allocateTargetId(r).next(l=>(i=new Dd(e,l,0,r.currentSequenceNumber),t.Vs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.$i.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.$i=t.$i.insert(r.targetId,r),t.Bi.set(e,r.targetId)),r})}function x_(n,e,t){return oR.apply(this,arguments)}function oR(){return oR=(0,xe.Z)(function*(n,e,t){const r=lt(n),i=r.$i.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",a,l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!vd(l))throw l;Ze("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.$i=r.$i.remove(e),r.Bi.delete(i.target)}),oR.apply(this,arguments)}function CD(n,e,t){const r=lt(n);let i=Vt.min(),a=ln();return r.persistence.runTransaction("Execute query","readonly",l=>function(h,m,v){const b=lt(h),D=b.Bi.get(v);return void 0!==D?he.resolve(b.$i.get(D)):b.Vs.getTargetData(m,v)}(r,l,Zo(e)).next(h=>{if(h)return i=h.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(l,h.targetId).next(m=>{a=m})}).next(()=>r.Fi.getDocumentsMatchingQuery(l,e,t?i:Vt.min(),t?a:ln())).next(h=>(jO(r,Ek(e),h),{documents:h,ji:a})))}function UO(n,e){const t=lt(n),r=lt(t.Vs),i=t.$i.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>r.te(a,e).next(l=>l?l.target:null))}function BO(n,e){const t=lt(n),r=t.Li.get(e)||Vt.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Ui.getAllFromCollectionGroup(i,e,ZP(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(jO(t,e,i),i))}function jO(n,e,t){let r=Vt.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Li.set(e,r)}function aR(){return aR=(0,xe.Z)(function*(n,e,t,r){const i=lt(n);let a=ln(),l=Ls();for(const v of t){const b=e.Wi(v.metadata.name);v.document&&(a=a.add(b));const D=e.zi(v);D.setReadTime(e.Hi(v.metadata.readTime)),l=l.insert(b,D)}const h=i.Ui.newChangeBuffer({trackRemovals:!0}),m=yield A_(i,(v=r,Zo(y_(xn.fromString(`__bundle__/docs/${v}`)))));var v;return i.persistence.runTransaction("Apply bundle documents","readwrite",v=>VO(v,h,l).next(b=>(h.apply(v),b)).next(b=>i.Vs.removeMatchingKeysForTargetId(v,m.targetId).next(()=>i.Vs.addMatchingKeys(v,a,m.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(v,b.Gi,b.Qi)).next(()=>b.Gi)))}),aR.apply(this,arguments)}function cB(n,e){return uR.apply(this,arguments)}function uR(){return uR=(0,xe.Z)(function*(n,e,t=ln()){const r=yield A_(n,Zo(Qx(e.bundledQuery))),i=lt(n);return i.persistence.runTransaction("Save named query","readwrite",a=>{const l=wi(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Ds.saveNamedQuery(a,e);const h=r.withResumeToken(ci.EMPTY_BYTE_STRING,l);return i.$i=i.$i.insert(h.targetId,h),i.Vs.updateTargetData(a,h).next(()=>i.Vs.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>i.Vs.addMatchingKeys(a,t,r.targetId)).next(()=>i.Ds.saveNamedQuery(a,e))})}),uR.apply(this,arguments)}function HO(n,e){return`firestore_clients_${n}_${e}`}function $O(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function lR(n,e){return`firestore_targets_${n}_${e}`}class bD{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ji(e,t,r){const i=JSON.parse(r);let a,l="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return l&&i.error&&(l="string"==typeof i.error.message&&"string"==typeof i.error.code,l&&(a=new Ge(i.error.code,i.error.message))),l?new bD(e,t,i.state,a):(zr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class F0{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ji(e,t){const r=JSON.parse(t);let i,a="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(i=new Ge(r.error.code,r.error.message))),a?new F0(e,r.state,i):(zr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class DD{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ji(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,a=dD();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=ik(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return i?new DD(e,a):(zr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class cR{constructor(e,t){this.clientId=e,this.onlineState=t}static Ji(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new cR(t.clientId,t.onlineState):(zr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class dR{constructor(){this.activeTargetIds=dD()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hR{constructor(e,t,r,i,a){this.window=e,this.js=t,this.persistenceKey=r,this.tr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new Pr(sn),this.started=!1,this.ir=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.rr=HO(this.persistenceKey,this.tr),this.ur=`firestore_sequence_number_${this.persistenceKey}`,this.sr=this.sr.insert(this.tr,new dR),this.cr=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.lr=`firestore_online_state_${this.persistenceKey}`,this.dr=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,xe.Z)(function*(){const t=yield e.syncEngine.Ri();for(const i of t){if(i===e.tr)continue;const a=e.getItem(HO(e.persistenceKey,i));if(a){const l=DD.Ji(i,a);l&&(e.sr=e.sr.insert(l.clientId,l))}}e._r();const r=e.storage.getItem(e.lr);if(r){const i=e.wr(r);i&&e.mr(i)}for(const i of e.ir)e.nr(i);e.ir=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let t=!1;return this.sr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,t,r){this.yr(e,t,r),this.pr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(lR(this.persistenceKey,e));if(r){const i=F0.Ji(e,r);i&&(t=i.state)}}return this.Ir.Xi(e),this._r(),t}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(lR(this.persistenceKey,e))}updateQueryState(e,t,r){this.Tr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.pr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ze("SharedClientState","READ",e,t),t}setItem(e,t){Ze("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ze("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(Ze("SharedClientState","EVENT",r.key,r.newValue),r.key===this.rr)return void zr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable((0,xe.Z)(function*(){if(t.started){if(null!==r.key)if(t.cr.test(r.key)){if(null==r.newValue){const i=t.Rr(r.key);return t.br(i,null)}{const i=t.Pr(r.key,r.newValue);if(i)return t.br(i.clientId,i)}}else if(t.ar.test(r.key)){if(null!==r.newValue){const i=t.vr(r.key,r.newValue);if(i)return t.Vr(i)}}else if(t.hr.test(r.key)){if(null!==r.newValue){const i=t.Sr(r.key,r.newValue);if(i)return t.Dr(i)}}else if(r.key===t.lr){if(null!==r.newValue){const i=t.wr(r.newValue);if(i)return t.mr(i)}}else if(r.key===t.ur){const i=function(a){let l=Fs.ot;if(null!=a)try{const h=JSON.parse(a);Ht("number"==typeof h),l=h}catch(h){zr("SharedClientState","Failed to read sequence number from WebStorage",h)}return l}(r.newValue);i!==Fs.ot&&t.sequenceNumberHandler(i)}else if(r.key===t.dr){const i=t.Cr(r.newValue);yield Promise.all(i.map(a=>t.syncEngine.Nr(a)))}}else t.ir.push(r)}))}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,t,r){const i=new bD(this.currentUser,e,t,r),a=$O(this.persistenceKey,this.currentUser,e);this.setItem(a,i.Yi())}pr(e){const t=$O(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Er(e){this.storage.setItem(this.lr,JSON.stringify({clientId:this.tr,onlineState:e}))}Tr(e,t,r){const i=lR(this.persistenceKey,e),a=new F0(e,t,r);this.setItem(i,a.Yi())}Ar(e){const t=JSON.stringify(Array.from(e));this.setItem(this.dr,t)}Rr(e){const t=this.cr.exec(e);return t?t[1]:null}Pr(e,t){const r=this.Rr(e);return DD.Ji(r,t)}vr(e,t){const r=this.ar.exec(e),i=Number(r[1]);return bD.Ji(new yi(void 0!==r[2]?r[2]:null),i,t)}Sr(e,t){const r=this.hr.exec(e),i=Number(r[1]);return F0.Ji(i,t)}wr(e){return cR.Ji(e)}Cr(e){return JSON.parse(e)}Vr(e){var t=this;return(0,xe.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.kr(e.batchId,e.state,e.error);Ze("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Dr(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}br(e,t){const r=t?this.sr.insert(e,t):this.sr.remove(e),i=this.gr(this.sr),a=this.gr(r),l=[],h=[];return a.forEach(m=>{i.has(m)||l.push(m)}),i.forEach(m=>{a.has(m)||h.push(m)}),this.syncEngine.Mr(l,h).then(()=>{this.sr=r})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let t=dD();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class GO{constructor(){this.Fr=new dR,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,r){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new dR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class dB{Br(e){}shutdown(){}}class WO{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){Ze("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){Ze("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const hB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class fB{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class pB extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.so=(e.ssl?"https":"http")+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,r,i,a){const l=this.oo(e,t);Ze("RestConnection","Sending: ",l,r);const h={};return this.uo(h,i,a),this.co(e,l,h,r).then(m=>(Ze("RestConnection","Received: ",m),m),m=>{throw a0("RestConnection",`${e} failed with error: `,m,"url: ",l,"request:",r),m})}ao(e,t,r,i,a,l){return this.ro(e,t,r,i,a)}uo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+f_,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}oo(e,t){return`${this.so}/v1/${t}:${hB[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,r,i){return new Promise((a,l)=>{const h=new fV;h.listenOnce(cV.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Ax.NO_ERROR:const v=h.getResponseJson();Ze("Connection","XHR received:",JSON.stringify(v)),a(v);break;case Ax.TIMEOUT:Ze("Connection",'RPC "'+e+'" timed out'),l(new Ge(Ee.DEADLINE_EXCEEDED,"Request time out"));break;case Ax.HTTP_ERROR:const b=h.getStatus();if(Ze("Connection",'RPC "'+e+'" failed with status:',b,"response text:",h.getResponseText()),b>0){const D=h.getResponseJson().error;if(D&&D.status&&D.message){const x=function(j){const Q=j.toLowerCase().replace(/_/g,"-");return Object.values(Ee).indexOf(Q)>=0?Q:Ee.UNKNOWN}(D.status);l(new Ge(x,D.message))}else l(new Ge(Ee.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new Ge(Ee.UNAVAILABLE,"Connection failed."));break;default:_t()}}finally{Ze("Connection",'RPC "'+e+'" completed.')}});const m=JSON.stringify(i);h.send(t,"POST",m,r,15)})}ho(e,t,r){const i=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=uV(),l=lV(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(h.xmlHttpFactory=new hV({})),this.uo(h.initMessageHeaders,t,r),(0,R.uI)()||(0,R.b$)()||(0,R.d)()||(0,R.w1)()||(0,R.Mn)()||(0,R.ru)()||(h.httpHeadersOverwriteParam="$httpHeaders");const m=i.join("");Ze("Connection","Creating WebChannel: "+m,h);const v=a.createWebChannel(m,h);let b=!1,D=!1;const x=new fB({jr:Q=>{D?Ze("Connection","Not sending because WebChannel is closed:",Q):(b||(Ze("Connection","Opening WebChannel transport."),v.open(),b=!0),Ze("Connection","WebChannel sending:",Q),v.send(Q))},Wr:()=>v.close()}),j=(Q,Se,Le)=>{Q.listen(Se,Et=>{try{Le(Et)}catch(It){setTimeout(()=>{throw It},0)}})};return j(v,Xb.EventType.OPEN,()=>{D||Ze("Connection","WebChannel transport opened.")}),j(v,Xb.EventType.CLOSE,()=>{D||(D=!0,Ze("Connection","WebChannel transport closed"),x.eo())}),j(v,Xb.EventType.ERROR,Q=>{D||(D=!0,a0("Connection","WebChannel transport errored:",Q),x.eo(new Ge(Ee.UNAVAILABLE,"The operation could not be completed")))}),j(v,Xb.EventType.MESSAGE,Q=>{var Se;if(!D){const Le=Q.data[0];Ht(!!Le);const Et=Le,It=Et.error||(null===(Se=Et[0])||void 0===Se?void 0:Se.error);if(It){Ze("Connection","WebChannel received error:",It);const Ct=It.status;let wt=function(pn){const Zr=qr[pn];if(void 0!==Zr)return Lk(Zr)}(Ct),qt=It.message;void 0===wt&&(wt=Ee.INTERNAL,qt="Unknown error status: "+Ct+" with message "+It.message),D=!0,x.eo(new Ge(wt,qt)),v.close()}else Ze("Connection","WebChannel received:",Le),x.no(Le)}}),j(l,dV.STAT_EVENT,Q=>{Q.stat===$P.PROXY?Ze("Connection","Detected buffering proxy"):Q.stat===$P.NOPROXY&&Ze("Connection","Detected no buffering proxy")}),setTimeout(()=>{x.Zr()},0),x}}function zO(){return typeof window<"u"?window:null}function TD(){return typeof document<"u"?document:null}function L0(n){return new sU(n,!0)}class fR{constructor(e,t,r=1e3,i=1.5,a=6e4){this.js=e,this.timerId=t,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,t-r);i>0&&Ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,i,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class qO{constructor(e,t,r,i,a,l,h,m){this.js=e,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new fR(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}stop(){var e=this;return(0,xe.Z)(function*(){e.Do()&&(yield e.close(0))})()}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}Oo(){var e=this;return(0,xe.Z)(function*(){if(e.Co())return e.close(0)})()}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}close(e,t){var r=this;return(0,xe.Z)(function*(){r.Fo(),r.$o(),r.So.cancel(),r.Po++,4!==e?r.So.reset():t&&t.code===Ee.RESOURCE_EXHAUSTED?(zr(t.toString()),zr("Using maximum backoff delay to prevent overloading the backend."),r.So.po()):t&&t.code===Ee.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Bo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Jr(t)})()}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Po===t&&this.Uo(r,i)},r=>{e(()=>{const i=new Ge(Ee.UNKNOWN,"Fetching auth token failed: "+r.message);return this.qo(i)})})}Uo(e,t){const r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(()=>{r(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(i=>{r(()=>this.qo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}xo(){var e=this;this.state=5,this.So.Io((0,xe.Z)(function*(){e.state=0,e.start()}))}qo(e){return Ze("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget(()=>this.Po===e?t():(Ze("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class gB extends qO{constructor(e,t,r,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.wt=a}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function uU(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(m=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===m?1:"REMOVE"===m?2:"CURRENT"===m?3:"RESET"===m?4:_t(),i=e.targetChange.targetIds||[],a=function(m,v){return m.dt?(Ht(void 0===v||"string"==typeof v),ci.fromBase64String(v||"")):(Ht(void 0===v||v instanceof Uint8Array),ci.fromUint8Array(v||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(m){const v=void 0===m.code?Ee.UNKNOWN:Lk(m.code);return new Ge(v,m.message||"")}(l);t=new Hk(r,i,a,h||null)}else if("documentChange"in e){const r=e.documentChange,i=Nu(n,r.document.name),a=wi(r.document.updateTime),l=new Fi({mapValue:{fields:r.document.fields}}),h=ar.newFoundDocument(i,a,l);t=new hD(r.targetIds||[],r.removedTargetIds||[],h.key,h)}else if("documentDelete"in e){const r=e.documentDelete,i=Nu(n,r.document),a=r.readTime?wi(r.readTime):Vt.min(),l=ar.newNoDocument(i,a);t=new hD([],r.removedTargetIds||[],l.key,l)}else if("documentRemove"in e){const r=e.documentRemove,i=Nu(n,r.document);t=new hD([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return _t();{const r=e.filter,a=new QV(r.count||0);t=new jk(r.targetId,a)}}var m;return t}(this.wt,e),r=function(i){if(!("targetChange"in i))return Vt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Vt.min():a.readTime?wi(a.readTime):Vt.min()}(e);return this.listener.Go(t,r)}Qo(e){const t={};t.database=S0(this.wt),t.addTarget=function(i,a){let l;const h=a.target;return l=oD(h)?{documents:Jk(i,h)}:{query:Xk(i,h)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?l.resumeToken=zk(i,a.resumeToken):a.snapshotVersion.compareTo(Vt.min())>0&&(l.readTime=D0(i,a.snapshotVersion.toTimestamp())),l}(this.wt,e);const r=function cU(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _t()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Mo(t)}jo(e){const t={};t.database=S0(this.wt),t.removeTarget=e,this.Mo(t)}}class mB extends qO{constructor(e,t,r,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.wt=a,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,t){return this.bo.ho("Write",e,t)}onMessage(e){if(Ht(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const t=function lU(n,e){return n&&n.length>0?(Ht(void 0!==e),n.map(t=>function(r,i){let a=wi(r.updateTime?r.updateTime:i);return a.isEqual(Vt.min())&&(a=wi(i)),new KV(a,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=wi(e.commitTime);return this.listener.Jo(r,t)}return Ht(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=S0(this.wt),this.Mo(e)}Ho(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>A0(this.wt,r))};this.Mo(t)}}class _B extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=r,this.wt=i,this.Zo=!1}tu(){if(this.Zo)throw new Ge(Ee.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,r){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.bo.ro(e,t,r,i,a)).catch(i=>{throw"FirebaseError"===i.name?(i.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ge(Ee.UNKNOWN,i.toString())})}ao(e,t,r,i){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.bo.ao(e,t,r,a,l,i)).catch(a=>{throw"FirebaseError"===a.name?(a.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ge(Ee.UNKNOWN,a.toString())})}terminate(){this.Zo=!0}}class yB{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(zr(t),this.su=!1):Ze("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class vB{constructor(e,t,r,i,a){var l=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br(h=>{r.enqueueAndForget((0,xe.Z)(function*(){var m;Ad(l)&&(Ze("RemoteStore","Restarting streams for network reachability change."),yield(m=(0,xe.Z)(function*(v){const b=lt(v);b.lu.add(4),yield R_(b),b._u.set("Unknown"),b.lu.delete(4),yield V0(b)}),function(v){return m.apply(this,arguments)})(l))}))}),this._u=new yB(r,i)}}function V0(n){return pR.apply(this,arguments)}function pR(){return pR=(0,xe.Z)(function*(n){if(Ad(n))for(const e of n.fu)yield e(!0)}),pR.apply(this,arguments)}function R_(n){return gR.apply(this,arguments)}function gR(){return gR=(0,xe.Z)(function*(n){for(const e of n.fu)yield e(!1)}),gR.apply(this,arguments)}function SD(n,e){const t=lt(n);t.hu.has(e.targetId)||(t.hu.set(e.targetId,e),yR(t)?_R(t):N_(t).Co()&&mR(t,e))}function U0(n,e){const t=lt(n),r=N_(t);t.hu.delete(e),r.Co()&&KO(t,e),0===t.hu.size&&(r.Co()?r.ko():Ad(t)&&t._u.set("Unknown"))}function mR(n,e){n.wu.Nt(e.targetId),N_(n).Qo(e)}function KO(n,e){n.wu.Nt(e),N_(n).jo(e)}function _R(n){n.wu=new nU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),te:e=>n.hu.get(e)||null}),N_(n).start(),n._u.iu()}function yR(n){return Ad(n)&&!N_(n).Do()&&n.hu.size>0}function Ad(n){return 0===lt(n).lu.size}function ZO(n){n.wu=void 0}function wB(n){return vR.apply(this,arguments)}function vR(){return vR=(0,xe.Z)(function*(n){n.hu.forEach((e,t)=>{mR(n,e)})}),vR.apply(this,arguments)}function EB(n,e){return wR.apply(this,arguments)}function wR(){return wR=(0,xe.Z)(function*(n,e){ZO(n),yR(n)?(n._u.uu(e),_R(n)):n._u.set("Unknown")}),wR.apply(this,arguments)}function IB(n,e,t){return ER.apply(this,arguments)}function ER(){return ER=(0,xe.Z)(function*(n,e,t){if(n._u.set("Online"),e instanceof Hk&&2===e.state&&e.cause)try{yield(r=(0,xe.Z)(function*(i,a){const l=a.cause;for(const h of a.targetIds)i.hu.has(h)&&(yield i.remoteSyncer.rejectListen(h,l),i.hu.delete(h),i.wu.removeTarget(h))}),function(i,a){return r.apply(this,arguments)})(n,e)}catch(r){Ze("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield AD(n,r)}else if(e instanceof hD?n.wu.Ut(e):e instanceof jk?n.wu.zt(e):n.wu.Gt(e),!t.isEqual(Vt.min()))try{const r=yield LO(n.localStore);t.compareTo(r)>=0&&(yield function(i,a){const l=i.wu.Yt(a);return l.targetChanges.forEach((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const v=i.hu.get(m);v&&i.hu.set(m,v.withResumeToken(h.resumeToken,a))}}),l.targetMismatches.forEach(h=>{const m=i.hu.get(h);if(!m)return;i.hu.set(h,m.withResumeToken(ci.EMPTY_BYTE_STRING,m.snapshotVersion)),KO(i,h);const v=new Dd(m.target,h,1,m.sequenceNumber);mR(i,v)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(r){Ze("RemoteStore","Failed to raise snapshot:",r),yield AD(n,r)}var r}),ER.apply(this,arguments)}function AD(n,e,t){return IR.apply(this,arguments)}function IR(){return IR=(0,xe.Z)(function*(n,e,t){if(!vd(e))throw e;n.lu.add(1),yield R_(n),n._u.set("Offline"),t||(t=()=>LO(n.localStore)),n.asyncQueue.enqueueRetryable((0,xe.Z)(function*(){Ze("RemoteStore","Retrying IndexedDB access"),yield t(),n.lu.delete(1),yield V0(n)}))}),IR.apply(this,arguments)}function YO(n,e){return e().catch(t=>AD(n,t,e))}function M_(n){return CR.apply(this,arguments)}function CR(){return CR=(0,xe.Z)(function*(n){const e=lt(n),t=xd(e);let r=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;CB(e);)try{const i=yield uB(e.localStore,r);if(null===i){0===e.au.length&&t.ko();break}r=i.batchId,bB(e,i)}catch(i){yield AD(e,i)}QO(e)&&JO(e)}),CR.apply(this,arguments)}function CB(n){return Ad(n)&&n.au.length<10}function bB(n,e){n.au.push(e);const t=xd(n);t.Co()&&t.zo&&t.Ho(e.mutations)}function QO(n){return Ad(n)&&!xd(n).Do()&&n.au.length>0}function JO(n){xd(n).start()}function DB(n){return bR.apply(this,arguments)}function bR(){return bR=(0,xe.Z)(function*(n){xd(n).Xo()}),bR.apply(this,arguments)}function TB(n){return DR.apply(this,arguments)}function DR(){return DR=(0,xe.Z)(function*(n){const e=xd(n);for(const t of n.au)e.Ho(t.mutations)}),DR.apply(this,arguments)}function SB(n,e,t){return TR.apply(this,arguments)}function TR(){return TR=(0,xe.Z)(function*(n,e,t){const r=n.au.shift(),i=Zx.from(r,e,t);yield YO(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield M_(n)}),TR.apply(this,arguments)}function AB(n,e){return SR.apply(this,arguments)}function SR(){return SR=(0,xe.Z)(function*(n,e){var t;e&&xd(n).zo&&(yield(t=(0,xe.Z)(function*(r,i){if(Fk(a=i.code)&&a!==Ee.ABORTED){const l=r.au.shift();xd(r).No(),yield YO(r,()=>r.remoteSyncer.rejectFailedWrite(l.batchId,i)),yield M_(r)}var a}),function(r,i){return t.apply(this,arguments)})(n,e)),QO(n)&&JO(n)}),SR.apply(this,arguments)}function XO(n,e){return AR.apply(this,arguments)}function AR(){return AR=(0,xe.Z)(function*(n,e){const t=lt(n);t.asyncQueue.verifyOperationInProgress(),Ze("RemoteStore","RemoteStore received new credentials");const r=Ad(t);t.lu.add(3),yield R_(t),r&&t._u.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.lu.delete(3),yield V0(t)}),AR.apply(this,arguments)}function xR(n,e){return RR.apply(this,arguments)}function RR(){return RR=(0,xe.Z)(function*(n,e){const t=lt(n);e?(t.lu.delete(2),yield V0(t)):e||(t.lu.add(2),yield R_(t),t._u.set("Unknown"))}),RR.apply(this,arguments)}function N_(n){return n.mu||(n.mu=function(e,t,r){const i=lt(e);return i.tu(),new gB(t,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)}(n.datastore,n.asyncQueue,{zr:wB.bind(null,n),Jr:EB.bind(null,n),Go:IB.bind(null,n)}),n.fu.push(function(){var e=(0,xe.Z)(function*(t){t?(n.mu.No(),yR(n)?_R(n):n._u.set("Unknown")):(yield n.mu.stop(),ZO(n))});return function(t){return e.apply(this,arguments)}}())),n.mu}function xd(n){return n.gu||(n.gu=function(e,t,r){const i=lt(e);return i.tu(),new mB(t,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)}(n.datastore,n.asyncQueue,{zr:DB.bind(null,n),Jr:AB.bind(null,n),Yo:TB.bind(null,n),Jo:SB.bind(null,n)}),n.fu.push(function(){var e=(0,xe.Z)(function*(t){t?(n.gu.No(),yield M_(n)):(yield n.gu.stop(),n.au.length>0&&(Ze("RemoteStore",`Stopping write stream with ${n.au.length} pending writes`),n.au=[]))});return function(t){return e.apply(this,arguments)}}())),n.gu}class MR{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new vi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}static createAndSchedule(e,t,r,i,a){const l=Date.now()+r,h=new MR(e,t,l,i,a);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ge(Ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function P_(n,e){if(zr("AsyncQueue",`${e}: ${n}`),vd(n))return new Ge(Ee.UNAVAILABLE,`${e}: ${n}`);throw n}class k_{constructor(e){this.comparator=e?(t,r)=>e(t,r)||st.comparator(t.key,r.key):(t,r)=>st.comparator(t.key,r.key),this.keyedMap=E0(),this.sortedSet=new Pr(this.comparator)}static emptySet(e){return new k_(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof k_)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new k_;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class e1{constructor(){this.yu=new Pr(st.comparator)}track(e){const t=e.doc.key,r=this.yu.get(t);r?0!==e.type&&3===r.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==r.type?this.yu=this.yu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.yu=this.yu.remove(t):1===e.type&&2===r.type?this.yu=this.yu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):_t():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal((t,r)=>{e.push(r)}),e}}class O_{constructor(e,t,r,i,a,l,h,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=m}static fromInitialDocuments(e,t,r,i){const a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new O_(e,t,k_.emptySet(t),a,r,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&y0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class xB{constructor(){this.Iu=void 0,this.listeners=[]}}class RB{constructor(){this.queries=new bd(e=>wk(e),y0),this.onlineState="Unknown",this.Tu=new Set}}function NR(n,e){return PR.apply(this,arguments)}function PR(){return PR=(0,xe.Z)(function*(n,e){const t=lt(n),r=e.query;let i=!1,a=t.queries.get(r);if(a||(i=!0,a=new xB),i)try{a.Iu=yield t.onListen(r)}catch(l){const h=P_(l,`Initialization of query '${jx(e.query)}' failed`);return void e.onError(h)}t.queries.set(r,a),a.listeners.push(e),e.Eu(t.onlineState),a.Iu&&e.Au(a.Iu)&&FR(t)}),PR.apply(this,arguments)}function kR(n,e){return OR.apply(this,arguments)}function OR(){return OR=(0,xe.Z)(function*(n,e){const t=lt(n),r=e.query;let i=!1;const a=t.queries.get(r);if(a){const l=a.listeners.indexOf(e);l>=0&&(a.listeners.splice(l,1),i=0===a.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),OR.apply(this,arguments)}function MB(n,e){const t=lt(n);let r=!1;for(const i of e){const l=t.queries.get(i.query);if(l){for(const h of l.listeners)h.Au(i)&&(r=!0);l.Iu=i}}r&&FR(t)}function NB(n,e,t){const r=lt(n),i=r.queries.get(e);if(i)for(const a of i.listeners)a.onError(t);r.queries.delete(e)}function FR(n){n.Tu.forEach(e=>{e.next()})}class LR{constructor(e,t,r){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}Au(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new O_(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}vu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Su(e){e=O_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class PB{constructor(e,t){this.payload=e,this.byteLength=t}Cu(){return"metadata"in this.payload}}class t1{constructor(e){this.wt=e}Wi(e){return Nu(this.wt,e)}zi(e){return e.metadata.exists?Qk(this.wt,e.document,!1):ar.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return wi(e)}}class kB{constructor(e,t,r){this.xu=e,this.localStore=t,this.wt=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=n1(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;const r=xn.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ku(e){const t=new Map,r=new t1(this.wt);for(const i of e)if(i.metadata.queries){const a=r.Wi(i.metadata.name);for(const l of i.metadata.queries){const h=(t.get(l)||ln()).add(a);t.set(l,h)}}return t}complete(){var e=this;return(0,xe.Z)(function*(){const t=yield function lB(n,e,t,r){return aR.apply(this,arguments)}(e.localStore,new t1(e.wt),e.documents,e.xu.id),r=e.ku(e.documents);for(const i of e.queries)yield cB(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Ou:e.collectionGroups,Mu:t}})()}}function n1(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class r1{constructor(e){this.key=e}}class i1{constructor(e){this.key=e}}class s1{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=ln(),this.mutatedKeys=ln(),this.Lu=Ik(e),this.Uu=new k_(this.Lu)}get qu(){return this.Fu}Ku(e,t){const r=t?t.Gu:new e1,i=t?t.Uu:this.Uu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,h=!1;const m="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,v="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((b,D)=>{const x=i.get(b),j=Hx(this.query,D)?D:null,Q=!!x&&this.mutatedKeys.has(x.key),Se=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let Le=!1;x&&j?x.data.isEqual(j.data)?Q!==Se&&(r.track({type:3,doc:j}),Le=!0):this.Qu(x,j)||(r.track({type:2,doc:j}),Le=!0,(m&&this.Lu(j,m)>0||v&&this.Lu(j,v)<0)&&(h=!0)):!x&&j?(r.track({type:0,doc:j}),Le=!0):x&&!j&&(r.track({type:1,doc:x}),Le=!0,(m||v)&&(h=!0)),Le&&(j?(l=l.add(j),a=Se?a.add(b):a.delete(b)):(l=l.delete(b),a=a.delete(b)))}),null!==this.query.limit)for(;l.size>this.query.limit;){const b="F"===this.query.limitType?l.last():l.first();l=l.delete(b.key),a=a.delete(b.key),r.track({type:1,doc:b})}return{Uu:l,Gu:r,Oi:h,mutatedKeys:a}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const a=e.Gu.pu();a.sort((v,b)=>function(D,x){const j=Q=>{switch(Q){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _t()}};return j(D)-j(x)}(v.type,b.type)||this.Lu(v.doc,b.doc)),this.ju(r);const l=t?this.Wu():[],h=0===this.Bu.size&&this.current?1:0,m=h!==this.$u;return this.$u=h,0!==a.length||m?{snapshot:new O_(this.query,e.Uu,i,a,e.mutatedKeys,0===h,m,!1),zu:l}:{zu:l}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new e1,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(t=>this.Fu=this.Fu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Fu=this.Fu.delete(t)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=ln(),this.Uu.forEach(r=>{this.Hu(r.key)&&(this.Bu=this.Bu.add(r.key))});const t=[];return e.forEach(r=>{this.Bu.has(r)||t.push(new i1(r))}),this.Bu.forEach(r=>{e.has(r)||t.push(new r1(r))}),t}Ju(e){this.Fu=e.ji,this.Bu=ln();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return O_.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class OB{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class FB{constructor(e){this.key=e,this.Xu=!1}}class LB{constructor(e,t,r,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Zu={},this.tc=new bd(h=>wk(h),y0),this.ec=new Map,this.nc=new Set,this.sc=new Pr(st.comparator),this.ic=new Map,this.rc=new eR,this.oc={},this.uc=new Map,this.cc=ep.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}function VB(n,e){return VR.apply(this,arguments)}function VR(){return VR=(0,xe.Z)(function*(n,e){const t=aM(n);let r,i;const a=t.tc.get(e);if(a)r=a.targetId,t.sharedClientState.addLocalQueryTarget(r),i=a.view.Yu();else{const l=yield A_(t.localStore,Zo(e));t.isPrimaryClient&&SD(t.remoteStore,l);const h=t.sharedClientState.addLocalQueryTarget(l.targetId);r=l.targetId,i=yield UR(t,e,r,"current"===h)}return i}),VR.apply(this,arguments)}function UR(n,e,t,r){return BR.apply(this,arguments)}function BR(){return BR=(0,xe.Z)(function*(n,e,t,r){n.hc=(b,D,x)=>{return(j=(0,xe.Z)(function*(Q,Se,Le,Et){let It=Se.view.Ku(Le);It.Oi&&(It=yield CD(Q.localStore,Se.query,!1).then(({documents:qt})=>Se.view.Ku(qt,It)));const Ct=Et&&Et.targetChanges.get(Se.targetId),wt=Se.view.applyChanges(It,Q.isPrimaryClient,Ct);return YR(Q,Se.targetId,wt.zu),wt.snapshot}),function(Q,Se,Le,Et){return j.apply(this,arguments)})(n,b,D,x);var j};const i=yield CD(n.localStore,e,!0),a=new s1(e,i.ji),l=a.Ku(i.documents),h=b0.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState),m=a.applyChanges(l,n.isPrimaryClient,h);YR(n,t,m.zu);const v=new OB(e,t,a);return n.tc.set(e,v),n.ec.has(t)?n.ec.get(t).push(e):n.ec.set(t,[e]),m.snapshot}),BR.apply(this,arguments)}function UB(n,e){return jR.apply(this,arguments)}function jR(){return jR=(0,xe.Z)(function*(n,e){const t=lt(n),r=t.tc.get(e),i=t.ec.get(r.targetId);if(i.length>1)return t.ec.set(r.targetId,i.filter(a=>!y0(a,e))),void t.tc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield x_(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),U0(t.remoteStore,r.targetId),F_(t,r.targetId)}).catch(yd))):(F_(t,r.targetId),yield x_(t.localStore,r.targetId,!0))}),jR.apply(this,arguments)}function HR(){return HR=(0,xe.Z)(function*(n,e,t){const r=uM(n);try{const i=yield function(a,l){const h=lt(a),m=yr.now(),v=l.reduce((x,j)=>x.add(j.key),ln());let b,D;return h.persistence.runTransaction("Locally write mutations","readwrite",x=>{let j=Ls(),Q=ln();return h.Ui.getEntries(x,v).next(Se=>{j=Se,j.forEach((Le,Et)=>{Et.isValidDocument()||(Q=Q.add(Le))})}).next(()=>h.localDocuments.getOverlayedDocuments(x,j)).next(Se=>{b=Se;const Le=[];for(const Et of l){const It=YV(Et,b.get(Et.key).overlayedDocument);null!=It&&Le.push(new Bl(Et.key,It,dk(It.value.mapValue),br.exists(!0)))}return h.mutationQueue.addMutationBatch(x,m,Le,l)}).next(Se=>{D=Se;const Le=Se.applyToLocalDocumentSet(b,Q);return h.documentOverlayCache.saveOverlays(x,Se.batchId,Le)})}).then(()=>({batchId:D.batchId,changes:Uk(b)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,h){let m=a.oc[a.currentUser.toKey()];m||(m=new Pr(sn)),m=m.insert(l,h),a.oc[a.currentUser.toKey()]=m}(r,i.batchId,t),yield jl(r,i.changes),yield M_(r.remoteStore)}catch(i){const a=P_(i,"Failed to persist write");t.reject(a)}}),HR.apply(this,arguments)}function o1(n,e){return $R.apply(this,arguments)}function $R(){return $R=(0,xe.Z)(function*(n,e){const t=lt(n);try{const r=yield aB(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.ic.get(a);l&&(Ht(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?l.Xu=!0:i.modifiedDocuments.size>0?Ht(l.Xu):i.removedDocuments.size>0&&(Ht(l.Xu),l.Xu=!1))}),yield jl(t,r,e)}catch(r){yield yd(r)}}),$R.apply(this,arguments)}function a1(n,e,t){const r=lt(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.tc.forEach((a,l)=>{const h=l.view.Eu(e);h.snapshot&&i.push(h.snapshot)}),function(a,l){const h=lt(a);h.onlineState=l;let m=!1;h.queries.forEach((v,b)=>{for(const D of b.listeners)D.Eu(l)&&(m=!0)}),m&&FR(h)}(r.eventManager,e),i.length&&r.Zu.Go(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function jB(n,e,t){return GR.apply(this,arguments)}function GR(){return GR=(0,xe.Z)(function*(n,e,t){const r=lt(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.ic.get(e),a=i&&i.key;if(a){let l=new Pr(st.comparator);l=l.insert(a,ar.newNoDocument(a,Vt.min()));const h=ln().add(a),m=new C0(Vt.min(),new Map,new qn(sn),l,h);yield o1(r,m),r.sc=r.sc.remove(a),r.ic.delete(e),QR(r)}else yield x_(r.localStore,e,!1).then(()=>F_(r,e,t)).catch(yd)}),GR.apply(this,arguments)}function HB(n,e){return WR.apply(this,arguments)}function WR(){return WR=(0,xe.Z)(function*(n,e){const t=lt(n),r=e.batch.batchId;try{const i=yield oB(t.localStore,e);ZR(t,r,null),KR(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield jl(t,i)}catch(i){yield yd(i)}}),WR.apply(this,arguments)}function $B(n,e,t){return zR.apply(this,arguments)}function zR(){return zR=(0,xe.Z)(function*(n,e,t){const r=lt(n);try{const i=yield function(a,l){const h=lt(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let v;return h.mutationQueue.lookupMutationBatch(m,l).next(b=>(Ht(null!==b),v=b.keys(),h.mutationQueue.removeMutationBatch(m,b))).next(()=>h.mutationQueue.performConsistencyCheck(m)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(m,v,l)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v)).next(()=>h.localDocuments.getDocuments(m,v))})}(r.localStore,e);ZR(r,e,t),KR(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield jl(r,i)}catch(i){yield yd(i)}}),zR.apply(this,arguments)}function qR(){return qR=(0,xe.Z)(function*(n,e){const t=lt(n);Ad(t.remoteStore)||Ze("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const l=lt(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>l.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(-1===r)return void e.resolve();const i=t.uc.get(r)||[];i.push(e),t.uc.set(r,i)}catch(r){const i=P_(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),qR.apply(this,arguments)}function KR(n,e){(n.uc.get(e)||[]).forEach(t=>{t.resolve()}),n.uc.delete(e)}function ZR(n,e,t){const r=lt(n);let i=r.oc[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.oc[r.currentUser.toKey()]=i}}function F_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.ec.get(e))n.tc.delete(r),t&&n.Zu.lc(r,t);n.ec.delete(e),n.isPrimaryClient&&n.rc.us(e).forEach(r=>{n.rc.containsKey(r)||u1(n,r)})}function u1(n,e){n.nc.delete(e.path.canonicalString());const t=n.sc.get(e);null!==t&&(U0(n.remoteStore,t),n.sc=n.sc.remove(e),n.ic.delete(t),QR(n))}function YR(n,e,t){for(const r of t)r instanceof r1?(n.rc.addReference(r.key,e),WB(n,r)):r instanceof i1?(Ze("SyncEngine","Document no longer in limbo: "+r.key),n.rc.removeReference(r.key,e),n.rc.containsKey(r.key)||u1(n,r.key)):_t()}function WB(n,e){const t=e.key,r=t.path.canonicalString();n.sc.get(t)||n.nc.has(r)||(Ze("SyncEngine","New document in limbo: "+t),n.nc.add(r),QR(n))}function QR(n){for(;n.nc.size>0&&n.sc.size<n.maxConcurrentLimboResolutions;){const e=n.nc.values().next().value;n.nc.delete(e);const t=new st(xn.fromString(e)),r=n.cc.next();n.ic.set(r,new FB(t)),n.sc=n.sc.insert(t,r),SD(n.remoteStore,new Dd(Zo(y_(t.path)),r,2,Fs.ot))}}function jl(n,e,t){return JR.apply(this,arguments)}function JR(){return JR=(0,xe.Z)(function*(n,e,t){const r=lt(n),i=[],a=[],l=[];var h;r.tc.isEmpty()||(r.tc.forEach((h,m)=>{l.push(r.hc(m,e,t).then(v=>{if(v){r.isPrimaryClient&&r.sharedClientState.updateQueryState(m.targetId,v.fromCache?"not-current":"current"),i.push(v);const b=iR.Vi(m.targetId,v);a.push(b)}}))}),yield Promise.all(l),r.Zu.Go(i),yield(h=(0,xe.Z)(function*(m,v){const b=lt(m);try{yield b.persistence.runTransaction("notifyLocalViewChanges","readwrite",D=>he.forEach(v,x=>he.forEach(x.Pi,j=>b.persistence.referenceDelegate.addReference(D,x.targetId,j)).next(()=>he.forEach(x.vi,j=>b.persistence.referenceDelegate.removeReference(D,x.targetId,j)))))}catch(D){if(!vd(D))throw D;Ze("LocalStore","Failed to update sequence numbers: "+D)}for(const D of v){const x=D.targetId;if(!D.fromCache){const j=b.$i.get(x),Se=j.withLastLimboFreeSnapshotVersion(j.snapshotVersion);b.$i=b.$i.insert(x,Se)}}}),function(m,v){return h.apply(this,arguments)})(r.localStore,a))}),JR.apply(this,arguments)}function zB(n,e){return XR.apply(this,arguments)}function XR(){return XR=(0,xe.Z)(function*(n,e){const t=lt(n);if(!t.currentUser.isEqual(e)){Ze("SyncEngine","User change. New user:",e.toKey());const r=yield FO(t.localStore,e);t.currentUser=e,(i=t).uc.forEach(l=>{l.forEach(h=>{h.reject(new Ge(Ee.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.uc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield jl(t,r.Ki)}var i}),XR.apply(this,arguments)}function qB(n,e){const t=lt(n),r=t.ic.get(e);if(r&&r.Xu)return ln().add(r.key);{let i=ln();const a=t.ec.get(e);if(!a)return i;for(const l of a){const h=t.tc.get(l);i=i.unionWith(h.view.qu)}return i}}function KB(n,e){return eM.apply(this,arguments)}function eM(){return eM=(0,xe.Z)(function*(n,e){const t=lt(n),r=yield CD(t.localStore,e.query,!0),i=e.view.Ju(r);return t.isPrimaryClient&&YR(t,e.targetId,i.zu),i}),eM.apply(this,arguments)}function ZB(n,e){return tM.apply(this,arguments)}function tM(){return tM=(0,xe.Z)(function*(n,e){const t=lt(n);return BO(t.localStore,e).then(r=>jl(t,r))}),tM.apply(this,arguments)}function YB(n,e,t,r){return nM.apply(this,arguments)}function nM(){return nM=(0,xe.Z)(function*(n,e,t,r){const i=lt(n),a=yield function(l,h){const m=lt(l),v=lt(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",b=>v.yn(b,h).next(D=>D?m.localDocuments.getDocuments(b,D):he.resolve(null)))}(i.localStore,e);var h;null!==a?("pending"===t?yield M_(i.remoteStore):"acknowledged"===t||"rejected"===t?(ZR(i,e,r||null),KR(i,e),h=e,lt(lt(i.localStore).mutationQueue).In(h)):_t(),yield jl(i,a)):Ze("SyncEngine","Cannot apply mutation batch with id: "+e)}),nM.apply(this,arguments)}function rM(){return rM=(0,xe.Z)(function*(n,e){const t=lt(n);if(aM(t),uM(t),!0===e&&!0!==t.ac){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield l1(t,r.toArray());t.ac=!0,yield xR(t.remoteStore,!0);for(const a of i)SD(t.remoteStore,a)}else if(!1===e&&!1!==t.ac){const r=[];let i=Promise.resolve();t.ec.forEach((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then(()=>(F_(t,l),x_(t.localStore,l,!0))),U0(t.remoteStore,l)}),yield i,yield l1(t,r),function(a){const l=lt(a);l.ic.forEach((h,m)=>{U0(l.remoteStore,m)}),l.rc.cs(),l.ic=new Map,l.sc=new Pr(st.comparator)}(t),t.ac=!1,yield xR(t.remoteStore,!1)}}),rM.apply(this,arguments)}function l1(n,e,t){return iM.apply(this,arguments)}function iM(){return iM=(0,xe.Z)(function*(n,e,t){const r=lt(n),i=[],a=[];for(const l of e){let h;const m=r.ec.get(l);if(m&&0!==m.length){h=yield A_(r.localStore,Zo(m[0]));for(const v of m){const b=r.tc.get(v),D=yield KB(r,b);D.snapshot&&a.push(D.snapshot)}}else{const v=yield UO(r.localStore,l);h=yield A_(r.localStore,v),yield UR(r,c1(v),l,!1)}i.push(h)}return r.Zu.Go(a),i}),iM.apply(this,arguments)}function c1(n){return yk(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function JB(n){const e=lt(n);return lt(lt(e.localStore).persistence).Ri()}function XB(n,e,t,r){return sM.apply(this,arguments)}function sM(){return sM=(0,xe.Z)(function*(n,e,t,r){const i=lt(n);if(i.ac)return void Ze("SyncEngine","Ignoring unexpected query state notification.");const a=i.ec.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=yield BO(i.localStore,Ek(a[0])),h=C0.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield jl(i,l,h);break}case"rejected":yield x_(i.localStore,e,!0),F_(i,e,r);break;default:_t()}}),sM.apply(this,arguments)}function e2(n,e,t){return oM.apply(this,arguments)}function oM(){return oM=(0,xe.Z)(function*(n,e,t){const r=aM(n);if(r.ac){for(const i of e){if(r.ec.has(i)){Ze("SyncEngine","Adding an already active target "+i);continue}const a=yield UO(r.localStore,i),l=yield A_(r.localStore,a);yield UR(r,c1(a),l.targetId,!1),SD(r.remoteStore,l)}for(const i of t)r.ec.has(i)&&(yield x_(r.localStore,i,!1).then(()=>{U0(r.remoteStore,i),F_(r,i)}).catch(yd))}}),oM.apply(this,arguments)}function aM(n){const e=lt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=o1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jB.bind(null,e),e.Zu.Go=MB.bind(null,e.eventManager),e.Zu.lc=NB.bind(null,e.eventManager),e}function uM(n){const e=lt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=HB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$B.bind(null,e),e}class d1{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,xe.Z)(function*(){t.wt=L0(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),yield t.persistence.start(),t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore)})()}mc(e,t){return null}gc(e,t){return null}wc(e){return OO(this.persistence,new kO,e.initialUser,this.wt)}_c(e){return new NO(ED.Ms,this.wt)}dc(e){return new GO}terminate(){var e=this;return(0,xe.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class h1 extends d1{constructor(e,t,r){super(),this.yc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,xe.Z)(function*(){yield t().call(r,e),yield r.yc.initialize(r,e),yield uM(r.yc.syncEngine),yield M_(r.yc.remoteStore),yield r.persistence.ci(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}wc(e){return OO(this.persistence,new kO,e.initialUser,this.wt)}mc(e,t){return new WU(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}gc(e,t){const r=new SV(t,this.persistence);return new TV(e.asyncQueue,r)}_c(e){const t=rR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Vs.withCacheSize(this.cacheSizeBytes):Vs.DEFAULT;return new nR(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,zO(),TD(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new GO}}class n2 extends h1{constructor(e,t){super(e,t,!1),this.yc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,xe.Z)(function*(){yield t().call(r,e);const i=r.yc.syncEngine;r.sharedClientState instanceof hR&&(r.sharedClientState.syncEngine={kr:YB.bind(null,i),Or:XB.bind(null,i),Mr:e2.bind(null,i),Ri:JB.bind(null,i),Nr:ZB.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.ci(function(){var a=(0,xe.Z)(function*(l){yield function QB(n,e){return rM.apply(this,arguments)}(r.yc.syncEngine,l),r.gcScheduler&&(l&&!r.gcScheduler.started?r.gcScheduler.start():l||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(l&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():l||r.indexBackfillerScheduler.stop())});return function(l){return a.apply(this,arguments)}}())})()}dc(e){const t=zO();if(!hR.V(t))throw new Ge(Ee.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=rR(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new hR(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class lM{initialize(e,t){var r=this;return(0,xe.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>a1(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=zB.bind(null,r.syncEngine),yield xR(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new RB}createDatastore(e){const t=L0(e.databaseInfo.databaseId),r=new pB(e.databaseInfo);return new _B(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,a=h=>a1(this.syncEngine,h,0),l=WO.V()?new WO:new dB,new vB(t,r,i,a,l);var t,r,i,a,l}createSyncEngine(e,t){return function(r,i,a,l,h,m,v){const b=new LB(r,i,a,l,h,m);return v&&(b.ac=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,xe.Z)(function*(t){const r=lt(t);Ze("RemoteStore","RemoteStore shutting down."),r.lu.add(5),yield R_(r),r.du.shutdown(),r._u.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function f1(n,e=10240){let t=0;return{read:()=>(0,xe.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,xe.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class xD{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class r2{constructor(e,t){this.Ec=e,this.wt=t,this.metadata=new vi,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(r=>{r&&r.Cu()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.payload)}`))},r=>this.metadata.reject(r))}close(){return this.Ec.cancel()}getMetadata(){var e=this;return(0,xe.Z)(function*(){return e.metadata.promise})()}fc(){var e=this;return(0,xe.Z)(function*(){return yield e.getMetadata(),e.Rc()})()}Rc(){var e=this;return(0,xe.Z)(function*(){const t=yield e.bc();if(null===t)return null;const r=e.Ac.decode(t),i=Number(r);isNaN(i)&&e.Pc(`length string (${r}) is not valid number`);const a=yield e.vc(i);return new PB(JSON.parse(a),t.length+i)})()}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}bc(){var e=this;return(0,xe.Z)(function*(){for(;e.Vc()<0&&!(yield e.Sc()););if(0===e.buffer.length)return null;const t=e.Vc();t<0&&e.Pc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}vc(e){var t=this;return(0,xe.Z)(function*(){for(;t.buffer.length<e;)(yield t.Sc())&&t.Pc("Reached the end of bundle when more is expected.");const r=t.Ac.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}Sc(){var e=this;return(0,xe.Z)(function*(){const t=yield e.Ec.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class i2{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,xe.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Ge(Ee.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,xe.Z)(function*(a,l){const h=lt(a),m=S0(h.wt)+"/documents",v={documents:l.map(j=>T0(h.wt,j))},b=yield h.ao("BatchGetDocuments",m,v,l.length),D=new Map;b.forEach(j=>{const Q=function aU(n,e){return"found"in e?function(t,r){Ht(!!r.found);const i=Nu(t,r.found.name),a=wi(r.found.updateTime),l=new Fi({mapValue:{fields:r.found.fields}});return ar.newFoundDocument(i,a,l)}(n,e):"missing"in e?function(t,r){Ht(!!r.missing),Ht(!!r.readTime);const i=Nu(t,r.missing),a=wi(r.readTime);return ar.newNoDocument(i,a)}(n,e):_t()}(h.wt,j);D.set(Q.key.toString(),Q)});const x=[];return l.forEach(j=>{const Q=D.get(j.toString());Ht(!!Q),x.push(Q)}),x}),function(a,l){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new C_(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,xe.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const a=st.fromPath(i);e.mutations.push(new $x(a,e.precondition(a)))}),yield(r=(0,xe.Z)(function*(i,a){const l=lt(i),h=S0(l.wt)+"/documents",m={writes:a.map(v=>A0(l.wt,v))};yield l.ro("Commit",h,m)}),function(i,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw _t();t=Vt.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Ge(Ee.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?br.updateTime(t):br.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Vt.min()))throw new Ge(Ee.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return br.updateTime(t)}return br.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class s2{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.Dc=r.maxAttempts,this.So=new fR(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){var e=this;this.So.Io((0,xe.Z)(function*(){const t=new i2(e.datastore),r=e.xc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(a=>{e.Nc(a)}))}).catch(i=>{e.Nc(i)})}))}xc(e){try{const t=this.updateFunction(e);return!h0(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!Fk(t)}return!1}}class o2{constructor(e,t,r,i){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=yi.UNAUTHENTICATED,this.clientId=qP.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var l=(0,xe.Z)(function*(h){Ze("FirestoreClient","Received user=",h.uid),yield a.authCredentialListener(h),a.user=h});return function(h){return l.apply(this,arguments)}}()),this.appCheckCredentials.start(r,l=>(Ze("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}getConfiguration(){var e=this;return(0,xe.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ge(Ee.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new vi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,xe.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=P_(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function p1(n,e){return cM.apply(this,arguments)}function cM(){return cM=(0,xe.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),Ze("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,xe.Z)(function*(a){r.isEqual(a)||(yield FO(e.localStore,a),r=a)});return function(a){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),cM.apply(this,arguments)}function g1(n,e){return dM.apply(this,arguments)}function dM(){return dM=(0,xe.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield hM(n);Ze("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>XO(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,a)=>XO(e.remoteStore,a)),n.onlineComponents=e}),dM.apply(this,arguments)}function hM(n){return fM.apply(this,arguments)}function fM(){return fM=(0,xe.Z)(function*(n){return n.offlineComponents||(Ze("FirestoreClient","Using default OfflineComponentProvider"),yield p1(n,new d1)),n.offlineComponents}),fM.apply(this,arguments)}function RD(n){return pM.apply(this,arguments)}function pM(){return pM=(0,xe.Z)(function*(n){return n.onlineComponents||(Ze("FirestoreClient","Using default OnlineComponentProvider"),yield g1(n,new lM)),n.onlineComponents}),pM.apply(this,arguments)}function m1(n){return hM(n).then(e=>e.persistence)}function gM(n){return hM(n).then(e=>e.localStore)}function _1(n){return RD(n).then(e=>e.remoteStore)}function mM(n){return RD(n).then(e=>e.syncEngine)}function L_(n){return _M.apply(this,arguments)}function _M(){return _M=(0,xe.Z)(function*(n){const e=yield RD(n),t=e.eventManager;return t.onListen=VB.bind(null,e.syncEngine),t.onUnlisten=UB.bind(null,e.syncEngine),t}),_M.apply(this,arguments)}function y1(n,e,t={}){const r=new vi;return n.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){return function(i,a,l,h,m){const v=new xD({next:D=>{a.enqueueAndForget(()=>kR(i,b));const x=D.docs.has(l);!x&&D.fromCache?m.reject(new Ge(Ee.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&D.fromCache&&h&&"server"===h.source?m.reject(new Ge(Ee.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(D)},error:D=>m.reject(D)}),b=new LR(y_(l.path),v,{includeMetadataChanges:!0,Du:!0});return NR(i,b)}(yield L_(n),n.asyncQueue,e,t,r)})),r.promise}function v1(n,e,t={}){const r=new vi;return n.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){return function(i,a,l,h,m){const v=new xD({next:D=>{a.enqueueAndForget(()=>kR(i,b)),D.fromCache&&"server"===h.source?m.reject(new Ge(Ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(D)},error:D=>m.reject(D)}),b=new LR(l,v,{includeMetadataChanges:!0,Du:!0});return NR(i,b)}(yield L_(n),n.asyncQueue,e,t,r)})),r.promise}const w1=new Map;function yM(n,e,t){if(!t)throw new Ge(Ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function E1(n,e,t,r){if(!0===e&&!0===r)throw new Ge(Ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function I1(n){if(!st.isDocumentKey(n))throw new Ge(Ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function C1(n){if(st.isDocumentKey(n))throw new Ge(Ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function MD(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":_t()}function Cn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ge(Ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=MD(n);throw new Ge(Ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function b1(n,e){if(e<=0)throw new Ge(Ee.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class D1{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Ge(Ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ge(Ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,E1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class B0{constructor(e,t,r){this._authCredentials=t,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new D1({}),this._settingsFrozen=!1,e instanceof Vl?this._databaseId=e:(this._app=e,this._databaseId=function(i){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new Ge(Ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vl(i.options.projectId)}(e))}get app(){if(!this._app)throw new Ge(Ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ge(Ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new D1(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new mV;switch(t.type){case"gapi":const r=t.client;return Ht(!("object"!=typeof r||null===r||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new wV(r,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Ge(Ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=w1.get(e);t&&(Ze("ComponentProvider","Removing Datastore"),w1.delete(e),t.terminate())}(this),Promise.resolve()}}class hr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ku(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hr(this.firestore,e,this._key)}}class Ji{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ji(this.firestore,e,this._query)}}class ku extends Ji{constructor(e,t,r){super(e,t,y_(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hr(this.firestore,null,new st(e))}withConverter(e){return new ku(this.firestore,e,this._path)}}function T1(n,e,...t){if(n=(0,R.m9)(n),yM("collection","path",e),n instanceof B0){const r=xn.fromString(e,...t);return C1(r),new ku(n,null,r)}{if(!(n instanceof hr||n instanceof ku))throw new Ge(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(xn.fromString(e,...t));return C1(r),new ku(n.firestore,null,r)}}function ND(n,e,...t){if(n=(0,R.m9)(n),1===arguments.length&&(e=qP.I()),yM("doc","path",e),n instanceof B0){const r=xn.fromString(e,...t);return I1(r),new hr(n,null,new st(r))}{if(!(n instanceof hr||n instanceof ku))throw new Ge(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(xn.fromString(e,...t));return I1(r),new hr(n.firestore,n instanceof ku?n.converter:null,new st(r))}}function S1(n,e){return n=(0,R.m9)(n),e=(0,R.m9)(e),(n instanceof hr||n instanceof ku)&&(e instanceof hr||e instanceof ku)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function A1(n,e){return n=(0,R.m9)(n),e=(0,R.m9)(e),n instanceof Ji&&e instanceof Ji&&n.firestore===e.firestore&&y0(n._query,e._query)&&n.converter===e.converter}class _2{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new fR(this,"async_queue_retry"),this.Kc=()=>{const t=TD();t&&Ze("AsyncQueue","Visibility state changed to "+t.visibilityState),this.So.Eo()};const e=TD();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=TD();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const t=new vi;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}jc(){var e=this;return(0,xe.Z)(function*(){if(0!==e.Mc.length){try{yield e.Mc[0](),e.Mc.shift(),e.So.reset()}catch(t){if(!vd(t))throw t;Ze("AsyncQueue","Operation failed with retryable error: "+t)}e.Mc.length>0&&e.So.Io(()=>e.jc())}})()}Qc(e){const t=this.Oc.then(()=>(this.Lc=!0,e().catch(r=>{throw this.Bc=r,this.Lc=!1,zr("INTERNAL UNHANDLED ERROR: ",function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),l}(r)),r}).then(r=>(this.Lc=!1,r))));return this.Oc=t,t}enqueueAfterDelay(e,t,r){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const i=MR.createAndSchedule(this,e,t,r,a=>this.Wc(a));return this.$c.push(i),i}Gc(){this.Bc&&_t()}verifyOperationInProgress(){}zc(){var e=this;return(0,xe.Z)(function*(){let t;do{t=e.Oc,yield t}while(t!==e.Oc)})()}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function vM(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class y2{constructor(){this._progressObserver={},this._taskCompletionResolver=new vi,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class vr extends B0{constructor(e,t,r){super(e,t,r),this.type="firestore",this._queue=new _2,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||x1(this),this._firestoreClient.terminate()}}function Kr(n){return n._firestoreClient||x1(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function x1(n){var e;const t=n._freezeSettings(),r=(a=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new RV(n._databaseId,a,n._persistenceKey,(h=t).host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,h.useFetchStreams));var a,h;n._firestoreClient=new o2(n._authCredentials,n._appCheckCredentials,n._queue,r)}function R1(n,e,t){const r=new vi;return n.asyncQueue.enqueue((0,xe.Z)(function*(){try{yield p1(n,t),yield g1(n,e),r.resolve()}catch(i){const a=i;if(!("FirebaseError"===(l=a).name?l.code===Ee.FAILED_PRECONDITION||l.code===Ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||22===l.code||20===l.code||11===l.code))throw a;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a)}var l})).then(()=>r.promise)}function M1(n){if(n._initialized||n._terminated)throw new Ge(Ee.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Hl{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Ge(Ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ou{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ou(ci.fromBase64String(e))}catch(t){throw new Ge(Ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ou(ci.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class np{constructor(e){this._methodName=e}}class PD{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ge(Ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ge(Ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return sn(this._lat,e._lat)||sn(this._long,e._long)}}const A2=/^__.*__$/;class x2{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Bl(e,this.data,this.fieldMask,t,this.fieldTransforms):new I_(e,this.data,t,this.fieldTransforms)}}class N1{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Bl(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function P1(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _t()}}class kD{constructor(e,t,r,i,a,l){this.settings=e,this.databaseId=t,this.wt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Xc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new kD(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ta({path:r,na:!1});return i.sa(e),i}ia(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ta({path:r,na:!1});return i.Xc(),i}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return LD(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(P1(this.Zc)&&A2.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class R2{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.wt=r||L0(e)}aa(e,t,r,i=!1){return new kD({Zc:e,methodName:t,ca:r,path:Vr.emptyPath(),na:!1,ua:i},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function rp(n){const e=n._freezeSettings(),t=L0(n._databaseId);return new R2(n._databaseId,!!e.ignoreUndefinedProperties,t)}function OD(n,e,t,r,i,a={}){const l=n.aa(a.merge||a.mergeFields?2:0,e,t,i);CM("Data must be an object, but it was:",l,r);const h=F1(r,l);let m,v;if(a.merge)m=new mo(l.fieldMask),v=l.fieldTransforms;else if(a.mergeFields){const b=[];for(const D of a.mergeFields){const x=bM(e,D,t);if(!l.contains(x))throw new Ge(Ee.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);V1(b,x)||b.push(x)}m=new mo(b),v=l.fieldTransforms.filter(D=>m.covers(D.field))}else m=null,v=l.fieldTransforms;return new x2(new Fi(h),m,v)}class j0 extends np{_toFieldTransform(e){if(2!==e.Zc)throw e.oa(1===e.Zc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof j0}}function k1(n,e,t){return new kD({Zc:3,ca:e.settings.ca,methodName:n._methodName,na:t},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class wM extends np{_toFieldTransform(e){return new v0(e.path,new w_)}isEqual(e){return e instanceof wM}}class M2 extends np{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=k1(this,e,!0),r=this.ha.map(a=>ip(a,t)),i=new zf(r);return new v0(e.path,i)}isEqual(e){return this===e}}class N2 extends np{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=k1(this,e,!0),r=this.ha.map(a=>ip(a,t)),i=new qf(r);return new v0(e.path,i)}isEqual(e){return this===e}}class P2 extends np{constructor(e,t){super(e),this.la=t}_toFieldTransform(e){const t=new E_(e.wt,Dk(e.wt,this.la));return new v0(e.path,t)}isEqual(e){return this===e}}function EM(n,e,t,r){const i=n.aa(1,e,t);CM("Data must be an object, but it was:",i,r);const a=[],l=Fi.empty();jf(r,(m,v)=>{const b=FD(e,m,t);v=(0,R.m9)(v);const D=i.ia(b);if(v instanceof j0)a.push(b);else{const x=ip(v,D);null!=x&&(a.push(b),l.set(b,x))}});const h=new mo(a);return new N1(l,h,i.fieldTransforms)}function IM(n,e,t,r,i,a){const l=n.aa(1,e,t),h=[bM(e,r,t)],m=[i];if(a.length%2!=0)throw new Ge(Ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)h.push(bM(e,a[x])),m.push(a[x+1]);const v=[],b=Fi.empty();for(let x=h.length-1;x>=0;--x)if(!V1(v,h[x])){const j=h[x];let Q=m[x];Q=(0,R.m9)(Q);const Se=l.ia(j);if(Q instanceof j0)v.push(j);else{const Le=ip(Q,Se);null!=Le&&(v.push(j),b.set(j,Le))}}const D=new mo(v);return new N1(b,D,l.fieldTransforms)}function O1(n,e,t,r=!1){return ip(t,n.aa(r?4:3,e))}function ip(n,e){if(L1(n=(0,R.m9)(n)))return CM("Unsupported field value:",e,n),F1(n,e);if(n instanceof np)return function(t,r){if(!P1(r.Zc))throw r.oa(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.oa(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.na&&4!==e.Zc)throw e.oa("Nested arrays are not supported");return function(t,r){const i=[];let a=0;for(const l of t){let h=ip(l,r.ra(a));null==h&&(h={nullValue:"NULL_VALUE"}),i.push(h),a++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,R.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Dk(r.wt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=yr.fromDate(t);return{timestampValue:D0(r.wt,i)}}if(t instanceof yr){const i=new yr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:D0(r.wt,i)}}if(t instanceof PD)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ou)return{bytesValue:zk(r.wt,t._byteString)};if(t instanceof hr){const i=r.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw r.oa(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Gx(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.oa(`Unsupported field value: ${MD(t)}`)}(n,e)}function F1(n,e){const t={};return tk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jf(n,(r,i)=>{const a=ip(i,e.ea(r));null!=a&&(t[r]=a)}),{mapValue:{fields:t}}}function L1(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof yr||n instanceof PD||n instanceof Ou||n instanceof hr||n instanceof np)}function CM(n,e,t){if(!L1(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=MD(t);throw e.oa("an object"===r?n+" a custom object":n+" "+r)}var r}function bM(n,e,t){if((e=(0,R.m9)(e))instanceof Hl)return e._internalPath;if("string"==typeof e)return FD(n,e);throw LD("Field path arguments must be of type string or ",n,!1,void 0,t)}const k2=new RegExp("[~\\*/\\[\\]]");function FD(n,e,t){if(e.search(k2)>=0)throw LD(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Hl(...e.split("."))._internalPath}catch{throw LD(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function LD(n,e,t,r,i){const a=r&&!r.isEmpty(),l=void 0!==i;let h=`Function ${e}() called with invalid data`;t&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(a||l)&&(m+=" (found",a&&(m+=` in field ${r}`),l&&(m+=` in document ${i}`),m+=")"),new Ge(Ee.INVALID_ARGUMENT,h+n+m)}function V1(n,e){return n.some(t=>t.isEqual(e))}class H0{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new hr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new O2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(VD("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class O2 extends H0{data(){return super.data()}}function VD(n,e){return"string"==typeof e?FD(n,e):e instanceof Hl?e._internalPath:e._delegate._internalPath}class sp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $l extends H0{constructor(e,t,r,i,a,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new $0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(VD("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class $0 extends $l{data(e={}){return super.data(e)}}class Rd{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new sp(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new $0(this._firestore,this._userDataWriter,r.key,r,new sp(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ge(Ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>({type:"added",doc:new $0(r._firestore,r._userDataWriter,l.doc.key,l.doc,new sp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:a++}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||3!==l.type).map(l=>{const h=new $0(r._firestore,r._userDataWriter,l.doc.key,l.doc,new sp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let m=-1,v=-1;return 0!==l.type&&(m=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),1!==l.type&&(a=a.add(l.doc),v=a.indexOf(l.doc.key)),{type:F2(l.type),doc:h,oldIndex:m,newIndex:v}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function F2(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _t()}}function U1(n,e){return n instanceof $l&&e instanceof $l?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Rd&&e instanceof Rd&&n._firestore===e._firestore&&A1(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function B1(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Ge(Ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class G0{}function Md(n,...e){for(const t of e)n=t._apply(n);return n}class L2 extends G0{constructor(e,t,r){super(),this.fa=e,this.da=t,this._a=r,this.type="where"}_apply(e){const t=rp(e.firestore),r=function(i,a,l,h,m,v,b){let D;if(m.isKeyField()){if("array-contains"===v||"array-contains-any"===v)throw new Ge(Ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if("in"===v||"not-in"===v){z1(b,v);const j=[];for(const Q of b)j.push(W1(h,i,Q));D={arrayValue:{values:j}}}else D=W1(h,i,b)}else"in"!==v&&"not-in"!==v&&"array-contains-any"!==v||z1(b,v),D=O1(l,"where",b,"in"===v||"not-in"===v);const x=Li.create(m,v,D);return function(j,Q){if(Q.ht()){const Le=Ux(j);if(null!==Le&&!Le.isEqual(Q.field))throw new Ge(Ee.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Le.toString()}' and '${Q.field.toString()}'`);const Et=Vx(j);null!==Et&&q1(0,Q.field,Et)}const Se=function(Le,Et){for(const It of Le.filters)if(Et.indexOf(It.op)>=0)return It.op;return null}(j,function(Le){switch(Le){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(Q.op));if(null!==Se)throw new Ge(Ee.INVALID_ARGUMENT,Se===Q.op?`Invalid query. You cannot use more than one '${Q.op.toString()}' filter.`:`Invalid query. You cannot use '${Q.op.toString()}' filters with '${Se.toString()}' filters.`)}(i,x),x}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new Ji(e.firestore,e.converter,function(i,a){const l=i.filters.concat([a]);return new Ul(i.path,i.collectionGroup,i.explicitOrderBy.slice(),l,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}class U2 extends G0{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(r,i,a){if(null!==r.startAt)throw new Ge(Ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Ge(Ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const l=new __(i,a);return function(h,m){if(null===Vx(h)){const v=Ux(h);null!==v&&q1(0,v,m.field)}}(r,l),l}(e._query,this.fa,this.wa);return new Ji(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new Ul(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class j1 extends G0{constructor(e,t,r){super(),this.type=e,this.ma=t,this.ga=r}_apply(e){return new Ji(e.firestore,e.converter,vk(e._query,this.ma,this.ga))}}class H1 extends G0{constructor(e,t,r){super(),this.type=e,this.ya=t,this.pa=r}_apply(e){const t=G1(e,this.type,this.ya,this.pa);return new Ji(e.firestore,e.converter,(i=t,new Ul((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class $1 extends G0{constructor(e,t,r){super(),this.type=e,this.ya=t,this.pa=r}_apply(e){const t=G1(e,this.type,this.ya,this.pa);return new Ji(e.firestore,e.converter,(i=t,new Ul((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function G1(n,e,t,r){if(t[0]=(0,R.m9)(t[0]),t[0]instanceof H0)return function(i,a,l,h,m){if(!h)throw new Ge(Ee.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const v=[];for(const b of v_(i))if(b.field.isKeyField())v.push(Gf(a,h.key));else{const D=h.data.field(b.field);if(Ox(D))throw new Ge(Ee.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+b.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===D){const x=b.field.canonicalString();throw new Ge(Ee.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${x}' (used as the orderBy) does not exist.`)}v.push(D)}return new Cd(v,m)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=rp(n.firestore);return function(a,l,h,m,v,b){const D=a.explicitOrderBy;if(v.length>D.length)throw new Ge(Ee.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const x=[];for(let j=0;j<v.length;j++){const Q=v[j];if(D[j].field.isKeyField()){if("string"!=typeof Q)throw new Ge(Ee.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof Q}`);if(!Bx(a)&&-1!==Q.indexOf("/"))throw new Ge(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${Q}' contains a slash.`);const Se=a.path.child(xn.fromString(Q));if(!st.isDocumentKey(Se))throw new Ge(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${Se}' is not because it contains an odd number of segments.`);const Le=new st(Se);x.push(Gf(l,Le))}else{const Se=O1(h,m,Q);x.push(Se)}}return new Cd(x,b)}(n._query,n.firestore._databaseId,i,e,t,r)}}function W1(n,e,t){if("string"==typeof(t=(0,R.m9)(t))){if(""===t)throw new Ge(Ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bx(e)&&-1!==t.indexOf("/"))throw new Ge(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(xn.fromString(t));if(!st.isDocumentKey(r))throw new Ge(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Gf(n,new st(r))}if(t instanceof hr)return Gf(n,t._key);throw new Ge(Ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${MD(t)}.`)}function z1(n,e){if(!Array.isArray(n)||0===n.length)throw new Ge(Ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Ge(Ee.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function q1(n,e,t){if(!t.isEqual(e))throw new Ge(Ee.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}const q2={maxAttempts:5};class DM{convertValue(e,t="none"){switch($f(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Hf(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw _t()}}convertObject(e,t){const r={};return jf(e.fields,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertGeoPoint(e){return new PD(kr(e.latitude),kr(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=rk(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(d0(e));default:return null}}convertTimestamp(e){const t=wd(e);return new yr(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=xn.fromString(e);Ht(nO(r));const i=new Vl(r.get(1),r.get(3)),a=new st(r.popFirst(5));return i.isEqual(t)||zr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function UD(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class K2 extends DM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ou(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hr(this.firestore,null,t)}}class K1{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=rp(e)}set(e,t,r){this._verifyNotCommitted();const i=Nd(e,this._firestore),a=UD(i.converter,t,r),l=OD(this._dataReader,"WriteBatch.set",i._key,a,null!==i.converter,r);return this._mutations.push(l.toMutation(i._key,br.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Nd(e,this._firestore);let l;return l="string"==typeof(t=(0,R.m9)(t))||t instanceof Hl?IM(this._dataReader,"WriteBatch.update",a._key,t,r,i):EM(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,br.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Nd(e,this._firestore);return this._mutations=this._mutations.concat(new C_(t._key,br.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ge(Ee.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Nd(n,e){if((n=(0,R.m9)(n)).firestore!==e)throw new Ge(Ee.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class op extends DM{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ou(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hr(this.firestore,null,t)}}function Z1(n,e,t){n=Cn(n,hr);const r=Cn(n.firestore,vr),i=UD(n.converter,e,t);return V_(r,[OD(rp(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,br.none())])}function Y1(n,e,t,...r){n=Cn(n,hr);const i=Cn(n.firestore,vr),a=rp(i);let l;return l="string"==typeof(e=(0,R.m9)(e))||e instanceof Hl?IM(a,"updateDoc",n._key,e,t,r):EM(a,"updateDoc",n._key,e),V_(i,[l.toMutation(n._key,br.exists(!0))])}function Q1(n,...e){var t,r,i;n=(0,R.m9)(n);let a={includeMetadataChanges:!1},l=0;"object"!=typeof e[l]||vM(e[l])||(a=e[l],l++);const h={includeMetadataChanges:a.includeMetadataChanges};if(vM(e[l])){const D=e[l];e[l]=null===(t=D.next)||void 0===t?void 0:t.bind(D),e[l+1]=null===(r=D.error)||void 0===r?void 0:r.bind(D),e[l+2]=null===(i=D.complete)||void 0===i?void 0:i.bind(D)}let m,v,b;if(n instanceof hr)v=Cn(n.firestore,vr),b=y_(n._key.path),m={next:D=>{e[l]&&e[l](TM(v,n,D))},error:e[l+1],complete:e[l+2]};else{const D=Cn(n,Ji);v=Cn(D.firestore,vr),b=D._query;const x=new op(v);m={next:j=>{e[l]&&e[l](new Rd(v,x,D,j))},error:e[l+1],complete:e[l+2]},B1(n._query)}return function(D,x,j,Q){const Se=new xD(Q),Le=new LR(x,Se,j);return D.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){return NR(yield L_(D),Le)})),()=>{Se.Tc(),D.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){return kR(yield L_(D),Le)}))}}(Kr(v),b,h,m)}function V_(n,e){return function(t,r){const i=new vi;return t.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){return function BB(n,e,t){return HR.apply(this,arguments)}(yield mM(t),r,i)})),i.promise}(Kr(n),e)}function TM(n,e,t){const r=t.docs.get(e._key),i=new op(n);return new $l(n,i,e._key,r,new sp(t.hasPendingWrites,t.fromCache),e.converter)}class ij extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=rp(e)}get(e){const t=Nd(e,this._firestore),r=new K2(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return _t();const a=i[0];if(a.isFoundDocument())return new H0(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new H0(this._firestore,r,t._key,null,t.converter);throw _t()})}set(e,t,r){const i=Nd(e,this._firestore),a=UD(i.converter,t,r),l=OD(this._dataReader,"Transaction.set",i._key,a,null!==i.converter,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const a=Nd(e,this._firestore);let l;return l="string"==typeof(t=(0,R.m9)(t))||t instanceof Hl?IM(this._dataReader,"Transaction.update",a._key,t,r,i):EM(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=Nd(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Nd(e,this._firestore),r=new op(this._firestore);return super.get(e).then(i=>new $l(this._firestore,r,t._key,i._document,new sp(!1,!1),t.converter))}}function SM(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ge("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function X1(){if(typeof Uint8Array>"u")throw new Ge("unimplemented","Uint8Arrays are not available in this environment.")}function eF(){if(!function AV(){return typeof atob<"u"}())throw new Ge("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){f_=Si.SDK_VERSION,(0,Si._registerComponent)(new no.wA("firestore",(t,{options:r})=>{const i=t.getProvider("app").getImmediate(),a=new vr(i,new yV(t.getProvider("auth-internal")),new EV(t.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:e},r),a._setSettings(r),a},"PUBLIC")),(0,Si.registerVersion)(GP,"3.4.13",n),(0,Si.registerVersion)(GP,"3.4.13","esm2017")}();class W0{constructor(e){this._delegate=e}static fromBase64String(e){return eF(),new W0(Ou.fromBase64String(e))}static fromUint8Array(e){return X1(),new W0(Ou.fromUint8Array(e))}toBase64(){return eF(),this._delegate.toBase64()}toUint8Array(){return X1(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function AM(n){return function fj(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class pj{enableIndexedDbPersistence(e,t){return function w2(n,e){M1(n=Cn(n,vr));const t=Kr(n),r=n._freezeSettings(),i=new lM;return R1(t,i,new h1(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function E2(n){M1(n=Cn(n,vr));const e=Kr(n),t=n._freezeSettings(),r=new lM;return R1(e,r,new n2(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function I2(n){if(n._initialized&&!n._terminated)throw new Ge(Ee.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new vi;return n._queue.enqueueAndForgetEvenWhileRestricted((0,xe.Z)(function*(){try{yield(t=(0,xe.Z)(function*(r){if(!xa.V())return Promise.resolve();const i=r+"main";yield xa.delete(i)}),function(r){return t.apply(this,arguments)})(rR(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class tF{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Vl||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&a0("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function g2(n,e,t,r={}){var i;const a=(n=Cn(n,B0))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&a0("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let l,h;if("string"==typeof r.mockUserToken)l=r.mockUserToken,h=yi.MOCK_USER;else{l=(0,R.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new Ge(Ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new yi(m)}n._authCredentials=new _V(new WP(l,h))}}(this._delegate,e,t,r)}enableNetwork(){return function b2(n){return function a2(n){return n.asyncQueue.enqueue((0,xe.Z)(function*(){const e=yield m1(n),t=yield _1(n);return e.setNetworkEnabled(!0),function(r){const i=lt(r);return i.lu.delete(0),V0(i)}(t)}))}(Kr(n=Cn(n,vr)))}(this._delegate)}disableNetwork(){return function D2(n){return function u2(n){return n.asyncQueue.enqueue((0,xe.Z)(function*(){const e=yield m1(n),t=yield _1(n);return e.setNetworkEnabled(!1),(r=(0,xe.Z)(function*(i){const a=lt(i);a.lu.add(0),yield R_(a),a._u.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(Kr(n=Cn(n,vr)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,E1("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function C2(n){return function(e){const t=new vi;return e.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){return function GB(n,e){return qR.apply(this,arguments)}(yield mM(e),t)})),t.promise}(Kr(n=Cn(n,vr)))}(this._delegate)}onSnapshotsInSync(e){return function rj(n,e){return function d2(n,e){const t=new xD(e);return n.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){return r=yield L_(n),i=t,lt(r).Tu.add(i),void i.next();var r,i})),()=>{t.Tc(),n.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){return r=yield L_(n),i=t,void lt(r).Tu.delete(i);var r,i}))}}(Kr(n=Cn(n,vr)),vM(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Ge("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new U_(this,T1(this._delegate,e))}catch(t){throw ws(t,"collection()","Firestore.collection()")}}doc(e){try{return new Yo(this,ND(this._delegate,e))}catch(t){throw ws(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Es(this,function m2(n,e){if(n=Cn(n,B0),yM("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ge(Ee.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ji(n,null,(t=e,new Ul(xn.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw ws(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function sj(n,e,t){n=Cn(n,vr);const r=Object.assign(Object.assign({},q2),t);return function(i){if(i.maxAttempts<1)throw new Ge(Ee.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function h2(n,e,t){const r=new vi;return n.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){const i=yield(a=n,RD(a).then(l=>l.datastore));var a;new s2(n.asyncQueue,i,t,e,r).run()})),r.promise}(Kr(n),i=>e(new ij(n,i)),r)}(this._delegate,t=>e(new nF(this,t)))}batch(){return Kr(this._delegate),new rF(new K1(this._delegate,e=>V_(this._delegate,e)))}loadBundle(e){return function T2(n,e){const t=Kr(n=Cn(n,vr)),r=new y2;return function f2(n,e,t,r){const i=function(a,l){let h;return h="string"==typeof a?(new TextEncoder).encode(a):a,m=function(m,v){if(m instanceof Uint8Array)return f1(m,v);if(m instanceof ArrayBuffer)return f1(new Uint8Array(m),v);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),new r2(m,l);var m}(t,L0(e));n.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){!function t2(n,e,t){const r=lt(n);var i;(i=(0,xe.Z)(function*(a,l,h){try{const m=yield l.getMetadata();if(yield function(x,j){const Q=lt(x),Se=wi(j.createTime);return Q.persistence.runTransaction("hasNewerBundle","readonly",Le=>Q.Ds.getBundleMetadata(Le,j.id)).then(Le=>!!Le&&Le.createTime.compareTo(Se)>=0)}(a.localStore,m))return yield l.close(),h._completeWith({taskState:"Success",documentsLoaded:(x=m).totalDocuments,bytesLoaded:x.totalBytes,totalDocuments:x.totalDocuments,totalBytes:x.totalBytes}),Promise.resolve(new Set);h._updateProgress(n1(m));const v=new kB(m,a.localStore,l.wt);let b=yield l.fc();for(;b;){const x=yield v.Nu(b);x&&h._updateProgress(x),b=yield l.fc()}const D=yield v.complete();return yield jl(a,D.Mu,void 0),yield function(x,j){const Q=lt(x);return Q.persistence.runTransaction("Save bundle","readwrite",Se=>Q.Ds.saveBundleMetadata(Se,j))}(a.localStore,m),h._completeWith(D.progress),Promise.resolve(D.Ou)}catch(m){return a0("SyncEngine",`Loading bundle failed with ${m}`),h._failWith(m),Promise.resolve(new Set)}var x}),function(a,l,h){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield mM(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function S2(n,e){return function p2(n,e){return n.asyncQueue.enqueue((0,xe.Z)(function*(){return function(t,r){const i=lt(t);return i.persistence.runTransaction("Get named query","readonly",a=>i.Ds.getNamedQuery(a,r))}(yield gM(n),e)}))}(Kr(n=Cn(n,vr)),e).then(t=>t?new Ji(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Es(this,t):null)}}class BD extends DM{constructor(e){super(),this.firestore=e}convertBytes(e){return new W0(new Ou(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Yo.forKey(t,this.firestore,null)}}class nF{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new BD(e)}get(e){const t=up(e);return this._delegate.get(t).then(r=>new z0(this._firestore,new $l(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=up(e);return r?(SM("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=up(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=up(e);return this._delegate.delete(t),this}}class rF{constructor(e){this._delegate=e}set(e,t,r){const i=up(e);return r?(SM("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=up(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=up(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class ap{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new $0(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new q0(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=ap.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new ap(e,new BD(e),t),i.set(t,a)),a}}ap.INSTANCES=new WeakMap;class Yo{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new BD(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Ge("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Yo(t,new hr(t._delegate,r,new st(e)))}static forKey(e,t,r){return new Yo(t,new hr(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new U_(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new U_(this.firestore,T1(this._delegate,e))}catch(t){throw ws(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,R.m9)(e))instanceof hr&&S1(this._delegate,e)}set(e,t){t=SM("DocumentReference.set",t);try{return t?Z1(this._delegate,e,t):Z1(this._delegate,e)}catch(r){throw ws(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?Y1(this._delegate,e):Y1(this._delegate,e,t,...r)}catch(i){throw ws(i,"updateDoc()","DocumentReference.update()")}}delete(){return function tj(n){return V_(Cn(n.firestore,vr),[new C_(n._key,br.none())])}(this._delegate)}onSnapshot(...e){const t=iF(e),r=sF(e,i=>new z0(this.firestore,new $l(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Q1(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function Y2(n){n=Cn(n,hr);const e=Cn(n.firestore,vr),t=Kr(e),r=new op(e);return function l2(n,e){const t=new vi;return n.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){return(r=(0,xe.Z)(function*(i,a,l){try{const h=yield function(m,v){const b=lt(m);return b.persistence.runTransaction("read document","readonly",D=>b.localDocuments.getDocument(D,v))}(i,a);h.isFoundDocument()?l.resolve(h):h.isNoDocument()?l.resolve(null):l.reject(new Ge(Ee.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(h){const m=P_(h,`Failed to get document '${a} from cache`);l.reject(m)}}),function(i,a,l){return r.apply(this,arguments)})(yield gM(n),e,t);var r})),t.promise}(t,n._key).then(i=>new $l(e,r,n._key,i,new sp(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function Q2(n){n=Cn(n,hr);const e=Cn(n.firestore,vr);return y1(Kr(e),n._key,{source:"server"}).then(t=>TM(e,n,t))}(this._delegate):function Z2(n){n=Cn(n,hr);const e=Cn(n.firestore,vr);return y1(Kr(e),n._key).then(t=>TM(e,n,t))}(this._delegate),t.then(r=>new z0(this.firestore,new $l(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Yo(this.firestore,this._delegate.withConverter(e?ap.getInstance(this.firestore,e):null))}}function ws(n,e,t){return n.message=n.message.replace(e,t),n}function iF(n){for(const e of n)if("object"==typeof e&&!AM(e))return e;return{}}function sF(n,e){var t,r;let i;return i=AM(n[0])?n[0]:AM(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{i.next&&i.next(e(a))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class z0{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Yo(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return U1(this._delegate,e._delegate)}}class q0 extends z0{data(e){const t=this._delegate.data(e);return function gV(n,e){n||_t()}(void 0!==t),t}}class Es{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new BD(e)}where(e,t,r){try{return new Es(this.firestore,Md(this._delegate,function V2(n,e,t){const r=e,i=VD("where",n);return new L2(i,r,t)}(e,t,r)))}catch(i){throw ws(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Es(this.firestore,Md(this._delegate,function B2(n,e="asc"){const t=e,r=VD("orderBy",n);return new U2(r,t)}(e,t)))}catch(r){throw ws(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Es(this.firestore,Md(this._delegate,function j2(n){return b1("limit",n),new j1("limit",n,"F")}(e)))}catch(t){throw ws(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Es(this.firestore,Md(this._delegate,function H2(n){return b1("limitToLast",n),new j1("limitToLast",n,"L")}(e)))}catch(t){throw ws(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Es(this.firestore,Md(this._delegate,function $2(...n){return new H1("startAt",n,!0)}(...e)))}catch(t){throw ws(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Es(this.firestore,Md(this._delegate,function G2(...n){return new H1("startAfter",n,!1)}(...e)))}catch(t){throw ws(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Es(this.firestore,Md(this._delegate,function W2(...n){return new $1("endBefore",n,!1)}(...e)))}catch(t){throw ws(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Es(this.firestore,Md(this._delegate,function z2(...n){return new $1("endAt",n,!0)}(...e)))}catch(t){throw ws(t,"endAt()","Query.endAt()")}}isEqual(e){return A1(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function X2(n){n=Cn(n,Ji);const e=Cn(n.firestore,vr),t=Kr(e),r=new op(e);return function c2(n,e){const t=new vi;return n.asyncQueue.enqueueAndForget((0,xe.Z)(function*(){return(r=(0,xe.Z)(function*(i,a,l){try{const h=yield CD(i,a,!0),m=new s1(a,h.ji),v=m.Ku(h.documents),b=m.applyChanges(v,!1);l.resolve(b.snapshot)}catch(h){const m=P_(h,`Failed to execute query '${a} against cache`);l.reject(m)}}),function(i,a,l){return r.apply(this,arguments)})(yield gM(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Rd(e,r,n,i))}(this._delegate):"server"===e?.source?function ej(n){n=Cn(n,Ji);const e=Cn(n.firestore,vr),t=Kr(e),r=new op(e);return v1(t,n._query,{source:"server"}).then(i=>new Rd(e,r,n,i))}(this._delegate):function J2(n){n=Cn(n,Ji);const e=Cn(n.firestore,vr),t=Kr(e),r=new op(e);return B1(n._query),v1(t,n._query).then(i=>new Rd(e,r,n,i))}(this._delegate),t.then(r=>new xM(this.firestore,new Rd(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=iF(e),r=sF(e,i=>new xM(this.firestore,new Rd(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Q1(this._delegate,t,r)}withConverter(e){return new Es(this.firestore,this._delegate.withConverter(e?ap.getInstance(this.firestore,e):null))}}class mj{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new q0(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class xM{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Es(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new q0(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new mj(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new q0(this._firestore,r))})}isEqual(e){return U1(this._delegate,e._delegate)}}class U_ extends Es{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Yo(this.firestore,e):null}doc(e){try{return new Yo(this.firestore,void 0===e?ND(this._delegate):ND(this._delegate,e))}catch(t){throw ws(t,"doc()","CollectionReference.doc()")}}add(e){return function nj(n,e){const t=Cn(n.firestore,vr),r=ND(n),i=UD(n.converter,e);return V_(t,[OD(rp(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,br.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Yo(this.firestore,t))}isEqual(e){return S1(this._delegate,e._delegate)}withConverter(e){return new U_(this.firestore,this._delegate.withConverter(e?ap.getInstance(this.firestore,e):null))}}function up(n){return Cn(n,hr)}class RM{constructor(...e){this._delegate=new Hl(...e)}static documentId(){return new RM(Vr.keyField().canonicalString())}isEqual(e){return(e=(0,R.m9)(e))instanceof Hl&&this._delegate._internalPath.isEqual(e._internalPath)}}class lp{constructor(e){this._delegate=e}static serverTimestamp(){const e=function aj(){return new wM("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new lp(e)}static delete(){const e=function oj(){return new j0("deleteField")}();return e._methodName="FieldValue.delete",new lp(e)}static arrayUnion(...e){const t=function uj(...n){return new M2("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new lp(t)}static arrayRemove(...e){const t=function lj(...n){return new N2("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new lp(t)}static increment(e){const t=function cj(n){return new P2("increment",n)}(e);return t._methodName="FieldValue.increment",new lp(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const _j={Firestore:tF,GeoPoint:PD,Timestamp:yr,Blob:W0,Transaction:nF,WriteBatch:rF,DocumentReference:Yo,DocumentSnapshot:z0,Query:Es,QueryDocumentSnapshot:q0,QuerySnapshot:xM,CollectionReference:U_,FieldPath:RM,FieldValue:lp,setLogLevel:function gj(n){!function pV(n){_d.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function oF(n,e){return function wj(n,e=Ay.z){return new Mn.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function MM(n,e){return oF(n,e).pipe((0,Ot.U)(t=>({payload:t,type:"query"})))}function jD(n,e){return MM(n,e).pipe(Da(void 0),vw(),(0,Ot.U)(([t,r])=>{const i=r.payload.docChanges(),a=i.map(l=>({type:l.type,payload:l}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((l,h)=>{const m=i.find(b=>b.doc.ref.isEqual(l.ref)),v=t?.payload.docs.find(b=>b.ref.isEqual(l.ref));m&&JSON.stringify(m.doc.metadata)===JSON.stringify(l.metadata)||!m&&v&&JSON.stringify(v.metadata)===JSON.stringify(l.metadata)||a.push({type:"modified",payload:{oldIndex:h,newIndex:h,type:"modified",doc:l}})}),a}))}function aF(n,e,t){return jD(n,t).pipe(to((r,i)=>function Ij(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function Cj(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return NM(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return NM(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return NM(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(a=>a.payload),e),[]),bE(),(0,Ot.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function NM(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function uF(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}!function vj(n){(function yj(n,e){n.INTERNAL.registerComponent(new no.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},_j)))})(n,(e,t)=>new tF(e,t,new pj)),n.registerVersion("@firebase/firestore-compat","0.1.22")}(xy.Z);class lF{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=jD(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Ot.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Da(void 0),vw(),Ri(([r,i])=>i.length>0||!r),(0,Ot.U)(([r,i])=>i),An.iC)}auditTrail(e){return this.stateChanges(e).pipe(to((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=uF(e);return aF(this.query,t,this.afs.schedulers.outsideAngular).pipe(An.iC)}valueChanges(e={}){return MM(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ot.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),An.iC)}get(e){return(0,kn.D)(this.query.get(e)).pipe(An.iC)}add(e){return this.ref.add(e)}doc(e){return new cF(this.ref.doc(e),this.afs)}}class cF{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:a}=fF(r,t);return new lF(i,a,this.afs)}snapshotChanges(){return function Ej(n,e){return oF(n,e).pipe(Da(void 0),vw(),(0,Ot.U)(([t,r])=>r.exists?t?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(An.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Ot.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,kn.D)(this.ref.get(e)).pipe(An.iC)}}class bj{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?jD(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ot.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),Ri(t=>t.length>0),An.iC):jD(this.query,this.afs.schedulers.outsideAngular).pipe(An.iC)}auditTrail(e){return this.stateChanges(e).pipe(to((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=uF(e);return aF(this.query,t,this.afs.schedulers.outsideAngular).pipe(An.iC)}valueChanges(e={}){return MM(this.query,this.afs.schedulers.outsideAngular).pipe((0,Ot.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),An.iC)}get(e){return(0,kn.D)(this.query.get(e)).pipe(An.iC)}}const dF=new f.OlP("angularfire2.enableFirestorePersistence"),hF=new f.OlP("angularfire2.firestore.persistenceSettings"),Dj=new f.OlP("angularfire2.firestore.settings"),Tj=new f.OlP("angularfire2.firestore.use-emulator");function fF(n,e=(t=>t)){return{query:e(n),ref:n}}let PM=(()=>{class n{constructor(t,r,i,a,l,h,m,v,b,D,x,j,Q,Se,Le,Et,It){this.schedulers=m;const Ct=(0,xr.on)(t,h,r),wt=b;D&&id(Ct,h,x,Q,Se,Le,j,Et),[this.firestore,this.persistenceEnabled$]=(0,xr.cc)(`${Ct.name}.firestore`,"AngularFirestore",Ct.name,()=>{const qt=h.runOutsideAngular(()=>Ct.firestore());if(a&&qt.settings(a),wt&&qt.useEmulator(...wt),i&&!wp(l)){const pn=()=>{try{return(0,kn.D)(qt.enablePersistence(v||void 0).then(()=>!0,()=>!1))}catch(Zr){return typeof console<"u"&&console.warn(Zr),Nt(!1)}};return[qt,h.runOutsideAngular(pn)]}return[qt,Nt(!1)]},[a,wt,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:a,query:l}=fF(i,r),h=this.schedulers.ngZone.run(()=>a);return new lF(h,l,this)}collectionGroup(t,r){const i=r||(l=>l),a=this.firestore.collectionGroup(t);return new bj(i(a),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new cF(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(xr.Dh),f.LFG(xr.xv,8),f.LFG(dF,8),f.LFG(Dj,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(An.HU),f.LFG(hF,8),f.LFG(Tj,8),f.LFG(bf,8),f.LFG(Cf,8),f.LFG(Rl,8),f.LFG(hw,8),f.LFG(fw,8),f.LFG(pw,8),f.LFG(rd,8),f.LFG(nd,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),Sj=(()=>{class n{constructor(){_s.Z.registerVersion("angularfire",An.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:dF,useValue:!0},{provide:hF,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[PM]}),n})();var Aj=P(6457);class Ra extends wu.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}var xj=P(9672);function pF(...n){const e=(0,ia.yG)(n),t=(0,ia.jO)(n),{args:r,keys:i}=function ac(n){if(1===n.length){const e=n[0];if(xs(e))return{args:e,keys:null};if(function uc(n){return n&&"object"==typeof n&&Jd(n)===zu}(e)){const t=qu(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}(n);if(0===r.length)return(0,kn.D)([],e);const a=new Mn.y(function Rj(n,e,t=ru.y){return r=>{gF(e,()=>{const{length:i}=n,a=new Array(i);let l=i,h=i;for(let m=0;m<i;m++)gF(e,()=>{const v=(0,kn.D)(n[m],e);let b=!1;v.subscribe((0,Yn.x)(r,D=>{a[m]=D,b||(b=!0,h--),h||r.next(t(a.slice()))},()=>{--l||r.complete()}))},r)},r)}}(r,e,i?l=>function sa(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}(i,l):ru.y));return t?a.pipe(function kp(n){return(0,Ot.U)(e=>function Ku(n,e){return Ga(e)?n(...e):n(e)}(n,e))}(t)):a}function gF(n,e,t){n?(0,xj.f)(t,n,e):e()}function K0(n,e){const t=(0,Zv.m)(n)?n:()=>n,r=i=>i.error(t());return new Mn.y(e?i=>e.schedule(r,0,i):r)}function mF(n){return new Mn.y(e=>{(0,Zs.Xf)(n()).subscribe(e)})}var _F=P(727);function kM(){return(0,jr.e)((n,e)=>{let t=null;n._refCount++;const r=(0,Yn.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,a=t;t=null,i&&(!a||i===a)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class yF extends Mn.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,jr.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new _F.w0;const t=this.getSubject();e.add(this.source.subscribe((0,Yn.x)(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=_F.w0.EMPTY)}return e}refCount(){return kM()(this)}}function cp(n){return(0,jr.e)((e,t)=>{let a,r=null,i=!1;r=e.subscribe((0,Yn.x)(t,void 0,void 0,l=>{a=(0,Zs.Xf)(n(l,cp(n)(e))),r?(r.unsubscribe(),r=null,a.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,a.subscribe(t))})}var Is=P(5577);function Z0(n,e){return(0,Zv.m)(e)?(0,Is.z)(n,e,1):(0,Is.z)(n,1)}function OM(n){return n<=0?()=>Tl.E:(0,jr.e)((e,t)=>{let r=[];e.subscribe((0,Yn.x)(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}var Xi=P(8505);function FM(n){return(0,jr.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}class Gl{constructor(e,t){this.id=e,this.url=t}}class LM extends Gl{constructor(e,t,r="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class dp extends Gl{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class HD extends Gl{constructor(e,t,r){super(e,t),this.reason=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class vF extends Gl{constructor(e,t,r){super(e,t),this.error=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Pj extends Gl{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class kj extends Gl{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Oj extends Gl{constructor(e,t,r,i,a){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=a,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Fj extends Gl{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lj extends Gl{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Vj{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Uj{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Bj{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class jj{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Hj{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $j{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wF{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const hn="primary";class Wj{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function B_(n){return new Wj(n)}const VM="Redirecting to ",EF="ngNavigationCancelingError";function UM(n){const e=Error("NavigationCancelingError: "+(n||""));return e[EF]=!0,e}function qj(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let a=0;a<r.length;a++){const l=r[a],h=n[a];if(l.startsWith(":"))i[l.substring(1)]=h;else if(l!==h.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Fu(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!IF(n[i],e[i]))return!1;return!0}function IF(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,a)=>r[a]===i)}return n===e}function CF(n){return Array.prototype.concat.apply([],n)}function bF(n){return n.length>0?n[n.length-1]:null}function Vi(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function Pd(n){return(0,f.CqO)(n)?n:(0,f.QGY)(n)?(0,kn.D)(Promise.resolve(n)):Nt(n)}const Yj={exact:function SF(n,e,t){if(!fp(n.segments,e.segments)||!$D(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!SF(n.children[r],e.children[r],t))return!1;return!0},subset:AF},DF={exact:function Qj(n,e){return Fu(n,e)},subset:function Jj(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>IF(n[t],e[t]))},ignored:()=>!0};function TF(n,e,t){return Yj[t.paths](n.root,e.root,t.matrixParams)&&DF[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function AF(n,e,t){return xF(n,e,e.segments,t)}function xF(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!fp(i,t)||e.hasChildren()||!$D(i,t,r))}if(n.segments.length===t.length){if(!fp(n.segments,t)||!$D(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!AF(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),a=t.slice(n.segments.length);return!!(fp(n.segments,i)&&$D(n.segments,i,r)&&n.children[hn])&&xF(n.children[hn],e,a,r)}}function $D(n,e,t){return e.every((r,i)=>DF[t](n[i].parameters,r.parameters))}class hp{constructor(e,t,r){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=B_(this.queryParams)),this._queryParamMap}toString(){return tH.serialize(this)}}class _n{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Vi(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return GD(this)}}class Y0{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=B_(this.parameters)),this._parameterMap}toString(){return kF(this)}}function fp(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}class RF{}class MF{parse(e){const t=new cH(e);return new hp(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Q0(e.root,!0)}`,r=function iH(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${WD(t)}=${WD(i)}`).join("&"):`${WD(t)}=${WD(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams),i="string"==typeof e.fragment?`#${function nH(n){return encodeURI(n)}(e.fragment)}`:"";return`${t}${r}${i}`}}const tH=new MF;function GD(n){return n.segments.map(e=>kF(e)).join("/")}function Q0(n,e){if(!n.hasChildren())return GD(n);if(e){const t=n.children[hn]?Q0(n.children[hn],!1):"",r=[];return Vi(n.children,(i,a)=>{a!==hn&&r.push(`${a}:${Q0(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function eH(n,e){let t=[];return Vi(n.children,(r,i)=>{i===hn&&(t=t.concat(e(r,i)))}),Vi(n.children,(r,i)=>{i!==hn&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===hn?[Q0(n.children[hn],!1)]:[`${i}:${Q0(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[hn]?`${GD(n)}/${t[0]}`:`${GD(n)}/(${t.join("//")})`}}function NF(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function WD(n){return NF(n).replace(/%3B/gi,";")}function jM(n){return NF(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function zD(n){return decodeURIComponent(n)}function PF(n){return zD(n.replace(/\+/g,"%20"))}function kF(n){return`${jM(n.path)}${function rH(n){return Object.keys(n).map(e=>`;${jM(e)}=${jM(n[e])}`).join("")}(n.parameters)}`}const sH=/^[^\/()?;=#]+/;function qD(n){const e=n.match(sH);return e?e[0]:""}const oH=/^[^=?&#]+/,uH=/^[^&#]+/;class cH{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new _n([],{}):new _n([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[hn]=new _n(e,t)),r}parseSegment(){const e=qD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new f.vHH(4009,!1);return this.capture(e),new Y0(zD(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=qD(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=qD(this.remaining);i&&(r=i,this.capture(r))}e[zD(t)]=zD(r)}parseQueryParam(e){const t=function aH(n){const e=n.match(oH);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const l=function lH(n){const e=n.match(uH);return e?e[0]:""}(this.remaining);l&&(r=l,this.capture(r))}const i=PF(t),a=PF(r);if(e.hasOwnProperty(i)){let l=e[i];Array.isArray(l)||(l=[l],e[i]=l),l.push(a)}else e[i]=a}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=qD(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new f.vHH(4010,!1);let a;r.indexOf(":")>-1?(a=r.slice(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=hn);const l=this.parseChildren();t[a]=1===Object.keys(l).length?l[hn]:new _n([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new f.vHH(4011,!1)}}class OF{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=HM(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=HM(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=$M(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return $M(e,this._root).map(t=>t.value)}}function HM(n,e){if(n===e.value)return e;for(const t of e.children){const r=HM(n,t);if(r)return r}return null}function $M(n,e){if(n===e.value)return[e];for(const t of e.children){const r=$M(n,t);if(r.length)return r.unshift(e),r}return[]}class Wl{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function j_(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class FF extends OF{constructor(e,t){super(e),this.snapshot=t,GM(this,e)}toString(){return this.snapshot.toString()}}function LF(n,e){const t=function dH(n,e){const l=new KD([],{},{},"",{},hn,e,null,n.root,-1,{});return new UF("",new Wl(l,[]))}(n,e),r=new Ra([new Y0("",{})]),i=new Ra({}),a=new Ra({}),l=new Ra({}),h=new Ra(""),m=new H_(r,i,l,h,a,hn,e,t.root);return m.snapshot=t.root,new FF(new Wl(m,[]),t)}class H_{constructor(e,t,r,i,a,l,h,m){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this._futureSnapshot=m}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Ot.U)(e=>B_(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Ot.U)(e=>B_(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function VF(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],a=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function hH(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class KD{constructor(e,t,r,i,a,l,h,m,v,b,D,x){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=h,this.routeConfig=m,this._urlSegment=v,this._lastPathIndex=b,this._correctedLastPathIndex=x??b,this._resolve=D}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=B_(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=B_(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class UF extends OF{constructor(e,t){super(t),this.url=e,GM(this,t)}toString(){return BF(this._root)}}function GM(n,e){e.value._routerState=n,e.children.forEach(t=>GM(n,t))}function BF(n){const e=n.children.length>0?` { ${n.children.map(BF).join(", ")} } `:"";return`${n.value}${e}`}function WM(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Fu(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Fu(e.params,t.params)||n.params.next(t.params),function Kj(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Fu(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Fu(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function zM(n,e){const t=Fu(n.params,e.params)&&function Xj(n,e){return fp(n,e)&&n.every((t,r)=>Fu(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||zM(n.parent,e.parent))}function J0(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function pH(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return J0(n,r,i);return J0(n,r)})}(n,e,t);return new Wl(r,i)}{if(n.shouldAttach(e.value)){const a=n.retrieve(e.value);if(null!==a){const l=a.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(h=>J0(n,h)),l}}const r=function gH(n){return new H_(new Ra(n.url),new Ra(n.params),new Ra(n.queryParams),new Ra(n.fragment),new Ra(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(a=>J0(n,a));return new Wl(r,i)}}function ZD(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function X0(n){return"object"==typeof n&&null!=n&&n.outlets}function KM(n,e,t,r,i){let a={};if(r&&Vi(r,(h,m)=>{a[m]=Array.isArray(h)?h.map(v=>`${v}`):`${h}`}),n===e)return new hp(t,a,i);const l=jF(n,e,t);return new hp(l,a,i)}function jF(n,e,t){const r={};return Vi(n.children,(i,a)=>{r[a]=i===e?t:jF(i,e,t)}),new _n(n.segments,r)}class HF{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&ZD(r[0]))throw new f.vHH(4003,false);const i=r.find(X0);if(i&&i!==bF(r))throw new f.vHH(4004,false)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ZM{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function $F(n,e,t){if(n||(n=new _n([],{})),0===n.segments.length&&n.hasChildren())return YD(n,e,t);const r=function EH(n,e,t){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return a;const l=n.segments[i],h=t[r];if(X0(h))break;const m=`${h}`,v=r<t.length-1?t[r+1]:null;if(i>0&&void 0===m)break;if(m&&v&&"object"==typeof v&&void 0===v.outlets){if(!WF(m,v,l))return a;r+=2}else{if(!WF(m,{},l))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const a=new _n(n.segments.slice(0,r.pathIndex),{});return a.children[hn]=new _n(n.segments.slice(r.pathIndex),n.children),YD(a,0,i)}return r.match&&0===i.length?new _n(n.segments,{}):r.match&&!n.hasChildren()?YM(n,e,t):r.match?YD(n,0,i):YM(n,e,t)}function YD(n,e,t){if(0===t.length)return new _n(n.segments,{});{const r=function wH(n){return X0(n[0])?n[0].outlets:{[hn]:n}}(t),i={};return Vi(r,(a,l)=>{"string"==typeof a&&(a=[a]),null!==a&&(i[l]=$F(n.children[l],e,a))}),Vi(n.children,(a,l)=>{void 0===r[l]&&(i[l]=a)}),new _n(n.segments,i)}}function YM(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const a=t[i];if(X0(a)){const m=IH(a.outlets);return new _n(r,m)}if(0===i&&ZD(t[0])){r.push(new Y0(n.segments[e].path,GF(t[0]))),i++;continue}const l=X0(a)?a.outlets[hn]:`${a}`,h=i<t.length-1?t[i+1]:null;l&&h&&ZD(h)?(r.push(new Y0(l,GF(h))),i+=2):(r.push(new Y0(l,{})),i++)}return new _n(r,{})}function IH(n){const e={};return Vi(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=YM(new _n([],{}),0,t))}),e}function GF(n){const e={};return Vi(n,(t,r)=>e[r]=`${t}`),e}function WF(n,e,t){return n==t.path&&Fu(e,t.parameters)}class CH{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new eE,this.attachRef=null}}class eE{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const r=this.getOrCreateContext(e);r.outlet=t,this.contexts.set(e,r)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new CH,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}const QD=!1;let QM=(()=>{class n{constructor(t,r,i,a,l){this.parentContexts=t,this.location=r,this.changeDetector=a,this.environmentInjector=l,this.activated=null,this._activatedRoute=null,this.activateEvents=new f.vpe,this.deactivateEvents=new f.vpe,this.attachEvents=new f.vpe,this.detachEvents=new f.vpe,this.name=i||hn,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new f.vHH(4012,QD);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new f.vHH(4012,QD);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new f.vHH(4012,QD);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new f.vHH(4013,QD);this._activatedRoute=t;const i=this.location,l=t._futureSnapshot.component,h=this.parentContexts.getOrCreateContext(this.name).children,m=new bH(t,h,i.injector);if(r&&function DH(n){return!!n.resolveComponentFactory}(r)){const v=r.resolveComponentFactory(l);this.activated=i.createComponent(v,i.length,m)}else this.activated=i.createComponent(l,{index:i.length,injector:m,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(eE),f.Y36(f.s_b),f.$8M("name"),f.Y36(f.sBO),f.Y36(f.lqb))},n.\u0275dir=f.lG2({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class bH{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===H_?this.route:e===eE?this.childContexts:this.parent.get(e,t)}}let zF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f.Xpm({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,r){1&t&&f._UZ(0,"router-outlet")},dependencies:[QM],encapsulation:2}),n})();function qF(n,e){return n.providers&&!n._injector&&(n._injector=(0,f.MMx)(n.providers,e,`Route: ${n.path}`)),n._injector??e}function XM(n){const e=n.children&&n.children.map(XM),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==hn&&(t.component=zF),t}function Qo(n){return n.outlet||hn}function KF(n,e){const t=n.filter(r=>Qo(r)===e);return t.push(...n.filter(r=>Qo(r)!==e)),t}function ZF(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class RH{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),WM(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=j_(t);e.children.forEach(a=>{const l=a.value.outlet;this.deactivateRoutes(a,i[l],r),delete i[l]}),Vi(i,(a,l)=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(i===a)if(i.component){const l=r.getContext(i.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=j_(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);if(r&&r.outlet){const l=r.outlet.detach(),h=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:h})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=j_(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=j_(t);e.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],r),this.forwardEvent(new $j(a.value.snapshot))}),e.children.length&&this.forwardEvent(new jj(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(WM(i),i===a)if(i.component){const l=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,l.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const l=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const h=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),l.children.onOutletReAttached(h.contexts),l.attachRef=h.componentRef,l.route=h.route.value,l.outlet&&l.outlet.attach(h.componentRef,h.route.value),WM(h.route.value),this.activateChildRoutes(e,null,l.children)}else{const h=ZF(i.snapshot),m=h?.get(f._Vd)??null;l.attachRef=null,l.route=i,l.resolver=m,l.injector=h,l.outlet&&l.outlet.activateWith(i,l.injector),this.activateChildRoutes(e,null,l.children)}}else this.activateChildRoutes(e,null,r)}}function JD(n){return"function"==typeof n}function pp(n){return n instanceof hp}const tE=Symbol("INITIAL_VALUE");function nE(){return Ar(n=>pF(n.map(e=>e.pipe(yf(1),Da(tE)))).pipe(to((e,t)=>{let r=!1;return t.reduce((i,a,l)=>i!==tE?i:(a===tE&&(r=!0),r||!1!==a&&l!==t.length-1&&!pp(a)?i:a),e)},tE),Ri(e=>e!==tE),(0,Ot.U)(e=>pp(e)?e:!0===e),yf(1)))}const YF={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function XD(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...YF}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||qj)(t,n,e);if(!i)return{...YF};const a={};Vi(i.posParams,(h,m)=>{a[m]=h.path});const l=i.consumed.length>0?{...a,...i.consumed[i.consumed.length-1].parameters}:a;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:l,positionalParamSegments:i.posParams??{}}}function eT(n,e,t,r,i="corrected"){if(t.length>0&&function VH(n,e,t){return t.some(r=>tT(n,e,r)&&Qo(r)!==hn)}(n,t,r)){const l=new _n(e,function LH(n,e,t,r){const i={};i[hn]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const a of t)if(""===a.path&&Qo(a)!==hn){const l=new _n([],{});l._sourceSegment=n,l._segmentIndexShift=e.length,i[Qo(a)]=l}return i}(n,e,r,new _n(t,n.children)));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:[]}}if(0===t.length&&function UH(n,e,t){return t.some(r=>tT(n,e,r))}(n,t,r)){const l=new _n(n.segments,function FH(n,e,t,r,i,a){const l={};for(const h of r)if(tT(n,t,h)&&!i[Qo(h)]){const m=new _n([],{});m._sourceSegment=n,m._segmentIndexShift="legacy"===a?n.segments.length:e.length,l[Qo(h)]=m}return{...i,...l}}(n,e,t,r,n.children,i));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:t}}const a=new _n(n.segments,n.children);return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}function tT(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function QF(n,e,t,r){return!!(Qo(n)===r||r!==hn&&tT(e,t,n))&&("**"===n.path||XD(e,n,t).matched)}function JF(n,e,t){return 0===e.length&&!n.children[t]}const nT=!1;class rT{constructor(e){this.segmentGroup=e||null}}class XF{constructor(e){this.urlTree=e}}function rE(n){return K0(new rT(n))}function eL(n){return K0(new XF(n))}class $H{constructor(e,t,r,i,a){this.injector=e,this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0}apply(){const e=eT(this.urlTree.root,[],[],this.config).segmentGroup,t=new _n(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,hn).pipe((0,Ot.U)(a=>this.createUrlTree(eN(a),this.urlTree.queryParams,this.urlTree.fragment))).pipe(cp(a=>{if(a instanceof XF)return this.allowRedirects=!1,this.match(a.urlTree);throw a instanceof rT?this.noMatchError(a):a}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,hn).pipe((0,Ot.U)(i=>this.createUrlTree(eN(i),e.queryParams,e.fragment))).pipe(cp(i=>{throw i instanceof rT?this.noMatchError(i):i}))}noMatchError(e){return new f.vHH(4002,nT)}createUrlTree(e,t,r){const i=e.segments.length>0?new _n([],{[hn]:e}):e;return new hp(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe((0,Ot.U)(a=>new _n([],a))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const a of Object.keys(r.children))"primary"===a?i.unshift(a):i.push(a);return(0,kn.D)(i).pipe(Z0(a=>{const l=r.children[a],h=KF(t,a);return this.expandSegmentGroup(e,h,l,a).pipe((0,Ot.U)(m=>({segment:m,outlet:a})))}),to((a,l)=>(a[l.outlet]=l.segment,a),{}),function Mj(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Ri((i,a)=>n(i,a,r)):ru.y,OM(1),t?Kv(e):bC(()=>new Qc))}())}expandSegment(e,t,r,i,a,l){return(0,kn.D)(r).pipe(Z0(h=>this.expandSegmentAgainstRoute(e,t,r,h,i,a,l).pipe(cp(v=>{if(v instanceof rT)return Nt(null);throw v}))),ba(h=>!!h),cp((h,m)=>{if(h instanceof Qc||"EmptyError"===h.name)return JF(t,i,a)?Nt(new _n([],{})):rE(t);throw h}))}expandSegmentAgainstRoute(e,t,r,i,a,l,h){return QF(i,t,a,l)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,a,l):h&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l):rE(t):rE(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,l):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const a=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?eL(a):this.lineralizeSegments(r,a).pipe((0,Is.z)(l=>{const h=new _n(l,{});return this.expandSegment(e,h,t,l,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){const{matched:h,consumedSegments:m,remainingSegments:v,positionalParamSegments:b}=XD(t,i,a);if(!h)return rE(t);const D=this.applyRedirectCommands(m,i.redirectTo,b);return i.redirectTo.startsWith("/")?eL(D):this.lineralizeSegments(i,D).pipe((0,Is.z)(x=>this.expandSegment(e,t,r,x.concat(v),l,!1)))}matchSegmentAgainstRoute(e,t,r,i,a){if("**"===r.path)return e=qF(r,e),r.loadChildren?(r._loadedRoutes?Nt({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(e,r)).pipe((0,Ot.U)(D=>(r._loadedRoutes=D.routes,r._loadedInjector=D.injector,new _n(i,{})))):Nt(new _n(i,{}));const{matched:l,consumedSegments:h,remainingSegments:m}=XD(t,r,i);return l?(e=qF(r,e),this.getChildConfig(e,r,i).pipe((0,Is.z)(b=>{const D=b.injector??e,x=b.routes,{segmentGroup:j,slicedSegments:Q}=eT(t,h,m,x),Se=new _n(j.segments,j.children);if(0===Q.length&&Se.hasChildren())return this.expandChildren(D,x,Se).pipe((0,Ot.U)(Ct=>new _n(h,Ct)));if(0===x.length&&0===Q.length)return Nt(new _n(h,{}));const Le=Qo(r)===a;return this.expandSegment(D,Se,x,Q,Le?hn:a,!0).pipe((0,Ot.U)(It=>new _n(h.concat(It.segments),It.children)))}))):rE(t)}getChildConfig(e,t,r){return t.children?Nt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Nt({routes:t._loadedRoutes,injector:t._loadedInjector}):this.runCanLoadGuards(e,t,r).pipe((0,Is.z)(i=>i?this.configLoader.loadChildren(e,t).pipe((0,Xi.b)(a=>{t._loadedRoutes=a.routes,t._loadedInjector=a.injector})):function jH(n){return K0(UM(nT))}())):Nt({routes:[],injector:e})}runCanLoadGuards(e,t,r){const i=t.canLoad;if(!i||0===i.length)return Nt(!0);const a=i.map(l=>{const h=e.get(l),m=function NH(n){return n&&JD(n.canLoad)}(h)?h.canLoad(t,r):h(t,r);return Pd(m)});return Nt(a).pipe(nE(),(0,Xi.b)(l=>{if(!pp(l))return;const h=UM(VM+this.urlSerializer.serialize(l));throw h.url=l,h}),(0,Ot.U)(l=>!0===l))}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return Nt(r);if(i.numberOfChildren>1||!i.children[hn])return K0(new f.vHH(4e3,nT));i=i.children[hn]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreatreUrlTree(e,t,r,i){const a=this.createSegmentGroup(e,t.root,r,i);return new hp(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return Vi(e,(i,a)=>{if("string"==typeof i&&i.startsWith(":")){const h=i.substring(1);r[a]=t[h]}else r[a]=i}),r}createSegmentGroup(e,t,r,i){const a=this.createSegments(e,t.segments,r,i);let l={};return Vi(t.children,(h,m)=>{l[m]=this.createSegmentGroup(e,h,r,i)}),new _n(a,l)}createSegments(e,t,r,i){return t.map(a=>a.path.startsWith(":")?this.findPosParam(e,a,i):this.findOrReturn(a,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new f.vHH(4001,nT);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}function eN(n){const e={};for(const r of Object.keys(n.children)){const a=eN(n.children[r]);(a.segments.length>0||a.hasChildren())&&(e[r]=a)}return function GH(n){if(1===n.numberOfChildren&&n.children[hn]){const e=n.children[hn];return new _n(n.segments.concat(e.segments),e.children)}return n}(new _n(n.segments,e))}class tL{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class iT{constructor(e,t){this.component=e,this.route=t}}function zH(n,e,t){const r=n._root;return iE(r,e?e._root:null,t,[r.value])}function sT(n,e,t){return(ZF(e)??t).get(n)}function iE(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=j_(e);return n.children.forEach(l=>{(function KH(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,l=e?e.value:null,h=t?t.getContext(n.value.outlet):null;if(l&&a.routeConfig===l.routeConfig){const m=function ZH(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!fp(n.url,e.url);case"pathParamsOrQueryParamsChange":return!fp(n.url,e.url)||!Fu(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!zM(n,e)||!Fu(n.queryParams,e.queryParams);default:return!zM(n,e)}}(l,a,a.routeConfig.runGuardsAndResolvers);m?i.canActivateChecks.push(new tL(r)):(a.data=l.data,a._resolvedData=l._resolvedData),iE(n,e,a.component?h?h.children:null:t,r,i),m&&h&&h.outlet&&h.outlet.isActivated&&i.canDeactivateChecks.push(new iT(h.outlet.component,l))}else l&&sE(e,h,i),i.canActivateChecks.push(new tL(r)),iE(n,null,a.component?h?h.children:null:t,r,i)})(l,a[l.value.outlet],t,r.concat([l.value]),i),delete a[l.value.outlet]}),Vi(a,(l,h)=>sE(l,t.getContext(h),i)),i}function sE(n,e,t){const r=j_(n),i=n.value;Vi(r,(a,l)=>{sE(a,i.component?e?e.children.getContext(l):null:e,t)}),t.canDeactivateChecks.push(new iT(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}class i${}function nL(n){return new Mn.y(e=>e.error(n))}class o${constructor(e,t,r,i,a,l){this.rootComponentType=e,this.config=t,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=l}recognize(){const e=eT(this.urlTree.root,[],[],this.config.filter(l=>void 0===l.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,hn);if(null===t)return null;const r=new KD([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},hn,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new Wl(r,t),a=new UF(this.url,i);return this.inheritParamsAndData(a._root),a}inheritParamsAndData(e){const t=e.value,r=VF(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,r)}processChildren(e,t){const r=[];for(const a of Object.keys(t.children)){const l=t.children[a],h=KF(e,a),m=this.processSegmentGroup(h,l,a);if(null===m)return null;r.push(...m)}const i=rL(r);return function a$(n){n.sort((e,t)=>e.value.outlet===hn?-1:t.value.outlet===hn?1:e.value.outlet.localeCompare(t.value.outlet))}(i),i}processSegment(e,t,r,i){for(const a of e){const l=this.processSegmentAgainstRoute(a,t,r,i);if(null!==l)return l}return JF(t,r,i)?[]:null}processSegmentAgainstRoute(e,t,r,i){if(e.redirectTo||!QF(e,t,r,i))return null;let a,l=[],h=[];if("**"===e.path){const j=r.length>0?bF(r).parameters:{},Q=sL(t)+r.length;a=new KD(r,j,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,aL(e),Qo(e),e.component??e._loadedComponent??null,e,iL(t),Q,uL(e),Q)}else{const j=XD(t,e,r);if(!j.matched)return null;l=j.consumedSegments,h=j.remainingSegments;const Q=sL(t)+l.length;a=new KD(l,j.parameters,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,aL(e),Qo(e),e.component??e._loadedComponent??null,e,iL(t),Q,uL(e),Q)}const m=function u$(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:v,slicedSegments:b}=eT(t,l,h,m.filter(j=>void 0===j.redirectTo),this.relativeLinkResolution);if(0===b.length&&v.hasChildren()){const j=this.processChildren(m,v);return null===j?null:[new Wl(a,j)]}if(0===m.length&&0===b.length)return[new Wl(a,[])];const D=Qo(e)===i,x=this.processSegment(m,v,b,D?hn:i);return null===x?null:[new Wl(a,x)]}}function l$(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function rL(n){const e=[],t=new Set;for(const r of n){if(!l$(r)){e.push(r);continue}const i=e.find(a=>r.value.routeConfig===a.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=rL(r.children);e.push(new Wl(r.value,i))}return e.filter(r=>!t.has(r))}function iL(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function sL(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function aL(n){return n.data||{}}function uL(n){return n.resolve||{}}const nN=Symbol("RouteTitle");function lL(n){return"string"==typeof n.title||null===n.title}function rN(n){return Ar(e=>{const t=n(e);return t?(0,kn.D)(t).pipe((0,Ot.U)(()=>e)):Nt(e)})}class y$ extends class _${shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const iN=new f.OlP("ROUTES");let sN=(()=>{class n{constructor(t,r){this.injector=t,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Nt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=Pd(t.loadComponent()).pipe((0,Xi.b)(a=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=a}),FM(()=>{this.componentLoaders.delete(t)})),i=new yF(r,()=>new wu.x).pipe(kM());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Nt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const a=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe((0,Ot.U)(h=>{this.onLoadEndListener&&this.onLoadEndListener(r);let m,v,b=!1;Array.isArray(h)?v=h:(m=h.create(t).injector,v=CF(m.get(iN,[],f.XFs.Self|f.XFs.Optional)));return{routes:v.map(XM),injector:m}}),FM(()=>{this.childrenLoaders.delete(r)})),l=new yF(a,()=>new wu.x).pipe(kM());return this.childrenLoaders.set(r,l),l}loadModuleFactoryOrRoutes(t){return Pd(t()).pipe((0,Is.z)(r=>r instanceof f.YKP||Array.isArray(r)?Nt(r):(0,kn.D)(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(f.zs3),f.LFG(f.Sil))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();class w${shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function E$(n){throw n}function I$(n,e,t){return e.parse("/")}const C$={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},b$={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ui=(()=>{class n{constructor(t,r,i,a,l,h,m){this.rootComponentType=t,this.urlSerializer=r,this.rootContexts=i,this.location=a,this.config=m,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new wu.x,this.errorHandler=E$,this.malformedUriErrorHandler=I$,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Nt(void 0),this.urlHandlingStrategy=new w$,this.routeReuseStrategy=new y$,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=l.get(sN),this.configLoader.onLoadEndListener=x=>this.triggerEvent(new Uj(x)),this.configLoader.onLoadStartListener=x=>this.triggerEvent(new Vj(x)),this.ngModule=l.get(f.h0i),this.console=l.get(f.c2e);const D=l.get(f.R0b);this.isNgZoneEnabled=D instanceof f.R0b&&f.R0b.isInAngularZone(),this.resetConfig(m),this.currentUrlTree=function Zj(){return new hp(new _n([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=LF(this.currentUrlTree,this.rootComponentType),this.transitions=new Ra({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(t){const r=this.events;return t.pipe(Ri(i=>0!==i.id),(0,Ot.U)(i=>({...i,extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),Ar(i=>{let a=!1,l=!1;return Nt(i).pipe((0,Xi.b)(h=>{this.currentNavigation={id:h.id,initialUrl:h.rawUrl,extractedUrl:h.extractedUrl,trigger:h.source,extras:h.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ar(h=>{const m=this.browserUrlTree.toString(),v=!this.navigated||h.extractedUrl.toString()!==m||m!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||v)&&this.urlHandlingStrategy.shouldProcessUrl(h.rawUrl))return hL(h.source)&&(this.browserUrlTree=h.extractedUrl),Nt(h).pipe(Ar(D=>{const x=this.transitions.getValue();return r.next(new LM(D.id,this.serializeUrl(D.extractedUrl),D.source,D.restoredState)),x!==this.transitions.getValue()?Tl.E:Promise.resolve(D)}),function WH(n,e,t,r){return Ar(i=>function HH(n,e,t,r,i){return new $H(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe((0,Ot.U)(a=>({...i,urlAfterRedirects:a}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,Xi.b)(D=>{this.currentNavigation={...this.currentNavigation,finalUrl:D.urlAfterRedirects}}),function c$(n,e,t,r,i){return(0,Is.z)(a=>function s$(n,e,t,r,i="emptyOnly",a="legacy"){try{const l=new o$(n,e,t,r,i,a).recognize();return null===l?nL(new i$):Nt(l)}catch(l){return nL(l)}}(n,e,a.urlAfterRedirects,t(a.urlAfterRedirects),r,i).pipe((0,Ot.U)(l=>({...a,targetSnapshot:l}))))}(this.rootComponentType,this.config,D=>this.serializeUrl(D),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,Xi.b)(D=>{if("eager"===this.urlUpdateStrategy){if(!D.extras.skipLocationChange){const j=this.urlHandlingStrategy.merge(D.urlAfterRedirects,D.rawUrl);this.setBrowserUrl(j,D)}this.browserUrlTree=D.urlAfterRedirects}const x=new Pj(D.id,this.serializeUrl(D.extractedUrl),this.serializeUrl(D.urlAfterRedirects),D.targetSnapshot);r.next(x)}));if(v&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:x,extractedUrl:j,source:Q,restoredState:Se,extras:Le}=h,Et=new LM(x,this.serializeUrl(j),Q,Se);r.next(Et);const It=LF(j,this.rootComponentType).snapshot;return Nt({...h,targetSnapshot:It,urlAfterRedirects:j,extras:{...Le,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=h.rawUrl,h.resolve(null),Tl.E}),(0,Xi.b)(h=>{const m=new kj(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot);this.triggerEvent(m)}),(0,Ot.U)(h=>({...h,guards:zH(h.targetSnapshot,h.currentSnapshot,this.rootContexts)})),function YH(n,e){return(0,Is.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:l}}=t;return 0===l.length&&0===a.length?Nt({...t,guardsResult:!0}):function QH(n,e,t,r){return(0,kn.D)(n).pipe((0,Is.z)(i=>function r$(n,e,t,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?Nt(a.map(h=>{const m=sT(h,e,i);return Pd(function OH(n){return n&&JD(n.canDeactivate)}(m)?m.canDeactivate(n,e,t,r):m(n,e,t,r)).pipe(ba())})).pipe(nE()):Nt(!0)}(i.component,i.route,t,e,r)),ba(i=>!0!==i,!0))}(l,r,i,n).pipe((0,Is.z)(h=>h&&function MH(n){return"boolean"==typeof n}(h)?function JH(n,e,t,r){return(0,kn.D)(e).pipe(Z0(i=>si(function e$(n,e){return null!==n&&e&&e(new Bj(n)),Nt(!0)}(i.route.parent,r),function XH(n,e){return null!==n&&e&&e(new Hj(n)),Nt(!0)}(i.route,r),function n$(n,e,t){const r=e[e.length-1],a=e.slice(0,e.length-1).reverse().map(l=>function qH(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(l)).filter(l=>null!==l).map(l=>mF(()=>Nt(l.guards.map(m=>{const v=sT(m,l.node,t);return Pd(function kH(n){return n&&JD(n.canActivateChild)}(v)?v.canActivateChild(r,n):v(r,n)).pipe(ba())})).pipe(nE())));return Nt(a).pipe(nE())}(n,i.path,t),function t$(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return Nt(!0);const i=r.map(a=>mF(()=>{const l=sT(a,e,t);return Pd(function PH(n){return n&&JD(n.canActivate)}(l)?l.canActivate(e,n):l(e,n)).pipe(ba())}));return Nt(i).pipe(nE())}(n,i.route,t))),ba(i=>!0!==i,!0))}(r,a,n,e):Nt(h)),(0,Ot.U)(h=>({...t,guardsResult:h})))})}(this.ngModule.injector,h=>this.triggerEvent(h)),(0,Xi.b)(h=>{if(pp(h.guardsResult)){const v=UM(`Redirecting to "${this.serializeUrl(h.guardsResult)}"`);throw v.url=h.guardsResult,v}const m=new Oj(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot,!!h.guardsResult);this.triggerEvent(m)}),Ri(h=>!!h.guardsResult||(this.restoreHistory(h),this.cancelNavigationTransition(h,""),!1)),rN(h=>{if(h.guards.canActivateChecks.length)return Nt(h).pipe((0,Xi.b)(m=>{const v=new Fj(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);this.triggerEvent(v)}),Ar(m=>{let v=!1;return Nt(m).pipe(function d$(n,e){return(0,Is.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Nt(t);let a=0;return(0,kn.D)(i).pipe(Z0(l=>function h$(n,e,t,r){const i=n.routeConfig,a=n._resolve;return void 0!==i?.title&&!lL(i)&&(a[nN]=i.title),function f$(n,e,t,r){const i=function p$(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return Nt({});const a={};return(0,kn.D)(i).pipe((0,Is.z)(l=>function g$(n,e,t,r){const i=sT(n,e,r);return Pd(i.resolve?i.resolve(e,t):i(e,t))}(n[l],e,t,r).pipe(ba(),(0,Xi.b)(h=>{a[l]=h}))),OM(1),function Nj(n){return(0,Ot.U)(()=>n)}(a),cp(l=>l instanceof Qc?Tl.E:K0(l)))}(a,n,e,r).pipe((0,Ot.U)(l=>(n._resolvedData=l,n.data=VF(n,t).resolve,i&&lL(i)&&(n.data[nN]=i.title),null)))}(l.route,r,n,e)),(0,Xi.b)(()=>a++),OM(1),(0,Is.z)(l=>a===i.length?Nt(t):Tl.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,Xi.b)({next:()=>v=!0,complete:()=>{v||(this.restoreHistory(m),this.cancelNavigationTransition(m,"At least one route resolver didn't emit any value."))}}))}),(0,Xi.b)(m=>{const v=new Lj(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);this.triggerEvent(v)}))}),rN(h=>{const m=v=>{const b=[];v.routeConfig?.loadComponent&&!v.routeConfig._loadedComponent&&b.push(this.configLoader.loadComponent(v.routeConfig).pipe((0,Xi.b)(D=>{v.component=D}),(0,Ot.U)(()=>{})));for(const D of v.children)b.push(...m(D));return b};return pF(m(h.targetSnapshot.root)).pipe(Kv(),yf(1))}),rN(()=>this.afterPreactivation()),(0,Ot.U)(h=>{const m=function fH(n,e,t){const r=J0(n,e._root,t?t._root:void 0);return new FF(r,e)}(this.routeReuseStrategy,h.targetSnapshot,h.currentRouterState);return{...h,targetRouterState:m}}),(0,Xi.b)(h=>{this.currentUrlTree=h.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl),this.routerState=h.targetRouterState,"deferred"===this.urlUpdateStrategy&&(h.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,h),this.browserUrlTree=h.urlAfterRedirects)}),((n,e,t)=>(0,Ot.U)(r=>(new RH(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,h=>this.triggerEvent(h)),(0,Xi.b)({next(){a=!0},complete(){a=!0}}),FM(()=>{a||l||this.cancelNavigationTransition(i,`Navigation ID ${i.id} is not equal to the current navigation id ${this.navigationId}`),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),cp(h=>{if(l=!0,function zj(n){return n&&n[EF]}(h)){const m=pp(h.url);m||(this.navigated=!0,this.restoreHistory(i,!0));const v=new HD(i.id,this.serializeUrl(i.extractedUrl),h.message);if(r.next(v),m){const b=this.urlHandlingStrategy.merge(h.url,this.rawUrlTree),D={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||hL(i.source)};this.scheduleNavigation(b,"imperative",null,D,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{this.restoreHistory(i,!0);const m=new vF(i.id,this.serializeUrl(i.extractedUrl),h);r.next(m);try{i.resolve(this.errorHandler(h))}catch(v){i.reject(v)}}return Tl.E}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next({...this.transitions.value,...t})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const i={replaceUrl:!0},a=t.state?.navigationId?t.state:null;if(a){const h={...a};delete h.navigationId,delete h.\u0275routerPageId,0!==Object.keys(h).length&&(i.state=h)}const l=this.parseUrl(t.url);this.scheduleNavigation(l,r,a,i)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){this.config=t.map(XM),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:a,fragment:l,queryParamsHandling:h,preserveFragment:m}=r,v=i||this.routerState.root,b=m?this.currentUrlTree.fragment:l;let D=null;switch(h){case"merge":D={...this.currentUrlTree.queryParams,...a};break;case"preserve":D=this.currentUrlTree.queryParams;break;default:D=a||null}return null!==D&&(D=this.removeEmptyProps(D)),function mH(n,e,t,r,i){if(0===t.length)return KM(e.root,e.root,e.root,r,i);const a=function _H(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new HF(!0,0,n);let e=0,t=!1;const r=n.reduce((i,a,l)=>{if("object"==typeof a&&null!=a){if(a.outlets){const h={};return Vi(a.outlets,(m,v)=>{h[v]="string"==typeof m?m.split("/"):m}),[...i,{outlets:h}]}if(a.segmentPath)return[...i,a.segmentPath]}return"string"!=typeof a?[...i,a]:0===l?(a.split("/").forEach((h,m)=>{0==m&&"."===h||(0==m&&""===h?t=!0:".."===h?e++:""!=h&&i.push(h))}),i):[...i,a]},[]);return new HF(t,e,r)}(t);return a.toRoot()?KM(e.root,e.root,new _n([],{}),r,i):function l(m){const v=function yH(n,e,t,r){return n.isAbsolute?new ZM(e.root,!0,0):-1===r?new ZM(t,t===e.root,0):function vH(n,e,t){let r=n,i=e,a=t;for(;a>i;){if(a-=i,r=r.parent,!r)throw new f.vHH(4005,!1);i=r.segments.length}return new ZM(r,!1,i-a)}(t,r+(ZD(n.commands[0])?0:1),n.numberOfDoubleDots)}(a,e,n.snapshot?._urlSegment,m),b=v.processChildren?YD(v.segmentGroup,v.index,a.commands):$F(v.segmentGroup,v.index,a.commands);return KM(e.root,v.segmentGroup,b,r,i)}(n.snapshot?._lastPathIndex)}(v,this.currentUrlTree,t,D,b??null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=pp(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(a,"imperative",null,r)}navigate(t,r={skipLocationChange:!1}){return function D$(n){for(let e=0;e<n.length;e++){if(null==n[e])throw new f.vHH(4008,!1)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?{...C$}:!1===r?{...b$}:r,pp(t))return TF(this.currentUrlTree,t,i);const a=this.parseUrl(t);return TF(this.currentUrlTree,a,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const a=t[i];return null!=a&&(r[i]=a),r},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new dp(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,r,i,a,l){if(this.disposed)return Promise.resolve(!1);let h,m,v;l?(h=l.resolve,m=l.reject,v=l.promise):v=new Promise((x,j)=>{h=x,m=j});const b=++this.navigationId;let D;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),D=i&&i.\u0275routerPageId?i.\u0275routerPageId:a.replaceUrl||a.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):D=0,this.setTransition({id:b,targetPageId:D,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:a,resolve:h,reject:m,promise:v,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),v.catch(x=>Promise.reject(x))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t),a={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",a):this.location.go(i,"",a)}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const i=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===i?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===i&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,r){const i=new HD(t.id,this.serializeUrl(t.extractedUrl),r);this.triggerEvent(i),t.resolve(!1)}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){f.$Z()},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();function hL(n){return"imperative"!==n}let oN=(()=>{class n{constructor(t,r,i,a,l){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=a,this.el=l,this.commands=null,this.onChanges=new wu.x,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){if(null!=this.tabIndexAttribute)return;const r=this.renderer,i=this.el.nativeElement;null!==t?r.setAttribute(i,"tabindex",t):r.removeAttribute(i,"tabindex")}ngOnChanges(t){this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const t={skipLocationChange:(0,f.D6c)(this.skipLocationChange),replaceUrl:(0,f.D6c)(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,t),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:(0,f.D6c)(this.preserveFragment)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Ui),f.Y36(H_),f.$8M("tabindex"),f.Y36(f.Qsj),f.Y36(f.SBq))},n.\u0275dir=f.lG2({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(t,r){1&t&&f.NdJ("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[f.TTD]}),n})(),oT=(()=>{class n{constructor(t,r,i){this.router=t,this.route=r,this.locationStrategy=i,this.commands=null,this.href=null,this.onChanges=new wu.x,this.subscription=t.events.subscribe(a=>{a instanceof dp&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:null}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,r,i,a,l){if(0!==t||r||i||a||l||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const h={skipLocationChange:(0,f.D6c)(this.skipLocationChange),replaceUrl:(0,f.D6c)(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,h),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:(0,f.D6c)(this.preserveFragment)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Ui),f.Y36(H_),f.Y36(ge))},n.\u0275dir=f.lG2({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,r){1&t&&f.NdJ("click",function(a){return r.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&t&&f.uIk("target",r.target)("href",r.href,f.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[f.TTD]}),n})(),fL=(()=>{class n{constructor(t,r,i,a,l,h){this.router=t,this.element=r,this.renderer=i,this.cdr=a,this.link=l,this.linkWithHref=h,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new f.vpe,this.routerEventsSubscription=t.events.subscribe(m=>{m instanceof dp&&this.update()})}ngAfterContentInit(){Nt(this.links.changes,this.linksWithHrefs.changes,Nt(null)).pipe((0,sd.J)()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const t=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=(0,kn.D)(t).pipe((0,sd.J)()).subscribe(r=>{this.isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(t){const r=Array.isArray(t)?t:t.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const t=this.hasActiveLinks();this.isActive!==t&&(this.isActive=t,this.cdr.markForCheck(),this.classes.forEach(r=>{t?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),t&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(t))})}isLinkActive(t){const r=function T$(n){return!!n.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>!!i.urlTree&&t.isActive(i.urlTree,r)}hasActiveLinks(){const t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.linkWithHref&&t(this.linkWithHref)||this.links.some(t)||this.linksWithHrefs.some(t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Ui),f.Y36(f.SBq),f.Y36(f.Qsj),f.Y36(f.sBO),f.Y36(oN,8),f.Y36(oT,8))},n.\u0275dir=f.lG2({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(t,r,i){if(1&t&&(f.Suo(i,oN,5),f.Suo(i,oT,5)),2&t){let a;f.iGM(a=f.CRH())&&(r.links=a),f.iGM(a=f.CRH())&&(r.linksWithHrefs=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[f.TTD]}),n})();class pL{buildTitle(e){let t,r=e.root;for(;void 0!==r;)t=this.getResolvedTitleForRoute(r)??t,r=r.children.find(i=>i.outlet===hn);return t}getResolvedTitleForRoute(e){return e.data[nN]}}let S$=(()=>{class n extends pL{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Ap))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class gL{}let mL=(()=>{class n{constructor(t,r,i,a,l){this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe(Ri(t=>t instanceof dp),Z0(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const a of r){a.providers&&!a._injector&&(a._injector=(0,f.MMx)(a.providers,t,`Route: ${a.path}`));const l=a._injector??t,h=a._loadedInjector??l;a.loadChildren&&!a._loadedRoutes||a.loadComponent&&!a._loadedComponent?i.push(this.preloadConfig(l,a)):(a.children||a._loadedRoutes)&&i.push(this.processRoutes(h,a.children??a._loadedRoutes))}return(0,kn.D)(i).pipe((0,sd.J)())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):Nt(null);const a=i.pipe((0,Is.z)(l=>null===l?Nt(void 0):(r._loadedRoutes=l.routes,r._loadedInjector=l.injector,this.processRoutes(l.injector??t,l.routes))));if(r.loadComponent&&!r._loadedComponent){const l=this.loader.loadComponent(r);return(0,kn.D)([a,l]).pipe((0,sd.J)())}return a})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Ui),f.LFG(f.Sil),f.LFG(f.lqb),f.LFG(gL),f.LFG(sN))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const _L=new f.OlP("");let A$=(()=>{class n{constructor(t,r,i={}){this.router=t,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof LM?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof dp&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof wF&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.router.triggerEvent(new wF(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){f.$Z()},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const aN=new f.OlP("ROUTER_CONFIGURATION",{providedIn:"root",factory:()=>({})}),yL=new f.OlP("ROUTER_FORROOT_GUARD"),vL=new f.OlP(""),x$=[Pe,{provide:RF,useClass:MF},{provide:Ui,useFactory:function O$(n,e,t,r,i,a,l={},h,m,v,b){const D=new Ui(null,n,e,t,r,i,CF(a));return v&&(D.urlHandlingStrategy=v),b&&(D.routeReuseStrategy=b),D.titleStrategy=m??h,function F$(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(l,D),D},deps:[RF,eE,Pe,f.zs3,f.Sil,iN,aN,S$,[pL,new f.FiY],[class v${},new f.FiY],[class m${},new f.FiY]]},eE,{provide:H_,useFactory:function L$(n){return n.routerState.root},deps:[Ui]},sN];function R$(){return new f.PXZ("Router",Ui)}let wL=(()=>{class n{constructor(t,r){}static forRoot(t,r){return{ngModule:n,providers:[x$,[],EL(t),{provide:yL,useFactory:k$,deps:[[Ui,new f.FiY,new f.tp0]]},{provide:aN,useValue:r||{}},r?.useHash?{provide:ge,useClass:Ve}:{provide:ge,useClass:Ye},{provide:_L,useFactory:()=>{const n=(0,f.f3M)(Ui),e=(0,f.f3M)(Hi),t=(0,f.f3M)(aN);return t.scrollOffset&&e.setOffset(t.scrollOffset),new A$(n,e,t)}},r?.preloadingStrategy?G$(r.preloadingStrategy):[],{provide:f.PXZ,multi:!0,useFactory:R$},r?.initialNavigation?U$(r):[],[{provide:IL,useFactory:V$},{provide:f.tb,multi:!0,useExisting:IL}]]}}static forChild(t){return{ngModule:n,providers:[EL(t)]}}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(yL,8),f.LFG(Ui,8))},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})();function k$(n){return"guarded"}function EL(n){return[{provide:f.deG,multi:!0,useValue:n},{provide:iN,multi:!0,useValue:n}]}function V$(){const n=(0,f.f3M)(f.zs3);return e=>{const t=n.get(f.z2F);if(e!==t.components[0])return;const r=n.get(Ui),i=n.get(CL);null===n.get(uN,null,f.XFs.Optional)&&r.initialNavigation(),n.get(vL,null,f.XFs.Optional)?.setUpPreloading(),n.get(_L,null,f.XFs.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.next(),i.complete()}}const IL=new f.OlP("");function U$(n){return["disabled"===n.initialNavigation?[{provide:f.ip1,multi:!0,useFactory:()=>{const n=(0,f.f3M)(Ui);return()=>{n.setUpLocationChangeListener()}}},{provide:uN,useValue:"disabled"}]:[],"enabledBlocking"===n.initialNavigation?[{provide:uN,useValue:"enabledBlocking"},{provide:f.ip1,multi:!0,deps:[f.zs3],useFactory:n=>{const e=n.get(z,Promise.resolve(null));let t=!1;return()=>e.then(()=>new Promise(i=>{const a=n.get(Ui),l=n.get(CL);(function r(i){const a=n.get(Ui);a.events.pipe(Ri(l=>l instanceof dp||l instanceof HD||l instanceof vF),(0,Ot.U)(l=>{if(l instanceof dp)return!0;const h=a.navigationId!==l.id,m=l instanceof HD&&-1!==l.reason.indexOf(VM);return!(!h&&!m)&&null}),Ri(l=>null!==l),yf(1)).subscribe(()=>{i()})})(()=>{i(!0),t=!0}),a.afterPreactivation=()=>(i(!0),t||l.closed?Nt(void 0):l),a.initialNavigation()}))}}]:[]]}const CL=new f.OlP("",{factory:()=>new wu.x}),uN=new f.OlP("");function G$(n){return[mL,{provide:vL,useExisting:mL},{provide:gL,useExisting:n}]}let $_=(()=>{class n{constructor(t,r,i,a){this.afs=t,this.afAuth=r,this.router=i,this.ngZone=a,this.currentUser=JSON.parse(localStorage.getItem("user")),this.usrDat={},this.afAuth.authState.subscribe(l=>{l?(this.userData=l,localStorage.setItem("user",JSON.stringify(this.userData)),JSON.parse(localStorage.getItem("user")),this.currentUser=JSON.parse(localStorage.getItem("user"))):(localStorage.setItem("user","null"),JSON.parse(localStorage.getItem("user")))})}SignIn(t,r){return this.afAuth.signInWithEmailAndPassword(t,r).then(i=>{this.ngZone.run(()=>{this.router.navigate(["test"])}),this.SetUserData(i.user)}).catch(i=>{window.alert(i.message),this.router.navigate(["refreshpass"])})}SignUp(t,r){return this.afAuth.createUserWithEmailAndPassword(t,r).then(i=>{this.SendVerificationMail(),this.SetUserData(i.user),this.router.navigate(["test"])}).catch(i=>{window.alert(i.message)})}SendVerificationMail(){return this.afAuth.currentUser.then(t=>t.sendEmailVerification()).then(()=>{})}ForgotPassword(t){return this.afAuth.sendPasswordResetEmail(t).then(()=>{window.alert("Password reset email sent, check your inbox.")}).catch(r=>{window.alert(r)})}get isLoggedIn(){const t=JSON.parse(localStorage.getItem("user"));return null!==t&&!1!==t.emailVerified}GoogleAuth(){return this.AuthLogin(new Aj.Q).then(t=>{t&&this.router.navigate(["test"])})}AuthLogin(t){return this.afAuth.signInWithPopup(t).then(r=>{this.ngZone.run(()=>{this.router.navigate(["test"])}),this.SetUserData(r.user)}).catch(r=>{this.router.navigate(["refreshpass"]),window.alert(r)})}SetUserData(t){return this.afs.doc(`users/${t.uid}`).set({uid:t.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL,emailVerified:t.emailVerified},{merge:!0})}SignOut(){return this.afAuth.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate(["login"]),this.currentUser=null})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(PM),f.LFG(bf),f.LFG(Ui),f.LFG(f.R0b))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),W$=(()=>{class n{constructor(t){this.authService=t,this.index=this.authService.currentUser.email.indexOf("@"),this.user=this.authService.currentUser.email.slice(0,this.index)}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(f.Y36($_))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-testcomponent"]],decls:2,vars:1,template:function(t,r){1&t&&(f.TgZ(0,"h3"),f._uU(1),f.qZA()),2&t&&(f.xp6(1),f.hij("hello, ",r.user,""))},styles:["input.ng-touched.ng-invalid[_ngcontent-%COMP%]{border:solid red 2px}input.ng-touched.ng-valid[_ngcontent-%COMP%]{border:solid green 2px}"]}),n})(),bL=(()=>{class n{constructor(t){this.fireservices=t}createNewUser(t){return this.fireservices.collection("user").add(t)}getAll(){return this.fireservices.collection("user").snapshotChanges()}getUser(t){this.loginUser=this.fireservices.collection("user",r=>r.where("email","==",t.email)).get().subscribe(r=>r.forEach(i=>{if(this.loginUser=i.data(),this.loginUser.password===t.password){console.log("CrudService ~ data.forEach ~ this.currentUser",this.currentUser),console.log(`${this.loginUser.name}! welcome`);const a=eo.IH();eo.Kz(a,"login-event",{useremail:`${this.loginUser.email}`})}}))}currentUserName(){return this.currentUser.name}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(PM))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function z$(n,e){if(1&n&&(f.TgZ(0,"div")(1,"div")(2,"h5"),f._uU(3,"user"),f.qZA(),f.TgZ(4,"div"),f._uU(5),f.qZA(),f.TgZ(6,"div"),f._uU(7),f.qZA(),f.TgZ(8,"div"),f._uU(9),f.qZA(),f._UZ(10,"div"),f.qZA()()),2&n){const t=e.$implicit;f.xp6(5),f.hij("Name: ",t.data.name,""),f.xp6(2),f.hij("email: ",t.data.email,""),f.xp6(2),f.hij("pass: ",t.data.password,"")}}let q$=(()=>{class n{constructor(t){this.crudservice=t,this.array=[]}ngOnInit(){this.crudservice.getAll().subscribe(t=>{this.user=t.map(r=>({id:r.payload.doc.id,data:r.payload.doc.data()})),console.log(this.user),this.array=this.user})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(bL))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-home"]],decls:6,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(t,r){1&t&&(f.TgZ(0,"p"),f._uU(1,"Hi! this is my first Angular App!"),f.qZA(),f.TgZ(2,"p"),f._uU(3,"you may register, logIn or refresh your password"),f.qZA(),f.TgZ(4,"div"),f.YNc(5,z$,11,3,"div",0),f.qZA()),2&t&&(f.xp6(5),f.Q6J("ngForOf",r.array))},dependencies:[Ci]}),n})(),K$=(()=>{class n{constructor(t){this.authService=t}authOnPassForgot(t){this.authService.ForgotPassword(t);const r=eo.IH();eo.Kz(r,"refreshPass",{userEmail:`${t}`})}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(f.Y36($_))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-refreshpass"]],decls:13,vars:0,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"text-center"],[1,"formGroup"],["type","email","placeholder","Email Address","required","",1,"formControl"],["passwordResetEmail",""],["type","submit","value","Reset Password",1,"btn","btnPrimary",3,"click"]],template:function(t,r){if(1&t){const i=f.EpF();f.TgZ(0,"h3"),f._uU(1,"Reset Password"),f.qZA(),f.TgZ(2,"div",0)(3,"div",1)(4,"div",2)(5,"p",3),f._uU(6," Please enter your email address to request a password reset. "),f.qZA(),f.TgZ(7,"div",4),f._UZ(8,"input",5,6),f.qZA(),f.TgZ(10,"div",4)(11,"button",7),f.NdJ("click",function(){f.CHM(i);const l=f.MAs(9);return f.KtG(r.authOnPassForgot(l.value))}),f._uU(12," Reset Password "),f.qZA()()()()()}},styles:[".authBlock[_ngcontent-%COMP%]{width:35%}.authBlock[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between;margin-bottom:10px}input[_ngcontent-%COMP%]{width:60%;text-align:center}button[_ngcontent-%COMP%]{width:62%}"]}),n})(),Z$=(()=>{class n{constructor(t){this.authService=t}authLogin(t,r){this.authService.SignIn(t,r);const i=eo.IH();eo.Kz(i,"login-event",{userLoginEmail:`${t}`}),console.log("login")}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)(f.Y36($_))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-login"]],decls:14,vars:0,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"formGroup"],["type","text","placeholder","Username","required","",1,"formControl"],["userName",""],["type","password","placeholder","Password","required","",1,"formControl"],["userPassword",""],["type","button","value","Log in",1,"btn","btnPrimary",3,"click"]],template:function(t,r){if(1&t){const i=f.EpF();f.TgZ(0,"h3"),f._uU(1,"Sign In"),f.qZA(),f.TgZ(2,"div",0)(3,"div",1)(4,"div",2)(5,"div",3),f._UZ(6,"input",4,5),f.qZA(),f.TgZ(8,"div",3),f._UZ(9,"input",6,7),f.qZA(),f.TgZ(11,"div",3)(12,"button",8),f.NdJ("click",function(){f.CHM(i);const l=f.MAs(7),h=f.MAs(10);return f.KtG(r.authLogin(l.value,h.value))}),f._uU(13," Log in "),f.qZA()()()()()}},styles:[".authBlock[_ngcontent-%COMP%]{width:35%}.authBlock[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between;margin-bottom:10px}input[_ngcontent-%COMP%]{margin-left:20px;width:60%;text-align:center}button[_ngcontent-%COMP%]{margin-left:20px;width:62%}"]}),n})(),Y$=(()=>{class n{constructor(t){this.authService=t}authRegister(t,r){this.authService.SignUp(t,r);const i=eo.IH();eo.Kz(i,"register-event",{firsttimeuser:!0,userRegisterEmail:`${t}`}),console.log("registered: ",t,r)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36($_))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-register"]],decls:14,vars:0,consts:[[1,"displayTable"],[1,"displayTableCell"],[1,"authBlock"],[1,"formGroup"],["type","email","placeholder","Email Address","required","",1,"formControl"],["userEmail",""],["type","password","placeholder","Password","required","",1,"formControl"],["userPwd",""],["type","button","value","Sign Up",1,"btn","btnPrimary",3,"click"]],template:function(t,r){if(1&t){const i=f.EpF();f.TgZ(0,"h3"),f._uU(1,"Sign Up"),f.qZA(),f.TgZ(2,"div",0)(3,"div",1)(4,"div",2)(5,"div",3),f._UZ(6,"input",4,5),f.qZA(),f.TgZ(8,"div",3),f._UZ(9,"input",6,7),f.qZA(),f.TgZ(11,"div",3)(12,"button",8),f.NdJ("click",function(){f.CHM(i);const l=f.MAs(7),h=f.MAs(10);return f.KtG(r.authRegister(l.value,h.value))}),f._uU(13," Sign Up "),f.qZA()()()()()}},styles:[".authBlock[_ngcontent-%COMP%]{width:35%}.authBlock[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between;margin-bottom:10px}input[_ngcontent-%COMP%]{margin-left:20px;width:60%;text-align:center}button[_ngcontent-%COMP%]{margin-left:20px;width:62%}"]}),n})(),Q$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[wL.forRoot([{path:"",component:q$},{path:"register",component:Y$},{path:"login",component:Z$},{path:"refreshpass",component:K$},{path:"test",component:W$}]),wL]}),n})();function J$(n,e){1&n&&(f.TgZ(0,"div")(1,"a",5),f._uU(2,"register"),f.qZA(),f.TgZ(3,"a",6),f._uU(4,"login"),f.qZA(),f.TgZ(5,"a",7),f._uU(6,"refreshpass"),f.qZA()())}function X$(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div")(1,"a",8),f._uU(2,"test"),f.qZA(),f.TgZ(3,"button",9),f.NdJ("click",function(){f.CHM(t);const i=f.oxw();return f.KtG(i.authLogOut())}),f._uU(4,"logOut"),f.qZA()()}}let eG=(()=>{class n{constructor(t){this.authService=t,this.currentUser=JSON.parse(localStorage.getItem("user")),this.title="angularapp",this.userName="",this.userEmail="",this.userPassword="",this.userId=""}authLogOut(){const t=JSON.parse(localStorage.getItem("user")),r=eo.IH();eo.Kz(r,"loginOut",{userLogoutEmail:`${t.providerData[0].email}`}),this.authService.SignOut()}ngAfterViewInit(){}}return n.\u0275fac=function(t){return new(t||n)(f.Y36($_))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-root"]],decls:8,vars:2,consts:[[1,"container"],[1,"nav"],["routerLink","/","routerLinkActive","active","ariaCurrentWhenActive","page"],[1,"logo"],[4,"ngIf"],["routerLink","/register","routerLinkActive","active","ariaCurrentWhenActive","page"],["routerLink","/login","routerLinkActive","active","ariaCurrentWhenActive","page"],["routerLink","/refreshpass","routerLinkActive","active","ariaCurrentWhenActive","page"],["routerLink","/test","routerLinkActive","active","ariaCurrentWhenActive","page"],[3,"click"]],template:function(t,r){1&t&&(f.TgZ(0,"div",0)(1,"div",1)(2,"a",2)(3,"p",3),f._uU(4,"hello"),f.qZA()(),f.YNc(5,J$,7,0,"div",4),f.YNc(6,X$,5,0,"div",4),f.qZA(),f._UZ(7,"router-outlet"),f.qZA()),2&t&&(f.xp6(5),f.Q6J("ngIf",!r.authService.currentUser),f.xp6(1),f.Q6J("ngIf",r.authService.currentUser))},dependencies:[Er,QM,oT,fL],styles:["*[_ngcontent-%COMP%]{box-sizing:border-box}.container[_ngcontent-%COMP%]{padding:1.5rem}.logo[_ngcontent-%COMP%]{color:red}.nav[_ngcontent-%COMP%], .nav[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;gap:40px;align-items:center}button[_ngcontent-%COMP%]{margin-left:auto}a.active[_ngcontent-%COMP%]:not(:nth-child(1)){border:1px solid red}"]}),n})();const DL="firebasestorage.googleapis.com",TL="storageBucket";class Or extends R.ZR{constructor(e,t){super(lN(e),`Firebase Storage: ${t} (${lN(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Or.prototype)}_codeEquals(e){return lN(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function lN(n){return"storage/"+n}function cN(){return new Or("unknown","An unknown error occurred, please check the error payload for server response.")}function SL(){return new Or("canceled","User canceled the upload/download.")}function AL(){return new Or("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function G_(n){return new Or("invalid-argument",n)}function xL(){return new Or("app-deleted","The Firebase app was deleted.")}function RL(n){return new Or("invalid-root-operation","The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function oE(n,e){return new Or("invalid-format","String does not match format '"+n+"': "+e)}function aE(n){throw new Or("internal-error","Internal error: "+n)}class es{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=es.makeFromUrl(e,t)}catch{return new es(e,"")}if(""===r.path)return r;throw function dG(n){return new Or("invalid-default-bucket","Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",h=new RegExp("^gs://"+i+"(/(.*))?$","i");function v(wt){wt.path_=decodeURIComponent(wt.path)}const D=t.replace(/[.]/g,"\\."),Ct=[{regex:h,indices:{bucket:1,path:3},postModify:function a(wt){"/"===wt.path.charAt(wt.path.length-1)&&(wt.path_=wt.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${D}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:v},{regex:new RegExp(`^https?://${t===DL?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:v}];for(let wt=0;wt<Ct.length;wt++){const qt=Ct[wt],pn=qt.regex.exec(e);if(pn){let Na=pn[qt.indices.path];Na||(Na=""),r=new es(pn[qt.indices.bucket],Na),qt.postModify(r);break}}if(null==r)throw function cG(n){return new Or("invalid-url","Invalid URL '"+n+"'.")}(e);return r}}class gG{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function aT(n){return"string"==typeof n||n instanceof String}function ML(n){return dN()&&n instanceof Blob}function dN(){return typeof Blob<"u"}function hN(n,e,t,r){if(r<e)throw G_(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw G_(`Invalid value for '${n}'. Expected ${t} or less.`)}function ql(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function NL(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var kd=(()=>(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"}(kd||(kd={})),kd))();class EG{constructor(e,t,r,i,a,l,h,m,v,b,D){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=m,this.timeout_=v,this.progressCallback_=b,this.connectionFactory_=D,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,j)=>{this.resolve_=x,this.reject_=j,this.start_()})}start_(){const t=(r,i)=>{const a=this.resolve_,l=this.reject_,h=i.connection;if(i.wasSuccessCode)try{const m=this.callback_(h,h.getResponse());!function yG(n){return void 0!==n}(m)?a():a(m)}catch(m){l(m)}else if(null!==h){const m=cN();m.serverResponse=h.getErrorText(),l(this.errorCallback_?this.errorCallback_(h,m):m)}else l(i.canceled?this.appDelete_?xL():SL():function lG(){return new Or("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}())};this.canceled_?t(0,new uT(!1,null,!0)):this.backoffId_=function mG(n,e,t){let r=1,i=null,a=null,l=!1,h=0;function m(){return 2===h}let v=!1;function b(...Le){v||(v=!0,e.apply(null,Le))}function D(Le){i=setTimeout(()=>{i=null,n(j,m())},Le)}function x(){a&&clearTimeout(a)}function j(Le,...Et){if(v)return void x();if(Le)return x(),void b.call(null,Le,...Et);if(m()||l)return x(),void b.call(null,Le,...Et);let Ct;r<64&&(r*=2),1===h?(h=2,Ct=0):Ct=1e3*(r+Math.random()),D(Ct)}let Q=!1;function Se(Le){Q||(Q=!0,x(),!v&&(null!==i?(Le||(h=2),clearTimeout(i),D(0)):Le||(h=1)))}return D(0),a=setTimeout(()=>{l=!0,Se(!0)},t),Se}((r,i)=>{if(i)return void r(!1,new uT(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const l=h=>{null!==this.progressCallback_&&this.progressCallback_(h.loaded,h.lengthComputable?h.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const h=a.getErrorCode()===kd.NO_ERROR,m=a.getStatus();if(!h||this.isRetryStatusCode_(m)){const b=a.getErrorCode()===kd.ABORT;return void r(!1,new uT(!1,null,b))}const v=-1!==this.successCodes_.indexOf(m);r(!0,new uT(v,a))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function _G(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,i=-1!==[408,429].indexOf(e),a=-1!==this.additionalRetryCodes_.indexOf(e);return t||i||a}}class uT{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function AG(...n){const e=function SG(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(dN())return new Blob(n);throw new Or("unsupported-environment","This browser doesn't seem to support creating Blobs")}const _o={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class fN{constructor(e,t){this.data=e,this.contentType=t||null}}function pN(n,e){switch(n){case _o.RAW:return new fN(PL(e));case _o.BASE64:case _o.BASE64URL:return new fN(kL(n,e));case _o.DATA_URL:return new fN(function NG(n){const e=new OL(n);return e.base64?kL(_o.BASE64,e.rest):function MG(n){let e;try{e=decodeURIComponent(n)}catch{throw oE(_o.DATA_URL,"Malformed data URL.")}return PL(e)}(e.rest)}(e),function PG(n){return new OL(n).contentType}(e))}throw cN()}function PL(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function kL(n,e){switch(n){case _o.BASE64:{const i=-1!==e.indexOf("-"),a=-1!==e.indexOf("_");if(i||a)throw oE(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case _o.BASE64URL:{const i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a)throw oE(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function RG(n){return atob(n)}(e)}catch{throw oE(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class OL{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw oE(_o.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function kG(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class Lu{constructor(e,t){let r=0,i="";ML(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(ML(this.data_)){const i=function xG(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new Lu(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Lu(r,!0)}}static getBlob(...e){if(dN()){const t=e.map(r=>r instanceof Lu?r.data_:r);return new Lu(AG.apply(null,t))}{const t=e.map(l=>aT(l)?pN(_o.RAW,l).data:l.data_);let r=0;t.forEach(l=>{r+=l.byteLength});const i=new Uint8Array(r);let a=0;return t.forEach(l=>{for(let h=0;h<l.length;h++)i[a++]=l[h]}),new Lu(i,!0)}}uploadData(){return this.data_}}function gN(n){let e;try{e=JSON.parse(n)}catch{return null}return function wG(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function FL(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function LG(n,e){return e}class Cs{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||LG}}let lT=null;function uE(){if(lT)return lT;const n=[];n.push(new Cs("bucket")),n.push(new Cs("generation")),n.push(new Cs("metageneration")),n.push(new Cs("name","fullPath",!0));const t=new Cs("name");t.xform=function e(a,l){return function VG(n){return!aT(n)||n.length<2?n:FL(n)}(l)},n.push(t);const i=new Cs("size");return i.xform=function r(a,l){return void 0!==l?Number(l):l},n.push(i),n.push(new Cs("timeCreated")),n.push(new Cs("updated")),n.push(new Cs("md5Hash",null,!0)),n.push(new Cs("cacheControl",null,!0)),n.push(new Cs("contentDisposition",null,!0)),n.push(new Cs("contentEncoding",null,!0)),n.push(new Cs("contentLanguage",null,!0)),n.push(new Cs("contentType",null,!0)),n.push(new Cs("metadata","customMetadata",!0)),lT=n,lT}function LL(n,e,t){const r=gN(e);return null===r?null:function BG(n,e,t){const r={type:"file"},i=t.length;for(let a=0;a<i;a++){const l=t[a];r[l.local]=l.xform(r,e[l.server])}return function UG(n,e){Object.defineProperty(n,"ref",{get:function t(){const a=new es(n.bucket,n.fullPath);return e._makeStorageReference(a)}})}(r,n),r}(n,r,t)}function mN(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}const VL="prefixes";class Vu{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Uu(n){if(!n)throw cN()}function cT(n,e){return function t(r,i){const a=LL(n,i,e);return Uu(null!==a),a}}function W_(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function aG(){return new Or("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function oG(){return new Or("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function sG(n){return new Or("quota-exceeded","Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function uG(n){return new Or("unauthorized","User does not have permission to access '"+n+"'.")}(n.path):r,i.serverResponse=r.serverResponse,i}}function lE(n){const e=W_(n);return function t(r,i){let a=e(r,i);return 404===r.getStatus()&&(a=function iG(n){return new Or("object-not-found","Object '"+n+"' does not exist.")}(n.path)),a.serverResponse=i.serverResponse,a}}function BL(n,e,t){const i=ql(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,h=new Vu(i,"GET",cT(n,t),l);return h.errorHandler=lE(e),h}function zG(n,e,t,r,i){const a={};a.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(a.delimiter=t),r&&(a.pageToken=r),i&&(a.maxResults=i);const h=ql(e.bucketOnlyServerUrl(),n.host,n._protocol),v=n.maxOperationRetryTime,b=new Vu(h,"GET",function GG(n,e){return function t(r,i){const a=function $G(n,e,t){const r=gN(t);return null===r?null:function HG(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[VL])for(const i of t[VL]){const a=i.replace(/\/$/,""),l=n._makeStorageReference(new es(e,a));r.prefixes.push(l)}if(t.items)for(const i of t.items){const a=n._makeStorageReference(new es(e,i.name));r.items.push(a)}return r}(n,e,r)}(n,e,i);return Uu(null!==a),a}}(n,e.bucket),v);return b.urlParams=a,b.errorHandler=W_(e),b}function HL(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function YG(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class dT{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function _N(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Uu(!1)}return Uu(!!t&&-1!==(e||["active"]).indexOf(t)),t}const eW={STATE_CHANGED:"state_changed"},bs={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function yN(n){switch(n){case"running":case"pausing":case"canceling":return bs.RUNNING;case"paused":return bs.PAUSED;case"success":return bs.SUCCESS;case"canceled":return bs.CANCELED;default:return bs.ERROR}}class tW{constructor(e,t,r){if(function vG(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function z_(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class rW extends class nW{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=kd.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=kd.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=kd.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw aE("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw aE("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw aE("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw aE("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw aE("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}{initXhr(){this.xhr_.responseType="text"}}function Ma(){return new rW}class zL{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=uE(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=i,this._transition("error"))},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function QG(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l=HL(e,r,i),h={name:l.fullPath},m=ql(a,n.host,n._protocol),b={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":l.contentType,"Content-Type":"application/json; charset=utf-8"},D=mN(l,t),Q=new Vu(m,"POST",function j(Se){let Le;_N(Se);try{Le=Se.getResponseHeader("X-Goog-Upload-URL")}catch{Uu(!1)}return Uu(aT(Le)),Le},n.maxUploadRetryTime);return Q.urlParams=h,Q.headers=b,Q.body=D,Q.errorHandler=W_(e),Q}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ma,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function JG(n,e,t,r){const m=new Vu(t,"POST",function a(v){const b=_N(v,["active","final"]);let D=null;try{D=v.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Uu(!1)}D||Uu(!1);const x=Number(D);return Uu(!isNaN(x)),new dT(x,r.size(),"final"===b)},n.maxUploadRetryTime);return m.headers={"X-Goog-Upload-Command":"query"},m.errorHandler=W_(e),m}(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(i,Ma,t,r);this._request=a,a.getPromise().then(l=>{this._request=void 0,this._updateProgress(l.current),this._needToFetchStatus=!1,l.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new dT(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,a)=>{let l;try{l=function XG(n,e,t,r,i,a,l,h){const m=new dT(0,0);if(l?(m.current=l.current,m.total=l.total):(m.current=0,m.total=r.size()),r.size()!==m.total)throw function fG(){return new Or("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const v=m.total-m.current;let b=v;i>0&&(b=Math.min(b,i));const D=m.current,Q={"X-Goog-Upload-Command":b===v?"upload, finalize":"upload","X-Goog-Upload-Offset":`${m.current}`},Se=r.slice(D,D+b);if(null===Se)throw AL();const Ct=new Vu(t,"POST",function Le(wt,qt){const pn=_N(wt,["active","final"]),Zr=m.current+b,Na=r.size();let EN;return EN="final"===pn?cT(e,a)(wt,qt):null,new dT(Zr,Na,"final"===pn,EN)},e.maxUploadRetryTime);return Ct.headers=Q,Ct.body=Se.uploadData(),Ct.progressCallback=h||null,Ct.errorHandler=W_(n),Ct}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(m){return this._error=m,void this._transition("error")}const h=this._ref.storage._makeRequest(l,Ma,i,a);this._request=h,h.getPromise().then(m=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(m.current),m.finalized?(this._metadata=m.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=BL(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Ma,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function $L(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"},m=function h(){let Ct="";for(let wt=0;wt<2;wt++)Ct+=Math.random().toString().slice(2);return Ct}();l["Content-Type"]="multipart/related; boundary="+m;const v=HL(e,r,i),b=mN(v,t),j=Lu.getBlob("--"+m+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+b+"\r\n--"+m+"\r\nContent-Type: "+v.contentType+"\r\n\r\n",r,"\r\n--"+m+"--");if(null===j)throw AL();const Q={name:v.fullPath},Se=ql(a,n.host,n._protocol),Et=n.maxUploadRetryTime,It=new Vu(Se,"POST",cT(n,t),Et);return It.urlParams=Q,It.headers=l,It.body=j.uploadData(),It.errorHandler=W_(e),It}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ma,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=SL(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=yN(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const a=new tW(t||void 0,r||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(yN(this._state)){case bs.SUCCESS:z_(this._resolve.bind(null,this.snapshot))();break;case bs.CANCELED:case bs.ERROR:z_(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(yN(this._state)){case bs.RUNNING:case bs.PAUSED:e.next&&z_(e.next.bind(e,this.snapshot))();break;case bs.SUCCESS:e.complete&&z_(e.complete.bind(e))();break;default:e.error&&z_(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class gp{constructor(e,t){this._service=e,this._location=t instanceof es?t:es.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new gp(e,t)}get root(){const e=new es(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return FL(this._location.path)}get storage(){return this._service}get parent(){const e=function OG(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new es(this._location.bucket,e);return new gp(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw RL(e)}}function KL(n,e,t){return vN.apply(this,arguments)}function vN(){return vN=(0,xe.Z)(function*(n,e,t){const i=yield ZL(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield KL(n,e,i.nextPageToken))}),vN.apply(this,arguments)}function ZL(n,e){null!=e&&"number"==typeof e.maxResults&&hN("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=zG(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Ma)}function gW(n){n._throwIfRoot("getDownloadURL");const e=function qG(n,e,t){const i=ql(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,h=new Vu(i,"GET",function WG(n,e){return function t(r,i){const a=LL(n,i,e);return Uu(null!==a),function jG(n,e,t,r){const i=gN(e);if(null===i||!aT(i.downloadTokens))return null;const a=i.downloadTokens;if(0===a.length)return null;const l=encodeURIComponent;return a.split(",").map(v=>{const D=n.fullPath;return ql("/b/"+l(n.bucket)+"/o/"+l(D),t,r)+NL({alt:"media",token:v})})[0]}(a,i,n.host,n._protocol)}}(n,t),l);return h.errorHandler=lE(e),h}(n.storage,n._location,uE());return n.storage.makeRequestWithTokens(e,Ma).then(t=>{if(null===t)throw function pG(){return new Or("no-download-url","The given file does not have any download URLs.")}();return t})}function YL(n,e){const t=function FG(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new es(n._location.bucket,t);return new gp(n.storage,r)}function QL(n,e){if(n instanceof wN){const t=n;if(null==t._bucket)throw function hG(){return new Or("no-default-bucket","No default bucket found. Did you set the '"+TL+"' property when initializing the app?")}();const r=new gp(t,t._bucket);return null!=e?QL(r,e):r}return void 0!==e?YL(n,e):n}function vW(n,e){if(e&&function _W(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof wN)return function yW(n,e){return new gp(n,e)}(n,e);throw G_("To use ref(service, url), the first argument must be a Storage instance.")}return QL(n,e)}function JL(n,e){const t=e?.[TL];return null==t?null:es.makeFromBucketSpec(t,n)}class wN{constructor(e,t,r,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=DL,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?es.makeFromBucketSpec(i,this._host):JL(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?es.makeFromBucketSpec(this._url,e):JL(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){hN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){hN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,xe.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,xe.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new gp(this,e)}_makeRequest(e,t,r,i){if(this._deleted)return new gG(xL());{const a=function TG(n,e,t,r,i,a){const l=NL(n.urlParams),h=n.url+l,m=Object.assign({},n.headers);return function bG(n,e){e&&(n["X-Firebase-GMPID"]=e)}(m,e),function IG(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(m,t),function CG(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(m,a),function DG(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(m,r),new EG(h,n.method,m,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i)}(e,this._appId,r,i,t,this._firebaseVersion);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(e,t){var r=this;return(0,xe.Z)(function*(){const[i,a]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,a).getPromise()})()}}const XL="@firebase/storage";function nV(n,e){return vW(n=(0,R.m9)(n),e)}function RW(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new wN(t,r,i,e,Si.SDK_VERSION)}!function MW(){(0,Si._registerComponent)(new no.wA("storage",RW,"PUBLIC").setMultipleInstances(!0)),(0,Si.registerVersion)(XL,"0.9.9",""),(0,Si.registerVersion)(XL,"0.9.9","esm2017")}();class hT{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class rV{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new hT(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new hT(r,this,this._ref))},t)}on(e,t,r,i){let a;return t&&(a="function"==typeof t?l=>t(new hT(l,this,this._ref)):{next:t.next?l=>t.next(new hT(l,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,r||void 0,i||void 0)}}class iV{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Kl(e,this._service))}get items(){return this._delegate.items.map(e=>new Kl(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Kl{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function AW(n,e){return YL(n,e)}(this._delegate,e);return new Kl(t,this.storage)}get root(){return new Kl(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new Kl(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new rV(function EW(n,e,t){return function cW(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new zL(n,new Lu(e),t)}(n=(0,R.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=_o.RAW,r){this._throwIfRoot("putString");const i=pN(t,e),a=Object.assign({},r);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new rV(new zL(this._delegate,new Lu(i.data,!0),a),this)}listAll(){return function DW(n){return function hW(n){const e={prefixes:[],items:[]};return KL(n,e).then(()=>e)}(n=(0,R.m9)(n))}(this._delegate).then(e=>new iV(e,this.storage))}list(e){return function bW(n,e){return ZL(n=(0,R.m9)(n),e)}(this._delegate,e||void 0).then(t=>new iV(t,this.storage))}getMetadata(){return function IW(n){return function fW(n){n._throwIfRoot("getMetadata");const e=BL(n.storage,n._location,uE());return n.storage.makeRequestWithTokens(e,Ma)}(n=(0,R.m9)(n))}(this._delegate)}updateMetadata(e){return function CW(n,e){return function pW(n,e){n._throwIfRoot("updateMetadata");const t=function KG(n,e,t,r){const a=ql(e.fullServerUrl(),n.host,n._protocol),h=mN(t,r),v=n.maxOperationRetryTime,b=new Vu(a,"PATCH",cT(n,r),v);return b.headers={"Content-Type":"application/json; charset=utf-8"},b.body=h,b.errorHandler=lE(e),b}(n.storage,n._location,e,uE());return n.storage.makeRequestWithTokens(t,Ma)}(n=(0,R.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function TW(n){return gW(n=(0,R.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function SW(n){return function mW(n){n._throwIfRoot("deleteObject");const e=function ZG(n,e){const r=ql(e.fullServerUrl(),n.host,n._protocol),h=new Vu(r,"DELETE",function l(m,v){},n.maxOperationRetryTime);return h.successCodes=[200,204],h.errorHandler=lE(e),h}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Ma)}(n=(0,R.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw RL(e)}}class sV{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(oV(e))throw G_("ref() expected a child path but got a URL, use refFromURL instead.");return new Kl(nV(this._delegate,e),this)}refFromURL(e){if(!oV(e))throw G_("refFromURL() expected a full URL but got a child path, use ref() instead.");try{es.makeFromUrl(e,this._delegate.host)}catch{throw G_("refFromUrl() expected a valid full URL but got an invalid one.")}return new Kl(nV(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function xW(n,e,t,r={}){!function wW(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,R.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function oV(n){return/^[A-Za-z]+:\/\//.test(n)}function OW(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new sV(t,r)}function aV(n){const e=function LW(n){return new Mn.y(e=>{const t=l=>e.next(l);t(n.snapshot);const a=n.on("state_changed",t);return n.then(l=>{t(l),e.complete()},l=>{t(n.snapshot),(l=>{e.error(l)})(l)}),function(){a()}}).pipe(function tG(n,e=Ay.z){return(0,jr.e)((t,r)=>{let i=null,a=null,l=null;const h=()=>{if(i){i.unsubscribe(),i=null;const v=a;a=null,r.next(v)}};function m(){const v=l+n,b=e.now();if(b<v)return i=this.schedule(void 0,v-b),void r.add(i);h()}t.subscribe((0,Yn.x)(r,v=>{a=v,l=e.now(),i||(i=e.schedule(m,n),r.add(i))},()=>{h(),r.complete()},void 0,()=>{a=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,Ot.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function fT(n){return{getDownloadURL:()=>Nt(void 0).pipe(An.fc,Ar(()=>n.getDownloadURL()),An.iC),getMetadata:()=>Nt(void 0).pipe(An.fc,Ar(()=>n.getMetadata()),An.iC),delete:()=>(0,kn.D)(n.delete()),child:e=>fT(n.child(e)),updateMetadata:e=>(0,kn.D)(n.updateMetadata(e)),put:(e,t)=>aV(n.put(e,t)),putString:(e,t,r)=>aV(n.putString(e,t,r)),list:e=>(0,kn.D)(n.list(e)),listAll:()=>(0,kn.D)(n.listAll())}}!function FW(n){const e={TaskState:bs,TaskEvent:eW,StringFormat:_o,Storage:sV,Reference:Kl};n.INTERNAL.registerComponent(new no.wA("storage-compat",OW,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.1.17")}(xy.Z);const VW=new f.OlP("angularfire2.storageBucket"),UW=new f.OlP("angularfire2.storage.maxUploadRetryTime"),BW=new f.OlP("angularfire2.storage.maxOperationRetryTime"),jW=new f.OlP("angularfire2.storage.use-emulator");let HW=(()=>{class n{constructor(t,r,i,a,l,h,m,v,b,D){const x=(0,xr.on)(t,l,r);this.storage=(0,xr.cc)(`${x.name}.storage.${i}`,"AngularFireStorage",x.name,()=>{const j=l.runOutsideAngular(()=>x.storage(i||void 0)),Q=b;return Q&&j.useEmulator(...Q),m&&j.setMaxUploadRetryTime(m),v&&j.setMaxOperationRetryTime(v),j},[m,v])}ref(t){return fT(this.storage.ref(t))}refFromURL(t){return fT(this.storage.refFromURL(t))}upload(t,r,i){return fT(this.storage.ref(t)).put(r,i)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(xr.Dh),f.LFG(xr.xv,8),f.LFG(VW,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(An.HU),f.LFG(UW,8),f.LFG(BW,8),f.LFG(jW,8),f.LFG(nd,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),$W=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})(),GW=(()=>{class n{constructor(){_s.Z.registerVersion("angularfire",An.q4.full,"gcs-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[HW],imports:[$W]}),n})();const zW=(0,Ty.ZF)({apiKey:"AIzaSyClD21a4Yb_O2e__nm-sqI_LsdocEieF54",authDomain:"my-test-project-450cf.firebaseapp.com",projectId:"my-test-project-450cf",storageBucket:"my-test-project-450cf.appspot.com",messagingSenderId:"781922575005",appId:"1:781922575005:web:25d346cef985b1b201ea74",measurementId:"G-T2GBSCH2D1"});(0,eo.IH)(zW);let qW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n,bootstrap:[eG]}),n.\u0275inj=f.cJS({providers:[bL,$_],imports:[Zn,Q$,GW,QA,DT,xr.hO.initializeApp(Sy_firebaseConfig),nx,Sj]}),n})();(0,f.G48)(),Sp().bootstrapModule(qW).catch(n=>console.error(n))},6148:(mt,Fe,P)=>{P.d(Fe,{IH:()=>vn,Gb:()=>Jt,Kz:()=>ke});var f=P(5861),B=P(9681),N=P(1877),oe=P(2090),ye=P(4859);P(2833);const de="analytics",fe="firebase_id",G="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ne="https://www.googletagmanager.com/gtag/js",Ue=new N.Yd("@firebase/analytics");function Te(ue){return Promise.all(ue.map(U=>U.catch(M=>M)))}function Oe(ue,U){const M=document.createElement("script");M.src=`${ne}?l=${ue}&id=${U}`,M.async=!0,document.head.appendChild(M)}function ge(ue,U,M,F,J,Ie){return pe.apply(this,arguments)}function pe(){return(pe=(0,f.Z)(function*(ue,U,M,F,J,Ie){const Ke=F[J];try{if(Ke)yield U[Ke];else{const ze=(yield Te(M)).find(ot=>ot.measurementId===J);ze&&(yield U[ze.appId])}}catch(_e){Ue.error(_e)}ue("config",J,Ie)})).apply(this,arguments)}function rt(ue,U,M,F,J){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,f.Z)(function*(ue,U,M,F,J){try{let Ie=[];if(J&&J.send_to){let Ke=J.send_to;Array.isArray(Ke)||(Ke=[Ke]);const _e=yield Te(M);for(const ze of Ke){const ot=_e.find(wn=>wn.measurementId===ze),Rt=ot&&U[ot.appId];if(!Rt){Ie=[];break}Ie.push(Rt)}}0===Ie.length&&(Ie=Object.values(U)),yield Promise.all(Ie),ue("event",F,J||{})}catch(Ie){Ue.error(Ie)}})).apply(this,arguments)}function Ae(){const ue=window.document.getElementsByTagName("script");for(const U of Object.values(ue))if(U.src&&U.src.includes(ne))return U;return null}const te=new oe.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),re=new class X{constructor(U={},M=1e3){this.throttleMetadata=U,this.intervalMillis=M}getThrottleMetadata(U){return this.throttleMetadata[U]}setThrottleMetadata(U,M){this.throttleMetadata[U]=M}deleteThrottleMetadata(U){delete this.throttleMetadata[U]}};function ae(ue){return new Headers({Accept:"application/json","x-goog-api-key":ue})}function ve(ue){return le.apply(this,arguments)}function le(){return(le=(0,f.Z)(function*(ue){var U;const{appId:M,apiKey:F}=ue,J={method:"GET",headers:ae(F)},Ie=G.replace("{app-id}",M),Ke=yield fetch(Ie,J);if(200!==Ke.status&&304!==Ke.status){let _e="";try{const ze=yield Ke.json();null!==(U=ze.error)&&void 0!==U&&U.message&&(_e=ze.error.message)}catch{}throw te.create("config-fetch-failed",{httpStatus:Ke.status,responseMessage:_e})}return Ke.json()})).apply(this,arguments)}function $e(ue){return ft.apply(this,arguments)}function ft(){return(ft=(0,f.Z)(function*(ue,U=re,M){const{appId:F,apiKey:J,measurementId:Ie}=ue.options;if(!F)throw te.create("no-app-id");if(!J){if(Ie)return{measurementId:Ie,appId:F};throw te.create("no-api-key")}const Ke=U.getThrottleMetadata(F)||{backoffCount:0,throttleEndTimeMillis:Date.now()},_e=new er;return setTimeout((0,f.Z)(function*(){_e.abort()}),void 0!==M?M:6e4),Gt({appId:F,apiKey:J,measurementId:Ie},Ke,_e,U)})).apply(this,arguments)}function Gt(ue,U,M){return xt.apply(this,arguments)}function xt(){return(xt=(0,f.Z)(function*(ue,{throttleEndTimeMillis:U,backoffCount:M},F,J=re){var Ie,Ke;const{appId:_e,measurementId:ze}=ue;try{yield Qe(F,U)}catch(ot){if(ze)return Ue.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${ze} provided in the "measurementId" field in the local Firebase config. [${null===(Ie=ot)||void 0===Ie?void 0:Ie.message}]`),{appId:_e,measurementId:ze};throw ot}try{const ot=yield ve(ue);return J.deleteThrottleMetadata(_e),ot}catch(ot){const Rt=ot;if(!cn(Rt)){if(J.deleteThrottleMetadata(_e),ze)return Ue.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${ze} provided in the "measurementId" field in the local Firebase config. [${Rt?.message}]`),{appId:_e,measurementId:ze};throw ot}const wn=503===Number(null===(Ke=Rt?.customData)||void 0===Ke?void 0:Ke.httpStatus)?(0,oe.$s)(M,J.intervalMillis,30):(0,oe.$s)(M,J.intervalMillis),pt={throttleEndTimeMillis:Date.now()+wn,backoffCount:M+1};return J.setThrottleMetadata(_e,pt),Ue.debug(`Calling attemptFetch again in ${wn} millis`),Gt(ue,pt,F,J)}})).apply(this,arguments)}function Qe(ue,U){return new Promise((M,F)=>{const J=Math.max(U-Date.now(),0),Ie=setTimeout(M,J);ue.addEventListener(()=>{clearTimeout(Ie),F(te.create("fetch-throttle",{throttleEndTimeMillis:U}))})})}function cn(ue){if(!(ue instanceof oe.ZR&&ue.customData))return!1;const U=Number(ue.customData.httpStatus);return 429===U||500===U||503===U||504===U}class er{constructor(){this.listeners=[]}addEventListener(U){this.listeners.push(U)}abort(){this.listeners.forEach(U=>U())}}let yn,$n;function Ft(){return(Ft=(0,f.Z)(function*(ue,U,M,F,J){if(J&&J.global)ue("event",M,F);else{const Ie=yield U;ue("event",M,Object.assign(Object.assign({},F),{send_to:Ie}))}})).apply(this,arguments)}function wr(ue){$n=ue}function ht(ue){yn=ue}function nr(){return nn.apply(this,arguments)}function nn(){return(nn=(0,f.Z)(function*(){var ue;if(!(0,oe.hl)())return Ue.warn(te.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,oe.eu)()}catch(U){return Ue.warn(te.create("indexeddb-unavailable",{errorInfo:null===(ue=U)||void 0===ue?void 0:ue.toString()}).message),!1}return!0})).apply(this,arguments)}function Bn(){return(Bn=(0,f.Z)(function*(ue,U,M,F,J,Ie,Ke){var _e;const ze=$e(ue);ze.then(dn=>{M[dn.measurementId]=dn.appId,ue.options.measurementId&&dn.measurementId!==ue.options.measurementId&&Ue.warn(`The measurement ID in the local Firebase config (${ue.options.measurementId}) does not match the measurement ID fetched from the server (${dn.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(dn=>Ue.error(dn)),U.push(ze);const ot=nr().then(dn=>{if(dn)return F.getId()}),[Rt,wn]=yield Promise.all([ze,ot]);Ae()||Oe(Ie,Rt.measurementId),$n&&(J("consent","default",$n),wr(void 0)),J("js",new Date);const pt=null!==(_e=Ke?.config)&&void 0!==_e?_e:{};return pt.origin="firebase",pt.update=!0,null!=wn&&(pt[fe]=wn),J("config",Rt.measurementId,pt),yn&&(J("set",yn),ht(void 0)),Rt.measurementId})).apply(this,arguments)}class pr{constructor(U){this.app=U}_delete(){return delete bn[this.app.options.appId],Promise.resolve()}}let bn={},Dn=[];const Kn={};let et,nt,gr="dataLayer",Pn=!1;function rr(ue,U,M){!function Dt(){const ue=[];if((0,oe.ru)()&&ue.push("This is a browser extension environment."),(0,oe.zI)()||ue.push("Cookies are not available."),ue.length>0){const U=ue.map((F,J)=>`(${J+1}) ${F}`).join(" "),M=te.create("invalid-analytics-context",{errorInfo:U});Ue.warn(M.message)}}();const F=ue.options.appId;if(!F)throw te.create("no-app-id");if(!ue.options.apiKey){if(!ue.options.measurementId)throw te.create("no-api-key");Ue.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${ue.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=bn[F])throw te.create("already-exists",{id:F});if(!Pn){!function We(ue){let U=[];Array.isArray(window[ue])?U=window[ue]:window[ue]=U}(gr);const{wrappedGtag:Ie,gtagCore:Ke}=function Pe(ue,U,M,F,J){let Ie=function(...Ke){window[F].push(arguments)};return window[J]&&"function"==typeof window[J]&&(Ie=window[J]),window[J]=function Ve(ue,U,M,F){function Ie(){return(Ie=(0,f.Z)(function*(Ke,_e,ze){try{"event"===Ke?yield rt(ue,U,M,_e,ze):"config"===Ke?yield ge(ue,U,M,F,_e,ze):"consent"===Ke?ue("consent","update",ze):ue("set",_e)}catch(ot){Ue.error(ot)}})).apply(this,arguments)}return function J(Ke,_e,ze){return Ie.apply(this,arguments)}}(Ie,ue,U,M),{gtagCore:Ie,wrappedGtag:window[J]}}(bn,Dn,Kn,gr,"gtag");nt=Ie,et=Ke,Pn=!0}return bn[F]=function rn(ue,U,M,F,J,Ie,Ke){return Bn.apply(this,arguments)}(ue,Dn,Kn,U,et,gr,M),new pr(ue)}function vn(ue=(0,B.getApp)()){ue=(0,oe.m9)(ue);const U=(0,B._getProvider)(ue,de);return U.isInitialized()?U.getImmediate():function gn(ue,U={}){const M=(0,B._getProvider)(ue,de);if(M.isInitialized()){const J=M.getImmediate();if((0,oe.vZ)(U,M.getOptions()))return J;throw te.create("already-initialized")}return M.initialize({options:U})}(ue)}function Jt(){return Ln.apply(this,arguments)}function Ln(){return(Ln=(0,f.Z)(function*(){if((0,oe.ru)()||!(0,oe.zI)()||!(0,oe.hl)())return!1;try{return yield(0,oe.eu)()}catch{return!1}})).apply(this,arguments)}function ke(ue,U,M,F){ue=(0,oe.m9)(ue),function Qt(ue,U,M,F,J){return Ft.apply(this,arguments)}(nt,bn[ue.app.options.appId],U,M,F).catch(J=>Ue.error(J))}const yt="@firebase/analytics";!function Xt(){(0,B._registerComponent)(new ye.wA(de,(U,{options:M})=>rr(U.getProvider("app").getImmediate(),U.getProvider("installations-internal").getImmediate(),M),"PUBLIC")),(0,B._registerComponent)(new ye.wA("analytics-internal",function ue(U){try{const M=U.getProvider(de).getImmediate();return{logEvent:(F,J,Ie)=>ke(M,F,J,Ie)}}catch(M){throw te.create("interop-component-reg-failed",{reason:M})}},"PRIVATE")),(0,B.registerVersion)(yt,"0.8.0"),(0,B.registerVersion)(yt,"0.8.0","esm2017")}()},5867:(mt,Fe,P)=>{P.d(Fe,{C6:()=>f.getApps,Mq:()=>f.getApp,ZF:()=>f.initializeApp});var f=P(9681);(0,f.registerVersion)("firebase","9.9.1","app")},127:(mt,Fe,P)=>{P.d(Fe,{Z:()=>f.Z});var f=P(3942);f.Z.registerVersion("firebase","9.9.1","app-compat")},5881:(mt,Fe,P)=>{P.r(Fe);var f=P(5861),B=P(3942),N=P(6457),oe=P(2090),de=(P(9681),P(1877),P(4859));function fe(){return window}function G(){return(G=(0,f.Z)(function*(U,M,F){var J;const{BuildInfo:Ie}=fe();(0,N.aq)(M.sessionId,"AuthEvent did not contain a session ID");const Ke=yield pe(M.sessionId),_e={};return(0,N.ar)()?_e.ibi=Ie.packageName:(0,N.as)()?_e.apn=Ie.packageName:(0,N.at)(U,"operation-not-supported-in-this-environment"),Ie.displayName&&(_e.appDisplayName=Ie.displayName),_e.sessionId=Ke,(0,N.au)(U,F,M.type,void 0,null!==(J=M.eventId)&&void 0!==J?J:void 0,_e)})).apply(this,arguments)}function Ue(){return(Ue=(0,f.Z)(function*(U){const{BuildInfo:M}=fe(),F={};(0,N.ar)()?F.iosBundleId=M.packageName:(0,N.as)()?F.androidPackageName=M.packageName:(0,N.at)(U,"operation-not-supported-in-this-environment"),yield(0,N.av)(U,F)})).apply(this,arguments)}function We(){return(We=(0,f.Z)(function*(U,M,F){const{cordova:J}=fe();let Ie=()=>{};try{yield new Promise((Ke,_e)=>{let ze=null;function ot(){var pt;Ke();const dn=null===(pt=J.plugins.browsertab)||void 0===pt?void 0:pt.close;"function"==typeof dn&&dn(),"function"==typeof F?.close&&F.close()}function Rt(){ze||(ze=window.setTimeout(()=>{_e((0,N.aw)(U,"redirect-cancelled-by-user"))},2e3))}function wn(){"visible"===document?.visibilityState&&Rt()}M.addPassiveListener(ot),document.addEventListener("resume",Rt,!1),(0,N.as)()&&document.addEventListener("visibilitychange",wn,!1),Ie=()=>{M.removePassiveListener(ot),document.removeEventListener("resume",Rt,!1),document.removeEventListener("visibilitychange",wn,!1),ze&&window.clearTimeout(ze)}})}finally{Ie()}})).apply(this,arguments)}function pe(U){return rt.apply(this,arguments)}function rt(){return(rt=(0,f.Z)(function*(U){const M=Ye(U),F=yield crypto.subtle.digest("SHA-256",M);return Array.from(new Uint8Array(F)).map(Ie=>Ie.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function Ye(U){if((0,N.aq)(/[0-9a-zA-Z]+/.test(U),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(U);const M=new ArrayBuffer(U.length),F=new Uint8Array(M);for(let J=0;J<U.length;J++)F[J]=U.charCodeAt(J);return F}class Pe extends N.aA{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(M=>{this.resolveInialized=M})}addPassiveListener(M){this.passiveListeners.add(M)}removePassiveListener(M){this.passiveListeners.delete(M)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(M){return this.resolveInialized(),this.passiveListeners.forEach(F=>F(M)),super.onEvent(M)}initialized(){var M=this;return(0,f.Z)(function*(){yield M.initPromise})()}}function te(U){return me.apply(this,arguments)}function me(){return(me=(0,f.Z)(function*(U){const M=yield re()._get(ae(U));return M&&(yield re()._remove(ae(U))),M})).apply(this,arguments)}function X(){const U=[],M="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let F=0;F<20;F++){const J=Math.floor(Math.random()*M.length);U.push(M.charAt(J))}return U.join("")}function re(){return(0,N.ay)(N.b)}function ae(U){return(0,N.az)("authEvent",U.config.apiKey,U.name)}function $e(U){if(!U?.includes("?"))return{};const[M,...F]=U.split("?");return(0,oe.zd)(F.join("?"))}function Qe(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,N.aw)("no-auth-event")}}function Ft(){var U;return(null===(U=self?.location)||void 0===U?void 0:U.protocol)||null}function tn(U=(0,oe.z$)()){return!("file:"!==Ft()&&"ionic:"!==Ft()&&"capacitor:"!==Ft()||!U.toLowerCase().match(/iphone|ipad|ipod|android/))}function fr(){try{const U=self.localStorage,M=N.aI();if(U)return U.setItem(M,"1"),U.removeItem(M),!function tr(U=(0,oe.z$)()){return function Fr(){return(0,oe.w1)()&&11===document?.documentMode}()||function Nn(U=(0,oe.z$)()){return/Edge\/\d+/.test(U)}(U)}()||(0,oe.hl)()}catch{return ur()&&(0,oe.hl)()}return!1}function ur(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function $n(){return(function Pt(){return"http:"===Ft()||"https:"===Ft()}()||(0,oe.ru)()||tn())&&!function Dr(){return(0,oe.b$)()||(0,oe.UG)()}()&&fr()&&!ur()}function wr(){return tn()&&typeof document<"u"}function nr(){return(nr=(0,f.Z)(function*(){return!!wr()&&new Promise(U=>{const M=setTimeout(()=>{U(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(M),U(!0)})})})).apply(this,arguments)}const rn={LOCAL:"local",NONE:"none",SESSION:"session"},Bn=N.ax,pr="persistence";function Dn(U){return Kn.apply(this,arguments)}function Kn(){return(Kn=(0,f.Z)(function*(U){yield U._initializationPromise;const M=Ut(),F=N.az(pr,U.config.apiKey,U.name);M&&M.setItem(F,U._getPersistence())})).apply(this,arguments)}function Ut(){var U;try{return(null===(U=function nn(){return typeof window<"u"?window:null}())||void 0===U?void 0:U.sessionStorage)||null}catch{return null}}const et=N.ax;class nt{constructor(){this.browserResolver=N.ay(N.k),this.cordovaResolver=N.ay(class Gt{constructor(){this._redirectPersistence=N.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=N.aB,this._overrideRedirectResult=N.aC}_initialize(M){var F=this;return(0,f.Z)(function*(){const J=M._key();let Ie=F.eventManagers.get(J);return Ie||(Ie=new Pe(M),F.eventManagers.set(J,Ie),F.attachCallbackListeners(M,Ie)),Ie})()}_openPopup(M){(0,N.at)(M,"operation-not-supported-in-this-environment")}_openRedirect(M,F,J,Ie){var Ke=this;return(0,f.Z)(function*(){!function ge(U){var M,F,J,Ie,Ke,_e,ze,ot,Rt,wn;const pt=fe();(0,N.ax)("function"==typeof(null===(M=pt?.universalLinks)||void 0===M?void 0:M.subscribe),U,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,N.ax)(typeof(null===(F=pt?.BuildInfo)||void 0===F?void 0:F.packageName)<"u",U,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,N.ax)("function"==typeof(null===(Ke=null===(Ie=null===(J=pt?.cordova)||void 0===J?void 0:J.plugins)||void 0===Ie?void 0:Ie.browsertab)||void 0===Ke?void 0:Ke.openUrl),U,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,N.ax)("function"==typeof(null===(ot=null===(ze=null===(_e=pt?.cordova)||void 0===_e?void 0:_e.plugins)||void 0===ze?void 0:ze.browsertab)||void 0===ot?void 0:ot.isAvailable),U,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,N.ax)("function"==typeof(null===(wn=null===(Rt=pt?.cordova)||void 0===Rt?void 0:Rt.InAppBrowser)||void 0===wn?void 0:wn.open),U,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(M);const _e=yield Ke._initialize(M);yield _e.initialized(),_e.resetRedirect(),(0,N.aD)(),yield Ke._originValidation(M);const ze=function Ae(U,M,F=null){return{type:M,eventId:F,urlResponse:null,sessionId:X(),postBody:null,tenantId:U.tenantId,error:(0,N.aw)(U,"no-auth-event")}}(M,J,Ie);yield function Je(U,M){return re()._set(ae(U),M)}(M,ze);const ot=yield function z(U,M,F){return G.apply(this,arguments)}(M,ze,F),Rt=yield function Te(U){const{cordova:M}=fe();return new Promise(F=>{M.plugins.browsertab.isAvailable(J=>{let Ie=null;J?M.plugins.browsertab.openUrl(U):Ie=M.InAppBrowser.open(U,(0,N.ap)()?"_blank":"_system","location=yes"),F(Ie)})})}(ot);return function Oe(U,M,F){return We.apply(this,arguments)}(M,_e,Rt)})()}_isIframeWebStorageSupported(M,F){throw new Error("Method not implemented.")}_originValidation(M){const F=M._key();return this.originValidationPromises[F]||(this.originValidationPromises[F]=function ne(U){return Ue.apply(this,arguments)}(M)),this.originValidationPromises[F]}attachCallbackListeners(M,F){const{universalLinks:J,handleOpenURL:Ie,BuildInfo:Ke}=fe(),_e=setTimeout((0,f.Z)(function*(){yield te(M),F.onEvent(Qe())}),500),ze=function(){var wn=(0,f.Z)(function*(pt){clearTimeout(_e);const dn=yield te(M);let En=null;dn&&pt?.url&&(En=function Re(U,M){var F,J;const Ie=function le(U){const M=$e(U),F=M.link?decodeURIComponent(M.link):void 0,J=$e(F).link,Ie=M.deep_link_id?decodeURIComponent(M.deep_link_id):void 0;return $e(Ie).link||Ie||J||F||U}(M);if(Ie.includes("/__/auth/callback")){const Ke=$e(Ie),_e=Ke.firebaseError?function ve(U){try{return JSON.parse(U)}catch{return null}}(decodeURIComponent(Ke.firebaseError)):null,ze=null===(J=null===(F=_e?.code)||void 0===F?void 0:F.split("auth/"))||void 0===J?void 0:J[1],ot=ze?(0,N.aw)(ze):null;return ot?{type:U.type,eventId:U.eventId,tenantId:U.tenantId,error:ot,urlResponse:null,sessionId:null,postBody:null}:{type:U.type,eventId:U.eventId,tenantId:U.tenantId,sessionId:U.sessionId,urlResponse:Ie,postBody:null}}return null}(dn,pt.url)),F.onEvent(En||Qe())});return function(dn){return wn.apply(this,arguments)}}();typeof J<"u"&&"function"==typeof J.subscribe&&J.subscribe(null,ze);const ot=Ie,Rt=`${Ke.packageName.toLowerCase()}://`;fe().handleOpenURL=function(){var wn=(0,f.Z)(function*(pt){if(pt.toLowerCase().startsWith(Rt)&&ze({url:pt}),"function"==typeof ot)try{ot(pt)}catch(dn){console.error(dn)}});return function(pt){return wn.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=N.a,this._completeRedirectFn=N.aB,this._overrideRedirectResult=N.aC}_initialize(M){var F=this;return(0,f.Z)(function*(){return yield F.selectUnderlyingResolver(),F.assertedUnderlyingResolver._initialize(M)})()}_openPopup(M,F,J,Ie){var Ke=this;return(0,f.Z)(function*(){return yield Ke.selectUnderlyingResolver(),Ke.assertedUnderlyingResolver._openPopup(M,F,J,Ie)})()}_openRedirect(M,F,J,Ie){var Ke=this;return(0,f.Z)(function*(){return yield Ke.selectUnderlyingResolver(),Ke.assertedUnderlyingResolver._openRedirect(M,F,J,Ie)})()}_isIframeWebStorageSupported(M,F){this.assertedUnderlyingResolver._isIframeWebStorageSupported(M,F)}_originValidation(M){return this.assertedUnderlyingResolver._originValidation(M)}get _shouldInitProactively(){return wr()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return et(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var M=this;return(0,f.Z)(function*(){if(M.underlyingResolver)return;const F=yield function ht(){return nr.apply(this,arguments)}();M.underlyingResolver=F?M.cordovaResolver:M.browserResolver})()}}function Pn(U){return U.unwrap()}function Dt(U){return vn(U)}function vn(U){const{_tokenResponse:M}=U instanceof oe.ZR?U.customData:U;if(!M)return null;if(!(U instanceof oe.ZR)&&"temporaryProof"in M&&"phoneNumber"in M)return N.P.credentialFromResult(U);const F=M.providerId;if(!F||F===N.o.PASSWORD)return null;let J;switch(F){case N.o.GOOGLE:J=N.Q;break;case N.o.FACEBOOK:J=N.N;break;case N.o.GITHUB:J=N.T;break;case N.o.TWITTER:J=N.W;break;default:const{oauthIdToken:Ie,oauthAccessToken:Ke,oauthTokenSecret:_e,pendingToken:ze,nonce:ot}=M;return Ke||_e||Ie||ze?ze?F.startsWith("saml.")?N.aL._create(F,ze):N.J._fromParams({providerId:F,signInMethod:F,pendingToken:ze,idToken:Ie,accessToken:Ke}):new N.U(F).credential({idToken:Ie,accessToken:Ke,rawNonce:ot}):null}return U instanceof oe.ZR?J.credentialFromError(U):J.credentialFromResult(U)}function gn(U,M){return M.catch(F=>{throw F instanceof oe.ZR&&function rr(U,M){var F,J;const Ie=null===(F=M.customData)||void 0===F?void 0:F._tokenResponse;if("auth/multi-factor-auth-required"===(null===(J=M)||void 0===J?void 0:J.code))M.resolver=new $(U,N.an(U,M));else if(Ie){const Ke=vn(M),_e=M;Ke&&(_e.credential=Ke,_e.tenantId=Ie.tenantId||void 0,_e.email=Ie.email||void 0,_e.phoneNumber=Ie.phoneNumber||void 0)}}(U,F),F}).then(F=>{const Ie=F.user;return{operationType:F.operationType,credential:Dt(F),additionalUserInfo:N.al(F),user:W.getOrCreate(Ie)}})}function Jt(U,M){return Ln.apply(this,arguments)}function Ln(){return(Ln=(0,f.Z)(function*(U,M){const F=yield M;return{verificationId:F.verificationId,confirm:J=>gn(U,F.confirm(J))}})).apply(this,arguments)}class ${constructor(M,F){this.resolver=F,this.auth=function lr(U){return U.wrapped()}(M)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(M){return gn(Pn(this.auth),this.resolver.resolveSignIn(M))}}class W{constructor(M){this._delegate=M,this.multiFactor=N.ao(M)}static getOrCreate(M){return W.USER_MAP.has(M)||W.USER_MAP.set(M,new W(M)),W.USER_MAP.get(M)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(M){return this._delegate.getIdTokenResult(M)}getIdToken(M){return this._delegate.getIdToken(M)}linkAndRetrieveDataWithCredential(M){return this.linkWithCredential(M)}linkWithCredential(M){var F=this;return(0,f.Z)(function*(){return gn(F.auth,N.Z(F._delegate,M))})()}linkWithPhoneNumber(M,F){var J=this;return(0,f.Z)(function*(){return Jt(J.auth,N.l(J._delegate,M,F))})()}linkWithPopup(M){var F=this;return(0,f.Z)(function*(){return gn(F.auth,N.d(F._delegate,M,nt))})()}linkWithRedirect(M){var F=this;return(0,f.Z)(function*(){return yield Dn(N.aE(F.auth)),N.g(F._delegate,M,nt)})()}reauthenticateAndRetrieveDataWithCredential(M){return this.reauthenticateWithCredential(M)}reauthenticateWithCredential(M){var F=this;return(0,f.Z)(function*(){return gn(F.auth,N._(F._delegate,M))})()}reauthenticateWithPhoneNumber(M,F){return Jt(this.auth,N.r(this._delegate,M,F))}reauthenticateWithPopup(M){return gn(this.auth,N.e(this._delegate,M,nt))}reauthenticateWithRedirect(M){var F=this;return(0,f.Z)(function*(){return yield Dn(N.aE(F.auth)),N.h(F._delegate,M,nt)})()}sendEmailVerification(M){return N.ab(this._delegate,M)}unlink(M){var F=this;return(0,f.Z)(function*(){return yield N.ak(F._delegate,M),F})()}updateEmail(M){return N.ag(this._delegate,M)}updatePassword(M){return N.ah(this._delegate,M)}updatePhoneNumber(M){return N.u(this._delegate,M)}updateProfile(M){return N.af(this._delegate,M)}verifyBeforeUpdateEmail(M,F){return N.ac(this._delegate,M,F)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}W.USER_MAP=new WeakMap;const H=N.ax;let q=(()=>{class U{constructor(F,J){if(this.app=F,J.isInitialized())return this._delegate=J.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:Ie}=F.options;H(Ie,"invalid-api-key",{appName:F.name}),H(Ie,"invalid-api-key",{appName:F.name});const Ke=typeof window<"u"?nt:void 0;this._delegate=J.initialize({options:{persistence:ke(Ie,F.name),popupRedirectResolver:Ke}}),this._delegate._updateErrorMap(N.B),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?W.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(F){this._delegate.languageCode=F}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(F){this._delegate.tenantId=F}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(F,J){N.G(this._delegate,F,J)}applyActionCode(F){return N.a2(this._delegate,F)}checkActionCode(F){return N.a3(this._delegate,F)}confirmPasswordReset(F,J){return N.a1(this._delegate,F,J)}createUserWithEmailAndPassword(F,J){var Ie=this;return(0,f.Z)(function*(){return gn(Ie._delegate,N.a5(Ie._delegate,F,J))})()}fetchProvidersForEmail(F){return this.fetchSignInMethodsForEmail(F)}fetchSignInMethodsForEmail(F){return N.aa(this._delegate,F)}isSignInWithEmailLink(F){return N.a8(this._delegate,F)}getRedirectResult(){var F=this;return(0,f.Z)(function*(){H($n(),F._delegate,"operation-not-supported-in-this-environment");const J=yield N.j(F._delegate,nt);return J?gn(F._delegate,Promise.resolve(J)):{credential:null,user:null}})()}addFrameworkForLogging(F){!function cn(U,M){(0,N.aE)(U)._logFramework(M)}(this._delegate,F)}onAuthStateChanged(F,J,Ie){const{next:Ke,error:_e,complete:ze}=K(F,J,Ie);return this._delegate.onAuthStateChanged(Ke,_e,ze)}onIdTokenChanged(F,J,Ie){const{next:Ke,error:_e,complete:ze}=K(F,J,Ie);return this._delegate.onIdTokenChanged(Ke,_e,ze)}sendSignInLinkToEmail(F,J){return N.a7(this._delegate,F,J)}sendPasswordResetEmail(F,J){return N.a0(this._delegate,F,J||void 0)}setPersistence(F){var J=this;return(0,f.Z)(function*(){let Ie;switch(function bn(U,M){Bn(Object.values(rn).includes(M),U,"invalid-persistence-type"),(0,oe.b$)()?Bn(M!==rn.SESSION,U,"unsupported-persistence-type"):(0,oe.UG)()?Bn(M===rn.NONE,U,"unsupported-persistence-type"):ur()?Bn(M===rn.NONE||M===rn.LOCAL&&(0,oe.hl)(),U,"unsupported-persistence-type"):Bn(M===rn.NONE||fr(),U,"unsupported-persistence-type")}(J._delegate,F),F){case rn.SESSION:Ie=N.a;break;case rn.LOCAL:Ie=(yield N.ay(N.i)._isAvailable())?N.i:N.b;break;case rn.NONE:Ie=N.L;break;default:return N.at("argument-error",{appName:J._delegate.name})}return J._delegate.setPersistence(Ie)})()}signInAndRetrieveDataWithCredential(F){return this.signInWithCredential(F)}signInAnonymously(){return gn(this._delegate,N.X(this._delegate))}signInWithCredential(F){return gn(this._delegate,N.Y(this._delegate,F))}signInWithCustomToken(F){return gn(this._delegate,N.$(this._delegate,F))}signInWithEmailAndPassword(F,J){return gn(this._delegate,N.a6(this._delegate,F,J))}signInWithEmailLink(F,J){return gn(this._delegate,N.a9(this._delegate,F,J))}signInWithPhoneNumber(F,J){return Jt(this._delegate,N.s(this._delegate,F,J))}signInWithPopup(F){var J=this;return(0,f.Z)(function*(){return H($n(),J._delegate,"operation-not-supported-in-this-environment"),gn(J._delegate,N.c(J._delegate,F,nt))})()}signInWithRedirect(F){var J=this;return(0,f.Z)(function*(){return H($n(),J._delegate,"operation-not-supported-in-this-environment"),yield Dn(J._delegate),N.f(J._delegate,F,nt)})()}updateCurrentUser(F){return this._delegate.updateCurrentUser(F)}verifyPasswordResetCode(F){return N.a4(this._delegate,F)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return U.Persistence=rn,U})();function K(U,M,F){let J=U;"function"!=typeof U&&({next:J,error:M,complete:F}=U);const Ie=J;return{next:_e=>Ie(_e&&W.getOrCreate(_e)),error:M,complete:F}}function ke(U,M){const F=function gr(U,M){const F=Ut();if(!F)return[];const J=N.az(pr,U,M);switch(F.getItem(J)){case rn.NONE:return[N.L];case rn.LOCAL:return[N.i,N.a];case rn.SESSION:return[N.a];default:return[]}}(U,M);if(typeof self<"u"&&!F.includes(N.i)&&F.push(N.i),typeof window<"u")for(const J of[N.b,N.a])F.includes(J)||F.push(J);return F.includes(N.L)||F.push(N.L),F}class Xe{constructor(){this.providerId="phone",this._delegate=new N.P(Pn(B.Z.auth()))}static credential(M,F){return N.P.credential(M,F)}verifyPhoneNumber(M,F){return this._delegate.verifyPhoneNumber(M,F)}unwrap(){return this._delegate}}Xe.PHONE_SIGN_IN_METHOD=N.P.PHONE_SIGN_IN_METHOD,Xe.PROVIDER_ID=N.P.PROVIDER_ID;const yt=N.ax;class Kt{constructor(M,F,J=B.Z.app()){var Ie;yt(null===(Ie=J.options)||void 0===Ie?void 0:Ie.apiKey,"invalid-api-key",{appName:J.name}),this._delegate=new N.R(M,F,J.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function ue(U){U.INTERNAL.registerComponent(new de.wA("auth-compat",M=>{const F=M.getProvider("app-compat").getImmediate(),J=M.getProvider("auth");return new q(F,J)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:N.A.EMAIL_SIGNIN,PASSWORD_RESET:N.A.PASSWORD_RESET,RECOVER_EMAIL:N.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:N.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:N.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:N.A.VERIFY_EMAIL}},EmailAuthProvider:N.M,FacebookAuthProvider:N.N,GithubAuthProvider:N.T,GoogleAuthProvider:N.Q,OAuthProvider:N.U,SAMLAuthProvider:N.V,PhoneAuthProvider:Xe,PhoneMultiFactorGenerator:N.m,RecaptchaVerifier:Kt,TwitterAuthProvider:N.W,Auth:q,AuthCredential:N.H,Error:oe.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),U.registerVersion("@firebase/auth-compat","0.2.18")}(B.Z)},8306:(mt,Fe,P)=>{P.d(Fe,{y:()=>z});var f=P(930),B=P(727),N=P(8822),oe=P(4671);var de=P(2416),fe=P(576),we=P(2806);let z=(()=>{class Te{constructor(We){We&&(this._subscribe=We)}lift(We){const ge=new Te;return ge.source=this,ge.operator=We,ge}subscribe(We,ge,pe){const rt=function Ue(Te){return Te&&Te instanceof f.Lv||function ne(Te){return Te&&(0,fe.m)(Te.next)&&(0,fe.m)(Te.error)&&(0,fe.m)(Te.complete)}(Te)&&(0,B.Nn)(Te)}(We)?We:new f.Hp(We,ge,pe);return(0,we.x)(()=>{const{operator:Ye,source:Ve}=this;rt.add(Ye?Ye.call(rt,Ve):Ve?this._subscribe(rt):this._trySubscribe(rt))}),rt}_trySubscribe(We){try{return this._subscribe(We)}catch(ge){We.error(ge)}}forEach(We,ge){return new(ge=G(ge))((pe,rt)=>{const Ye=new f.Hp({next:Ve=>{try{We(Ve)}catch(Pe){rt(Pe),Ye.unsubscribe()}},error:rt,complete:pe});this.subscribe(Ye)})}_subscribe(We){var ge;return null===(ge=this.source)||void 0===ge?void 0:ge.subscribe(We)}[N.L](){return this}pipe(...We){return function Ce(Te){return 0===Te.length?oe.y:1===Te.length?Te[0]:function(We){return Te.reduce((ge,pe)=>pe(ge),We)}}(We)(this)}toPromise(We){return new(We=G(We))((ge,pe)=>{let rt;this.subscribe(Ye=>rt=Ye,Ye=>pe(Ye),()=>ge(rt))})}}return Te.create=Oe=>new Te(Oe),Te})();function G(Te){var Oe;return null!==(Oe=Te??de.v.Promise)&&void 0!==Oe?Oe:Promise}},7579:(mt,Fe,P)=>{P.d(Fe,{x:()=>de});var f=P(8306),B=P(727);const oe=(0,P(3888).d)(we=>function(){we(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ye=P(8737),Ce=P(2806);let de=(()=>{class we extends f.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(G){const ne=new fe(this,this);return ne.operator=G,ne}_throwIfClosed(){if(this.closed)throw new oe}next(G){(0,Ce.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const ne of this.currentObservers)ne.next(G)}})}error(G){(0,Ce.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=G;const{observers:ne}=this;for(;ne.length;)ne.shift().error(G)}})}complete(){(0,Ce.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:G}=this;for(;G.length;)G.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var G;return(null===(G=this.observers)||void 0===G?void 0:G.length)>0}_trySubscribe(G){return this._throwIfClosed(),super._trySubscribe(G)}_subscribe(G){return this._throwIfClosed(),this._checkFinalizedStatuses(G),this._innerSubscribe(G)}_innerSubscribe(G){const{hasError:ne,isStopped:Ue,observers:Te}=this;return ne||Ue?B.Lc:(this.currentObservers=null,Te.push(G),new B.w0(()=>{this.currentObservers=null,(0,ye.P)(Te,G)}))}_checkFinalizedStatuses(G){const{hasError:ne,thrownError:Ue,isStopped:Te}=this;ne?G.error(Ue):Te&&G.complete()}asObservable(){const G=new f.y;return G.source=this,G}}return we.create=(z,G)=>new fe(z,G),we})();class fe extends de{constructor(z,G){super(),this.destination=z,this.source=G}next(z){var G,ne;null===(ne=null===(G=this.destination)||void 0===G?void 0:G.next)||void 0===ne||ne.call(G,z)}error(z){var G,ne;null===(ne=null===(G=this.destination)||void 0===G?void 0:G.error)||void 0===ne||ne.call(G,z)}complete(){var z,G;null===(G=null===(z=this.destination)||void 0===z?void 0:z.complete)||void 0===G||G.call(z)}_subscribe(z){var G,ne;return null!==(ne=null===(G=this.source)||void 0===G?void 0:G.subscribe(z))&&void 0!==ne?ne:B.Lc}}},930:(mt,Fe,P)=>{P.d(Fe,{Hp:()=>We,Lv:()=>ne});var f=P(576),B=P(727),N=P(2416),oe=P(7849),ye=P(5032);const Ce=we("C",void 0,void 0);function we(Ve,Pe,Ae){return{kind:Ve,value:Pe,error:Ae}}var z=P(3410),G=P(2806);class ne extends B.w0{constructor(Pe){super(),this.isStopped=!1,Pe?(this.destination=Pe,(0,B.Nn)(Pe)&&Pe.add(this)):this.destination=Ye}static create(Pe,Ae,Je){return new We(Pe,Ae,Je)}next(Pe){this.isStopped?rt(function fe(Ve){return we("N",Ve,void 0)}(Pe),this):this._next(Pe)}error(Pe){this.isStopped?rt(function de(Ve){return we("E",void 0,Ve)}(Pe),this):(this.isStopped=!0,this._error(Pe))}complete(){this.isStopped?rt(Ce,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Pe){this.destination.next(Pe)}_error(Pe){try{this.destination.error(Pe)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ue=Function.prototype.bind;function Te(Ve,Pe){return Ue.call(Ve,Pe)}class Oe{constructor(Pe){this.partialObserver=Pe}next(Pe){const{partialObserver:Ae}=this;if(Ae.next)try{Ae.next(Pe)}catch(Je){ge(Je)}}error(Pe){const{partialObserver:Ae}=this;if(Ae.error)try{Ae.error(Pe)}catch(Je){ge(Je)}else ge(Pe)}complete(){const{partialObserver:Pe}=this;if(Pe.complete)try{Pe.complete()}catch(Ae){ge(Ae)}}}class We extends ne{constructor(Pe,Ae,Je){let te;if(super(),(0,f.m)(Pe)||!Pe)te={next:Pe??void 0,error:Ae??void 0,complete:Je??void 0};else{let me;this&&N.v.useDeprecatedNextContext?(me=Object.create(Pe),me.unsubscribe=()=>this.unsubscribe(),te={next:Pe.next&&Te(Pe.next,me),error:Pe.error&&Te(Pe.error,me),complete:Pe.complete&&Te(Pe.complete,me)}):te=Pe}this.destination=new Oe(te)}}function ge(Ve){N.v.useDeprecatedSynchronousErrorHandling?(0,G.O)(Ve):(0,oe.h)(Ve)}function rt(Ve,Pe){const{onStoppedNotification:Ae}=N.v;Ae&&z.z.setTimeout(()=>Ae(Ve,Pe))}const Ye={closed:!0,next:ye.Z,error:function pe(Ve){throw Ve},complete:ye.Z}},727:(mt,Fe,P)=>{P.d(Fe,{Lc:()=>Ce,w0:()=>ye,Nn:()=>de});var f=P(576);const N=(0,P(3888).d)(we=>function(G){we(this),this.message=G?`${G.length} errors occurred during unsubscription:\n${G.map((ne,Ue)=>`${Ue+1}) ${ne.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=G});var oe=P(8737);class ye{constructor(z){this.initialTeardown=z,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let z;if(!this.closed){this.closed=!0;const{_parentage:G}=this;if(G)if(this._parentage=null,Array.isArray(G))for(const Te of G)Te.remove(this);else G.remove(this);const{initialTeardown:ne}=this;if((0,f.m)(ne))try{ne()}catch(Te){z=Te instanceof N?Te.errors:[Te]}const{_finalizers:Ue}=this;if(Ue){this._finalizers=null;for(const Te of Ue)try{fe(Te)}catch(Oe){z=z??[],Oe instanceof N?z=[...z,...Oe.errors]:z.push(Oe)}}if(z)throw new N(z)}}add(z){var G;if(z&&z!==this)if(this.closed)fe(z);else{if(z instanceof ye){if(z.closed||z._hasParent(this))return;z._addParent(this)}(this._finalizers=null!==(G=this._finalizers)&&void 0!==G?G:[]).push(z)}}_hasParent(z){const{_parentage:G}=this;return G===z||Array.isArray(G)&&G.includes(z)}_addParent(z){const{_parentage:G}=this;this._parentage=Array.isArray(G)?(G.push(z),G):G?[G,z]:z}_removeParent(z){const{_parentage:G}=this;G===z?this._parentage=null:Array.isArray(G)&&(0,oe.P)(G,z)}remove(z){const{_finalizers:G}=this;G&&(0,oe.P)(G,z),z instanceof ye&&z._removeParent(this)}}ye.EMPTY=(()=>{const we=new ye;return we.closed=!0,we})();const Ce=ye.EMPTY;function de(we){return we instanceof ye||we&&"closed"in we&&(0,f.m)(we.remove)&&(0,f.m)(we.add)&&(0,f.m)(we.unsubscribe)}function fe(we){(0,f.m)(we)?we():we.unsubscribe()}},2416:(mt,Fe,P)=>{P.d(Fe,{v:()=>f});const f={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(mt,Fe,P)=>{P.d(Fe,{E:()=>B});const B=new(P(8306).y)(ye=>ye.complete())},8996:(mt,Fe,P)=>{P.d(Fe,{D:()=>Pe});var f=P(8421),B=P(5363),N=P(9468),Ce=P(8306),fe=P(2202),we=P(576),z=P(9672);function ne(Ae,Je){if(!Ae)throw new Error("Iterable cannot be null");return new Ce.y(te=>{(0,z.f)(te,Je,()=>{const me=Ae[Symbol.asyncIterator]();(0,z.f)(te,Je,()=>{me.next().then(Re=>{Re.done?te.complete():te.next(Re.value)})},0,!0)})})}var Ue=P(3670),Te=P(8239),Oe=P(1144),We=P(6495),ge=P(2206),pe=P(4532),rt=P(3260);function Pe(Ae,Je){return Je?function Ve(Ae,Je){if(null!=Ae){if((0,Ue.c)(Ae))return function oe(Ae,Je){return(0,f.Xf)(Ae).pipe((0,N.R)(Je),(0,B.Q)(Je))}(Ae,Je);if((0,Oe.z)(Ae))return function de(Ae,Je){return new Ce.y(te=>{let me=0;return Je.schedule(function(){me===Ae.length?te.complete():(te.next(Ae[me++]),te.closed||this.schedule())})})}(Ae,Je);if((0,Te.t)(Ae))return function ye(Ae,Je){return(0,f.Xf)(Ae).pipe((0,N.R)(Je),(0,B.Q)(Je))}(Ae,Je);if((0,ge.D)(Ae))return ne(Ae,Je);if((0,We.T)(Ae))return function G(Ae,Je){return new Ce.y(te=>{let me;return(0,z.f)(te,Je,()=>{me=Ae[fe.h](),(0,z.f)(te,Je,()=>{let Re,X;try{({value:Re,done:X}=me.next())}catch(re){return void te.error(re)}X?te.complete():te.next(Re)},0,!0)}),()=>(0,we.m)(me?.return)&&me.return()})}(Ae,Je);if((0,rt.L)(Ae))return function Ye(Ae,Je){return ne((0,rt.Q)(Ae),Je)}(Ae,Je)}throw(0,pe.z)(Ae)}(Ae,Je):(0,f.Xf)(Ae)}},8421:(mt,Fe,P)=>{P.d(Fe,{Xf:()=>Ue});var f=P(655),B=P(1144),N=P(8239),oe=P(8306),ye=P(3670),Ce=P(2206),de=P(4532),fe=P(6495),we=P(3260),z=P(576),G=P(7849),ne=P(8822);function Ue(Ve){if(Ve instanceof oe.y)return Ve;if(null!=Ve){if((0,ye.c)(Ve))return function Te(Ve){return new oe.y(Pe=>{const Ae=Ve[ne.L]();if((0,z.m)(Ae.subscribe))return Ae.subscribe(Pe);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ve);if((0,B.z)(Ve))return function Oe(Ve){return new oe.y(Pe=>{for(let Ae=0;Ae<Ve.length&&!Pe.closed;Ae++)Pe.next(Ve[Ae]);Pe.complete()})}(Ve);if((0,N.t)(Ve))return function We(Ve){return new oe.y(Pe=>{Ve.then(Ae=>{Pe.closed||(Pe.next(Ae),Pe.complete())},Ae=>Pe.error(Ae)).then(null,G.h)})}(Ve);if((0,Ce.D)(Ve))return pe(Ve);if((0,fe.T)(Ve))return function ge(Ve){return new oe.y(Pe=>{for(const Ae of Ve)if(Pe.next(Ae),Pe.closed)return;Pe.complete()})}(Ve);if((0,we.L)(Ve))return function rt(Ve){return pe((0,we.Q)(Ve))}(Ve)}throw(0,de.z)(Ve)}function pe(Ve){return new oe.y(Pe=>{(function Ye(Ve,Pe){var Ae,Je,te,me;return(0,f.mG)(this,void 0,void 0,function*(){try{for(Ae=(0,f.KL)(Ve);!(Je=yield Ae.next()).done;)if(Pe.next(Je.value),Pe.closed)return}catch(Re){te={error:Re}}finally{try{Je&&!Je.done&&(me=Ae.return)&&(yield me.call(Ae))}finally{if(te)throw te.error}}Pe.complete()})})(Ve,Pe).catch(Ae=>Pe.error(Ae))})}},6451:(mt,Fe,P)=>{P.d(Fe,{T:()=>Ce});var f=P(8189),B=P(8421),N=P(515),oe=P(7669),ye=P(8996);function Ce(...de){const fe=(0,oe.yG)(de),we=(0,oe._6)(de,1/0),z=de;return z.length?1===z.length?(0,B.Xf)(z[0]):(0,f.J)(we)((0,ye.D)(z,fe)):N.E}},5403:(mt,Fe,P)=>{P.d(Fe,{x:()=>B});var f=P(930);function B(oe,ye,Ce,de,fe){return new N(oe,ye,Ce,de,fe)}class N extends f.Lv{constructor(ye,Ce,de,fe,we,z){super(ye),this.onFinalize=we,this.shouldUnsubscribe=z,this._next=Ce?function(G){try{Ce(G)}catch(ne){ye.error(ne)}}:super._next,this._error=fe?function(G){try{fe(G)}catch(ne){ye.error(ne)}finally{this.unsubscribe()}}:super._error,this._complete=de?function(){try{de()}catch(G){ye.error(G)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ye;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Ce}=this;super.unsubscribe(),!Ce&&(null===(ye=this.onFinalize)||void 0===ye||ye.call(this))}}}},4004:(mt,Fe,P)=>{P.d(Fe,{U:()=>N});var f=P(4482),B=P(5403);function N(oe,ye){return(0,f.e)((Ce,de)=>{let fe=0;Ce.subscribe((0,B.x)(de,we=>{de.next(oe.call(ye,we,fe++))}))})}},8189:(mt,Fe,P)=>{P.d(Fe,{J:()=>N});var f=P(5577),B=P(4671);function N(oe=1/0){return(0,f.z)(B.y,oe)}},5577:(mt,Fe,P)=>{P.d(Fe,{z:()=>fe});var f=P(4004),B=P(8421),N=P(4482),oe=P(9672),ye=P(5403),de=P(576);function fe(we,z,G=1/0){return(0,de.m)(z)?fe((ne,Ue)=>(0,f.U)((Te,Oe)=>z(ne,Te,Ue,Oe))((0,B.Xf)(we(ne,Ue))),G):("number"==typeof z&&(G=z),(0,N.e)((ne,Ue)=>function Ce(we,z,G,ne,Ue,Te,Oe,We){const ge=[];let pe=0,rt=0,Ye=!1;const Ve=()=>{Ye&&!ge.length&&!pe&&z.complete()},Pe=Je=>pe<ne?Ae(Je):ge.push(Je),Ae=Je=>{Te&&z.next(Je),pe++;let te=!1;(0,B.Xf)(G(Je,rt++)).subscribe((0,ye.x)(z,me=>{Ue?.(me),Te?Pe(me):z.next(me)},()=>{te=!0},void 0,()=>{if(te)try{for(pe--;ge.length&&pe<ne;){const me=ge.shift();Oe?(0,oe.f)(z,Oe,()=>Ae(me)):Ae(me)}Ve()}catch(me){z.error(me)}}))};return we.subscribe((0,ye.x)(z,Pe,()=>{Ye=!0,Ve()})),()=>{We?.()}}(ne,Ue,we,G)))}},5363:(mt,Fe,P)=>{P.d(Fe,{Q:()=>oe});var f=P(9672),B=P(4482),N=P(5403);function oe(ye,Ce=0){return(0,B.e)((de,fe)=>{de.subscribe((0,N.x)(fe,we=>(0,f.f)(fe,ye,()=>fe.next(we),Ce),()=>(0,f.f)(fe,ye,()=>fe.complete(),Ce),we=>(0,f.f)(fe,ye,()=>fe.error(we),Ce)))})}},3099:(mt,Fe,P)=>{P.d(Fe,{B:()=>ye});var f=P(8421),B=P(7579),N=P(930),oe=P(4482);function ye(de={}){const{connector:fe=(()=>new B.x),resetOnError:we=!0,resetOnComplete:z=!0,resetOnRefCountZero:G=!0}=de;return ne=>{let Ue,Te,Oe,We=0,ge=!1,pe=!1;const rt=()=>{Te?.unsubscribe(),Te=void 0},Ye=()=>{rt(),Ue=Oe=void 0,ge=pe=!1},Ve=()=>{const Pe=Ue;Ye(),Pe?.unsubscribe()};return(0,oe.e)((Pe,Ae)=>{We++,!pe&&!ge&&rt();const Je=Oe=Oe??fe();Ae.add(()=>{We--,0===We&&!pe&&!ge&&(Te=Ce(Ve,G))}),Je.subscribe(Ae),!Ue&&We>0&&(Ue=new N.Hp({next:te=>Je.next(te),error:te=>{pe=!0,rt(),Te=Ce(Ye,we,te),Je.error(te)},complete:()=>{ge=!0,rt(),Te=Ce(Ye,z),Je.complete()}}),(0,f.Xf)(Pe).subscribe(Ue))})(ne)}}function Ce(de,fe,...we){if(!0===fe)return void de();if(!1===fe)return;const z=new N.Hp({next:()=>{z.unsubscribe(),de()}});return fe(...we).subscribe(z)}},9468:(mt,Fe,P)=>{P.d(Fe,{R:()=>B});var f=P(4482);function B(N,oe=0){return(0,f.e)((ye,Ce)=>{Ce.add(N.schedule(()=>ye.subscribe(Ce),oe))})}},8505:(mt,Fe,P)=>{P.d(Fe,{b:()=>ye});var f=P(576),B=P(4482),N=P(5403),oe=P(4671);function ye(Ce,de,fe){const we=(0,f.m)(Ce)||de||fe?{next:Ce,error:de,complete:fe}:Ce;return we?(0,B.e)((z,G)=>{var ne;null===(ne=we.subscribe)||void 0===ne||ne.call(we);let Ue=!0;z.subscribe((0,N.x)(G,Te=>{var Oe;null===(Oe=we.next)||void 0===Oe||Oe.call(we,Te),G.next(Te)},()=>{var Te;Ue=!1,null===(Te=we.complete)||void 0===Te||Te.call(we),G.complete()},Te=>{var Oe;Ue=!1,null===(Oe=we.error)||void 0===Oe||Oe.call(we,Te),G.error(Te)},()=>{var Te,Oe;Ue&&(null===(Te=we.unsubscribe)||void 0===Te||Te.call(we)),null===(Oe=we.finalize)||void 0===Oe||Oe.call(we)}))}):oe.y}},4408:(mt,Fe,P)=>{P.d(Fe,{o:()=>ye});var f=P(727);class B extends f.w0{constructor(de,fe){super()}schedule(de,fe=0){return this}}const N={setInterval(Ce,de,...fe){const{delegate:we}=N;return we?.setInterval?we.setInterval(Ce,de,...fe):setInterval(Ce,de,...fe)},clearInterval(Ce){const{delegate:de}=N;return(de?.clearInterval||clearInterval)(Ce)},delegate:void 0};var oe=P(8737);class ye extends B{constructor(de,fe){super(de,fe),this.scheduler=de,this.work=fe,this.pending=!1}schedule(de,fe=0){if(this.closed)return this;this.state=de;const we=this.id,z=this.scheduler;return null!=we&&(this.id=this.recycleAsyncId(z,we,fe)),this.pending=!0,this.delay=fe,this.id=this.id||this.requestAsyncId(z,this.id,fe),this}requestAsyncId(de,fe,we=0){return N.setInterval(de.flush.bind(de,this),we)}recycleAsyncId(de,fe,we=0){if(null!=we&&this.delay===we&&!1===this.pending)return fe;N.clearInterval(fe)}execute(de,fe){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const we=this._execute(de,fe);if(we)return we;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(de,fe){let z,we=!1;try{this.work(de)}catch(G){we=!0,z=G||new Error("Scheduled action threw falsy error")}if(we)return this.unsubscribe(),z}unsubscribe(){if(!this.closed){const{id:de,scheduler:fe}=this,{actions:we}=fe;this.work=this.state=this.scheduler=null,this.pending=!1,(0,oe.P)(we,this),null!=de&&(this.id=this.recycleAsyncId(fe,de,null)),this.delay=null,super.unsubscribe()}}}},7565:(mt,Fe,P)=>{P.d(Fe,{v:()=>N});var f=P(6063);class B{constructor(ye,Ce=B.now){this.schedulerActionCtor=ye,this.now=Ce}schedule(ye,Ce=0,de){return new this.schedulerActionCtor(this,ye).schedule(de,Ce)}}B.now=f.l.now;class N extends B{constructor(ye,Ce=B.now){super(ye,Ce),this.actions=[],this._active=!1,this._scheduled=void 0}flush(ye){const{actions:Ce}=this;if(this._active)return void Ce.push(ye);let de;this._active=!0;do{if(de=ye.execute(ye.state,ye.delay))break}while(ye=Ce.shift());if(this._active=!1,de){for(;ye=Ce.shift();)ye.unsubscribe();throw de}}}},4986:(mt,Fe,P)=>{P.d(Fe,{z:()=>N});var f=P(4408);const N=new(P(7565).v)(f.o)},6063:(mt,Fe,P)=>{P.d(Fe,{l:()=>f});const f={now:()=>(f.delegate||Date).now(),delegate:void 0}},3410:(mt,Fe,P)=>{P.d(Fe,{z:()=>f});const f={setTimeout(B,N,...oe){const{delegate:ye}=f;return ye?.setTimeout?ye.setTimeout(B,N,...oe):setTimeout(B,N,...oe)},clearTimeout(B){const{delegate:N}=f;return(N?.clearTimeout||clearTimeout)(B)},delegate:void 0}},2202:(mt,Fe,P)=>{P.d(Fe,{h:()=>B});const B=function f(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(mt,Fe,P)=>{P.d(Fe,{L:()=>f});const f="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(mt,Fe,P)=>{P.d(Fe,{_6:()=>Ce,jO:()=>oe,yG:()=>ye});var f=P(576);function N(de){return de[de.length-1]}function oe(de){return(0,f.m)(N(de))?de.pop():void 0}function ye(de){return function B(de){return de&&(0,f.m)(de.schedule)}(N(de))?de.pop():void 0}function Ce(de,fe){return"number"==typeof N(de)?de.pop():fe}},8737:(mt,Fe,P)=>{function f(B,N){if(B){const oe=B.indexOf(N);0<=oe&&B.splice(oe,1)}}P.d(Fe,{P:()=>f})},3888:(mt,Fe,P)=>{function f(B){const oe=B(ye=>{Error.call(ye),ye.stack=(new Error).stack});return oe.prototype=Object.create(Error.prototype),oe.prototype.constructor=oe,oe}P.d(Fe,{d:()=>f})},2806:(mt,Fe,P)=>{P.d(Fe,{O:()=>oe,x:()=>N});var f=P(2416);let B=null;function N(ye){if(f.v.useDeprecatedSynchronousErrorHandling){const Ce=!B;if(Ce&&(B={errorThrown:!1,error:null}),ye(),Ce){const{errorThrown:de,error:fe}=B;if(B=null,de)throw fe}}else ye()}function oe(ye){f.v.useDeprecatedSynchronousErrorHandling&&B&&(B.errorThrown=!0,B.error=ye)}},9672:(mt,Fe,P)=>{function f(B,N,oe,ye=0,Ce=!1){const de=N.schedule(function(){oe(),Ce?B.add(this.schedule(null,ye)):this.unsubscribe()},ye);if(B.add(de),!Ce)return de}P.d(Fe,{f:()=>f})},4671:(mt,Fe,P)=>{function f(B){return B}P.d(Fe,{y:()=>f})},1144:(mt,Fe,P)=>{P.d(Fe,{z:()=>f});const f=B=>B&&"number"==typeof B.length&&"function"!=typeof B},2206:(mt,Fe,P)=>{P.d(Fe,{D:()=>B});var f=P(576);function B(N){return Symbol.asyncIterator&&(0,f.m)(N?.[Symbol.asyncIterator])}},576:(mt,Fe,P)=>{function f(B){return"function"==typeof B}P.d(Fe,{m:()=>f})},3670:(mt,Fe,P)=>{P.d(Fe,{c:()=>N});var f=P(8822),B=P(576);function N(oe){return(0,B.m)(oe[f.L])}},6495:(mt,Fe,P)=>{P.d(Fe,{T:()=>N});var f=P(2202),B=P(576);function N(oe){return(0,B.m)(oe?.[f.h])}},8239:(mt,Fe,P)=>{P.d(Fe,{t:()=>B});var f=P(576);function B(N){return(0,f.m)(N?.then)}},3260:(mt,Fe,P)=>{P.d(Fe,{L:()=>oe,Q:()=>N});var f=P(655),B=P(576);function N(ye){return(0,f.FC)(this,arguments,function*(){const de=ye.getReader();try{for(;;){const{value:fe,done:we}=yield(0,f.qq)(de.read());if(we)return yield(0,f.qq)(void 0);yield yield(0,f.qq)(fe)}}finally{de.releaseLock()}})}function oe(ye){return(0,B.m)(ye?.getReader)}},4482:(mt,Fe,P)=>{P.d(Fe,{A:()=>B,e:()=>N});var f=P(576);function B(oe){return(0,f.m)(oe?.lift)}function N(oe){return ye=>{if(B(ye))return ye.lift(function(Ce){try{return oe(Ce,this)}catch(de){this.error(de)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(mt,Fe,P)=>{function f(){}P.d(Fe,{Z:()=>f})},7849:(mt,Fe,P)=>{P.d(Fe,{h:()=>N});var f=P(2416),B=P(3410);function N(oe){B.z.setTimeout(()=>{const{onUnhandledError:ye}=f.v;if(!ye)throw oe;ye(oe)})}},4532:(mt,Fe,P)=>{function f(B){return new TypeError(`You provided ${null!==B&&"object"==typeof B?"an invalid object":`'${B}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}P.d(Fe,{z:()=>f})},655:(mt,Fe,P)=>{function oe(X,re){var ae={};for(var ve in X)Object.prototype.hasOwnProperty.call(X,ve)&&re.indexOf(ve)<0&&(ae[ve]=X[ve]);if(null!=X&&"function"==typeof Object.getOwnPropertySymbols){var le=0;for(ve=Object.getOwnPropertySymbols(X);le<ve.length;le++)re.indexOf(ve[le])<0&&Object.prototype.propertyIsEnumerable.call(X,ve[le])&&(ae[ve[le]]=X[ve[le]])}return ae}function fe(X,re,ae,ve){return new(ae||(ae=Promise))(function($e,ft){function Gt(cn){try{Qe(ve.next(cn))}catch(er){ft(er)}}function xt(cn){try{Qe(ve.throw(cn))}catch(er){ft(er)}}function Qe(cn){cn.done?$e(cn.value):function le($e){return $e instanceof ae?$e:new ae(function(ft){ft($e)})}(cn.value).then(Gt,xt)}Qe((ve=ve.apply(X,re||[])).next())})}function ge(X){return this instanceof ge?(this.v=X,this):new ge(X)}function pe(X,re,ae){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var le,ve=ae.apply(X,re||[]),$e=[];return le={},ft("next"),ft("throw"),ft("return"),le[Symbol.asyncIterator]=function(){return this},le;function ft(yn){ve[yn]&&(le[yn]=function(Qt){return new Promise(function(Ft,Pt){$e.push([yn,Qt,Ft,Pt])>1||Gt(yn,Qt)})})}function Gt(yn,Qt){try{!function xt(yn){yn.value instanceof ge?Promise.resolve(yn.value.v).then(Qe,cn):er($e[0][2],yn)}(ve[yn](Qt))}catch(Ft){er($e[0][3],Ft)}}function Qe(yn){Gt("next",yn)}function cn(yn){Gt("throw",yn)}function er(yn,Qt){yn(Qt),$e.shift(),$e.length&&Gt($e[0][0],$e[0][1])}}function Ye(X){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ae,re=X[Symbol.asyncIterator];return re?re.call(X):(X=function ne(X){var re="function"==typeof Symbol&&Symbol.iterator,ae=re&&X[re],ve=0;if(ae)return ae.call(X);if(X&&"number"==typeof X.length)return{next:function(){return X&&ve>=X.length&&(X=void 0),{value:X&&X[ve++],done:!X}}};throw new TypeError(re?"Object is not iterable.":"Symbol.iterator is not defined.")}(X),ae={},ve("next"),ve("throw"),ve("return"),ae[Symbol.asyncIterator]=function(){return this},ae);function ve($e){ae[$e]=X[$e]&&function(ft){return new Promise(function(Gt,xt){!function le($e,ft,Gt,xt){Promise.resolve(xt).then(function(Qe){$e({value:Qe,done:Gt})},ft)}(Gt,xt,(ft=X[$e](ft)).done,ft.value)})}}}P.d(Fe,{FC:()=>pe,KL:()=>Ye,_T:()=>oe,mG:()=>fe,qq:()=>ge})},4650:(mt,Fe,P)=>{P.d(Fe,{$8M:()=>Xd,$Z:()=>eI,AFp:()=>Vm,AaK:()=>fe,CHM:()=>Sn,CRH:()=>pb,CZH:()=>Nl,CqO:()=>PI,D6c:()=>Tx,EJc:()=>kw,EpF:()=>im,F4k:()=>NI,FYo:()=>nw,FiY:()=>Qa,G48:()=>jb,GfV:()=>iw,Gpc:()=>G,JOm:()=>ro,KtG:()=>kt,LFG:()=>Qn,LSH:()=>Ih,Lbi:()=>Ab,MAs:()=>tm,MMx:()=>lw,NdJ:()=>sf,OlP:()=>On,PXZ:()=>Vb,Q6J:()=>nf,QGY:()=>Av,QP$:()=>od,Qsj:()=>vf,R0b:()=>Qi,RDi:()=>gy,Rgc:()=>Rl,SBq:()=>Al,Sil:()=>jm,Suo:()=>yw,TTD:()=>Ss,TgZ:()=>jc,X6Q:()=>Bb,XFs:()=>ht,Xpm:()=>H,Xts:()=>Gy,Y36:()=>xc,YKP:()=>LC,YNc:()=>bv,Yjl:()=>U,Yz7:()=>Qt,ZZ4:()=>e0,_Bn:()=>kC,_UZ:()=>Tv,_Vd:()=>Iu,_c5:()=>Qb,_uU:()=>Fv,aQg:()=>r_,c2e:()=>Pw,cJS:()=>Pt,cg1:()=>Gv,dDg:()=>$m,deG:()=>Up,dqk:()=>et,eFA:()=>Ww,ekj:()=>cf,eoX:()=>Fb,f3M:()=>No,g9A:()=>Nw,h0i:()=>Cu,hGG:()=>n0,hM9:()=>OA,hij:()=>ii,iGM:()=>fb,ifc:()=>Ut,ip1:()=>Tf,kL8:()=>pC,lG2:()=>ue,lqb:()=>us,lri:()=>Hw,n5z:()=>Fp,oAB:()=>yt,oxw:()=>Gc,q4F:()=>jC,qLn:()=>Ch,qOj:()=>Go,qZA:()=>rf,rWj:()=>$w,sBO:()=>Jm,sIi:()=>Os,s_b:()=>id,soG:()=>Bm,tb:()=>xb,tp0:()=>Qs,uIk:()=>Lc,vHH:()=>Oe,vpe:()=>_s,wAp:()=>At,xp6:()=>$E,z2F:()=>Rf,zSh:()=>Sg,zs3:()=>Lo});var f=P(7579),B=P(727),N=P(8306),oe=P(6451),ye=P(3099);function Ce(s){for(let o in s)if(s[o]===Ce)return o;throw Error("Could not find renamed property on target object.")}function de(s,o){for(const u in o)o.hasOwnProperty(u)&&!s.hasOwnProperty(u)&&(s[u]=o[u])}function fe(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(fe).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function we(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const z=Ce({__forward_ref__:Ce});function G(s){return s.__forward_ref__=G,s.toString=function(){return fe(this())},s}function ne(s){return Ue(s)?s():s}function Ue(s){return"function"==typeof s&&s.hasOwnProperty(z)&&s.__forward_ref__===G}class Oe extends Error{constructor(o,u){super(function We(s,o){return`NG0${Math.abs(s)}${o?": "+o.trim():""}`}(o,u)),this.code=o}}function ge(s){return"string"==typeof s?s:null==s?"":String(s)}function Pe(s,o){throw new Oe(-201,!1)}function xt(s,o){null==s&&function Qe(s,o,u,c){throw new Error(`ASSERTION ERROR: ${s}`+(null==c?"":` [Expected=> ${u} ${c} ${o} <=Actual]`))}(o,s,null,"!=")}function Qt(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function Pt(s){return{providers:s.providers||[],imports:s.imports||[]}}function tn(s){return Dr(s,fr)||Dr(s,$n)}function Dr(s,o){return s.hasOwnProperty(o)?s[o]:null}function tr(s){return s&&(s.hasOwnProperty(ur)||s.hasOwnProperty(wr))?s[ur]:null}const fr=Ce({\u0275prov:Ce}),ur=Ce({\u0275inj:Ce}),$n=Ce({ngInjectableDef:Ce}),wr=Ce({ngInjectorDef:Ce});var ht=(()=>((ht=ht||{})[ht.Default=0]="Default",ht[ht.Host=1]="Host",ht[ht.Self=2]="Self",ht[ht.SkipSelf=4]="SkipSelf",ht[ht.Optional=8]="Optional",ht))();let nr;function rn(s){const o=nr;return nr=s,o}function Bn(s,o,u){const c=tn(s);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:u&ht.Optional?null:void 0!==o?o:void Pe(fe(s))}function bn(s){return{toString:s}.toString()}var Dn=(()=>((Dn=Dn||{})[Dn.OnPush=0]="OnPush",Dn[Dn.Default=1]="Default",Dn))(),Ut=(()=>{return(s=Ut||(Ut={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",Ut;var s})();const et=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),lr={},Dt=[],rr=Ce({\u0275cmp:Ce}),vn=Ce({\u0275dir:Ce}),gn=Ce({\u0275pipe:Ce}),Jt=Ce({\u0275mod:Ce}),Ln=Ce({\u0275fac:Ce}),$=Ce({__NG_ELEMENT_ID__:Ce});let W=0;function H(s){return bn(()=>{const u=!0===s.standalone,c={},d={type:s.type,providersResolver:null,decls:s.decls,vars:s.vars,factory:null,template:s.template||null,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:c,inputs:null,outputs:null,exportAs:s.exportAs||null,onPush:s.changeDetection===Dn.OnPush,directiveDefs:null,pipeDefs:null,standalone:u,dependencies:u&&s.dependencies||null,getStandaloneInjector:null,selectors:s.selectors||Dt,viewQuery:s.viewQuery||null,features:s.features||null,data:s.data||{},encapsulation:s.encapsulation||Ut.Emulated,id:"c"+W++,styles:s.styles||Dt,_:null,setInput:null,schemas:s.schemas||null,tView:null},p=s.dependencies,y=s.features;return d.inputs=Xt(s.inputs,c),d.outputs=Xt(s.outputs),y&&y.forEach(E=>E(d)),d.directiveDefs=p?()=>("function"==typeof p?p():p).map(K).filter(ke):null,d.pipeDefs=p?()=>("function"==typeof p?p():p).map(J).filter(ke):null,d})}function K(s){return M(s)||F(s)}function ke(s){return null!==s}const Xe={};function yt(s){return bn(()=>{const o={type:s.type,bootstrap:s.bootstrap||Dt,declarations:s.declarations||Dt,imports:s.imports||Dt,exports:s.exports||Dt,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null};return null!=s.id&&(Xe[s.id]=s.type),o})}function Xt(s,o){if(null==s)return lr;const u={};for(const c in s)if(s.hasOwnProperty(c)){let d=s[c],p=d;Array.isArray(d)&&(p=d[1],d=d[0]),u[d]=c,o&&(o[d]=p)}return u}const ue=H;function U(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,standalone:!0===s.standalone,onDestroy:s.type.prototype.ngOnDestroy||null}}function M(s){return s[rr]||null}function F(s){return s[vn]||null}function J(s){return s[gn]||null}function Ie(s,o){const u=s[Jt]||null;if(!u&&!0===o)throw new Error(`Type ${fe(s)} does not have '\u0275mod' property.`);return u}function Er(s){return Array.isArray(s)&&"object"==typeof s[1]}function Yr(s){return Array.isArray(s)&&!0===s[1]}function yo(s){return 0!=(8&s.flags)}function ts(s){return 2==(2&s.flags)}function Ts(s){return 1==(1&s.flags)}function Qr(s){return null!==s.template}function ju(s){return 0!=(256&s[2])}function is(s,o){return s.hasOwnProperty(Ln)?s[Ln]:null}class ss{constructor(o,u,c){this.previousValue=o,this.currentValue=u,this.firstChange=c}isFirstChange(){return this.firstChange}}function Ss(){return vo}function vo(s){return s.type.prototype.ngOnChanges&&(s.setInput=Ql),jd}function jd(){const s=Va(this),o=s?.current;if(o){const u=s.previous;if(u===lr)s.previous=o;else for(let c in o)u[c]=o[c];s.current=null,this.ngOnChanges(o)}}function Ql(s,o,u,c){const d=Va(s)||function As(s,o){return s[La]=o}(s,{previous:lr,current:null}),p=d.current||(d.current={}),y=d.previous,E=this.declaredInputs[u],C=y[E];p[E]=new ss(C&&C.currentValue,o,y===lr),s[c]=o}Ss.ngInherit=!0;const La="__ngSimpleChanges__";function Va(s){return s[La]||null}function ir(s){for(;Array.isArray(s);)s=s[0];return s}function Hi(s,o){return ir(o[s])}function Jr(s,o){return ir(o[s.index])}function na(s,o){return s.data[o]}function Sr(s,o){const u=o[s];return Er(u)?u:u[0]}function $i(s){return 4==(4&s[2])}function Io(s){return 64==(64&s[2])}function Gi(s,o){return null==o?null:s[o]}function Hs(s){s[18]=0}function bo(s,o){s[5]+=o;let u=s,c=s[3];for(;null!==c&&(1===o&&1===u[5]||-1===o&&0===u[5]);)c[5]+=o,u=c,c=c[3]}const Mt={lFrame:Dp(null),bindingsEnabled:!0};function tt(){return Mt.bindingsEnabled}function be(){return Mt.lFrame.lView}function St(){return Mt.lFrame.tView}function Sn(s){return Mt.lFrame.contextLView=s,s[8]}function kt(s){return Mt.lFrame.contextLView=null,s}function In(){let s=Do();for(;null!==s&&64===s.type;)s=s.parent;return s}function Do(){return Mt.lFrame.currentTNode}function Ur(s,o){const u=Mt.lFrame;u.currentTNode=s,u.isParent=o}function zi(){return Mt.lFrame.isParent}function zs(){return Mt.lFrame.bindingIndex++}function Ip(s,o){const u=Mt.lFrame;u.bindingIndex=u.bindingRootIndex=s,Gd(o)}function Gd(s){Mt.lFrame.currentDirectiveIndex=s}function Cp(){return Mt.lFrame.currentQueryIndex}function Gu(s){Mt.lFrame.currentQueryIndex=s}function Y_(s){const o=s[1];return 2===o.type?o.declTNode:1===o.type?s[6]:null}function $a(s,o,u){if(u&ht.SkipSelf){let d=o,p=s;for(;!(d=d.parent,null!==d||u&ht.Host||(d=Y_(p),null===d||(p=p[15],10&d.type))););if(null===d)return!1;o=d,s=p}const c=Mt.lFrame=Wd();return c.currentTNode=o,c.lView=s,!0}function bp(s){const o=Wd(),u=s[1];Mt.lFrame=o,o.currentTNode=u.firstChild,o.lView=s,o.tView=u,o.contextLView=s,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function Wd(){const s=Mt.lFrame,o=null===s?null:s.child;return null===o?Dp(s):o}function Dp(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function Xl(){const s=Mt.lFrame;return Mt.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const Tp=Xl;function ec(){const s=Xl();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function Br(){return Mt.lFrame.selectedIndex}function fi(s){Mt.lFrame.selectedIndex=s}function Zn(){const s=Mt.lFrame;return na(s.tView,s.selectedIndex)}function zd(s,o){for(let u=o.directiveStart,c=o.directiveEnd;u<c;u++){const p=s.data[u].type.prototype,{ngAfterContentInit:y,ngAfterContentChecked:E,ngAfterViewInit:C,ngAfterViewChecked:T,ngOnDestroy:A}=p;y&&(s.contentHooks||(s.contentHooks=[])).push(-u,y),E&&((s.contentHooks||(s.contentHooks=[])).push(u,E),(s.contentCheckHooks||(s.contentCheckHooks=[])).push(u,E)),C&&(s.viewHooks||(s.viewHooks=[])).push(-u,C),T&&((s.viewHooks||(s.viewHooks=[])).push(u,T),(s.viewCheckHooks||(s.viewCheckHooks=[])).push(u,T)),null!=A&&(s.destroyHooks||(s.destroyHooks=[])).push(u,A)}}function xp(s,o,u){So(s,o,3,u)}function Rp(s,o,u,c){(3&s[2])===u&&So(s,o,u,c)}function qd(s,o){let u=s[2];(3&u)===o&&(u&=2047,u+=1,s[2]=u)}function So(s,o,u,c){const p=c??-1,y=o.length-1;let E=0;for(let C=void 0!==c?65535&s[18]:0;C<y;C++)if("number"==typeof o[C+1]){if(E=o[C],null!=c&&E>=c)break}else o[C]<0&&(s[18]+=65536),(E<p||-1==p)&&(fE(s,u,o,C),s[18]=(4294901760&s[18])+C+2),C++}function fE(s,o,u,c){const d=u[c]<0,p=u[c+1],E=s[d?-u[c]:u[c]];if(d){if(s[2]>>11<s[18]>>16&&(3&s[2])===o){s[2]+=2048;try{p.call(E)}finally{}}}else try{p.call(E)}finally{}}class Ks{constructor(o,u,c){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=c}}function Kd(s,o,u){let c=0;for(;c<u.length;){const d=u[c];if("number"==typeof d){if(0!==d)break;c++;const p=u[c++],y=u[c++],E=u[c++];s.setAttribute(o,y,E,p)}else{const p=d,y=u[++c];Zd(p)?s.setProperty(o,p,y):s.setAttribute(o,p,y),c++}}return c}function rc(s){return 3===s||4===s||6===s}function Zd(s){return 64===s.charCodeAt(0)}function Yd(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let u=-1;for(let c=0;c<o.length;c++){const d=o[c];"number"==typeof d?u=d:0===u||ty(s,u,d,null,-1===u||2===u?o[++c]:null)}}return s}function ty(s,o,u,c,d){let p=0,y=s.length;if(-1===o)y=-1;else for(;p<s.length;){const E=s[p++];if("number"==typeof E){if(E===o){y=-1;break}if(E>o){y=p-1;break}}}for(;p<s.length;){const E=s[p];if("number"==typeof E)break;if(E===u){if(null===c)return void(null!==d&&(s[p+1]=d));if(c===s[p+1])return void(s[p+2]=d)}p++,null!==c&&p++,null!==d&&p++}-1!==y&&(s.splice(y,0,o),p=y+1),s.splice(p++,0,u),null!==c&&s.splice(p++,0,c),null!==d&&s.splice(p++,0,d)}function ny(s){return-1!==s}function ic(s){return 32767&s}function sc(s,o){let u=function ry(s){return s>>16}(s),c=o;for(;u>0;)c=c[15],u--;return c}let oc=!0;function Qd(s){const o=oc;return oc=s,o}let Mn=0;const xs={};function zu(s,o){const u=ac(s,o);if(-1!==u)return u;const c=o[1];c.firstCreatePass&&(s.injectorIndex=o.length,qu(c.data,s),qu(o,null),qu(c.blueprint,null));const d=uc(s,o),p=s.injectorIndex;if(ny(d)){const y=ic(d),E=sc(d,o),C=E[1].data;for(let T=0;T<8;T++)o[p+T]=E[y+T]|C[y+T]}return o[p+8]=d,p}function qu(s,o){s.push(0,0,0,0,0,0,0,0,o)}function ac(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function uc(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let u=0,c=null,d=o;for(;null!==d;){if(c=cc(d),null===c)return-1;if(u++,d=d[15],-1!==c.injectorIndex)return c.injectorIndex|u<<16}return-1}function Zs(s,o,u){!function Jd(s,o,u){let c;"string"==typeof u?c=u.charCodeAt(0)||0:u.hasOwnProperty($)&&(c=u[$]),null==c&&(c=u[$]=Mn++);const d=255&c;o.data[s+(d>>5)]|=1<<d}(s,o,u)}function Yn(s,o,u){if(u&ht.Optional)return s;Pe()}function Ot(s,o,u,c){if(u&ht.Optional&&void 0===c&&(c=null),0==(u&(ht.Self|ht.Host))){const d=s[9],p=rn(void 0);try{return d?d.get(o,c,u&ht.Optional):Bn(o,c,u&ht.Optional)}finally{rn(p)}}return Yn(c,0,u)}function Ga(s,o,u,c=ht.Default,d){if(null!==s){if(1024&o[2]){const y=function Vp(s,o,u,c,d){let p=s,y=o;for(;null!==p&&null!==y&&1024&y[2]&&!(256&y[2]);){const E=Ku(p,y,u,c|ht.Self,xs);if(E!==xs)return E;let C=p.parent;if(!C){const T=y[21];if(T){const A=T.get(u,xs,c);if(A!==xs)return A}C=cc(y),y=y[15]}p=C}return d}(s,o,u,c,xs);if(y!==xs)return y}const p=Ku(s,o,u,c,xs);if(p!==xs)return p}return Ot(o,u,c,d)}function Ku(s,o,u,c,d){const p=function lc(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty($)?s[$]:void 0;return"number"==typeof o?o>=0?255&o:Op:o}(u);if("function"==typeof p){if(!$a(o,s,c))return c&ht.Host?Yn(d,0,c):Ot(o,u,c,d);try{const y=p(c);if(null!=y||c&ht.Optional)return y;Pe()}finally{Tp()}}else if("number"==typeof p){let y=null,E=ac(s,o),C=-1,T=c&ht.Host?o[16][6]:null;for((-1===E||c&ht.SkipSelf)&&(C=-1===E?uc(s,o):o[E+8],-1!==C&&Di(c,!1)?(y=o[1],E=ic(C),o=sc(C,o)):E=-1);-1!==E;){const A=o[1];if(xo(p,E,A.data)){const V=kp(E,o,u,y,c,T);if(V!==xs)return V}C=o[E+8],-1!==C&&Di(c,o[1].data[E+8]===T)&&xo(p,E,o)?(y=A,E=ic(C),o=sc(C,o)):E=-1}}return d}function kp(s,o,u,c,d,p){const y=o[1],E=y.data[s+8],A=sa(E,y,u,null==c?ts(E)&&oc:c!=y&&0!=(3&E.type),d&ht.Host&&p===E);return null!==A?Wa(o,y,A,E):xs}function sa(s,o,u,c,d){const p=s.providerIndexes,y=o.data,E=1048575&p,C=s.directiveStart,A=p>>20,Z=d?E+A:s.directiveEnd;for(let se=c?E:E+A;se<Z;se++){const Me=y[se];if(se<C&&u===Me||se>=C&&Me.type===u)return se}if(d){const se=y[C];if(se&&Qr(se)&&se.type===u)return C}return null}function Wa(s,o,u,c){let d=s[u];const p=o.data;if(function Ao(s){return s instanceof Ks}(d)){const y=d;y.resolving&&function rt(s,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new Oe(-200,`Circular dependency in DI detected for ${s}${u}`)}(function pe(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():ge(s)}(p[u]));const E=Qd(y.canSeeViewProviders);y.resolving=!0;const C=y.injectImpl?rn(y.injectImpl):null;$a(s,c,ht.Default);try{d=s[u]=y.factory(void 0,p,s,c),o.firstCreatePass&&u>=c.directiveStart&&function hE(s,o,u){const{ngOnChanges:c,ngOnInit:d,ngDoCheck:p}=o.type.prototype;if(c){const y=vo(o);(u.preOrderHooks||(u.preOrderHooks=[])).push(s,y),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,y)}d&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-s,d),p&&((u.preOrderHooks||(u.preOrderHooks=[])).push(s,p),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,p))}(u,p[u],o)}finally{null!==C&&rn(C),Qd(E),y.resolving=!1,Tp()}}return d}function xo(s,o,u){return!!(u[o+(s>>5)]&1<<s)}function Di(s,o){return!(s&ht.Self||s&ht.Host&&o)}class oa{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,c){return Ga(this._tNode,this._lView,o,c,u)}}function Op(){return new oa(In(),be())}function Fp(s){return bn(()=>{const o=s.prototype.constructor,u=o[Ln]||Lp(o),c=Object.prototype;let d=Object.getPrototypeOf(s.prototype).constructor;for(;d&&d!==c;){const p=d[Ln]||Lp(d);if(p&&p!==u)return p;d=Object.getPrototypeOf(d)}return p=>new p})}function Lp(s){return Ue(s)?()=>{const o=Lp(ne(s));return o&&o()}:is(s)}function cc(s){const o=s[1],u=o.type;return 2===u?o.declTNode:1===u?s[6]:null}function Xd(s){return function ia(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const u=s.attrs;if(u){const c=u.length;let d=0;for(;d<c;){const p=u[d];if(rc(p))break;if(0===p)d+=2;else if("number"==typeof p)for(d++;d<c&&"string"==typeof u[d];)d++;else{if(p===o)return u[d+1];d+=2}}}return null}(In(),s)}const Ys="__parameters__";function Zu(s,o,u){return bn(()=>{const c=function dc(s){return function(...u){if(s){const c=s(...u);for(const d in c)this[d]=c[d]}}}(o);function d(...p){if(this instanceof d)return c.apply(this,p),this;const y=new d(...p);return E.annotation=y,E;function E(C,T,A){const V=C.hasOwnProperty(Ys)?C[Ys]:Object.defineProperty(C,Ys,{value:[]})[Ys];for(;V.length<=A;)V.push(null);return(V[A]=V[A]||[]).push(y),C}}return u&&(d.prototype=Object.create(u.prototype)),d.prototype.ngMetadataName=s,d.annotationCls=d,d})}class On{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=Qt({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Up=new On("AnalyzeForEntryComponents");function ei(s,o){void 0===o&&(o=s);for(let u=0;u<s.length;u++){let c=s[u];Array.isArray(c)?(o===s&&(o=s.slice(0,u)),ei(c,o)):o!==s&&o.push(c)}return o}function qi(s,o){s.forEach(u=>Array.isArray(u)?qi(u,o):o(u))}function nh(s,o,u){o>=s.length?s.push(u):s.splice(o,0,u)}function aa(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}function pi(s,o,u){let c=Qu(s,o);return c>=0?s[1|c]=u:(c=~c,function pc(s,o,u,c){let d=s.length;if(d==o)s.push(u,c);else if(1===d)s.push(c,s[0]),s[0]=u;else{for(d--,s.push(s[d-1],s[d]);d>o;)s[d]=s[d-2],d--;s[o]=u,s[o+1]=c}}(s,c,o,u)),c}function $p(s,o){const u=Qu(s,o);if(u>=0)return s[1|u]}function Qu(s,o){return function rh(s,o,u){let c=0,d=s.length>>u;for(;d!==c;){const p=c+(d-c>>1),y=s[p<<u];if(o===y)return p<<u;y>o?d=p:c=p+1}return~(d<<u)}(s,o,1)}const Mo={},Wp="__NG_DI_FLAG__",uh="ngTempTokenPath",_c=/\n/gm,zp="__source";let qa;function la(s){const o=qa;return qa=s,o}function Ka(s,o=ht.Default){if(void 0===qa)throw new Oe(-203,!1);return null===qa?Bn(s,void 0,o):qa.get(s,o&ht.Optional?null:void 0,o)}function Qn(s,o=ht.Default){return(function nn(){return nr}()||Ka)(ne(s),o)}function No(s,o=ht.Default){return Qn(s,o)}function Xu(s){const o=[];for(let u=0;u<s.length;u++){const c=ne(s[u]);if(Array.isArray(c)){if(0===c.length)throw new Oe(900,!1);let d,p=ht.Default;for(let y=0;y<c.length;y++){const E=c[y],C=el(E);"number"==typeof C?-1===C?d=E.token:p|=C:d=E}o.push(Qn(d,p))}else o.push(Qn(c))}return o}function Za(s,o){return s[Wp]=o,s.prototype[Wp]=o,s}function el(s){return s[Wp]}const Qa=Za(Zu("Optional"),8),Qs=Za(Zu("SkipSelf"),4);let sl;function gy(s){sl=s}class _h{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function as(s){return s instanceof _h?s.changingThisBreaksApplicationSecurity:s}const S=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,ie=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var Cr=(()=>((Cr=Cr||{})[Cr.NONE=0]="NONE",Cr[Cr.HTML=1]="HTML",Cr[Cr.STYLE=2]="STYLE",Cr[Cr.SCRIPT=3]="SCRIPT",Cr[Cr.URL=4]="URL",Cr[Cr.RESOURCE_URL=5]="RESOURCE_URL",Cr))();function Ih(s){const o=function Cc(){const s=be();return s&&s[12]}();return o?o.sanitize(Cr.URL,s)||"":function ol(s,o){const u=function ag(s){return s instanceof _h&&s.getTypeName()||null}(s);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see https://g.co/ng/security#xss)`)}return u===o}(s,"URL")?as(s):function Ne(s){return(s=String(s)).match(S)||s.match(ie)?s:"unsafe:"+s}(ge(s))}function IE(s){return s.ngOriginalError}class Ch{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o);this._console.error("ERROR",o),u&&this._console.error("ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&IE(o);for(;u&&IE(u);)u=IE(u);return u||null}}const CE=new Map;let xN=0;const Ar="__ngContext__";function gi(s,o){Er(o)?(s[Ar]=o[20],function eo(s){CE.set(s[20],s)}(o)):s[Ar]=o}function to(s){const o=s[Ar];return"number"==typeof o?function Sy(s){return CE.get(s)||null}(o):o||null}function ru(s){const o=to(s);return o?Er(o)?o:o.lView:null}const no=(()=>(typeof requestAnimationFrame<"u"&&requestAnimationFrame||setTimeout).bind(et))();function Oo(s){return s instanceof Function?s():s}var ro=(()=>((ro=ro||{})[ro.Important=1]="Important",ro[ro.DashCase=2]="DashCase",ro))();function bh(s,o){return undefined(s,o)}function pa(s){const o=s[3];return Yr(o)?o[3]:o}function fg(s){return Dc(s[13])}function Rr(s){return Dc(s[4])}function Dc(s){for(;null!==s&&!Yr(s);)s=s[4];return s}function Ai(s,o,u,c,d){if(null!=c){let p,y=!1;Yr(c)?p=c:Er(c)&&(y=!0,c=c[0]);const E=ir(c);0===s&&null!==u?null==d?Th(o,u,E):ma(o,u,E,d||null,!0):1===s&&null!==u?ma(o,u,E,d||null,!0):2===s?function vg(s,o,u){const c=mg(s,o);c&&function kT(s,o,u,c){s.removeChild(o,u,c)}(s,c,o,u)}(o,E,y):3===s&&o.destroyNode(E),null!=p&&function OE(s,o,u,c,d){const p=u[7];p!==ir(u)&&Ai(o,s,c,p,d);for(let E=10;E<u.length;E++){const C=u[E];Sc(C[1],C,s,o,c,p)}}(o,s,p,u,d)}}function Ny(s,o,u){return s.createElement(o,u)}function ky(s,o){const u=s[9],c=u.indexOf(o),d=o[3];512&o[2]&&(o[2]&=-513,bo(d,-1)),u.splice(c,1)}function Mr(s,o){if(s.length<=10)return;const u=10+o,c=s[u];if(c){const d=c[17];null!==d&&d!==s&&ky(d,c),o>0&&(s[u-1][4]=c[4]);const p=aa(s,10+o);!function ga(s,o){Sc(s,o,o[11],2,null,null),o[0]=null,o[6]=null}(c[1],c);const y=p[19];null!==y&&y.detachView(p[1]),c[3]=null,c[4]=null,c[2]&=-65}return c}function Oy(s,o){if(!(128&o[2])){const u=o[11];u.destroyNode&&Sc(s,o,u,3,null,null),function MT(s){let o=s[13];if(!o)return Fy(s[1],s);for(;o;){let u=null;if(Er(o))u=o[13];else{const c=o[10];c&&(u=c)}if(!u){for(;o&&!o[4]&&o!==s;)Er(o)&&Fy(o[1],o),o=o[3];null===o&&(o=s),Er(o)&&Fy(o[1],o),u=o&&o[4]}o=u}}(o)}}function Fy(s,o){if(!(128&o[2])){o[2]&=-65,o[2]|=128,function PT(s,o){let u;if(null!=s&&null!=(u=s.destroyHooks))for(let c=0;c<u.length;c+=2){const d=o[u[c]];if(!(d instanceof Ks)){const p=u[c+1];if(Array.isArray(p))for(let y=0;y<p.length;y+=2){const E=d[p[y]],C=p[y+1];try{C.call(E)}finally{}}else try{p.call(d)}finally{}}}}(s,o),function NT(s,o){const u=s.cleanup,c=o[7];let d=-1;if(null!==u)for(let p=0;p<u.length-1;p+=2)if("string"==typeof u[p]){const y=u[p+1],E="function"==typeof y?y(o):ir(o[y]),C=c[d=u[p+2]],T=u[p+3];"boolean"==typeof T?E.removeEventListener(u[p],C,T):T>=0?c[d=T]():c[d=-T].unsubscribe(),p+=2}else{const y=c[d=u[p+1]];u[p].call(y)}if(null!==c){for(let p=d+1;p<c.length;p++)c[p]();o[7]=null}}(s,o),1===o[1].type&&o[11].destroy();const u=o[17];if(null!==u&&Yr(o[3])){u!==o[3]&&ky(u,o);const c=o[19];null!==c&&c.detachView(s)}!function Ay(s){CE.delete(s[20])}(o)}}function PE(s,o,u){return function Ly(s,o,u){let c=o;for(;null!==c&&40&c.type;)c=(o=c).parent;if(null===c)return u[0];if(2&c.flags){const d=s.data[c.directiveStart].encapsulation;if(d===Ut.None||d===Ut.Emulated)return null}return Jr(c,u)}(s,o.parent,u)}function ma(s,o,u,c,d){s.insertBefore(o,u,c,d)}function Th(s,o,u){s.appendChild(o,u)}function cl(s,o,u,c,d){null!==c?ma(s,o,u,c,d):Th(s,o,u)}function mg(s,o){return s.parentNode(o)}let Vy=function Sh(s,o,u){return 40&s.type?Jr(s,u):null};function Ah(s,o,u,c){const d=PE(s,c,o),p=o[11],E=function Tc(s,o,u){return Vy(s,o,u)}(c.parent||o[6],c,o);if(null!=d)if(Array.isArray(u))for(let C=0;C<u.length;C++)cl(p,d,u[C],E,!1);else cl(p,d,u,E,!1)}function xh(s,o){if(null!==o){const u=o.type;if(3&u)return Jr(o,s);if(4&u)return yg(-1,s[o.index]);if(8&u){const c=o.child;if(null!==c)return xh(s,c);{const d=s[o.index];return Yr(d)?yg(-1,d):ir(d)}}if(32&u)return bh(o,s)()||ir(s[o.index]);{const c=By(s,o);return null!==c?Array.isArray(c)?c[0]:xh(pa(s[16]),c):xh(s,o.next)}}return null}function By(s,o){return null!==o?s[16][6].projection[o.projection]:null}function yg(s,o){const u=10+s+1;if(u<o.length){const c=o[u],d=c[1].firstChild;if(null!==d)return xh(c,d)}return o[7]}function wg(s,o,u,c,d,p,y){for(;null!=u;){const E=c[u.index],C=u.type;if(y&&0===o&&(E&&gi(ir(E),c),u.flags|=4),64!=(64&u.flags))if(8&C)wg(s,o,u.child,c,d,p,!1),Ai(o,s,d,E,p);else if(32&C){const T=bh(u,c);let A;for(;A=T();)Ai(o,s,d,A,p);Ai(o,s,d,E,p)}else 16&C?kE(s,o,c,u,d,p):Ai(o,s,d,E,p);u=y?u.projectionNext:u.next}}function Sc(s,o,u,c,d,p){wg(u,c,s.firstChild,o,d,p,!1)}function kE(s,o,u,c,d,p){const y=u[16],C=y[6].projection[c.projection];if(Array.isArray(C))for(let T=0;T<C.length;T++)Ai(o,s,d,C[T],p);else wg(s,o,C,y[3],d,p,!0)}function Eg(s,o,u){s.setAttribute(o,"style",u)}function Rh(s,o,u){""===u?s.removeAttribute(o,"class"):s.setAttribute(o,"class",u)}function Ig(s,o,u){let c=s.length;for(;;){const d=s.indexOf(o,u);if(-1===d)return d;if(0===d||s.charCodeAt(d-1)<=32){const p=o.length;if(d+p===c||s.charCodeAt(d+p)<=32)return d}u=d+1}}const FE="ng-template";function LE(s,o,u){let c=0;for(;c<s.length;){let d=s[c++];if(u&&"class"===d){if(d=s[c],-1!==Ig(d.toLowerCase(),o,0))return!0}else if(1===d){for(;c<s.length&&"string"==typeof(d=s[c++]);)if(d.toLowerCase()===o)return!0;return!1}}return!1}function VE(s){return 4===s.type&&s.value!==FE}function LT(s,o,u){return o===(4!==s.type||u?s.value:FE)}function VT(s,o,u){let c=4;const d=s.attrs||[],p=function BT(s){for(let o=0;o<s.length;o++)if(rc(s[o]))return o;return s.length}(d);let y=!1;for(let E=0;E<o.length;E++){const C=o[E];if("number"!=typeof C){if(!y)if(4&c){if(c=2|1&c,""!==C&&!LT(s,C,u)||""===C&&1===o.length){if(Ns(c))return!1;y=!0}}else{const T=8&c?C:o[++E];if(8&c&&null!==s.attrs){if(!LE(s.attrs,T,u)){if(Ns(c))return!1;y=!0}continue}const V=UE(8&c?"class":C,d,VE(s),u);if(-1===V){if(Ns(c))return!1;y=!0;continue}if(""!==T){let Z;Z=V>p?"":d[V+1].toLowerCase();const se=8&c?Z:null;if(se&&-1!==Ig(se,T,0)||2&c&&T!==Z){if(Ns(c))return!1;y=!0}}}}else{if(!y&&!Ns(c)&&!Ns(C))return!1;if(y&&Ns(C))continue;y=!1,c=C|1&c}}return Ns(c)||y}function Ns(s){return 0==(1&s)}function UE(s,o,u,c){if(null===o)return-1;let d=0;if(c||!u){let p=!1;for(;d<o.length;){const y=o[d];if(y===s)return d;if(3===y||6===y)p=!0;else{if(1===y||2===y){let E=o[++d];for(;"string"==typeof E;)E=o[++d];continue}if(4===y)break;if(0===y){d+=4;continue}}d+=p?1:2}return-1}return function jT(s,o){let u=s.indexOf(4);if(u>-1)for(u++;u<s.length;){const c=s[u];if("number"==typeof c)return-1;if(c===o)return u;u++}return-1}(o,s)}function Hy(s,o,u=!1){for(let c=0;c<o.length;c++)if(VT(s,o[c],u))return!0;return!1}function BE(s,o){return s?":not("+o.trim()+")":o}function jE(s){let o=s[0],u=1,c=2,d="",p=!1;for(;u<s.length;){let y=s[u];if("string"==typeof y)if(2&c){const E=s[++u];d+="["+y+(E.length>0?'="'+E+'"':"")+"]"}else 8&c?d+="."+y:4&c&&(d+=" "+y);else""!==d&&!Ns(y)&&(o+=BE(p,d),d=""),c=y,p=p||!Ns(c);u++}return""!==d&&(o+=BE(p,d)),o}const $t={};function $E(s){_a(St(),be(),Br()+s,!1)}function _a(s,o,u,c){if(!c)if(3==(3&o[2])){const p=s.preOrderCheckHooks;null!==p&&xp(o,p,u)}else{const p=s.preOrderHooks;null!==p&&Rp(o,p,0,u)}fi(u)}const Gy=new On("ENVIRONMENT_INITIALIZER"),bg=new On("INJECTOR_DEF_TYPES");function GE(...s){return{\u0275providers:WE(0,s)}}function WE(s,...o){const u=[],c=new Set;let d;return qi(o,p=>{const y=p;zy(y,u,[],c)&&(d||(d=[]),d.push(y))}),void 0!==d&&Wy(d,u),u}function Wy(s,o){for(let u=0;u<s.length;u++){const{providers:d}=s[u];qi(d,p=>{o.push(p)})}}function zy(s,o,u,c){if(!(s=ne(s)))return!1;let d=null,p=tr(s);const y=!p&&M(s);if(p||y){if(y&&!y.standalone)return!1;d=s}else{const C=s.ngModule;if(p=tr(C),!p)return!1;d=C}const E=c.has(d);if(y){if(E)return!1;if(c.add(d),y.dependencies){const C="function"==typeof y.dependencies?y.dependencies():y.dependencies;for(const T of C)zy(T,o,u,c)}}else{if(!p)return!1;{if(null!=p.imports&&!E){let T;c.add(d);try{qi(p.imports,A=>{zy(A,o,u,c)&&(T||(T=[]),T.push(A))})}finally{}void 0!==T&&Wy(T,o)}if(!E){const T=is(d)||(()=>new d);o.push({provide:d,useFactory:T,deps:Dt},{provide:bg,useValue:d,multi:!0},{provide:Gy,useValue:()=>Qn(d),multi:!0})}const C=p.providers;null==C||E||qi(C,A=>{o.push(A)})}}return d!==s&&void 0!==s.providers}const zE=Ce({provide:String,useValue:Ce});function Dg(s){return null!==s&&"object"==typeof s&&zE in s}function iu(s){return"function"==typeof s}const Tg=new On("INJECTOR",-1);class Nh{get(o,u=Mo){if(u===Mo){const c=new Error(`NullInjectorError: No provider for ${fe(o)}!`);throw c.name="NullInjectorError",c}return u}}const Sg=new On("Set Injector scope."),Ph={},Fn={};let mn;function en(){return void 0===mn&&(mn=new Nh),mn}class us{}class jn extends us{constructor(o,u,c,d){super(),this.parent=u,this.source=c,this.scopes=d,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Zi(o,y=>this.processProvider(y)),this.records.set(Tg,Un(void 0,this)),d.has("environment")&&this.records.set(us,Un(void 0,this));const p=this.records.get(Sg);null!=p&&"string"==typeof p.value&&this.scopes.add(p.value),this.injectorDefTypes=new Set(this.get(bg.multi,Dt,ht.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();for(const o of this._onDestroyHooks)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(o){this._onDestroyHooks.push(o)}get(o,u=Mo,c=ht.Default){this.assertNotDestroyed();const d=la(this),p=rn(void 0);try{if(!(c&ht.SkipSelf)){let E=this.records.get(o);if(void 0===E){const C=function YT(s){return"function"==typeof s||"object"==typeof s&&s instanceof On}(o)&&tn(o);E=C&&this.injectableDefInScope(C)?Un(kh(o),Ph):null,this.records.set(o,E)}if(null!=E)return this.hydrate(o,E)}return(c&ht.Self?en():this.parent).get(o,u=c&ht.Optional&&u===Mo?null:u)}catch(y){if("NullInjectorError"===y.name){if((y[uh]=y[uh]||[]).unshift(fe(o)),d)throw y;return function qp(s,o,u,c){const d=s[uh];throw o[zp]&&d.unshift(o[zp]),s.message=function yc(s,o,u,c=null){s=s&&"\n"===s.charAt(0)&&"\u0275"==s.charAt(1)?s.slice(2):s;let d=fe(o);if(Array.isArray(o))d=o.map(fe).join(" -> ");else if("object"==typeof o){let p=[];for(let y in o)if(o.hasOwnProperty(y)){let E=o[y];p.push(y+":"+("string"==typeof E?JSON.stringify(E):fe(E)))}d=`{${p.join(", ")}}`}return`${u}${c?"("+c+")":""}[${d}]: ${s.replace(_c,"\n  ")}`}("\n"+s.message,d,u,c),s.ngTokenPath=d,s[uh]=null,s}(y,o,"R3InjectorError",this.source)}throw y}finally{rn(p),la(d)}}resolveInjectorInitializers(){const o=la(this),u=rn(void 0);try{const c=this.get(Gy.multi,Dt,ht.Self);for(const d of c)d()}finally{la(o),rn(u)}}toString(){const o=[],u=this.records;for(const c of u.keys())o.push(fe(c));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Oe(205,!1)}processProvider(o){let u=iu(o=ne(o))?o:ne(o&&o.provide);const c=function Oh(s){return Dg(s)?Un(void 0,s.useValue):Un(Ky(s),Ph)}(o);if(iu(o)||!0!==o.multi)this.records.get(u);else{let d=this.records.get(u);d||(d=Un(void 0,Ph,!0),d.factory=()=>Xu(d.multi),this.records.set(u,d)),u=o,d.multi.push(o)}this.records.set(u,c)}hydrate(o,u){return u.value===Ph&&(u.value=Fn,u.value=u.factory()),"object"==typeof u.value&&u.value&&function xi(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(u.value)&&this._ngOnDestroyHooks.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=ne(o.providedIn);return"string"==typeof u?"any"===u||this.scopes.has(u):this.injectorDefTypes.has(u)}}function kh(s){const o=tn(s),u=null!==o?o.factory:is(s);if(null!==u)return u;if(s instanceof On)throw new Oe(204,!1);if(s instanceof Function)return function ZT(s){const o=s.length;if(o>0)throw function Ms(s,o){const u=[];for(let c=0;c<s;c++)u.push(o);return u}(o,"?"),new Oe(204,!1);const u=function Fr(s){const o=s&&(s[fr]||s[$n]);if(o){const u=function Nn(s){if(s.hasOwnProperty("name"))return s.name;const o=(""+s).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(s);return console.warn(`DEPRECATED: DI is instantiating a token "${u}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${u}" class.`),o}return null}(s);return null!==u?()=>u.factory(s):()=>new s}(s);throw new Oe(204,!1)}function Ky(s,o,u){let c;if(iu(s)){const d=ne(s);return is(d)||kh(d)}if(Dg(s))c=()=>ne(s.useValue);else if(function qE(s){return!(!s||!s.useFactory)}(s))c=()=>s.useFactory(...Xu(s.deps||[]));else if(function qy(s){return!(!s||!s.useExisting)}(s))c=()=>Qn(ne(s.useExisting));else{const d=ne(s&&(s.useClass||s.provide));if(!function an(s){return!!s.deps}(s))return is(d)||kh(d);c=()=>new d(...Xu(s.deps))}return c}function Un(s,o,u=!1){return{factory:s,value:o,multi:u?[]:void 0}}function Zy(s){return!!s.\u0275providers}function Zi(s,o){for(const u of s)Array.isArray(u)?Zi(u,o):Zy(u)?Zi(u.\u0275providers,o):o(u)}function ZE(s,o=null,u=null,c){const d=YE(s,o,u,c);return d.resolveInjectorInitializers(),d}function YE(s,o=null,u=null,c,d=new Set){const p=[u||Dt,GE(s)];return c=c||("object"==typeof s?void 0:fe(s)),new jn(p,o||en(),c||null,d)}let Lo=(()=>{class s{static create(u,c){if(Array.isArray(u))return ZE({name:""},c,u,"");{const d=u.name??"";return ZE({name:d},u.parent,u.providers,d)}}}return s.THROW_IF_NOT_FOUND=Mo,s.NULL=new Nh,s.\u0275prov=Qt({token:s,providedIn:"any",factory:()=>Qn(Tg)}),s.__NG_ELEMENT_ID__=-1,s})();function xc(s,o=ht.Default){const u=be();return null===u?Qn(s,o):Ga(In(),u,ne(s),o)}function eI(){throw new Error("invalid")}function Rc(s,o){return s<<17|o<<2}function Ps(s){return s>>17&32767}function Fg(s){return 2|s}function Uo(s){return(131068&s)>>2}function Lg(s,o){return-131069&s|o<<2}function pl(s){return 1|s}function uv(s,o){const u=s.contentQueries;if(null!==u)for(let c=0;c<u.length;c+=2){const d=u[c],p=u[c+1];if(-1!==p){const y=s.data[p];Gu(d),y.contentQueries(2,o[p],p)}}}function Oc(s,o,u,c,d,p,y,E,C,T,A){const V=o.blueprint.slice();return V[0]=d,V[2]=76|c,(null!==A||s&&1024&s[2])&&(V[2]|=1024),Hs(V),V[3]=V[15]=s,V[8]=u,V[10]=y||s&&s[10],V[11]=E||s&&s[11],V[12]=C||s&&s[12]||null,V[9]=T||s&&s[9]||null,V[6]=p,V[20]=function Ty(){return xN++}(),V[21]=A,V[16]=2==o.type?s[16]:V,V}function Fc(s,o,u,c,d){let p=s.data[o];if(null===p)p=function Hn(s,o,u,c,d){const p=Do(),y=zi(),C=s.data[o]=function fS(s,o,u,c,d,p){return{type:u,index:c,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:d,attrs:p,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,y?p:p&&p.parent,u,o,c,d);return null===s.firstChild&&(s.firstChild=C),null!==p&&(y?null==p.child&&null!==C.parent&&(p.child=C):null===p.next&&(p.next=C)),C}(s,o,u,c,d),function Z_(){return Mt.lFrame.inI18n}()&&(p.flags|=64);else if(64&p.type){p.type=u,p.value=c,p.attrs=d;const y=function Wi(){const s=Mt.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();p.injectorIndex=null===y?-1:y.injectorIndex}return Ur(p,!0),p}function _i(s,o,u,c){if(0===u)return-1;const d=o.length;for(let p=0;p<u;p++)o.push(c),s.blueprint.push(c),s.data.push(null);return d}function cu(s,o,u){bp(o);try{const c=s.viewQuery;null!==c&&mv(1,c,u);const d=s.template;null!==d&&jg(s,o,d,1,u),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&uv(s,o),s.staticViewQueries&&mv(2,s.viewQuery,u);const p=s.components;null!==p&&function gl(s,o){for(let u=0;u<o.length;u++)EI(s,o[u])}(o,p)}catch(c){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),c}finally{o[2]&=-5,ec()}}function ml(s,o,u,c){const d=o[2];if(128!=(128&d)){bp(o);try{Hs(o),function Hd(s){return Mt.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==u&&jg(s,o,u,2,c);const y=3==(3&d);if(y){const T=s.preOrderCheckHooks;null!==T&&xp(o,T,null)}else{const T=s.preOrderHooks;null!==T&&Rp(o,T,0,null),qd(o,0)}if(function wI(s){for(let o=fg(s);null!==o;o=Rr(o)){if(!o[2])continue;const u=o[9];for(let c=0;c<u.length;c++){const d=u[c],p=d[3];0==(512&d[2])&&bo(p,1),d[2]|=512}}}(o),function IS(s){for(let o=fg(s);null!==o;o=Rr(o))for(let u=10;u<o.length;u++){const c=o[u],d=c[1];Io(c)&&ml(d,c,d.template,c[8])}}(o),null!==s.contentQueries&&uv(s,o),y){const T=s.contentCheckHooks;null!==T&&xp(o,T)}else{const T=s.contentHooks;null!==T&&Rp(o,T,1),qd(o,1)}!function zh(s,o){const u=s.hostBindingOpCodes;if(null!==u)try{for(let c=0;c<u.length;c++){const d=u[c];if(d<0)fi(~d);else{const p=d,y=u[++c],E=u[++c];Ip(y,p),E(2,o[p])}}}finally{fi(-1)}}(s,o);const E=s.components;null!==E&&function Bg(s,o){for(let u=0;u<o.length;u++)qg(s,o[u])}(o,E);const C=s.viewQuery;if(null!==C&&mv(2,C,c),y){const T=s.viewCheckHooks;null!==T&&xp(o,T)}else{const T=s.viewHooks;null!==T&&Rp(o,T,2),qd(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),o[2]&=-41,512&o[2]&&(o[2]&=-513,bo(o[3],-1))}finally{ec()}}}function dI(s,o,u,c){const d=o[10],y=$i(o);try{!y&&d.begin&&d.begin(),y&&cu(s,o,c),ml(s,o,u,c)}finally{!y&&d.end&&d.end()}}function jg(s,o,u,c,d){const p=Br(),y=2&c;try{fi(-1),y&&o.length>22&&_a(s,o,22,!1),u(c,d)}finally{fi(p)}}function Hg(s,o,u){!tt()||(function yS(s,o,u,c){const d=u.directiveStart,p=u.directiveEnd;s.firstCreatePass||zu(u,o),gi(c,o);const y=u.initialInputs;for(let E=d;E<p;E++){const C=s.data[E],T=Qr(C);T&&wS(o,u,C);const A=Wa(o,s,E,u);gi(A,o),null!==y&&pv(0,E-d,A,C,0,y),T&&(Sr(u.index,o)[8]=A)}}(s,o,u,Jr(u,o)),128==(128&u.flags)&&function Gg(s,o,u){const c=u.directiveStart,d=u.directiveEnd,p=u.index,y=function $d(){return Mt.lFrame.currentDirectiveIndex}();try{fi(p);for(let E=c;E<d;E++){const C=s.data[E],T=o[E];Gd(E),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&Wg(C,T)}}finally{fi(-1),Gd(y)}}(s,o,u))}function jo(s,o,u=Jr){const c=o.localNames;if(null!==c){let d=o.index+1;for(let p=0;p<c.length;p+=2){const y=c[p+1],E=-1===y?u(o,s):s[y];s[d++]=E}}}function $g(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=hu(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):o}function hu(s,o,u,c,d,p,y,E,C,T){const A=22+c,V=A+d,Z=function hI(s,o){const u=[];for(let c=0;c<o;c++)u.push(c<s?null:$t);return u}(A,V),se="function"==typeof T?T():T;return Z[1]={type:s,blueprint:Z,template:u,queries:null,viewQuery:E,declTNode:o,data:Z.slice().fill(null,A),bindingStartIndex:A,expandoStartIndex:V,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof p?p():p,pipeRegistry:"function"==typeof y?y():y,firstChild:null,schemas:C,consts:se,incompleteFirstPass:!1}}function fI(s,o,u,c){const d=_v(o);null===u?d.push(c):(d.push(u),s.firstCreatePass&&yv(s).push(c,d.length-1))}function pI(s,o,u){for(let c in s)if(s.hasOwnProperty(c)){const d=s[c];(u=null===u?{}:u).hasOwnProperty(c)?u[c].push(o,d):u[c]=[o,d]}return u}function cv(s,o,u,c){let d=!1;if(tt()){const p=function yI(s,o,u){const c=s.directiveRegistry;let d=null;if(c)for(let p=0;p<c.length;p++){const y=c[p];Hy(u,y.selectors,!1)&&(d||(d=[]),Zs(zu(u,o),s,y.type),Qr(y)?(qh(s,u),d.unshift(y)):d.push(y))}return d}(s,o,u),y=null===c?null:{"":-1};if(null!==p){d=!0,hv(u,s.data.length,p.length);for(let A=0;A<p.length;A++){const V=p[A];V.providersResolver&&V.providersResolver(V)}let E=!1,C=!1,T=_i(s,o,p.length,null);for(let A=0;A<p.length;A++){const V=p[A];u.mergedAttrs=Yd(u.mergedAttrs,V.hostAttrs),fv(s,u,o,T,V),dv(T,V,y),null!==V.contentQueries&&(u.flags|=8),(null!==V.hostBindings||null!==V.hostAttrs||0!==V.hostVars)&&(u.flags|=128);const Z=V.type.prototype;!E&&(Z.ngOnChanges||Z.ngOnInit||Z.ngDoCheck)&&((s.preOrderHooks||(s.preOrderHooks=[])).push(u.index),E=!0),!C&&(Z.ngOnChanges||Z.ngDoCheck)&&((s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(u.index),C=!0),T++}!function pS(s,o){const c=o.directiveEnd,d=s.data,p=o.attrs,y=[];let E=null,C=null;for(let T=o.directiveStart;T<c;T++){const A=d[T],V=A.inputs,Z=null===p||VE(o)?null:ES(V,p);y.push(Z),E=pI(V,T,E),C=pI(A.outputs,T,C)}null!==E&&(E.hasOwnProperty("class")&&(o.flags|=16),E.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=y,o.inputs=E,o.outputs=C}(s,u)}y&&function vS(s,o,u){if(o){const c=s.localNames=[];for(let d=0;d<o.length;d+=2){const p=u[o[d+1]];if(null==p)throw new Oe(-301,!1);c.push(o[d],p)}}}(u,c,y)}return u.mergedAttrs=Yd(u.mergedAttrs,u.attrs),d}function _I(s,o,u,c,d,p){const y=p.hostBindings;if(y){let E=s.hostBindingOpCodes;null===E&&(E=s.hostBindingOpCodes=[]);const C=~o.index;(function _S(s){let o=s.length;for(;o>0;){const u=s[--o];if("number"==typeof u&&u<0)return u}return 0})(E)!=C&&E.push(C),E.push(c,d,y)}}function Wg(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function qh(s,o){o.flags|=2,(s.components||(s.components=[])).push(o.index)}function dv(s,o,u){if(u){if(o.exportAs)for(let c=0;c<o.exportAs.length;c++)u[o.exportAs[c]]=s;Qr(o)&&(u[""]=s)}}function hv(s,o,u){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+u,s.providerIndexes=o}function fv(s,o,u,c,d){s.data[c]=d;const p=d.factory||(d.factory=is(d.type)),y=new Ks(p,Qr(d),xc);s.blueprint[c]=y,u[c]=y,_I(s,o,0,c,_i(s,u,d.hostVars,$t),d)}function wS(s,o,u){const c=Jr(o,s),d=$g(u),p=s[10],y=Zh(s,Oc(s,d,null,u.onPush?32:16,c,o,p,p.createRenderer(c,u),null,null,null));s[o.index]=y}function Ho(s,o,u,c,d,p){const y=Jr(s,o);!function zg(s,o,u,c,d,p,y){if(null==p)s.removeAttribute(o,d,u);else{const E=null==y?ge(p):y(p,c||"",d);s.setAttribute(o,d,E,u)}}(o[11],y,p,s.value,u,c,d)}function pv(s,o,u,c,d,p){const y=p[o];if(null!==y){const E=c.setInput;for(let C=0;C<y.length;){const T=y[C++],A=y[C++],V=y[C++];null!==E?c.setInput(u,V,T,A):u[A]=V}}}function ES(s,o){let u=null,c=0;for(;c<o.length;){const d=o[c];if(0!==d)if(5!==d){if("number"==typeof d)break;s.hasOwnProperty(d)&&(null===u&&(u=[]),u.push(d,s[d],o[c+1])),c+=2}else c+=2;else c+=4}return u}function vI(s,o,u,c){return new Array(s,!0,!1,o,null,0,c,u,null,null)}function qg(s,o){const u=Sr(o,s);if(Io(u)){const c=u[1];48&u[2]?ml(c,u,c.template,u[8]):u[5]>0&&Kh(u)}}function Kh(s){for(let c=fg(s);null!==c;c=Rr(c))for(let d=10;d<c.length;d++){const p=c[d];if(512&p[2]){const y=p[1];ml(y,p,y.template,p[8])}else p[5]>0&&Kh(p)}const u=s[1].components;if(null!==u)for(let c=0;c<u.length;c++){const d=Sr(u[c],s);Io(d)&&d[5]>0&&Kh(d)}}function EI(s,o){const u=Sr(o,s),c=u[1];(function CS(s,o){for(let u=o.length;u<s.blueprint.length;u++)o.push(s.blueprint[u])})(c,u),cu(c,u,u[8])}function Zh(s,o){return s[13]?s[14][4]=o:s[13]=o,s[14]=o,o}function Yh(s){for(;s;){s[2]|=32;const o=pa(s);if(ju(s)&&!o)return s;s=o}return null}function CI(s){!function II(s){for(let o=0;o<s.components.length;o++){const u=s.components[o],c=ru(u);if(null!==c){const d=c[1];dI(d,c,d.template,u)}}}(s[8])}function mv(s,o,u){Gu(0),o(s,u)}const TS=(()=>Promise.resolve(null))();function _v(s){return s[7]||(s[7]=[])}function yv(s){return s.cleanup||(s.cleanup=[])}function vv(s,o){const u=s[9],c=u?u.get(Ch,null):null;c&&c.handleError(o)}function Qh(s,o,u,c,d){for(let p=0;p<u.length;){const y=u[p++],E=u[p++],C=o[y],T=s.data[y];null!==T.setInput?T.setInput(C,d,c,E):C[E]=d}}function Kg(s,o,u){let c=u?s.styles:null,d=u?s.classes:null,p=0;if(null!==o)for(let y=0;y<o.length;y++){const E=o[y];"number"==typeof E?p=E:1==p?d=we(d,E):2==p&&(c=we(c,E+": "+o[++y]+";"))}u?s.styles=c:s.stylesWithoutHost=c,u?s.classes=d:s.classesWithoutHost=d}function AS(){const s=In();zd(be()[1],s)}function Go(s){let o=function Iv(s){return Object.getPrototypeOf(s.prototype).constructor}(s.type),u=!0;const c=[s];for(;o;){let d;if(Qr(s))d=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new Oe(903,!1);d=o.\u0275dir}if(d){if(u){c.push(d);const y=s;y.inputs=Zg(s.inputs),y.declaredInputs=Zg(s.declaredInputs),y.outputs=Zg(s.outputs);const E=d.hostBindings;E&&Qg(s,E);const C=d.viewQuery,T=d.contentQueries;if(C&&fu(s,C),T&&Yg(s,T),de(s.inputs,d.inputs),de(s.declaredInputs,d.declaredInputs),de(s.outputs,d.outputs),Qr(d)&&d.data.animation){const A=s.data;A.animation=(A.animation||[]).concat(d.data.animation)}}const p=d.features;if(p)for(let y=0;y<p.length;y++){const E=p[y];E&&E.ngInherit&&E(s),E===Go&&(u=!1)}}o=Object.getPrototypeOf(o)}!function DI(s){let o=0,u=null;for(let c=s.length-1;c>=0;c--){const d=s[c];d.hostVars=o+=d.hostVars,d.hostAttrs=Yd(d.hostAttrs,u=Yd(u,d.hostAttrs))}}(c)}function Zg(s){return s===lr?{}:s===Dt?[]:s}function fu(s,o){const u=s.viewQuery;s.viewQuery=u?(c,d)=>{o(c,d),u(c,d)}:o}function Yg(s,o){const u=s.contentQueries;s.contentQueries=u?(c,d,p)=>{o(c,d,p),u(c,d,p)}:o}function Qg(s,o){const u=s.hostBindings;s.hostBindings=u?(c,d)=>{o(c,d),u(c,d)}:o}let Jh=null;function wa(){if(!Jh){const s=et.Symbol;if(s&&s.iterator)Jh=s.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let u=0;u<o.length;++u){const c=o[u];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(Jh=c)}}}return Jh}function Os(s){return!!Cv(s)&&(Array.isArray(s)||!(s instanceof Map)&&wa()in s)}function Cv(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function ni(s,o,u){return!Object.is(s[o],u)&&(s[o]=u,!0)}function Lc(s,o,u,c){const d=be();return ni(d,zs(),o)&&(St(),Ho(Zn(),d,s,o,u,c)),Lc}function bv(s,o,u,c,d,p,y,E){const C=be(),T=St(),A=s+22,V=T.firstCreatePass?function OS(s,o,u,c,d,p,y,E,C){const T=o.consts,A=Fc(o,s,4,y||null,Gi(T,E));cv(o,u,A,Gi(T,C)),zd(o,A);const V=A.tViews=hu(2,A,c,d,p,o.directiveRegistry,o.pipeRegistry,null,o.schemas,T);return null!==o.queries&&(o.queries.template(o,A),V.queries=o.queries.embeddedTView(A)),A}(A,T,C,o,u,c,d,p,y):T.data[A];Ur(V,!1);const Z=C[11].createComment("");Ah(T,C,Z,V),gi(Z,C),Zh(C,C[A]=vI(Z,C,Z,V)),Ts(V)&&Hg(T,C,V),null!=y&&jo(C,V,E)}function tm(s){return function Xr(s,o){return s[o]}(function To(){return Mt.lFrame.contextLView}(),22+s)}function nf(s,o,u){const c=be();return ni(c,zs(),o)&&function ls(s,o,u,c,d,p,y,E){const C=Jr(o,u);let A,T=o.inputs;!E&&null!=T&&(A=T[c])?(Qh(s,u,A,c,d),ts(o)&&function gI(s,o){const u=Sr(o,s);16&u[2]||(u[2]|=32)}(u,o.index)):3&o.type&&(c=function gS(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(c),d=null!=y?y(d,o.value||"",c):d,p.setProperty(C,c,d))}(St(),Zn(),c,s,o,c[11],u,!1),nf}function Bc(s,o,u,c,d){const y=d?"class":"style";Qh(s,u,o.inputs[y],y,c)}function jc(s,o,u,c){const d=be(),p=St(),y=22+s,E=d[11],C=d[y]=Ny(E,o,function Ap(){return Mt.lFrame.currentNamespace}()),T=p.firstCreatePass?function El(s,o,u,c,d,p,y){const E=o.consts,T=Fc(o,s,2,d,Gi(E,p));return cv(o,u,T,Gi(E,y)),null!==T.attrs&&Kg(T,T.attrs,!1),null!==T.mergedAttrs&&Kg(T,T.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,T),T}(y,p,d,0,o,u,c):p.data[y];Ur(T,!0);const A=T.mergedAttrs;null!==A&&Kd(E,C,A);const V=T.classes;null!==V&&Rh(E,C,V);const Z=T.styles;return null!==Z&&Eg(E,C,Z),64!=(64&T.flags)&&Ah(p,d,C,T),0===function Y(){return Mt.lFrame.elementDepthCount}()&&gi(C,d),function ce(){Mt.lFrame.elementDepthCount++}(),Ts(T)&&(Hg(p,d,T),function du(s,o,u){if(yo(o)){const d=o.directiveEnd;for(let p=o.directiveStart;p<d;p++){const y=s.data[p];y.contentQueries&&y.contentQueries(1,u[p],p)}}}(p,T,d)),null!==c&&jo(d,T),jc}function rf(){let s=In();zi()?function ja(){Mt.lFrame.isParent=!1}():(s=s.parent,Ur(s,!1));const o=s;!function je(){Mt.lFrame.elementDepthCount--}();const u=St();return u.firstCreatePass&&(zd(u,s),yo(s)&&u.queries.elementEnd(s)),null!=o.classesWithoutHost&&function X_(s){return 0!=(16&s.flags)}(o)&&Bc(u,o,be(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function pE(s){return 0!=(32&s.flags)}(o)&&Bc(u,o,be(),o.stylesWithoutHost,!1),rf}function Tv(s,o,u,c){return jc(s,o,u,c),rf(),Tv}function im(){return be()}function Av(s){return!!s&&"function"==typeof s.then}function NI(s){return!!s&&"function"==typeof s.subscribe}const PI=NI;function sf(s,o,u,c){const d=be(),p=St(),y=In();return function OI(s,o,u,c,d,p,y,E){const C=Ts(c),A=s.firstCreatePass&&yv(s),V=o[8],Z=_v(o);let se=!0;if(3&c.type||E){const it=Jr(c,o),dt=E?E(it):it,Tt=Z.length,Be=E?un=>E(ir(un[c.index])):c.index;let bt=null;if(!E&&C&&(bt=function kI(s,o,u,c){const d=s.cleanup;if(null!=d)for(let p=0;p<d.length-1;p+=2){const y=d[p];if(y===u&&d[p+1]===c){const E=o[7],C=d[p+2];return E.length>C?E[C]:null}"string"==typeof y&&(p+=2)}return null}(s,o,d,c.index)),null!==bt)(bt.__ngLastListenerFn__||bt).__ngNextListenerFn__=p,bt.__ngLastListenerFn__=p,se=!1;else{p=ao(c,o,V,p,!1);const un=u.listen(dt,d,p);Z.push(p,un),A&&A.push(d,Be,Tt,Tt+1)}}else p=ao(c,o,V,p,!1);const Me=c.outputs;let qe;if(se&&null!==Me&&(qe=Me[d])){const it=qe.length;if(it)for(let dt=0;dt<it;dt+=2){const Xn=o[qe[dt]][qe[dt+1]].subscribe(p),xu=Z.length;Z.push(p,Xn),A&&A.push(d,c.index,xu,-(xu+1))}}}(p,d,d[11],y,s,o,0,c),sf}function $c(s,o,u,c){try{return!1!==u(c)}catch(d){return vv(s,d),!1}}function ao(s,o,u,c,d){return function p(y){if(y===Function)return c;Yh(2&s.flags?Sr(s.index,o):o);let C=$c(o,0,c,y),T=p.__ngNextListenerFn__;for(;T;)C=$c(o,0,T,y)&&C,T=T.__ngNextListenerFn__;return d&&!1===C&&(y.preventDefault(),y.returnValue=!1),C}}function Gc(s=1){return function Sp(s){return(Mt.lFrame.contextLView=function tc(s,o){for(;s>0;)o=o[15],s--;return o}(s,Mt.lFrame.contextLView))[8]}(s)}function BI(s,o,u,c,d){const p=s[u+1],y=null===o;let E=c?Ps(p):Uo(p),C=!1;for(;0!==E&&(!1===C||y);){const A=s[E+1];VS(s[E],o)&&(C=!0,s[E+1]=c?pl(A):Fg(A)),E=c?Ps(A):Uo(A)}C&&(s[u+1]=c?Fg(p):pl(p))}function VS(s,o){return null===s||null==o||(Array.isArray(s)?s[1]:s)===o||!(!Array.isArray(s)||"string"!=typeof o)&&Qu(s,o)>=0}function cf(s,o){return function lo(s,o,u,c){const d=be(),p=St(),y=function qs(s){const o=Mt.lFrame,u=o.bindingIndex;return o.bindingIndex=o.bindingIndex+s,u}(2);p.firstUpdatePass&&function ZI(s,o,u,c){const d=s.data;if(null===d[u+1]){const p=d[Br()],y=function df(s,o){return o>=s.expandoStartIndex}(s,u);(function Ov(s,o){return 0!=(s.flags&(o?16:32))})(p,c)&&null===o&&!y&&(o=!1),o=function qc(s,o,u,c){const d=function Ha(s){const o=Mt.lFrame.currentDirectiveIndex;return-1===o?null:s[o]}(s);let p=c?o.residualClasses:o.residualStyles;if(null===d)0===(c?o.classBindings:o.styleBindings)&&(u=_u(u=sm(null,s,o,u,c),o.attrs,c),p=null);else{const y=o.directiveStylingLast;if(-1===y||s[y]!==d)if(u=sm(d,s,o,u,c),null===p){let C=function HS(s,o,u){const c=u?o.classBindings:o.styleBindings;if(0!==Uo(c))return s[Ps(c)]}(s,o,c);void 0!==C&&Array.isArray(C)&&(C=sm(null,s,o,C[1],c),C=_u(C,o.attrs,c),function YI(s,o,u,c){s[Ps(u?o.classBindings:o.styleBindings)]=c}(s,o,c,C))}else p=function QI(s,o,u){let c;const d=o.directiveEnd;for(let p=1+o.directiveStylingLast;p<d;p++)c=_u(c,s[p].hostAttrs,u);return _u(c,o.attrs,u)}(s,o,c)}return void 0!==p&&(c?o.residualClasses=p:o.residualStyles=p),u}(d,p,o,c),function UI(s,o,u,c,d,p){let y=p?o.classBindings:o.styleBindings,E=Ps(y),C=Uo(y);s[c]=u;let A,T=!1;if(Array.isArray(u)){const V=u;A=V[1],(null===A||Qu(V,A)>0)&&(T=!0)}else A=u;if(d)if(0!==C){const Z=Ps(s[E+1]);s[c+1]=Rc(Z,E),0!==Z&&(s[Z+1]=Lg(s[Z+1],c)),s[E+1]=function sS(s,o){return 131071&s|o<<17}(s[E+1],c)}else s[c+1]=Rc(E,0),0!==E&&(s[E+1]=Lg(s[E+1],c)),E=c;else s[c+1]=Rc(C,0),0===E?E=c:s[C+1]=Lg(s[C+1],c),C=c;T&&(s[c+1]=Fg(s[c+1])),BI(s,A,c,!0),BI(s,A,c,!1),function LS(s,o,u,c,d){const p=d?s.residualClasses:s.residualStyles;null!=p&&"string"==typeof o&&Qu(p,o)>=0&&(u[c+1]=pl(u[c+1]))}(o,A,s,c,p),y=Rc(E,C),p?o.classBindings=y:o.styleBindings=y}(d,p,o,u,y,c)}}(p,s,y,c),o!==$t&&ni(d,y,o)&&function JI(s,o,u,c,d,p,y,E){if(!(3&o.type))return;const C=s.data,T=C[E+1];um(function fl(s){return 1==(1&s)}(T)?am(C,o,u,d,Uo(T),y):void 0)||(um(p)||function tv(s){return 2==(2&s)}(T)&&(p=am(C,null,u,d,E,y)),function FT(s,o,u,c,d){if(o)d?s.addClass(u,c):s.removeClass(u,c);else{let p=-1===c.indexOf("-")?void 0:ro.DashCase;null==d?s.removeStyle(u,c,p):("string"==typeof d&&d.endsWith("!important")&&(d=d.slice(0,-10),p|=ro.Important),s.setStyle(u,c,d,p))}}(c,y,Hi(Br(),u),d,p))}(p,p.data[Br()],d,d[11],s,d[y+1]=function XI(s,o){return null==s||("string"==typeof o?s+=o:"object"==typeof s&&(s=fe(as(s)))),s}(o,u),c,y)}(s,o,null,!0),cf}function sm(s,o,u,c,d){let p=null;const y=u.directiveEnd;let E=u.directiveStylingLast;for(-1===E?E=u.directiveStart:E++;E<y&&(p=o[E],c=_u(c,p.hostAttrs,d),p!==s);)E++;return null!==s&&(u.directiveStylingLast=E),c}function _u(s,o,u){const c=u?1:2;let d=-1;if(null!==o)for(let p=0;p<o.length;p++){const y=o[p];"number"==typeof y?d=y:d===c&&(Array.isArray(s)||(s=void 0===s?[]:["",s]),pi(s,y,!!u||o[++p]))}return void 0===s?null:s}function am(s,o,u,c,d,p){const y=null===o;let E;for(;d>0;){const C=s[d],T=Array.isArray(C),A=T?C[1]:C,V=null===A;let Z=u[d+1];Z===$t&&(Z=V?Dt:void 0);let se=V?$p(Z,c):A===c?Z:void 0;if(T&&!um(se)&&(se=$p(C,c)),um(se)&&(E=se,y))return E;const Me=s[d+1];d=y?Ps(Me):Uo(Me)}if(null!==o){let C=p?o.residualClasses:o.residualStyles;null!=C&&(E=$p(C,c))}return E}function um(s){return void 0!==s}function Fv(s,o=""){const u=be(),c=St(),d=s+22,p=c.firstCreatePass?Fc(c,d,1,o,null):c.data[d],y=u[d]=function Hr(s,o){return s.createText(o)}(u[11],o);Ah(c,u,y,p),Ur(p,!1)}function ii(s,o,u){const c=be(),d=function oo(s,o,u,c){return ni(s,zs(),u)?o+ge(u)+c:$t}(c,s,o,u);return d!==$t&&function $o(s,o,u){const c=Hi(o,s);!function NE(s,o,u){s.setValue(o,u)}(s[11],c,u)}(c,Br(),d),ii}const bl=void 0;var QS=["en",[["a","p"],["AM","PM"],bl],[["AM","PM"],bl,bl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],bl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],bl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",bl,"{1} 'at' {0}",bl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function YS(s){const u=Math.floor(Math.abs(s)),c=s.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===c?1:5}];let Kc={};function Gv(s){const o=function ho(s){return s.toLowerCase().replace(/_/g,"-")}(s);let u=gC(o);if(u)return u;const c=o.split("-")[0];if(u=gC(c),u)return u;if("en"===c)return QS;throw new Oe(701,!1)}function pC(s){return Gv(s)[At.PluralCase]}function gC(s){return s in Kc||(Kc[s]=et.ng&&et.ng.common&&et.ng.common.locales&&et.ng.common.locales[s]),Kc[s]}var At=(()=>((At=At||{})[At.LocaleId=0]="LocaleId",At[At.DayPeriodsFormat=1]="DayPeriodsFormat",At[At.DayPeriodsStandalone=2]="DayPeriodsStandalone",At[At.DaysFormat=3]="DaysFormat",At[At.DaysStandalone=4]="DaysStandalone",At[At.MonthsFormat=5]="MonthsFormat",At[At.MonthsStandalone=6]="MonthsStandalone",At[At.Eras=7]="Eras",At[At.FirstDayOfWeek=8]="FirstDayOfWeek",At[At.WeekendRange=9]="WeekendRange",At[At.DateFormat=10]="DateFormat",At[At.TimeFormat=11]="TimeFormat",At[At.DateTimeFormat=12]="DateTimeFormat",At[At.NumberSymbols=13]="NumberSymbols",At[At.NumberFormats=14]="NumberFormats",At[At.CurrencyCode=15]="CurrencyCode",At[At.CurrencySymbol=16]="CurrencySymbol",At[At.CurrencyName=17]="CurrencyName",At[At.Currencies=18]="Currencies",At[At.Directionality=19]="Directionality",At[At.PluralCase=20]="PluralCase",At[At.ExtraData=21]="ExtraData",At))();const Dl="en-US";let mC=Dl;function Jc(s,o,u,c,d){if(s=ne(s),Array.isArray(s))for(let p=0;p<s.length;p++)Jc(s[p],o,u,c,d);else{const p=St(),y=be();let E=iu(s)?s:ne(s.provide),C=Ky(s);const T=In(),A=1048575&T.providerIndexes,V=T.directiveStart,Z=T.providerIndexes>>20;if(iu(s)||!s.multi){const se=new Ks(C,d,xc),Me=Xc(E,o,d?A:A+Z,V);-1===Me?(Zs(zu(T,y),p,E),mm(p,s,o.length),o.push(E),T.directiveStart++,T.directiveEnd++,d&&(T.providerIndexes+=1048576),u.push(se),y.push(se)):(u[Me]=se,y[Me]=se)}else{const se=Xc(E,o,A+Z,V),Me=Xc(E,o,A,A+Z),qe=se>=0&&u[se],it=Me>=0&&u[Me];if(d&&!it||!d&&!qe){Zs(zu(T,y),p,E);const dt=function xA(s,o,u,c,d){const p=new Ks(s,u,xc);return p.multi=[],p.index=o,p.componentProviders=0,_m(p,d,c&&!u),p}(d?ew:Xv,u.length,d,c,C);!d&&it&&(u[Me].providerFactory=dt),mm(p,s,o.length,0),o.push(E),T.directiveStart++,T.directiveEnd++,d&&(T.providerIndexes+=1048576),u.push(dt),y.push(dt)}else mm(p,s,se>-1?se:Me,_m(u[d?Me:se],C,!d&&c));!d&&c&&it&&u[Me].componentProviders++}}}function mm(s,o,u,c){const d=iu(o),p=function KE(s){return!!s.useClass}(o);if(d||p){const C=(p?ne(o.useClass):o).prototype.ngOnDestroy;if(C){const T=s.destroyHooks||(s.destroyHooks=[]);if(!d&&o.multi){const A=T.indexOf(u);-1===A?T.push(u,[c,C]):T[A+1].push(c,C)}else T.push(u,C)}}}function _m(s,o,u){return u&&s.componentProviders++,s.multi.push(o)-1}function Xc(s,o,u,c){for(let d=u;d<c;d++)if(o[d]===s)return d;return-1}function Xv(s,o,u,c){return tw(this.multi,[])}function ew(s,o,u,c){const d=this.multi;let p;if(this.providerFactory){const y=this.providerFactory.componentProviders,E=Wa(u,u[1],this.providerFactory.index,c);p=E.slice(0,y),tw(d,p);for(let C=y;C<E.length;C++)p.push(E[C])}else p=[],tw(d,p);return p}function tw(s,o){for(let u=0;u<s.length;u++)o.push((0,s[u])());return o}function kC(s,o=[]){return u=>{u.providersResolver=(c,d)=>function Mi(s,o,u){const c=St();if(c.firstCreatePass){const d=Qr(s);Jc(u,c.data,c.blueprint,d,!0),Jc(o,c.data,c.blueprint,d,!1)}}(c,d?d(s):s,o)}}class FC{resolveComponentFactory(o){throw function RA(s){const o=Error(`No component factory found for ${fe(s)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=s,o}(o)}}let Iu=(()=>{class s{}return s.NULL=new FC,s})();class Cu{}class LC{}class VC{}function NA(){return Sl(In(),be())}function Sl(s,o){return new Al(Jr(s,o))}let Al=(()=>{class s{constructor(u){this.nativeElement=u}}return s.__NG_ELEMENT_ID__=NA,s})();function UC(s){return s instanceof Al?s.nativeElement:s}class nw{}let vf=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function PA(){const s=be(),u=Sr(In().index,s);return(Er(u)?u:s)[11]}(),s})(),rw=(()=>{class s{}return s.\u0275prov=Qt({token:s,providedIn:"root",factory:()=>null}),s})();class iw{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const jC=new iw("14.0.6"),wf={};function Ef(s,o,u,c,d=!1){for(;null!==u;){const p=o[u.index];if(null!==p&&c.push(ir(p)),Yr(p))for(let E=10;E<p.length;E++){const C=p[E],T=C[1].firstChild;null!==T&&Ef(C[1],C,T,c)}const y=u.type;if(8&y)Ef(s,o,u.child,c);else if(32&y){const E=bh(u,o);let C;for(;C=E();)c.push(C)}else if(16&y){const E=By(o,u);if(Array.isArray(E))c.push(...E);else{const C=pa(o[16]);Ef(C[1],C,E,c,!0)}}u=d?u.projectionNext:u.next}return c}class ed{constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,u=o[1];return Ef(u,o,u.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(Yr(o)){const u=o[8],c=u?u.indexOf(this):-1;c>-1&&(Mr(o,c),aa(u,c))}this._attachedToViewContainer=!1}Oy(this._lView[1],this._lView)}onDestroy(o){fI(this._lView[1],this._lView,null,o)}markForCheck(){Yh(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){!function gv(s,o,u){const c=o[10];c.begin&&c.begin();try{ml(s,o,s.template,u)}catch(d){throw vv(o,d),d}finally{c.end&&c.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Oe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function ll(s,o){Sc(s,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new Oe(902,!1);this._appRef=o}}class sw extends ed{constructor(o){super(o),this._view=o}detectChanges(){CI(this._view)}checkNoChanges(){}get context(){return null}}class ow extends Iu{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=M(o);return new If(u,this.ngModule)}}function HC(s){const o=[];for(let u in s)s.hasOwnProperty(u)&&o.push({propName:s[u],templateName:u});return o}class vm{constructor(o,u){this.injector=o,this.parentInjector=u}get(o,u,c){const d=this.injector.get(o,wf,c);return d!==wf||u===wf?d:this.parentInjector.get(o,u,c)}}class If extends VC{constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function HE(s){return s.map(jE).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}get inputs(){return HC(this.componentDef.inputs)}get outputs(){return HC(this.componentDef.outputs)}create(o,u,c,d){let p=(d=d||this.ngModule)instanceof us?d:d?.injector;p&&null!==this.componentDef.getStandaloneInjector&&(p=this.componentDef.getStandaloneInjector(p)||p);const y=p?new vm(o,p):o,E=y.get(nw,null);if(null===E)throw new Oe(407,!1);const C=y.get(rw,null),T=E.createRenderer(null,this.componentDef),A=this.componentDef.selectors[0][0]||"div",V=c?function hS(s,o,u){return s.selectRootElement(o,u===Ut.ShadowDom)}(T,c,this.componentDef.encapsulation):Ny(E.createRenderer(null,this.componentDef),A,function kA(s){const o=s.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(A)),Z=this.componentDef.onPush?288:272,se=function Ev(s,o){return{components:[],scheduler:s||no,clean:TS,playerHandler:o||null,flags:0}}(),Me=hu(0,null,null,1,0,null,null,null,null,null),qe=Oc(null,Me,se,Z,null,null,E,T,C,y,null);let it,dt;bp(qe);try{const Tt=function SS(s,o,u,c,d,p){const y=u[1];u[22]=s;const C=Fc(y,22,2,"#host",null),T=C.mergedAttrs=o.hostAttrs;null!==T&&(Kg(C,T,!0),null!==s&&(Kd(d,s,T),null!==C.classes&&Rh(d,s,C.classes),null!==C.styles&&Eg(d,s,C.styles)));const A=c.createRenderer(s,o),V=Oc(u,$g(o),null,o.onPush?32:16,u[22],C,c,A,p||null,null,null);return y.firstCreatePass&&(Zs(zu(C,u),y,o.type),qh(y,C),hv(C,u.length,1)),Zh(u,V),u[22]=V}(V,this.componentDef,qe,E,T);if(V)if(c)Kd(T,V,["ng-version",jC.full]);else{const{attrs:Be,classes:bt}=function $T(s){const o=[],u=[];let c=1,d=2;for(;c<s.length;){let p=s[c];if("string"==typeof p)2===d?""!==p&&o.push(p,s[++c]):8===d&&u.push(p);else{if(!Ns(d))break;d=p}c++}return{attrs:o,classes:u}}(this.componentDef.selectors[0]);Be&&Kd(T,V,Be),bt&&bt.length>0&&Rh(T,V,bt.join(" "))}if(dt=na(Me,22),void 0!==u){const Be=dt.projection=[];for(let bt=0;bt<this.ngContentSelectors.length;bt++){const un=u[bt];Be.push(null!=un?Array.from(un):null)}}it=function wv(s,o,u,c,d){const p=u[1],y=function mS(s,o,u){const c=In();s.firstCreatePass&&(u.providersResolver&&u.providersResolver(u),fv(s,c,o,_i(s,o,1,null),u));const d=Wa(o,s,c.directiveStart,c);gi(d,o);const p=Jr(c,o);return p&&gi(p,o),d}(p,u,o);if(c.components.push(y),s[8]=y,null!==d)for(const C of d)C(y,o);if(o.contentQueries){const C=In();o.contentQueries(1,y,C.directiveStart)}const E=In();return!p.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(fi(E.index),_I(u[1],E,0,E.directiveStart,E.directiveEnd,o),Wg(o,y)),y}(Tt,this.componentDef,qe,se,[AS]),cu(Me,qe,null)}finally{ec()}return new GC(this.componentType,it,Sl(dt,qe),qe,dt)}}class GC extends class MA{}{constructor(o,u,c,d,p){super(),this.location=c,this._rootLView=d,this._tNode=p,this.instance=u,this.hostView=this.changeDetectorRef=new sw(d),this.componentType=o}get injector(){return new oa(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function OA(s,o){return new uw(s,o??null)}class uw extends Cu{constructor(o,u){super(),this._parent=u,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new ow(this);const c=Ie(o);this._bootstrapComponents=Oo(c.bootstrap),this._r3Injector=YE(o,u,[{provide:Cu,useValue:this},{provide:Iu,useValue:this.componentFactoryResolver}],fe(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this.get(o)}get(o,u=Lo.THROW_IF_NOT_FOUND,c=ht.Default){return o===Lo||o===Cu||o===Tg?this:this._r3Injector.get(o,u,c)}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class td extends LC{constructor(o){super(),this.moduleType=o}create(o){return new uw(this.moduleType,o)}}class FA extends Cu{constructor(o,u,c){super(),this.componentFactoryResolver=new ow(this),this.instance=null;const d=new jn([...o,{provide:Cu,useValue:this},{provide:Iu,useValue:this.componentFactoryResolver}],u||en(),c,new Set(["environment"]));this.injector=d,d.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function lw(s,o=null,u=null){return new FA(s,o,u).injector}function ib(s){return o=>{setTimeout(s,void 0,o)}}const _s=class CP extends f.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,c){let d=o,p=u||(()=>null),y=c;if(o&&"object"==typeof o){const C=o;d=C.next?.bind(C),p=C.error?.bind(C),y=C.complete?.bind(C)}this.__isAsync&&(p=ib(p),d&&(d=ib(d)),y&&(y=ib(y)));const E=super.subscribe({next:d,error:p,complete:y});return o instanceof B.w0&&o.add(E),E}};function YA(){return this._results[wa()]()}class Cf{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=wa(),c=Cf.prototype;c[u]||(c[u]=YA)}get changes(){return this._changes||(this._changes=new _s)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const c=this;c.dirty=!1;const d=ei(o);(this._changesDetected=!function fc(s,o,u){if(s.length!==o.length)return!1;for(let c=0;c<s.length;c++){let d=s[c],p=o[c];if(u&&(d=u(d),p=u(p)),p!==d)return!1}return!0}(c._results,d,u))&&(c._results=d,c.length=d.length,c.last=d[this.length-1],c.first=d[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Rl=(()=>{class s{}return s.__NG_ELEMENT_ID__=pw,s})();const hw=Rl,fw=class extends hw{constructor(o,u,c){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=c}createEmbeddedView(o,u){const c=this._declarationTContainer.tViews,d=Oc(this._declarationLView,c,o,16,null,c.declTNode,null,null,null,null,u||null);d[17]=this._declarationLView[this._declarationTContainer.index];const y=this._declarationLView[19];return null!==y&&(d[19]=y.createEmbeddedView(c)),cu(c,d,o),new ed(d)}};function pw(){return rd(In(),be())}function rd(s,o){return 4&s.type?new fw(o,s,Sl(s,o)):null}let id=(()=>{class s{}return s.__NG_ELEMENT_ID__=bf,s})();function bf(){return gw(In(),be())}const QA=id,sb=class extends QA{constructor(o,u,c){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=c}get element(){return Sl(this._hostTNode,this._hostLView)}get injector(){return new oa(this._hostTNode,this._hostLView)}get parentInjector(){const o=uc(this._hostTNode,this._hostLView);if(ny(o)){const u=sc(o,this._hostLView),c=ic(o);return new oa(u[1].data[c+8],u)}return new oa(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=ob(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,u,c){let d,p;"number"==typeof c?d=c:null!=c&&(d=c.index,p=c.injector);const y=o.createEmbeddedView(u||{},p);return this.insert(y,d),y}createComponent(o,u,c,d,p){const y=o&&!function Ro(s){return"function"==typeof s}(o);let E;if(y)E=u;else{const V=u||{};E=V.index,c=V.injector,d=V.projectableNodes,p=V.environmentInjector||V.ngModuleRef}const C=y?o:new If(M(o)),T=c||this.parentInjector;if(!p&&null==C.ngModule){const Z=(y?T:this.parentInjector).get(us,null);Z&&(p=Z)}const A=C.create(T,d,void 0,p);return this.insert(A.hostView,E),A}insert(o,u){const c=o._lView,d=c[1];if(function Co(s){return Yr(s[3])}(c)){const A=this.indexOf(o);if(-1!==A)this.detach(A);else{const V=c[3],Z=new sb(V,V[6],V[3]);Z.detach(Z.indexOf(o))}}const p=this._adjustIndex(u),y=this._lContainer;!function Dh(s,o,u,c){const d=10+c,p=u.length;c>0&&(u[d-1][4]=o),c<p-10?(o[4]=u[d],nh(u,10+c,o)):(u.push(o),o[4]=null),o[3]=u;const y=o[17];null!==y&&u!==y&&function Py(s,o){const u=s[9];o[16]!==o[3][3][16]&&(s[2]=!0),null===u?s[9]=[o]:u.push(o)}(y,o);const E=o[19];null!==E&&E.insertView(s),o[2]|=64}(d,c,y,p);const E=yg(p,y),C=c[11],T=mg(C,y[7]);return null!==T&&function Fo(s,o,u,c,d,p){c[0]=d,c[6]=o,Sc(s,c,u,1,d,p)}(d,y[6],C,c,T,E),o.attachToViewContainerRef(),nh(bm(y),p,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=ob(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),c=Mr(this._lContainer,u);c&&(aa(bm(this._lContainer),u),Oy(c[1],c))}detach(o){const u=this._adjustIndex(o,-1),c=Mr(this._lContainer,u);return c&&null!=aa(bm(this._lContainer),u)?new ed(c):null}_adjustIndex(o,u=0){return o??this.length+u}};function ob(s){return s[8]}function bm(s){return s[8]||(s[8]=[])}function gw(s,o){let u;const c=o[s.index];if(Yr(c))u=c;else{let d;if(8&s.type)d=ir(c);else{const p=o[11];d=p.createComment("");const y=Jr(s,o);ma(p,mg(p,y),d,function OT(s,o){return s.nextSibling(o)}(p,y),!1)}o[s.index]=u=vI(c,o,d,s),Zh(o,u)}return new sb(u,s,o)}class mw{constructor(o){this.queryList=o,this.matches=null}clone(){return new mw(this.queryList)}setDirty(){this.queryList.setDirty()}}class Tm{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const c=null!==o.contentQueries?o.contentQueries[0]:u.length,d=[];for(let p=0;p<c;p++){const y=u.getByIndex(p);d.push(this.queries[y.indexInDeclarationView].clone())}return new Tm(d)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==sd(o,u).matches&&this.queries[u].setDirty()}}class lb{constructor(o,u,c=null){this.predicate=o,this.flags=u,this.read=c}}class _w{constructor(o=[]){this.queries=o}elementStart(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let c=0;c<this.length;c++){const d=null!==u?u.length:0,p=this.getByIndex(c).embeddedTView(o,d);p&&(p.indexInDeclarationView=c,null!==u?u.push(p):u=[p])}return null!==u?new _w(u):null}template(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class Sm{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new Sm(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let c=o.parent;for(;null!==c&&8&c.type&&c.index!==u;)c=c.parent;return u===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const c=this.metadata.predicate;if(Array.isArray(c))for(let d=0;d<c.length;d++){const p=c[d];this.matchTNodeWithReadOption(o,u,cb(u,p)),this.matchTNodeWithReadOption(o,u,sa(u,o,p,!1,!1))}else c===Rl?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,sa(u,o,c,!1,!1))}matchTNodeWithReadOption(o,u,c){if(null!==c){const d=this.metadata.read;if(null!==d)if(d===Al||d===id||d===Rl&&4&u.type)this.addMatch(u.index,-2);else{const p=sa(u,o,d,!1,!1);null!==p&&this.addMatch(u.index,p)}else this.addMatch(u.index,c)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function cb(s,o){const u=s.localNames;if(null!==u)for(let c=0;c<u.length;c+=2)if(u[c]===o)return u[c+1];return null}function JA(s,o,u,c){return-1===u?function db(s,o){return 11&s.type?Sl(s,o):4&s.type?rd(s,o):null}(o,s):-2===u?function XA(s,o,u){return u===Al?Sl(o,s):u===Rl?rd(o,s):u===id?gw(o,s):void 0}(s,o,c):Wa(s,s[1],u,o)}function hb(s,o,u,c){const d=o[19].queries[c];if(null===d.matches){const p=s.data,y=u.matches,E=[];for(let C=0;C<y.length;C+=2){const T=y[C];E.push(T<0?null:JA(o,p[T],y[C+1],u.metadata.read))}d.matches=E}return d.matches}function Am(s,o,u,c){const d=s.queries.getByIndex(u),p=d.matches;if(null!==p){const y=hb(s,o,d,u);for(let E=0;E<p.length;E+=2){const C=p[E];if(C>0)c.push(y[E/2]);else{const T=p[E+1],A=o[-C];for(let V=10;V<A.length;V++){const Z=A[V];Z[17]===Z[3]&&Am(Z[1],Z,T,c)}if(null!==A[9]){const V=A[9];for(let Z=0;Z<V.length;Z++){const se=V[Z];Am(se[1],se,T,c)}}}}}return c}function fb(s){const o=be(),u=St(),c=Cp();Gu(c+1);const d=sd(u,c);if(s.dirty&&$i(o)===(2==(2&d.metadata.flags))){if(null===d.matches)s.reset([]);else{const p=d.crossesNgTemplate?Am(u,o,c,[]):hb(u,o,d,c);s.reset(p,UC),s.notifyOnChanges()}return!0}return!1}function yw(s,o,u,c){const d=St();if(d.firstCreatePass){const p=In();(function mb(s,o,u){null===s.queries&&(s.queries=new _w),s.queries.track(new Sm(o,u))})(d,new lb(o,u,c),p.index),function nx(s,o){const u=s.contentQueries||(s.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(s.queries.length-1,o)}(d,s),2==(2&u)&&(d.staticContentQueries=!0)}!function gb(s,o,u){const c=new Cf(4==(4&u));fI(s,o,c,c.destroy),null===o[19]&&(o[19]=new Tm),o[19].queries.push(new mw(c))}(d,be(),u)}function pb(){return function tx(s,o){return s[19].queries[o].queryList}(be(),Cp())}function sd(s,o){return s.queries.getByIndex(o)}function od(s){const o=M(s)||F(s)||J(s);return null!==o&&o.standalone}function Lm(...s){}const Tf=new On("Application Initializer");let Nl=(()=>{class s{constructor(u){this.appInits=u,this.resolve=Lm,this.reject=Lm,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,d)=>{this.resolve=c,this.reject=d})}runInitializers(){if(this.initialized)return;const u=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let d=0;d<this.appInits.length;d++){const p=this.appInits[d]();if(Av(p))u.push(p);else if(PI(p)){const y=new Promise((E,C)=>{p.subscribe({complete:E,error:C})});u.push(y)}}Promise.all(u).then(()=>{c()}).catch(d=>{this.reject(d)}),0===u.length&&c(),this.initialized=!0}}return s.\u0275fac=function(u){return new(u||s)(Qn(Tf,8))},s.\u0275prov=Qt({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const Vm=new On("AppId",{providedIn:"root",factory:function Um(){return`${Sf()}${Sf()}${Sf()}`}});function Sf(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Nw=new On("Platform Initializer"),Ab=new On("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),xb=new On("appBootstrapListener");let Pw=(()=>{class s{log(u){console.log(u)}warn(u){console.warn(u)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Qt({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const Bm=new On("LocaleId",{providedIn:"root",factory:()=>No(Bm,ht.Optional|ht.SkipSelf)||function Rb(){return typeof $localize<"u"&&$localize.locale||Dl}()}),kw=new On("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class li{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let jm=(()=>{class s{compileModuleSync(u){return new td(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const c=this.compileModuleSync(u),p=Oo(Ie(u).declarations).reduce((y,E)=>{const C=M(E);return C&&y.push(new If(C)),y},[]);return new li(c,p)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Qt({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const Lw=(()=>Promise.resolve(0))();function Vw(s){typeof Zone>"u"?Lw.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class Qi{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new _s(!1),this.onMicrotaskEmpty=new _s(!1),this.onStable=new _s(!1),this.onError=new _s(!1),typeof Zone>"u")throw new Oe(908,!1);Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!c&&u,d.shouldCoalesceRunChangeDetection=c,d.lastRequestAnimationFrameId=-1,d.nativeRequestAnimationFrame=function Uw(){let s=et.requestAnimationFrame,o=et.cancelAnimationFrame;if(typeof Zone<"u"&&s&&o){const u=s[Zone.__symbol__("OriginalDelegate")];u&&(s=u);const c=o[Zone.__symbol__("OriginalDelegate")];c&&(o=c)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function jw(s){const o=()=>{!function Bw(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(et,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,Hm(s),s.isCheckStableRunning=!0,ld(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),Hm(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,c,d,p,y,E)=>{try{return kb(s),u.invokeTask(d,p,y,E)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===p.type||s.shouldCoalesceRunChangeDetection)&&o(),cd(s)}},onInvoke:(u,c,d,p,y,E,C)=>{try{return kb(s),u.invoke(d,p,y,E,C)}finally{s.shouldCoalesceRunChangeDetection&&o(),cd(s)}},onHasTask:(u,c,d,p)=>{u.hasTask(d,p),c===d&&("microTask"==p.change?(s._hasPendingMicrotasks=p.microTask,Hm(s),ld(s)):"macroTask"==p.change&&(s.hasPendingMacrotasks=p.macroTask))},onHandleError:(u,c,d,p)=>(u.handleError(d,p),s.runOutsideAngular(()=>s.onError.emit(p)),!1)})}(d)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Qi.isInAngularZone())throw new Oe(909,!1)}static assertNotInAngularZone(){if(Qi.isInAngularZone())throw new Oe(909,!1)}run(o,u,c){return this._inner.run(o,u,c)}runTask(o,u,c,d){const p=this._inner,y=p.scheduleEventTask("NgZoneEvent: "+d,o,gx,Lm,Lm);try{return p.runTask(y,u,c)}finally{p.cancelTask(y)}}runGuarded(o,u,c){return this._inner.runGuarded(o,u,c)}runOutsideAngular(o){return this._outer.run(o)}}const gx={};function ld(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function Hm(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function kb(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function cd(s){s._nesting--,ld(s)}class Ob{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new _s,this.onMicrotaskEmpty=new _s,this.onStable=new _s,this.onError=new _s}run(o,u,c){return o.apply(u,c)}runGuarded(o,u,c){return o.apply(u,c)}runOutsideAngular(o){return o()}runTask(o,u,c,d){return o.apply(u,c)}}const Hw=new On(""),$w=new On("");let Su,$m=(()=>{class s{constructor(u,c,d){this._ngZone=u,this.registry=c,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Su||(function mx(s){Su=s}(d),d.addToWindow(c)),this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Qi.assertNotInAngularZone(),Vw(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Vw(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(u)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,c,d){let p=-1;c&&c>0&&(p=setTimeout(()=>{this._callbacks=this._callbacks.filter(y=>y.timeoutId!==p),u(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:u,timeoutId:p,updateCb:d})}whenStable(u,c,d){if(d&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,c,d),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(u){this.registry.registerApplication(u,this)}unregisterApplication(u){this.registry.unregisterApplication(u)}findProviders(u,c,d){return[]}}return s.\u0275fac=function(u){return new(u||s)(Qn(Qi),Qn(Fb),Qn($w))},s.\u0275prov=Qt({token:s,factory:s.\u0275fac}),s})(),Fb=(()=>{class s{constructor(){this._applications=new Map}registerApplication(u,c){this._applications.set(u,c)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,c=!0){return Su?.findTestabilityInTree(this,u,c)??null}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=Qt({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})(),Au=null;const Lb=new On("AllowMultipleToken"),Sa=new On("PlatformDestroyListeners");class Vb{constructor(o,u){this.name=o,this.token=u}}function Ww(s,o,u=[]){const c=`Platform: ${o}`,d=new On(c);return(p=[])=>{let y=Pl();if(!y||y.injector.get(Lb,!1)){const E=[...u,...p,{provide:d,useValue:!0}];s?s(E):function ki(s){if(Au&&!Au.get(Lb,!1))throw new Oe(400,!1);Au=s;const o=s.get(Wm);(function dd(s){const o=s.get(Nw,null);o&&o.forEach(u=>u())})(s)}(function qw(s=[],o){return Lo.create({name:o,providers:[{provide:Sg,useValue:"platform"},{provide:Sa,useValue:new Set([()=>Au=null])},...s]})}(E,c))}return function zw(s){const o=Pl();if(!o)throw new Oe(401,!1);return o}()}}function Pl(){return Au?.get(Wm)??null}let Wm=(()=>{class s{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,c){const d=function Kw(s,o){let u;return u="noop"===s?new Ob:("zone.js"===s?void 0:s)||new Qi(o),u}(c?.ngZone,function zm(s){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!s||!s.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!s||!s.ngZoneRunCoalescing)||!1}}(c)),p=[{provide:Qi,useValue:d}];return d.run(()=>{const y=Lo.create({providers:p,parent:this.injector,name:u.moduleType.name}),E=u.create(y),C=E.injector.get(Ch,null);if(!C)throw new Oe(402,!1);return d.runOutsideAngular(()=>{const T=d.onError.subscribe({next:A=>{C.handleError(A)}});E.onDestroy(()=>{qm(this._modules,E),T.unsubscribe()})}),function xf(s,o,u){try{const c=u();return Av(c)?c.catch(d=>{throw o.runOutsideAngular(()=>s.handleError(d)),d}):c}catch(c){throw o.runOutsideAngular(()=>s.handleError(c)),c}}(C,d,()=>{const T=E.injector.get(Nl);return T.runInitializers(),T.donePromise.then(()=>(function zv(s){xt(s,"Expected localeId to be defined"),"string"==typeof s&&(mC=s.toLowerCase().replace(/_/g,"-"))}(E.injector.get(Bm,Dl)||Dl),this._moduleDoBootstrap(E),E))})})}bootstrapModule(u,c=[]){const d=hd({},c);return function Gm(s,o,u){const c=new td(u);return Promise.resolve(c)}(0,0,u).then(p=>this.bootstrapModuleFactory(p,d))}_moduleDoBootstrap(u){const c=u.injector.get(Rf);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(d=>c.bootstrap(d));else{if(!u.instance.ngDoBootstrap)throw new Oe(403,!1);u.instance.ngDoBootstrap(c)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Oe(404,!1);this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const u=this._injector.get(Sa,null);u&&(u.forEach(c=>c()),u.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(u){return new(u||s)(Qn(Lo))},s.\u0275prov=Qt({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function hd(s,o){return Array.isArray(o)?o.reduce(hd,s):{...s,...o}}let Rf=(()=>{class s{constructor(u,c,d){this._zone=u,this._injector=c,this._exceptionHandler=d,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const p=new N.y(E=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{E.next(this._stable),E.complete()})}),y=new N.y(E=>{let C;this._zone.runOutsideAngular(()=>{C=this._zone.onStable.subscribe(()=>{Qi.assertNotInAngularZone(),Vw(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,E.next(!0))})})});const T=this._zone.onUnstable.subscribe(()=>{Qi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{E.next(!1)}))});return()=>{C.unsubscribe(),T.unsubscribe()}});this.isStable=(0,oe.T)(p,y.pipe((0,ye.B)()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(u,c){const d=u instanceof VC;if(!this._injector.get(Nl).done)throw!d&&od(u),new Oe(405,false);let y;y=d?u:this._injector.get(Iu).resolveComponentFactory(u),this.componentTypes.push(y.componentType);const E=function Af(s){return s.isBoundToModule}(y)?void 0:this._injector.get(Cu),T=y.create(Lo.NULL,[],c||y.selector,E),A=T.location.nativeElement,V=T.injector.get(Hw,null);return V?.registerApplication(A),T.onDestroy(()=>{this.detachView(T.hostView),qm(this.components,T),V?.unregisterApplication(A)}),this._loadComponent(T),T}tick(){if(this._runningTick)throw new Oe(101,!1);try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const c=u;this._views.push(c),c.attachToAppRef(this)}detachView(u){const c=u;qm(this._views,c),c.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u),this._injector.get(xb,[]).concat(this._bootstrapListeners).forEach(d=>d(u))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(u=>u()),this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(u){return this._destroyListeners.push(u),()=>qm(this._destroyListeners,u)}destroy(){if(this._destroyed)throw new Oe(406,!1);const u=this._injector;u.destroy&&!u.destroyed&&u.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return s.\u0275fac=function(u){return new(u||s)(Qn(Qi),Qn(Lo),Qn(Ch))},s.\u0275prov=Qt({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function qm(s,o){const u=s.indexOf(o);u>-1&&s.splice(u,1)}let Ym=!0,Zw=!1;function Bb(){return Zw=!0,Ym}function jb(){if(Zw)throw new Error("Cannot enable prod mode after platform setup.");Ym=!1}let Jm=(()=>{class s{}return s.__NG_ELEMENT_ID__=Mf,s})();function Mf(s){return function kl(s,o,u){if(ts(s)&&!u){const c=Sr(s.index,o);return new ed(c,c)}return 47&s.type?new ed(o[16],o):null}(In(),be(),16==(16&s))}class Wb{constructor(){}supports(o){return Os(o)}create(o){return new Ix(o)}}const Ex=(s,o)=>o;class Ix{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||Ex}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,c=this._removalsHead,d=0,p=null;for(;u||c;){const y=!c||u&&u.currentIndex<Jw(c,d,p)?u:c,E=Jw(y,d,p),C=y.currentIndex;if(y===c)d--,c=c._nextRemoved;else if(u=u._next,null==y.previousIndex)d++;else{p||(p=[]);const T=E-d,A=C-d;if(T!=A){for(let Z=0;Z<T;Z++){const se=Z<p.length?p[Z]:p[Z]=0,Me=se+Z;A<=Me&&Me<T&&(p[Z]=se+1)}p[y.previousIndex]=A-T}}E!==C&&o(y,E,C)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!Os(o))throw new Oe(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let d,p,y,u=this._itHead,c=!1;if(Array.isArray(o)){this.length=o.length;for(let E=0;E<this.length;E++)p=o[E],y=this._trackByFn(E,p),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,p,y,E)),Object.is(u.item,p)||this._addIdentityChange(u,p)):(u=this._mismatch(u,p,y,E),c=!0),u=u._next}else d=0,function NS(s,o){if(Array.isArray(s))for(let u=0;u<s.length;u++)o(s[u]);else{const u=s[wa()]();let c;for(;!(c=u.next()).done;)o(c.value)}}(o,E=>{y=this._trackByFn(d,E),null!==u&&Object.is(u.trackById,y)?(c&&(u=this._verifyReinsertion(u,E,y,d)),Object.is(u.item,E)||this._addIdentityChange(u,E)):(u=this._mismatch(u,E,y,d),c=!0),u=u._next,d++}),this.length=d;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,c,d){let p;return null===o?p=this._itTail:(p=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,p,d)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(c,d))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,p,d)):o=this._addAfter(new Cx(u,c),p,d),o}_verifyReinsertion(o,u,c,d){let p=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==p?o=this._reinsertAfter(p,o._prev,d):o.currentIndex!=d&&(o.currentIndex=d,this._addToMoves(o,d)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const d=o._prevRemoved,p=o._nextRemoved;return null===d?this._removalsHead=p:d._nextRemoved=p,null===p?this._removalsTail=d:p._prevRemoved=d,this._insertAfter(o,u,c),this._addToMoves(o,c),o}_moveAfter(o,u,c){return this._unlink(o),this._insertAfter(o,u,c),this._addToMoves(o,c),o}_addAfter(o,u,c){return this._insertAfter(o,u,c),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,c){const d=null===u?this._itHead:u._next;return o._next=d,o._prev=u,null===d?this._itTail=o:d._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new Aa),this._linkedRecords.put(o),o.currentIndex=c,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,c=o._next;return null===u?this._itHead=c:u._next=c,null===c?this._itTail=u:c._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Aa),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class Cx{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Of{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===u||u<=c.currentIndex)&&Object.is(c.trackById,o))return c;return null}remove(o){const u=o._prevDup,c=o._nextDup;return null===u?this._head=c:u._nextDup=c,null===c?this._tail=u:c._prevDup=u,null===this._head}}class Aa{constructor(){this.map=new Map}put(o){const u=o.trackById;let c=this.map.get(u);c||(c=new Of,this.map.set(u,c)),c.add(o)}get(o,u){const d=this.map.get(o);return d?d.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Jw(s,o,u){const c=s.previousIndex;if(null===c)return c;let d=0;return u&&c<u.length&&(d=u[c]),c+o+d}class Xw{constructor(){}supports(o){return o instanceof Map||Cv(o)}create(){return new zb}}class zb{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||Cv(o)))throw new Oe(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(c,d)=>{if(u&&u.key===d)this._maybeAddToChanges(u,c),this._appendAfter=u,u=u._next;else{const p=this._getOrCreateRecordForKey(d,c);u=this._insertBeforeOrAppend(u,p)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let c=u;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const c=o._prev;return u._next=o,u._prev=c,o._prev=u,c&&(c._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const d=this._records.get(o);this._maybeAddToChanges(d,u);const p=d._prev,y=d._next;return p&&(p._next=y),y&&(y._prev=p),d._next=null,d._prev=null,d}const c=new gd(o);return this._records.set(o,c),c.currentValue=u,this._addToAdditions(c),c}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(c=>u(o[c],c))}}class gd{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function qb(){return new e0([new Wb])}let e0=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(null!=c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||qb()),deps:[[s,new Qs,new Qa]]}}find(u){const c=this.factories.find(d=>d.supports(u));if(null!=c)return c;throw new Oe(901,!1)}}return s.\u0275prov=Qt({token:s,providedIn:"root",factory:qb}),s})();function Kb(){return new r_([new Xw])}let r_=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(c){const d=c.factories.slice();u=u.concat(d)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||Kb()),deps:[[s,new Qs,new Qa]]}}find(u){const c=this.factories.find(d=>d.supports(u));if(c)return c;throw new Oe(901,!1)}}return s.\u0275prov=Qt({token:s,providedIn:"root",factory:Kb}),s})();const Qb=Ww(null,"core",[]);let n0=(()=>{class s{constructor(u){}}return s.\u0275fac=function(u){return new(u||s)(Qn(Rf))},s.\u0275mod=yt({type:s}),s.\u0275inj=Pt({}),s})();function Tx(s){return"boolean"==typeof s?s:null!=s&&"false"!==s}},3942:(mt,Fe,P)=>{P.d(Fe,{Z:()=>Oe});var f=P(2090),B=P(4859),N=P(9681),oe=P(1877);class ye{constructor(ge,pe){this._delegate=ge,this.firebase=pe,(0,N._addComponent)(ge,new B.wA("app-compat",()=>this,"PUBLIC")),this.container=ge.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ge){this._delegate.automaticDataCollectionEnabled=ge}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(ge=>{this._delegate.checkDestroyed(),ge()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,N.deleteApp)(this._delegate)))}_getService(ge,pe=N._DEFAULT_ENTRY_NAME){var rt;this._delegate.checkDestroyed();const Ye=this._delegate.container.getProvider(ge);return!Ye.isInitialized()&&"EXPLICIT"===(null===(rt=Ye.getComponent())||void 0===rt?void 0:rt.instantiationMode)&&Ye.initialize(),Ye.getImmediate({identifier:pe})}_removeServiceInstance(ge,pe=N._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(ge).clearInstance(pe)}_addComponent(ge){(0,N._addComponent)(this._delegate,ge)}_addOrOverwriteComponent(ge){(0,N._addOrOverwriteComponent)(this._delegate,ge)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const de=new f.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),z=function we(){const We=function fe(We){const ge={},pe={__esModule:!0,initializeApp:function Ve(te,me={}){const Re=N.initializeApp(te,me);if((0,f.r3)(ge,Re.name))return ge[Re.name];const X=new We(Re,pe);return ge[Re.name]=X,X},app:Ye,registerVersion:N.registerVersion,setLogLevel:N.setLogLevel,onLog:N.onLog,apps:null,SDK_VERSION:N.SDK_VERSION,INTERNAL:{registerComponent:function Ae(te){const me=te.name,Re=me.replace("-compat","");if(N._registerComponent(te)&&"PUBLIC"===te.type){const X=(re=Ye())=>{if("function"!=typeof re[Re])throw de.create("invalid-app-argument",{appName:me});return re[Re]()};void 0!==te.serviceProps&&(0,f.ZB)(X,te.serviceProps),pe[Re]=X,We.prototype[Re]=function(...re){return this._getService.bind(this,me).apply(this,te.multipleInstances?re:[])}}return"PUBLIC"===te.type?pe[Re]:null},removeApp:function rt(te){delete ge[te]},useAsService:function Je(te,me){return"serverAuth"===me?null:me},modularAPIs:N}};function Ye(te){if(!(0,f.r3)(ge,te=te||N._DEFAULT_ENTRY_NAME))throw de.create("no-app",{appName:te});return ge[te]}return pe.default=pe,Object.defineProperty(pe,"apps",{get:function Pe(){return Object.keys(ge).map(te=>ge[te])}}),Ye.App=We,pe}(ye);return We.INTERNAL=Object.assign(Object.assign({},We.INTERNAL),{createFirebaseNamespace:we,extendNamespace:function ge(pe){(0,f.ZB)(We,pe)},createSubscribe:f.ne,ErrorFactory:f.LL,deepExtend:f.ZB}),We}(),G=new oe.Yd("@firebase/app-compat");if((0,f.jU)()&&void 0!==self.firebase){G.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const We=self.firebase.SDK_VERSION;We&&We.indexOf("LITE")>=0&&G.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Oe=z;!function Te(We){(0,N.registerVersion)("@firebase/app-compat","0.1.30",We)}()},9681:(mt,Fe,P)=>{P.r(Fe),P.d(Fe,{FirebaseError:()=>oe.ZR,SDK_VERSION:()=>fr,_DEFAULT_ENTRY_NAME:()=>xt,_addComponent:()=>yn,_addOrOverwriteComponent:()=>Qt,_apps:()=>cn,_clearComponents:()=>Dr,_components:()=>er,_getProvider:()=>Pt,_registerComponent:()=>Ft,_removeServiceInstance:()=>tn,deleteApp:()=>ht,getApp:()=>$n,getApps:()=>wr,initializeApp:()=>ur,onLog:()=>rn,registerVersion:()=>nn,setLogLevel:()=>Bn});var f=P(5861),B=P(4859),N=P(1877),oe=P(2090),ye=P(8766);class Ce{constructor(q){this.container=q}getPlatformInfoString(){return this.container.getProviders().map(K=>{if(function de(H){return"VERSION"===H.getComponent()?.type}(K)){const ke=K.getImmediate();return`${ke.library}/${ke.version}`}return null}).filter(K=>K).join(" ")}}const fe="@firebase/app",z=new N.Yd("@firebase/app"),xt="[DEFAULT]",Qe={[fe]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},cn=new Map,er=new Map;function yn(H,q){try{H.container.addComponent(q)}catch(K){z.debug(`Component ${q.name} failed to register with FirebaseApp ${H.name}`,K)}}function Qt(H,q){H.container.addOrOverwriteComponent(q)}function Ft(H){const q=H.name;if(er.has(q))return z.debug(`There were multiple attempts to register component ${q}.`),!1;er.set(q,H);for(const K of cn.values())yn(K,H);return!0}function Pt(H,q){const K=H.container.getProvider("heartbeat").getImmediate({optional:!0});return K&&K.triggerHeartbeat(),H.container.getProvider(q)}function tn(H,q,K=xt){Pt(H,q).clearInstance(K)}function Dr(){er.clear()}const Nn=new oe.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class tr{constructor(q,K,ke){this._isDeleted=!1,this._options=Object.assign({},q),this._config=Object.assign({},K),this._name=K.name,this._automaticDataCollectionEnabled=K.automaticDataCollectionEnabled,this._container=ke,this.container.addComponent(new B.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(q){this.checkDestroyed(),this._automaticDataCollectionEnabled=q}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(q){this._isDeleted=q}checkDestroyed(){if(this.isDeleted)throw Nn.create("app-deleted",{appName:this._name})}}const fr="9.9.1";function ur(H,q={}){"object"!=typeof q&&(q={name:q});const K=Object.assign({name:xt,automaticDataCollectionEnabled:!1},q),ke=K.name;if("string"!=typeof ke||!ke)throw Nn.create("bad-app-name",{appName:String(ke)});const Xe=cn.get(ke);if(Xe){if((0,oe.vZ)(H,Xe.options)&&(0,oe.vZ)(K,Xe.config))return Xe;throw Nn.create("duplicate-app",{appName:ke})}const yt=new B.H0(ke);for(const Xt of er.values())yt.addComponent(Xt);const Kt=new tr(H,K,yt);return cn.set(ke,Kt),Kt}function $n(H=xt){const q=cn.get(H);if(!q)throw Nn.create("no-app",{appName:H});return q}function wr(){return Array.from(cn.values())}function ht(H){return nr.apply(this,arguments)}function nr(){return(nr=(0,f.Z)(function*(H){const q=H.name;cn.has(q)&&(cn.delete(q),yield Promise.all(H.container.getProviders().map(K=>K.delete())),H.isDeleted=!0)})).apply(this,arguments)}function nn(H,q,K){var ke;let Xe=null!==(ke=Qe[H])&&void 0!==ke?ke:H;K&&(Xe+=`-${K}`);const yt=Xe.match(/\s|\//),Kt=q.match(/\s|\//);if(yt||Kt){const Xt=[`Unable to register library "${Xe}" with version "${q}":`];return yt&&Xt.push(`library name "${Xe}" contains illegal characters (whitespace or "/")`),yt&&Kt&&Xt.push("and"),Kt&&Xt.push(`version name "${q}" contains illegal characters (whitespace or "/")`),void z.warn(Xt.join(" "))}Ft(new B.wA(`${Xe}-version`,()=>({library:Xe,version:q}),"VERSION"))}function rn(H,q){if(null!==H&&"function"!=typeof H)throw Nn.create("invalid-log-argument");(0,N.Am)(H,q)}function Bn(H){(0,N.Ub)(H)}const Dn="firebase-heartbeat-store";let Kn=null;function gr(){return Kn||(Kn=(0,ye.X3)("firebase-heartbeat-database",1,{upgrade:(H,q)=>{0===q&&H.createObjectStore(Dn)}}).catch(H=>{throw Nn.create("storage-open",{originalErrorMessage:H.message})})),Kn}function et(){return(et=(0,f.Z)(function*(H){var q;try{return(yield gr()).transaction(Dn).objectStore(Dn).get(lr(H))}catch(K){throw Nn.create("storage-get",{originalErrorMessage:null===(q=K)||void 0===q?void 0:q.message})}})).apply(this,arguments)}function nt(H,q){return Pn.apply(this,arguments)}function Pn(){return(Pn=(0,f.Z)(function*(H,q){var K;try{const Xe=(yield gr()).transaction(Dn,"readwrite");return yield Xe.objectStore(Dn).put(q,lr(H)),Xe.done}catch(ke){throw Nn.create("storage-set",{originalErrorMessage:null===(K=ke)||void 0===K?void 0:K.message})}})).apply(this,arguments)}function lr(H){return`${H.name}!${H.options.appId}`}class vn{constructor(q){this.container=q,this._heartbeatsCache=null;const K=this.container.getProvider("app").getImmediate();this._storage=new Ln(K),this._heartbeatsCachePromise=this._storage.read().then(ke=>(this._heartbeatsCache=ke,ke))}triggerHeartbeat(){var q=this;return(0,f.Z)(function*(){const ke=q.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Xe=gn();if(null===q._heartbeatsCache&&(q._heartbeatsCache=yield q._heartbeatsCachePromise),q._heartbeatsCache.lastSentHeartbeatDate!==Xe&&!q._heartbeatsCache.heartbeats.some(yt=>yt.date===Xe))return q._heartbeatsCache.heartbeats.push({date:Xe,agent:ke}),q._heartbeatsCache.heartbeats=q._heartbeatsCache.heartbeats.filter(yt=>{const Kt=new Date(yt.date).valueOf();return Date.now()-Kt<=2592e6}),q._storage.overwrite(q._heartbeatsCache)})()}getHeartbeatsHeader(){var q=this;return(0,f.Z)(function*(){if(null===q._heartbeatsCache&&(yield q._heartbeatsCachePromise),null===q._heartbeatsCache||0===q._heartbeatsCache.heartbeats.length)return"";const K=gn(),{heartbeatsToSend:ke,unsentEntries:Xe}=function Jt(H,q=1024){const K=[];let ke=H.slice();for(const Xe of H){const yt=K.find(Kt=>Kt.agent===Xe.agent);if(yt){if(yt.dates.push(Xe.date),$(K)>q){yt.dates.pop();break}}else if(K.push({agent:Xe.agent,dates:[Xe.date]}),$(K)>q){K.pop();break}ke=ke.slice(1)}return{heartbeatsToSend:K,unsentEntries:ke}}(q._heartbeatsCache.heartbeats),yt=(0,oe.L)(JSON.stringify({version:2,heartbeats:ke}));return q._heartbeatsCache.lastSentHeartbeatDate=K,Xe.length>0?(q._heartbeatsCache.heartbeats=Xe,yield q._storage.overwrite(q._heartbeatsCache)):(q._heartbeatsCache.heartbeats=[],q._storage.overwrite(q._heartbeatsCache)),yt})()}}function gn(){return(new Date).toISOString().substring(0,10)}class Ln{constructor(q){this.app=q,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,f.Z)(function*(){return!!(0,oe.hl)()&&(0,oe.eu)().then(()=>!0).catch(()=>!1)})()}read(){var q=this;return(0,f.Z)(function*(){return(yield q._canUseIndexedDBPromise)&&(yield function Ut(H){return et.apply(this,arguments)}(q.app))||{heartbeats:[]}})()}overwrite(q){var K=this;return(0,f.Z)(function*(){var ke;if(yield K._canUseIndexedDBPromise){const yt=yield K.read();return nt(K.app,{lastSentHeartbeatDate:null!==(ke=q.lastSentHeartbeatDate)&&void 0!==ke?ke:yt.lastSentHeartbeatDate,heartbeats:q.heartbeats})}})()}add(q){var K=this;return(0,f.Z)(function*(){var ke;if(yield K._canUseIndexedDBPromise){const yt=yield K.read();return nt(K.app,{lastSentHeartbeatDate:null!==(ke=q.lastSentHeartbeatDate)&&void 0!==ke?ke:yt.lastSentHeartbeatDate,heartbeats:[...yt.heartbeats,...q.heartbeats]})}})()}}function $(H){return(0,oe.L)(JSON.stringify({version:2,heartbeats:H})).length}!function W(H){Ft(new B.wA("platform-logger",q=>new Ce(q),"PRIVATE")),Ft(new B.wA("heartbeat",q=>new vn(q),"PRIVATE")),nn(fe,"0.7.29",H),nn(fe,"0.7.29","esm2017"),nn("fire-js","")}("")},4859:(mt,Fe,P)=>{P.d(Fe,{H0:()=>fe,wA:()=>N,zt:()=>ye});var f=P(5861),B=P(2090);class N{constructor(z,G,ne){this.name=z,this.instanceFactory=G,this.type=ne,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(z){return this.instantiationMode=z,this}setMultipleInstances(z){return this.multipleInstances=z,this}setServiceProps(z){return this.serviceProps=z,this}setInstanceCreatedCallback(z){return this.onInstanceCreated=z,this}}const oe="[DEFAULT]";class ye{constructor(z,G){this.name=z,this.container=G,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(z){const G=this.normalizeInstanceIdentifier(z);if(!this.instancesDeferred.has(G)){const ne=new B.BH;if(this.instancesDeferred.set(G,ne),this.isInitialized(G)||this.shouldAutoInitialize())try{const Ue=this.getOrInitializeService({instanceIdentifier:G});Ue&&ne.resolve(Ue)}catch{}}return this.instancesDeferred.get(G).promise}getImmediate(z){var G;const ne=this.normalizeInstanceIdentifier(z?.identifier),Ue=null!==(G=z?.optional)&&void 0!==G&&G;if(!this.isInitialized(ne)&&!this.shouldAutoInitialize()){if(Ue)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:ne})}catch(Te){if(Ue)return null;throw Te}}getComponent(){return this.component}setComponent(z){if(z.name!==this.name)throw Error(`Mismatching Component ${z.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=z,this.shouldAutoInitialize()){if(function de(we){return"EAGER"===we.instantiationMode}(z))try{this.getOrInitializeService({instanceIdentifier:oe})}catch{}for(const[G,ne]of this.instancesDeferred.entries()){const Ue=this.normalizeInstanceIdentifier(G);try{const Te=this.getOrInitializeService({instanceIdentifier:Ue});ne.resolve(Te)}catch{}}}}clearInstance(z=oe){this.instancesDeferred.delete(z),this.instancesOptions.delete(z),this.instances.delete(z)}delete(){var z=this;return(0,f.Z)(function*(){const G=Array.from(z.instances.values());yield Promise.all([...G.filter(ne=>"INTERNAL"in ne).map(ne=>ne.INTERNAL.delete()),...G.filter(ne=>"_delete"in ne).map(ne=>ne._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(z=oe){return this.instances.has(z)}getOptions(z=oe){return this.instancesOptions.get(z)||{}}initialize(z={}){const{options:G={}}=z,ne=this.normalizeInstanceIdentifier(z.instanceIdentifier);if(this.isInitialized(ne))throw Error(`${this.name}(${ne}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Ue=this.getOrInitializeService({instanceIdentifier:ne,options:G});for(const[Te,Oe]of this.instancesDeferred.entries())ne===this.normalizeInstanceIdentifier(Te)&&Oe.resolve(Ue);return Ue}onInit(z,G){var ne;const Ue=this.normalizeInstanceIdentifier(G),Te=null!==(ne=this.onInitCallbacks.get(Ue))&&void 0!==ne?ne:new Set;Te.add(z),this.onInitCallbacks.set(Ue,Te);const Oe=this.instances.get(Ue);return Oe&&z(Oe,Ue),()=>{Te.delete(z)}}invokeOnInitCallbacks(z,G){const ne=this.onInitCallbacks.get(G);if(ne)for(const Ue of ne)try{Ue(z,G)}catch{}}getOrInitializeService({instanceIdentifier:z,options:G={}}){let ne=this.instances.get(z);if(!ne&&this.component&&(ne=this.component.instanceFactory(this.container,{instanceIdentifier:(we=z,we===oe?void 0:we),options:G}),this.instances.set(z,ne),this.instancesOptions.set(z,G),this.invokeOnInitCallbacks(ne,z),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,z,ne)}catch{}var we;return ne||null}normalizeInstanceIdentifier(z=oe){return this.component?this.component.multipleInstances?z:oe:z}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class fe{constructor(z){this.name=z,this.providers=new Map}addComponent(z){const G=this.getProvider(z.name);if(G.isComponentSet())throw new Error(`Component ${z.name} has already been registered with ${this.name}`);G.setComponent(z)}addOrOverwriteComponent(z){this.getProvider(z.name).isComponentSet()&&this.providers.delete(z.name),this.addComponent(z)}getProvider(z){if(this.providers.has(z))return this.providers.get(z);const G=new ye(z,this);return this.providers.set(z,G),G}getProviders(){return Array.from(this.providers.values())}}},2833:(mt,Fe,P)=>{var f=P(5861),B=P(9681),N=P(4859),oe=P(2090),ye=P(8766);const Ce="@firebase/installations",de="0.5.12",we=`w:${de}`,z="FIS_v2",We=new oe.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ge(ee){return ee instanceof oe.ZR&&ee.code.includes("request-failed")}function pe({projectId:ee}){return`https://firebaseinstallations.googleapis.com/v1/projects/${ee}/installations`}function rt(ee){return{token:ee.token,requestStatus:2,expiresIn:me(ee.expiresIn),creationTime:Date.now()}}function Ye(ee,De){return Ve.apply(this,arguments)}function Ve(){return(Ve=(0,f.Z)(function*(ee,De){const at=(yield De.json()).error;return We.create("request-failed",{requestName:ee,serverCode:at.code,serverMessage:at.message,serverStatus:at.status})})).apply(this,arguments)}function Pe({apiKey:ee}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":ee})}function Ae(ee,{refreshToken:De}){const He=Pe(ee);return He.append("Authorization",function Re(ee){return`${z} ${ee}`}(De)),He}function Je(ee){return te.apply(this,arguments)}function te(){return(te=(0,f.Z)(function*(ee){const De=yield ee();return De.status>=500&&De.status<600?ee():De})).apply(this,arguments)}function me(ee){return Number(ee.replace("s","000"))}function X(ee,De){return re.apply(this,arguments)}function re(){return(re=(0,f.Z)(function*({appConfig:ee,heartbeatServiceProvider:De},{fid:He}){const at=pe(ee),Tn=Pe(ee),on=De.getImmediate({optional:!0});if(on){const Zt=yield on.getHeartbeatsHeader();Zt&&Tn.append("x-firebase-client",Zt)}const Wn={method:"POST",headers:Tn,body:JSON.stringify({fid:He,authVersion:z,appId:ee.appId,sdkVersion:we})},hi=yield Je(()=>fetch(at,Wn));if(hi.ok){const Zt=yield hi.json();return{fid:Zt.fid||He,registrationStatus:2,refreshToken:Zt.refreshToken,authToken:rt(Zt.authToken)}}throw yield Ye("Create Installation",hi)})).apply(this,arguments)}function ae(ee){return new Promise(De=>{setTimeout(De,ee)})}const le=/^[cdef][\w-]{21}$/;function ft(){try{const ee=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(ee),ee[0]=112+ee[0]%16;const He=function Gt(ee){return function ve(ee){return btoa(String.fromCharCode(...ee)).replace(/\+/g,"-").replace(/\//g,"_")}(ee).substr(0,22)}(ee);return le.test(He)?He:""}catch{return""}}function xt(ee){return`${ee.appName}!${ee.appId}`}const Qe=new Map;function cn(ee,De){const He=xt(ee);Qt(He,De),function Ft(ee,De){const He=function tn(){return!Pt&&"BroadcastChannel"in self&&(Pt=new BroadcastChannel("[Firebase] FID Change"),Pt.onmessage=ee=>{Qt(ee.data.key,ee.data.fid)}),Pt}();He&&He.postMessage({key:ee,fid:De}),function Dr(){0===Qe.size&&Pt&&(Pt.close(),Pt=null)}()}(He,De)}function Qt(ee,De){const He=Qe.get(ee);if(He)for(const at of He)at(De)}let Pt=null;const tr="firebase-installations-store";let fr=null;function ur(){return fr||(fr=(0,ye.X3)("firebase-installations-database",1,{upgrade:(ee,De)=>{0===De&&ee.createObjectStore(tr)}})),fr}function $n(ee,De){return wr.apply(this,arguments)}function wr(){return(wr=(0,f.Z)(function*(ee,De){const He=xt(ee),Tn=(yield ur()).transaction(tr,"readwrite"),on=Tn.objectStore(tr),fn=yield on.get(He);return yield on.put(De,He),yield Tn.done,(!fn||fn.fid!==De.fid)&&cn(ee,De.fid),De})).apply(this,arguments)}function ht(ee){return nr.apply(this,arguments)}function nr(){return(nr=(0,f.Z)(function*(ee){const De=xt(ee),at=(yield ur()).transaction(tr,"readwrite");yield at.objectStore(tr).delete(De),yield at.done})).apply(this,arguments)}function nn(ee,De){return rn.apply(this,arguments)}function rn(){return(rn=(0,f.Z)(function*(ee,De){const He=xt(ee),Tn=(yield ur()).transaction(tr,"readwrite"),on=Tn.objectStore(tr),fn=yield on.get(He),Wn=De(fn);return void 0===Wn?yield on.delete(He):yield on.put(Wn,He),yield Tn.done,Wn&&(!fn||fn.fid!==Wn.fid)&&cn(ee,Wn.fid),Wn})).apply(this,arguments)}function Bn(ee){return pr.apply(this,arguments)}function pr(){return(pr=(0,f.Z)(function*(ee){let De;const He=yield nn(ee.appConfig,at=>{const Tn=bn(at),on=Dn(ee,Tn);return De=on.registrationPromise,on.installationEntry});return""===He.fid?{installationEntry:yield De}:{installationEntry:He,registrationPromise:De}})).apply(this,arguments)}function bn(ee){return Pn(ee||{fid:ft(),registrationStatus:0})}function Dn(ee,De){if(0===De.registrationStatus){if(!navigator.onLine)return{installationEntry:De,registrationPromise:Promise.reject(We.create("app-offline"))};const He={fid:De.fid,registrationStatus:1,registrationTime:Date.now()},at=function Kn(ee,De){return gr.apply(this,arguments)}(ee,He);return{installationEntry:He,registrationPromise:at}}return 1===De.registrationStatus?{installationEntry:De,registrationPromise:Ut(ee)}:{installationEntry:De}}function gr(){return(gr=(0,f.Z)(function*(ee,De){try{const He=yield X(ee,De);return $n(ee.appConfig,He)}catch(He){throw ge(He)&&409===He.customData.serverCode?yield ht(ee.appConfig):yield $n(ee.appConfig,{fid:De.fid,registrationStatus:0}),He}})).apply(this,arguments)}function Ut(ee){return et.apply(this,arguments)}function et(){return(et=(0,f.Z)(function*(ee){let De=yield nt(ee.appConfig);for(;1===De.registrationStatus;)yield ae(100),De=yield nt(ee.appConfig);if(0===De.registrationStatus){const{installationEntry:He,registrationPromise:at}=yield Bn(ee);return at||He}return De})).apply(this,arguments)}function nt(ee){return nn(ee,De=>{if(!De)throw We.create("installation-not-found");return Pn(De)})}function Pn(ee){return function lr(ee){return 1===ee.registrationStatus&&ee.registrationTime+1e4<Date.now()}(ee)?{fid:ee.fid,registrationStatus:0}:ee}function Dt(ee,De){return rr.apply(this,arguments)}function rr(){return(rr=(0,f.Z)(function*({appConfig:ee,heartbeatServiceProvider:De},He){const at=vn(ee,He),Tn=Ae(ee,He),on=De.getImmediate({optional:!0});if(on){const Zt=yield on.getHeartbeatsHeader();Zt&&Tn.append("x-firebase-client",Zt)}const Wn={method:"POST",headers:Tn,body:JSON.stringify({installation:{sdkVersion:we,appId:ee.appId}})},hi=yield Je(()=>fetch(at,Wn));if(hi.ok)return rt(yield hi.json());throw yield Ye("Generate Auth Token",hi)})).apply(this,arguments)}function vn(ee,{fid:De}){return`${pe(ee)}/${De}/authTokens:generate`}function gn(ee){return Jt.apply(this,arguments)}function Jt(){return(Jt=(0,f.Z)(function*(ee,De=!1){let He;const at=yield nn(ee.appConfig,on=>{if(!K(on))throw We.create("not-registered");const fn=on.authToken;if(!De&&ke(fn))return on;if(1===fn.requestStatus)return He=Ln(ee,De),on;{if(!navigator.onLine)throw We.create("app-offline");const Wn=yt(on);return He=H(ee,Wn),Wn}});return He?yield He:at.authToken})).apply(this,arguments)}function Ln(ee,De){return $.apply(this,arguments)}function $(){return($=(0,f.Z)(function*(ee,De){let He=yield W(ee.appConfig);for(;1===He.authToken.requestStatus;)yield ae(100),He=yield W(ee.appConfig);const at=He.authToken;return 0===at.requestStatus?gn(ee,De):at})).apply(this,arguments)}function W(ee){return nn(ee,De=>{if(!K(De))throw We.create("not-registered");return function Kt(ee){return 1===ee.requestStatus&&ee.requestTime+1e4<Date.now()}(De.authToken)?Object.assign(Object.assign({},De),{authToken:{requestStatus:0}}):De})}function H(ee,De){return q.apply(this,arguments)}function q(){return(q=(0,f.Z)(function*(ee,De){try{const He=yield Dt(ee,De),at=Object.assign(Object.assign({},De),{authToken:He});return yield $n(ee.appConfig,at),He}catch(He){if(!ge(He)||401!==He.customData.serverCode&&404!==He.customData.serverCode){const at=Object.assign(Object.assign({},De),{authToken:{requestStatus:0}});yield $n(ee.appConfig,at)}else yield ht(ee.appConfig);throw He}})).apply(this,arguments)}function K(ee){return void 0!==ee&&2===ee.registrationStatus}function ke(ee){return 2===ee.requestStatus&&!function Xe(ee){const De=Date.now();return De<ee.creationTime||ee.creationTime+ee.expiresIn<De+36e5}(ee)}function yt(ee){const De={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},ee),{authToken:De})}function ue(){return(ue=(0,f.Z)(function*(ee){const De=ee,{installationEntry:He,registrationPromise:at}=yield Bn(De);return at?at.catch(console.error):gn(De).catch(console.error),He.fid})).apply(this,arguments)}function M(){return(M=(0,f.Z)(function*(ee,De=!1){const He=ee;return yield F(He),(yield gn(He,De)).token})).apply(this,arguments)}function F(ee){return J.apply(this,arguments)}function J(){return(J=(0,f.Z)(function*(ee){const{registrationPromise:De}=yield Bn(ee);De&&(yield De)})).apply(this,arguments)}function dn(ee){return We.create("missing-app-config-values",{valueName:ee})}const En="installations",di=ee=>{const De=ee.getProvider("app").getImmediate(),He=function pt(ee){if(!ee||!ee.options)throw dn("App Configuration");if(!ee.name)throw dn("App Name");const De=["projectId","apiKey","appId"];for(const He of De)if(!ee.options[He])throw dn(He);return{appName:ee.name,projectId:ee.options.projectId,apiKey:ee.options.apiKey,appId:ee.options.appId}}(De);return{app:De,appConfig:He,heartbeatServiceProvider:(0,B._getProvider)(De,"heartbeat"),_delete:()=>Promise.resolve()}},Lt=ee=>{const De=ee.getProvider("app").getImmediate(),He=(0,B._getProvider)(De,En).getImmediate();return{getId:()=>function Xt(ee){return ue.apply(this,arguments)}(He),getToken:Tn=>function U(ee){return M.apply(this,arguments)}(He,Tn)}};(function Gn(){(0,B._registerComponent)(new N.wA(En,di,"PUBLIC")),(0,B._registerComponent)(new N.wA("installations-internal",Lt,"PRIVATE"))})(),(0,B.registerVersion)(Ce,de),(0,B.registerVersion)(Ce,de,"esm2017")},1877:(mt,Fe,P)=>{P.d(Fe,{Am:()=>we,Ub:()=>fe,Yd:()=>de,in:()=>B});const f=[];var B=(()=>{return(z=B||(B={}))[z.DEBUG=0]="DEBUG",z[z.VERBOSE=1]="VERBOSE",z[z.INFO=2]="INFO",z[z.WARN=3]="WARN",z[z.ERROR=4]="ERROR",z[z.SILENT=5]="SILENT",B;var z})();const N={debug:B.DEBUG,verbose:B.VERBOSE,info:B.INFO,warn:B.WARN,error:B.ERROR,silent:B.SILENT},oe=B.INFO,ye={[B.DEBUG]:"log",[B.VERBOSE]:"log",[B.INFO]:"info",[B.WARN]:"warn",[B.ERROR]:"error"},Ce=(z,G,...ne)=>{if(G<z.logLevel)return;const Ue=(new Date).toISOString(),Te=ye[G];if(!Te)throw new Error(`Attempted to log a message with an invalid logType (value: ${G})`);console[Te](`[${Ue}]  ${z.name}:`,...ne)};class de{constructor(G){this.name=G,this._logLevel=oe,this._logHandler=Ce,this._userLogHandler=null,f.push(this)}get logLevel(){return this._logLevel}set logLevel(G){if(!(G in B))throw new TypeError(`Invalid value "${G}" assigned to \`logLevel\``);this._logLevel=G}setLogLevel(G){this._logLevel="string"==typeof G?N[G]:G}get logHandler(){return this._logHandler}set logHandler(G){if("function"!=typeof G)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=G}get userLogHandler(){return this._userLogHandler}set userLogHandler(G){this._userLogHandler=G}debug(...G){this._userLogHandler&&this._userLogHandler(this,B.DEBUG,...G),this._logHandler(this,B.DEBUG,...G)}log(...G){this._userLogHandler&&this._userLogHandler(this,B.VERBOSE,...G),this._logHandler(this,B.VERBOSE,...G)}info(...G){this._userLogHandler&&this._userLogHandler(this,B.INFO,...G),this._logHandler(this,B.INFO,...G)}warn(...G){this._userLogHandler&&this._userLogHandler(this,B.WARN,...G),this._logHandler(this,B.WARN,...G)}error(...G){this._userLogHandler&&this._userLogHandler(this,B.ERROR,...G),this._logHandler(this,B.ERROR,...G)}}function fe(z){f.forEach(G=>{G.setLogLevel(z)})}function we(z,G){for(const ne of f){let Ue=null;G&&G.level&&(Ue=N[G.level]),ne.userLogHandler=null===z?null:(Te,Oe,...We)=>{const ge=We.map(pe=>{if(null==pe)return null;if("string"==typeof pe)return pe;if("number"==typeof pe||"boolean"==typeof pe)return pe.toString();if(pe instanceof Error)return pe.message;try{return JSON.stringify(pe)}catch{return null}}).filter(pe=>pe).join(" ");Oe>=(Ue??Te.logLevel)&&z({level:B[Oe].toLowerCase(),message:ge,args:We,type:Te.name})}}}},8766:(mt,Fe,P)=>{P.d(Fe,{Lj:()=>Ve,X3:()=>Ye});var f=P(5861);let N,oe;const de=new WeakMap,fe=new WeakMap,we=new WeakMap,z=new WeakMap,G=new WeakMap;let Te={get(me,Re,X){if(me instanceof IDBTransaction){if("done"===Re)return fe.get(me);if("objectStoreNames"===Re)return me.objectStoreNames||we.get(me);if("store"===Re)return X.objectStoreNames[1]?void 0:X.objectStore(X.objectStoreNames[0])}return pe(me[Re])},set:(me,Re,X)=>(me[Re]=X,!0),has:(me,Re)=>me instanceof IDBTransaction&&("done"===Re||"store"===Re)||Re in me};function ge(me){return"function"==typeof me?function We(me){return me!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Ce(){return oe||(oe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(me)?function(...Re){return me.apply(rt(this),Re),pe(de.get(this))}:function(...Re){return pe(me.apply(rt(this),Re))}:function(Re,...X){const re=me.call(rt(this),Re,...X);return we.set(re,Re.sort?Re.sort():[Re]),pe(re)}}(me):(me instanceof IDBTransaction&&function Ue(me){if(fe.has(me))return;const Re=new Promise((X,re)=>{const ae=()=>{me.removeEventListener("complete",ve),me.removeEventListener("error",le),me.removeEventListener("abort",le)},ve=()=>{X(),ae()},le=()=>{re(me.error||new DOMException("AbortError","AbortError")),ae()};me.addEventListener("complete",ve),me.addEventListener("error",le),me.addEventListener("abort",le)});fe.set(me,Re)}(me),((me,Re)=>Re.some(X=>me instanceof X))(me,function ye(){return N||(N=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(me,Te):me)}function pe(me){if(me instanceof IDBRequest)return function ne(me){const Re=new Promise((X,re)=>{const ae=()=>{me.removeEventListener("success",ve),me.removeEventListener("error",le)},ve=()=>{X(pe(me.result)),ae()},le=()=>{re(me.error),ae()};me.addEventListener("success",ve),me.addEventListener("error",le)});return Re.then(X=>{X instanceof IDBCursor&&de.set(X,me)}).catch(()=>{}),G.set(Re,me),Re}(me);if(z.has(me))return z.get(me);const Re=ge(me);return Re!==me&&(z.set(me,Re),G.set(Re,me)),Re}const rt=me=>G.get(me);function Ye(me,Re,{blocked:X,upgrade:re,blocking:ae,terminated:ve}={}){const le=indexedDB.open(me,Re),$e=pe(le);return re&&le.addEventListener("upgradeneeded",ft=>{re(pe(le.result),ft.oldVersion,ft.newVersion,pe(le.transaction))}),X&&le.addEventListener("blocked",()=>X()),$e.then(ft=>{ve&&ft.addEventListener("close",()=>ve()),ae&&ft.addEventListener("versionchange",()=>ae())}).catch(()=>{}),$e}function Ve(me,{blocked:Re}={}){const X=indexedDB.deleteDatabase(me);return Re&&X.addEventListener("blocked",()=>Re()),pe(X).then(()=>{})}const Pe=["get","getKey","getAll","getAllKeys","count"],Ae=["put","add","delete","clear"],Je=new Map;function te(me,Re){if(!(me instanceof IDBDatabase)||Re in me||"string"!=typeof Re)return;if(Je.get(Re))return Je.get(Re);const X=Re.replace(/FromIndex$/,""),re=Re!==X,ae=Ae.includes(X);if(!(X in(re?IDBIndex:IDBObjectStore).prototype)||!ae&&!Pe.includes(X))return;const ve=function(){var le=(0,f.Z)(function*($e,...ft){const Gt=this.transaction($e,ae?"readwrite":"readonly");let xt=Gt.store;return re&&(xt=xt.index(ft.shift())),(yield Promise.all([xt[X](...ft),ae&&Gt.done]))[0]});return function(ft){return le.apply(this,arguments)}}();return Je.set(Re,ve),ve}!function Oe(me){Te=me(Te)}(me=>({...me,get:(Re,X,re)=>te(Re,X)||me.get(Re,X,re),has:(Re,X)=>!!te(Re,X)||me.has(Re,X)}))},5861:(mt,Fe,P)=>{function f(N,oe,ye,Ce,de,fe,we){try{var z=N[fe](we),G=z.value}catch(ne){return void ye(ne)}z.done?oe(G):Promise.resolve(G).then(Ce,de)}function B(N){return function(){var oe=this,ye=arguments;return new Promise(function(Ce,de){var fe=N.apply(oe,ye);function we(G){f(fe,Ce,de,we,z,"next",G)}function z(G){f(fe,Ce,de,we,z,"throw",G)}we(void 0)})}}P.d(Fe,{Z:()=>B})}},mt=>{mt(mt.s=6034)}]);